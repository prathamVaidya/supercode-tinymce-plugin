import{r as ri,R as Kf}from"./index-BBkUAzwr.js";import{p as K}from"./index-_4_hgnnR.js";var Xf=function(){return Xf=Object.assign||function(me){for(var ce,ge=1,be=arguments.length;ge<be;ge++){ce=arguments[ge];for(var ve in ce)Object.prototype.hasOwnProperty.call(ce,ve)&&(me[ve]=ce[ve])}return me},Xf.apply(this,arguments)},ax={onActivate:K.func,onAddUndo:K.func,onBeforeAddUndo:K.func,onBeforeExecCommand:K.func,onBeforeGetContent:K.func,onBeforeRenderUI:K.func,onBeforeSetContent:K.func,onBeforePaste:K.func,onBlur:K.func,onChange:K.func,onClearUndos:K.func,onClick:K.func,onContextMenu:K.func,onCommentChange:K.func,onCompositionEnd:K.func,onCompositionStart:K.func,onCompositionUpdate:K.func,onCopy:K.func,onCut:K.func,onDblclick:K.func,onDeactivate:K.func,onDirty:K.func,onDrag:K.func,onDragDrop:K.func,onDragEnd:K.func,onDragGesture:K.func,onDragOver:K.func,onDrop:K.func,onExecCommand:K.func,onFocus:K.func,onFocusIn:K.func,onFocusOut:K.func,onGetContent:K.func,onHide:K.func,onInit:K.func,onInput:K.func,onKeyDown:K.func,onKeyPress:K.func,onKeyUp:K.func,onLoadContent:K.func,onMouseDown:K.func,onMouseEnter:K.func,onMouseLeave:K.func,onMouseMove:K.func,onMouseOut:K.func,onMouseOver:K.func,onMouseUp:K.func,onNodeChange:K.func,onObjectResizeStart:K.func,onObjectResized:K.func,onObjectSelected:K.func,onPaste:K.func,onPostProcess:K.func,onPostRender:K.func,onPreProcess:K.func,onProgressState:K.func,onRedo:K.func,onRemove:K.func,onReset:K.func,onSaveContent:K.func,onSelectionChange:K.func,onSetAttrib:K.func,onSetContent:K.func,onShow:K.func,onSubmit:K.func,onUndo:K.func,onVisualAid:K.func,onSkinLoadError:K.func,onThemeLoadError:K.func,onModelLoadError:K.func,onPluginLoadError:K.func,onIconsLoadError:K.func,onLanguageLoadError:K.func,onScriptsLoad:K.func,onScriptsLoadError:K.func},tP=Xf({apiKey:K.string,licenseKey:K.string,id:K.string,inline:K.bool,init:K.object,initialValue:K.string,onEditorChange:K.func,value:K.string,tagName:K.string,cloudChannel:K.string,plugins:K.oneOfType([K.string,K.array]),toolbar:K.oneOfType([K.string,K.array]),disabled:K.bool,textareaName:K.string,tinymceScriptSrc:K.oneOfType([K.string,K.arrayOf(K.string),K.arrayOf(K.shape({src:K.string,async:K.bool,defer:K.bool}))]),rollback:K.oneOfType([K.number,K.oneOf([!1])]),scriptLoading:K.shape({async:K.bool,defer:K.bool,delay:K.number})},ax),Yf=function(me){return typeof me=="function"},Yk=function(me){return me in ax},Gk=function(me){return me.substr(2)},nP=function(me,ce,ge,be,ve,_e,H){var Se=Object.keys(ve).filter(Yk),Ae=Object.keys(_e).filter(Yk),$e=Se.filter(function(je){return _e[je]===void 0}),ot=Ae.filter(function(je){return ve[je]===void 0});$e.forEach(function(je){var Q=Gk(je),We=H[Q];ge(Q,We),delete H[Q]}),ot.forEach(function(je){var Q=be(me,je),We=Gk(je);H[We]=Q,ce(We,Q)})},oP=function(me,ce,ge,be,ve){return nP(ve,me.on.bind(me),me.off.bind(me),function(_e,H){return function(Se){var Ae;return(Ae=_e(H))===null||Ae===void 0?void 0:Ae(Se,me)}},ce,ge,be)},Xk=0,ix=function(me){var ce=Date.now(),ge=Math.floor(Math.random()*1e9);return Xk++,me+"_"+ge+Xk+String(ce)},Zk=function(me){return me!==null&&(me.tagName.toLowerCase()==="textarea"||me.tagName.toLowerCase()==="input")},Qk=function(me){return typeof me>"u"||me===""?[]:Array.isArray(me)?me:me.split(" ")},rP=function(me,ce){return Qk(me).concat(Qk(ce))},sP=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},aP=function(me){if(!("isConnected"in Node.prototype)){for(var ce=me,ge=me.parentNode;ge!=null;)ce=ge,ge=ce.parentNode;return ce===me.ownerDocument}return me.isConnected},Jk=function(me,ce){me!==void 0&&(me.mode!=null&&typeof me.mode=="object"&&typeof me.mode.set=="function"?me.mode.set(ce):me.setMode(ce))},Zf=function(){return Zf=Object.assign||function(me){for(var ce,ge=1,be=arguments.length;ge<be;ge++){ce=arguments[ge];for(var ve in ce)Object.prototype.hasOwnProperty.call(ce,ve)&&(me[ve]=ce[ve])}return me},Zf.apply(this,arguments)},iP=function(me,ce,ge){var be,ve,_e=me.createElement("script");_e.referrerPolicy="origin",_e.type="application/javascript",_e.id=ce.id,_e.src=ce.src,_e.async=(be=ce.async)!==null&&be!==void 0?be:!1,_e.defer=(ve=ce.defer)!==null&&ve!==void 0?ve:!1;var H=function(){_e.removeEventListener("load",H),_e.removeEventListener("error",Se),ge(ce.src)},Se=function(Ae){_e.removeEventListener("load",H),_e.removeEventListener("error",Se),ge(ce.src,Ae)};_e.addEventListener("load",H),_e.addEventListener("error",Se),me.head&&me.head.appendChild(_e)},lP=function(me){var ce={},ge=function(H,Se){var Ae=ce[H];Ae.done=!0,Ae.error=Se;for(var $e=0,ot=Ae.handlers;$e<ot.length;$e++){var je=ot[$e];je(H,Se)}Ae.handlers=[]},be=function(H,Se,Ae){var $e=function(st){return Ae!==void 0?Ae(st):console.error(st)};if(H.length===0){$e(new Error("At least one script must be provided"));return}for(var ot=0,je=!1,Q=function(st,at){je||(at?(je=!0,$e(at)):++ot===H.length&&Se())},We=0,Rt=H;We<Rt.length;We++){var He=Rt[We],ct=ce[He.src];if(ct)ct.done?Q(He.src,ct.error):ct.handlers.push(Q);else{var Kt=ix("tiny-");ce[He.src]={id:Kt,src:He.src,done:!1,error:null,handlers:[Q]},iP(me,Zf({id:Kt},He),ge)}}},ve=function(){for(var H,Se=0,Ae=Object.values(ce);Se<Ae.length;Se++){var $e=Ae[Se],ot=me.getElementById($e.id);ot!=null&&ot.tagName==="SCRIPT"&&((H=ot.parentNode)===null||H===void 0||H.removeChild(ot))}ce={}},_e=function(){return me};return{loadScripts:be,deleteScripts:ve,getDocument:_e}},cP=function(){var me=[],ce=function(ve){var _e=me.find(function(H){return H.getDocument()===ve});return _e===void 0&&(_e=lP(ve),me.push(_e)),_e},ge=function(ve,_e,H,Se,Ae){var $e=function(){return ce(ve).loadScripts(_e,Se,Ae)};H>0?setTimeout($e,H):$e()},be=function(){for(var ve=me.pop();ve!=null;ve=me.pop())ve.deleteScripts()};return{loadList:ge,reinitialize:be}},dP=cP(),Gf=function(me){var ce=me;return ce&&ce.tinymce?ce.tinymce:null},uP=function(){var me=function(ce,ge){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(be,ve){be.__proto__=ve}||function(be,ve){for(var _e in ve)Object.prototype.hasOwnProperty.call(ve,_e)&&(be[_e]=ve[_e])},me(ce,ge)};return function(ce,ge){if(typeof ge!="function"&&ge!==null)throw new TypeError("Class extends value "+String(ge)+" is not a constructor or null");me(ce,ge);function be(){this.constructor=ce}ce.prototype=ge===null?Object.create(ge):(be.prototype=ge.prototype,new be)}}(),_s=function(){return _s=Object.assign||function(me){for(var ce,ge=1,be=arguments.length;ge<be;ge++){ce=arguments[ge];for(var ve in ce)Object.prototype.hasOwnProperty.call(ce,ve)&&(me[ve]=ce[ve])}return me},_s.apply(this,arguments)},mP=function(me){uP(ce,me);function ce(ge){var be,ve,_e,H=me.call(this,ge)||this;return H.rollbackTimer=void 0,H.valueCursor=void 0,H.rollbackChange=function(){var Se=H.editor,Ae=H.props.value;Se&&Ae&&Ae!==H.currentContent&&Se.undoManager.ignore(function(){if(Se.setContent(Ae),H.valueCursor&&(!H.inline||Se.hasFocus()))try{Se.selection.moveToBookmark(H.valueCursor)}catch{}}),H.rollbackTimer=void 0},H.handleBeforeInput=function(Se){if(H.props.value!==void 0&&H.props.value===H.currentContent&&H.editor&&(!H.inline||H.editor.hasFocus()))try{H.valueCursor=H.editor.selection.getBookmark(3)}catch{}},H.handleBeforeInputSpecial=function(Se){(Se.key==="Enter"||Se.key==="Backspace"||Se.key==="Delete")&&H.handleBeforeInput(Se)},H.handleEditorChange=function(Se){var Ae=H.editor;if(Ae&&Ae.initialized){var $e=Ae.getContent();H.props.value!==void 0&&H.props.value!==$e&&H.props.rollback!==!1&&(H.rollbackTimer||(H.rollbackTimer=window.setTimeout(H.rollbackChange,typeof H.props.rollback=="number"?H.props.rollback:200))),$e!==H.currentContent&&(H.currentContent=$e,Yf(H.props.onEditorChange)&&H.props.onEditorChange($e,Ae))}},H.handleEditorChangeSpecial=function(Se){(Se.key==="Backspace"||Se.key==="Delete")&&H.handleEditorChange(Se)},H.initialise=function(Se){var Ae,$e,ot;Se===void 0&&(Se=0);var je=H.elementRef.current;if(je){if(!aP(je)){if(Se===0)setTimeout(function(){return H.initialise(1)},1);else if(Se<100)setTimeout(function(){return H.initialise(Se+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var Q=Gf(H.view);if(!Q)throw new Error("tinymce should have been loaded into global scope");var We=_s(_s(_s(_s({},H.props.init),{selector:void 0,target:je,readonly:H.props.disabled,inline:H.inline,plugins:rP((Ae=H.props.init)===null||Ae===void 0?void 0:Ae.plugins,H.props.plugins),toolbar:($e=H.props.toolbar)!==null&&$e!==void 0?$e:(ot=H.props.init)===null||ot===void 0?void 0:ot.toolbar}),H.props.licenseKey?{license_key:H.props.licenseKey}:{}),{setup:function(Rt){H.editor=Rt,H.bindHandlers({}),H.inline&&!Zk(je)&&Rt.once("PostRender",function(He){Rt.setContent(H.getInitialValue(),{no_events:!0})}),H.props.init&&Yf(H.props.init.setup)&&H.props.init.setup(Rt)},init_instance_callback:function(Rt){var He,ct,Kt=H.getInitialValue();H.currentContent=(He=H.currentContent)!==null&&He!==void 0?He:Rt.getContent(),H.currentContent!==Kt&&(H.currentContent=Kt,Rt.setContent(Kt),Rt.undoManager.clear(),Rt.undoManager.add(),Rt.setDirty(!1));var st=(ct=H.props.disabled)!==null&&ct!==void 0?ct:!1;Jk(H.editor,st?"readonly":"design"),H.props.init&&Yf(H.props.init.init_instance_callback)&&H.props.init.init_instance_callback(Rt)}});H.inline||(je.style.visibility=""),Zk(je)&&(je.value=H.getInitialValue()),Q.init(We)}},H.id=H.props.id||ix("tiny-react"),H.elementRef=ri.createRef(),H.inline=(_e=(be=H.props.inline)!==null&&be!==void 0?be:(ve=H.props.init)===null||ve===void 0?void 0:ve.inline)!==null&&_e!==void 0?_e:!1,H.boundHandlers={},H}return Object.defineProperty(ce.prototype,"view",{get:function(){var ge,be;return(be=(ge=this.elementRef.current)===null||ge===void 0?void 0:ge.ownerDocument.defaultView)!==null&&be!==void 0?be:window},enumerable:!1,configurable:!0}),ce.prototype.componentDidUpdate=function(ge){var be=this,ve,_e;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(ge),this.editor.initialized)){if(this.currentContent=(ve=this.currentContent)!==null&&ve!==void 0?ve:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==ge.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var H=this.editor;H.undoManager.transact(function(){var Ae;if(!be.inline||H.hasFocus())try{Ae=H.selection.getBookmark(3)}catch{}var $e=be.valueCursor;if(H.setContent(be.props.value),!be.inline||H.hasFocus())for(var ot=0,je=[Ae,$e];ot<je.length;ot++){var Q=je[ot];if(Q)try{H.selection.moveToBookmark(Q),be.valueCursor=Q;break}catch{}}})}if(this.props.disabled!==ge.disabled){var Se=(_e=this.props.disabled)!==null&&_e!==void 0?_e:!1;Jk(this.editor,Se?"readonly":"design")}}},ce.prototype.componentDidMount=function(){var ge=this,be,ve,_e,H,Se;if(Gf(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(ve=(be=this.props).onScriptsLoadError)===null||ve===void 0||ve.call(be,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((_e=this.elementRef.current)===null||_e===void 0)&&_e.ownerDocument){var Ae=function(){var ot,je;(je=(ot=ge.props).onScriptsLoad)===null||je===void 0||je.call(ot),ge.initialise()},$e=function(ot){var je,Q;(Q=(je=ge.props).onScriptsLoadError)===null||Q===void 0||Q.call(je,ot)};dP.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(Se=(H=this.props.scriptLoading)===null||H===void 0?void 0:H.delay)!==null&&Se!==void 0?Se:0,Ae,$e)}},ce.prototype.componentWillUnmount=function(){var ge=this,be=this.editor;be&&(be.off(this.changeEvents(),this.handleEditorChange),be.off(this.beforeInputEvent(),this.handleBeforeInput),be.off("keypress",this.handleEditorChangeSpecial),be.off("keydown",this.handleBeforeInputSpecial),be.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(ve){be.off(ve,ge.boundHandlers[ve])}),this.boundHandlers={},be.remove(),this.editor=void 0)},ce.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},ce.prototype.changeEvents=function(){var ge,be,ve,_e=(ve=(be=(ge=Gf(this.view))===null||ge===void 0?void 0:ge.Env)===null||be===void 0?void 0:be.browser)===null||ve===void 0?void 0:ve.isIE();return _e?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},ce.prototype.beforeInputEvent=function(){return sP()?"beforeinput SelectionChange":"SelectionChange"},ce.prototype.renderInline=function(){var ge=this.props.tagName,be=ge===void 0?"div":ge;return ri.createElement(be,{ref:this.elementRef,id:this.id})},ce.prototype.renderIframe=function(){return ri.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},ce.prototype.getScriptSources=function(){var ge,be,ve=(ge=this.props.scriptLoading)===null||ge===void 0?void 0:ge.async,_e=(be=this.props.scriptLoading)===null||be===void 0?void 0:be.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:ve,defer:_e}]:this.props.tinymceScriptSrc.map(function($e){return typeof $e=="string"?{src:$e,async:ve,defer:_e}:$e});var H=this.props.cloudChannel,Se=this.props.apiKey?this.props.apiKey:"no-api-key",Ae="https://cdn.tiny.cloud/1/".concat(Se,"/tinymce/").concat(H,"/tinymce.min.js");return[{src:Ae,async:ve,defer:_e}]},ce.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},ce.prototype.bindHandlers=function(ge){var be=this;if(this.editor!==void 0){oP(this.editor,ge,this.props,this.boundHandlers,function(Se){return be.props[Se]});var ve=function(Se){return Se.onEditorChange!==void 0||Se.value!==void 0},_e=ve(ge),H=ve(this.props);!_e&&H?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):_e&&!H&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},ce.propTypes=tP,ce.defaultProps={cloudChannel:"7"},ce}(ri.Component);(function(){var me=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},ce=function(e){return{eq:e}},ge=ce(function(e,t){return e===t}),be=function(e){return ce(function(t,n){if(t.length!==n.length)return!1;for(var o=t.length,r=0;r<o;r++)if(!e.eq(t[r],n[r]))return!1;return!0})},ve=function(e){return ce(function(t,n){var o=Object.keys(t),r=Object.keys(n);if(!function(l,c){return function(d,u){return ce(function(m,p){return d.eq(u(m),u(p))})}(be(l),function(d){return function(u,m){return Array.prototype.slice.call(u).sort(m)}(d,c)})}(ge).eq(o,r))return!1;for(var s=o.length,a=0;a<s;a++){var i=o[a];if(!e.eq(t[i],n[i]))return!1}return!0})},_e=ce(function(e,t){if(e===t)return!0;var n=me(e);return n===me(t)&&(function(o){return["undefined","boolean","number","string","function","xml","null"].indexOf(o)!==-1}(n)?e===t:n==="array"?be(_e).eq(e,t):n==="object"&&ve(_e).eq(e,t))});const H=Object.getPrototypeOf,Se=(e,t,n)=>{var o;return!!n(e,t.prototype)||((o=e.constructor)===null||o===void 0?void 0:o.name)===t.name},Ae=e=>t=>(n=>{const o=typeof n;return n===null?"null":o==="object"&&Array.isArray(n)?"array":o==="object"&&Se(n,String,(r,s)=>s.isPrototypeOf(r))?"string":o})(t)===e,$e=e=>t=>typeof t===e,ot=e=>t=>e===t,je=(e,t)=>We(e)&&Se(e,t,(n,o)=>H(n)===o),Q=Ae("string"),We=Ae("object"),Rt=e=>je(e,Object),He=Ae("array"),ct=ot(null),Kt=$e("boolean"),st=ot(void 0),at=e=>e==null,q=e=>!at(e),Ie=$e("function"),Sn=$e("number"),Ar=(e,t)=>{if(He(e)){for(let n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},Ne=()=>{},In=(e,t)=>(...n)=>e(t.apply(null,n)),Qf=(e,t)=>n=>e(t(n)),oe=e=>()=>e,jt=e=>e,Jf=(e,t)=>e===t;function ne(e,...t){return(...n)=>{const o=t.concat(n);return e.apply(null,o)}}const Ss=e=>t=>!e(t),eg=e=>()=>{throw new Error(e)},pc=e=>e(),Ns=e=>{e()},Qe=oe(!1),dt=oe(!0);class C{constructor(t,n){this.tag=t,this.value=n}static some(t){return new C(!0,t)}static none(){return C.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?C.some(t(this.value)):C.none()}bind(t){return this.tag?t(this.value):C.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:C.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return q(t)?C.some(t):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);const hc=Array.prototype.slice,cx=Array.prototype.indexOf,dx=Array.prototype.push,tg=(e,t)=>cx.call(e,t),Ue=(e,t)=>tg(e,t)>-1,it=(e,t)=>{for(let n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1},Te=(e,t)=>{const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const s=e[r];o[r]=t(s,r)}return o},U=(e,t)=>{for(let n=0,o=e.length;n<o;n++)t(e[n],n)},ng=(e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)},Tr=(e,t)=>{const n=[],o=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];(t(a,r)?n:o).push(a)}return{pass:n,fail:o}},ye=(e,t)=>{const n=[];for(let o=0,r=e.length;o<r;o++){const s=e[o];t(s,o)&&n.push(s)}return n},Rs=(e,t,n)=>(ng(e,(o,r)=>{n=t(n,o,r)}),n),Yt=(e,t,n)=>(U(e,(o,r)=>{n=t(n,o,r)}),n),og=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++){const s=e[o];if(t(s,o))return C.some(s);if(n(s,o))break}return C.none()},pt=(e,t)=>og(e,t,Qe),As=(e,t)=>{for(let n=0,o=e.length;n<o;n++)if(t(e[n],n))return C.some(n);return C.none()},rg=e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!He(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);dx.apply(t,e[n])}return t},an=(e,t)=>rg(Te(e,t)),wo=(e,t)=>{for(let n=0,o=e.length;n<o;++n)if(t(e[n],n)!==!0)return!1;return!0},Ts=e=>{const t=hc.call(e,0);return t.reverse(),t},si=(e,t)=>ye(e,n=>!Ue(t,n)),bc=(e,t)=>{const n={};for(let o=0,r=e.length;o<r;o++){const s=e[o];n[String(s)]=t(s,o)}return n},Vo=(e,t)=>{const n=hc.call(e,0);return n.sort(t),n},Os=(e,t)=>t>=0&&t<e.length?C.some(e[t]):C.none(),Ht=e=>Os(e,0),Eo=e=>Os(e,e.length-1),en=Ie(Array.from)?Array.from:e=>hc.call(e),Or=(e,t)=>{for(let n=0;n<e.length;n++){const o=t(e[n],n);if(o.isSome())return o}return C.none()},sg=(e,t)=>{const n=[],o=Ie(t)?r=>it(n,s=>t(s,r)):r=>Ue(n,r);for(let r=0,s=e.length;r<s;r++){const a=e[r];o(a)||n.push(a)}return n},Gt=Object.keys,ux=Object.hasOwnProperty,Ke=(e,t)=>{const n=Gt(e);for(let o=0,r=n.length;o<r;o++){const s=n[o];t(e[s],s)}},Bs=(e,t)=>mx(e,(n,o)=>({k:o,v:t(n,o)})),mx=(e,t)=>{const n={};return Ke(e,(o,r)=>{const s=t(o,r);n[s.k]=s.v}),n},vc=e=>(t,n)=>{e[n]=t},ag=(e,t,n,o)=>{Ke(e,(r,s)=>{(t(r,s)?n:o)(r,s)})},Ps=(e,t)=>{const n={};return ag(e,t,vc(n),Ne),n},ai=(e,t)=>{const n=[];return Ke(e,(o,r)=>{n.push(t(o,r))}),n},yc=e=>ai(e,jt),Xe=(e,t)=>ke(e,t)?C.from(e[t]):C.none(),ke=(e,t)=>ux.call(e,t),Br=(e,t)=>ke(e,t)&&e[t]!==void 0&&e[t]!==null,ig=e=>{const t={};return U(e,n=>{t[n]={}}),Gt(t)},lg=e=>e.length!==void 0,Cc=Array.isArray,ii=(e,t,n)=>{if(!e)return!1;if(n=n||e,lg(e)){for(let o=0,r=e.length;o<r;o++)if(t.call(n,e[o],o,e)===!1)return!1}else for(const o in e)if(ke(e,o)&&t.call(n,e[o],o,e)===!1)return!1;return!0},wc=(e,t)=>{const n=[];return ii(e,(o,r)=>{n.push(t(o,r,e))}),n},Ds=(e,t)=>{const n=[];return ii(e,(o,r)=>{t&&!t(o,r,e)||n.push(o)}),n},li=(e,t,n,o)=>{let r=st(n)?e[0]:n;for(let s=0;s<e.length;s++)r=t.call(o,r,e[s],s);return r},cg=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++)if(t.call(n,e[o],o,e))return o;return-1},qo=e=>e[e.length-1],Fn=e=>{let t,n=!1;return(...o)=>(n||(n=!0,t=e.apply(null,o)),t)},dg=()=>Ec(0,0),Ec=(e,t)=>({major:e,minor:t}),Ls={nu:Ec,detect:(e,t)=>{const n=String(t).toLowerCase();return e.length===0?dg():((o,r)=>{const s=((i,l)=>{for(let c=0;c<i.length;c++){const d=i[c];if(d.test(l))return d}})(o,r);if(!s)return{major:0,minor:0};const a=i=>Number(r.replace(s,"$"+i));return Ec(a(1),a(2))})(e,n)},unknown:dg},ug=(e,t)=>{const n=String(t).toLowerCase();return pt(e,o=>o.search(n))},mg=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,fg=(e,t)=>ht(e,t)?((n,o)=>n.substring(o))(e,t.length):e,At=(e,t,n=0,o)=>{const r=e.indexOf(t,n);return r!==-1&&(!!st(o)||r+t.length<=o)},ht=(e,t)=>mg(e,t,0),kc=(e,t)=>mg(e,t,e.length-t.length),xc=e=>t=>t.replace(e,""),Pr=xc(/^\s+|\s+$/g),fx=xc(/^\s+/g),gg=xc(/\s+$/g),Un=e=>e.length>0,Ms=e=>!Un(e),ci=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?C.none():C.some(n)},_c=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ro=e=>t=>At(t,e),gx=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>At(e,"edge/")&&At(e,"chrome")&&At(e,"safari")&&At(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,_c],search:e=>At(e,"chrome")&&!At(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>At(e,"msie")||At(e,"trident")},{name:"Opera",versionRegexes:[_c,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ro("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ro("firefox")},{name:"Safari",versionRegexes:[_c,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(At(e,"safari")||At(e,"mobile/"))&&At(e,"applewebkit")}],px=[{name:"Windows",search:ro("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>At(e,"iphone")||At(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ro("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:ro("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ro("linux"),versionRegexes:[]},{name:"Solaris",search:ro("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ro("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ro("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],pg={browsers:oe(gx),oses:oe(px)},hx="Edge",bx="Chromium",vx="Opera",yx="Firefox",Cx="Safari",hg=e=>{const t=e.current,n=e.version,o=r=>()=>t===r;return{current:t,version:n,isEdge:o(hx),isChromium:o(bx),isIE:o("IE"),isOpera:o(vx),isFirefox:o(yx),isSafari:o(Cx)}},wx=()=>hg({current:void 0,version:Ls.unknown()}),Ex=hg,kx="Windows",xx="Android",_x="Linux",Sx="macOS",Nx="Solaris",Rx="FreeBSD",Ax="ChromeOS",bg=e=>{const t=e.current,n=e.version,o=r=>()=>t===r;return{current:t,version:n,isWindows:o(kx),isiOS:o("iOS"),isAndroid:o(xx),isMacOS:o(Sx),isLinux:o(_x),isSolaris:o(Nx),isFreeBSD:o(Rx),isChromeOS:o(Ax)}},Tx=()=>bg({current:void 0,version:Ls.unknown()}),Ox=bg,Bx=e=>window.matchMedia(e).matches;let Px=Fn(()=>((e,t,n)=>{const o=pg.browsers(),r=pg.oses(),s=t.bind(l=>((c,d)=>Or(d.brands,u=>{const m=u.brand.toLowerCase();return pt(c,p=>{var g;return m===((g=p.brand)===null||g===void 0?void 0:g.toLowerCase())}).map(p=>({current:p.name,version:Ls.nu(parseInt(u.version,10),0)}))}))(o,l)).orThunk(()=>((l,c)=>ug(l,c).map(d=>{const u=Ls.detect(d.versionRegexes,c);return{current:d.name,version:u}}))(o,e)).fold(wx,Ex),a=((l,c)=>ug(l,c).map(d=>{const u=Ls.detect(d.versionRegexes,c);return{current:d.name,version:u}}))(r,e).fold(Tx,Ox),i=((l,c,d,u)=>{const m=l.isiOS()&&/ipad/i.test(d)===!0,p=l.isiOS()&&!m,g=l.isiOS()||l.isAndroid(),h=g||u("(pointer:coarse)"),f=m||!p&&g&&u("(min-device-width:768px)"),b=p||g&&!f,v=c.isSafari()&&l.isiOS()&&/safari/i.test(d)===!1,y=!b&&!f&&!v;return{isiPad:oe(m),isiPhone:oe(p),isTablet:oe(f),isPhone:oe(b),isTouch:oe(h),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:oe(v),isDesktop:oe(y)}})(a,s,e,n);return{browser:s,os:a,deviceType:i}})(navigator.userAgent,C.from(navigator.userAgentData),Bx));const zn=()=>Px(),Dx=navigator.userAgent,Sc=zn(),jn=Sc.browser,Hn=Sc.os,Wo=Sc.deviceType,Lx=Dx.indexOf("Windows Phone")!==-1,Be={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:jn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!jn.isIE(),windowsPhone:Lx,browser:{current:jn.current,version:jn.version,isChromium:jn.isChromium,isEdge:jn.isEdge,isFirefox:jn.isFirefox,isIE:jn.isIE,isOpera:jn.isOpera,isSafari:jn.isSafari},os:{current:Hn.current,version:Hn.version,isAndroid:Hn.isAndroid,isChromeOS:Hn.isChromeOS,isFreeBSD:Hn.isFreeBSD,isiOS:Hn.isiOS,isLinux:Hn.isLinux,isMacOS:Hn.isMacOS,isSolaris:Hn.isSolaris,isWindows:Hn.isWindows},deviceType:{isDesktop:Wo.isDesktop,isiPad:Wo.isiPad,isiPhone:Wo.isiPhone,isPhone:Wo.isPhone,isTablet:Wo.isTablet,isTouch:Wo.isTouch,isWebView:Wo.isWebView}},Mx=/^\s*|\s*$/g,vg=e=>at(e)?"":(""+e).replace(Mx,""),yg=function(e,t,n,o){o=o||this,e&&(n&&(e=e[n]),ii(e,(r,s)=>t.call(o,r,s,n)!==!1&&(yg(r,t,n,o),!0)))},$={trim:vg,isArray:Cc,is:(e,t)=>t?!(t!=="array"||!Cc(e))||typeof e===t:e!==void 0,toArray:e=>{if(Cc(e))return e;{const t=[];for(let n=0,o=e.length;n<o;n++)t[n]=e[n];return t}},makeMap:(e,t,n={})=>{const o=Q(e)?e.split(t||","):e||[];let r=o.length;for(;r--;)n[o[r]]={};return n},each:ii,map:wc,grep:Ds,inArray:(e,t)=>{if(e){for(let n=0,o=e.length;n<o;n++)if(e[n]===t)return n}return-1},hasOwn:ke,extend:(e,...t)=>{for(let n=0;n<t.length;n++){const o=t[n];for(const r in o)if(ke(o,r)){const s=o[r];s!==void 0&&(e[r]=s)}}return e},walk:yg,resolve:(e,t=window)=>{const n=e.split(".");for(let o=0,r=n.length;o<r&&(t=t[n[o]]);o++);return t},explode:(e,t)=>He(e)?e:e===""?[]:wc(e.split(t||","),vg),_addCacheSuffix:e=>{const t=Be.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},Dr=(e,t,n=Jf)=>e.exists(o=>n(o,t)),Cg=(e,t,n=Jf)=>Tt(e,t,n).getOr(e.isNone()&&t.isNone()),Tt=(e,t,n)=>e.isSome()&&t.isSome()?C.some(n(e.getOrDie(),t.getOrDie())):C.none(),Lr=(e,t)=>e?C.some(t):C.none(),Ix=typeof window<"u"?window:Function("return this;")(),wg=(e,t)=>((n,o)=>{let r=o??Ix;for(let s=0;s<n.length&&r!=null;++s)r=r[n[s]];return r})(e.split("."),t),Fx=Object.getPrototypeOf,Ux=e=>{const t=wg("ownerDocument.defaultView",e);return We(e)&&((n=>((o,r)=>{const s=((a,i)=>wg(a,i))(o,r);if(s==null)throw new Error(o+" not available on this browser");return s})("HTMLElement",n))(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(Fx(e).constructor.name))},Oe=e=>e.dom.nodeName.toLowerCase(),Eg=e=>e.dom.nodeType,di=e=>t=>Eg(t)===e,ui=e=>tn(e)&&Ux(e.dom),tn=di(1),ln=di(3),zx=di(9),jx=di(11),mi=e=>t=>tn(t)&&Oe(t)===e,kg=(e,t,n)=>{if(!(Q(n)||Kt(n)||Sn(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},_t=(e,t,n)=>{kg(e.dom,t,n)},so=(e,t)=>{const n=e.dom;Ke(t,(o,r)=>{kg(n,r,o)})},nn=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},ao=(e,t)=>C.from(nn(e,t)),Is=(e,t)=>{const n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},St=(e,t)=>{e.dom.removeAttribute(t)},xg=e=>Yt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Nc=(e,t)=>{const n=nn(e,t);return n===void 0||n===""?[]:n.split(" ")},Fs=e=>e.dom.classList!==void 0,_g=e=>Nc(e,"class"),Sg=(e,t)=>((n,o,r)=>{const s=Nc(n,o).concat([r]);return _t(n,o,s.join(" ")),!0})(e,"class",t),Ng=(e,t)=>((n,o,r)=>{const s=ye(Nc(n,o),a=>a!==r);return s.length>0?_t(n,o,s.join(" ")):St(n,o),!1})(e,"class",t),Mr=(e,t)=>{Fs(e)?e.dom.classList.add(t):Sg(e,t)},Rg=e=>{(Fs(e)?e.dom.classList:_g(e)).length===0&&St(e,"class")},Us=(e,t)=>{Fs(e)?e.dom.classList.remove(t):Ng(e,t),Rg(e)},Rc=(e,t)=>Fs(e)&&e.dom.classList.contains(t),zs=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},fi=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return zs(n.childNodes[0])},vt=(e,t)=>{const n=(t||document).createElement(e);return zs(n)},Ir=(e,t)=>{const n=(t||document).createTextNode(e);return zs(n)},R=zs,Hx=(e,t,n)=>C.from(e.dom.elementFromPoint(t,n)).map(zs),Ag=(e,t)=>{const n=[],o=s=>(n.push(s),t(s));let r=t(e);do r=r.bind(o);while(r.isSome());return n},Nn=(e,t)=>{const n=e.dom;if(n.nodeType!==1)return!1;{const o=n;if(o.matches!==void 0)return o.matches(t);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(t);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(t);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Tg=e=>e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11||e.childElementCount===0,De=(e,t)=>e.dom===t.dom,io=(e,t)=>{const n=e.dom,o=t.dom;return n!==o&&n.contains(o)},Og=e=>R(e.dom.ownerDocument),lo=e=>zx(e)?e:Og(e),js=e=>R(lo(e).dom.defaultView),Rn=e=>C.from(e.dom.parentNode).map(R),gi=e=>C.from(e.dom.parentElement).map(R),Bg=(e,t)=>{const n=Ie(t)?t:Qe;let o=e.dom;const r=[];for(;o.parentNode!==null&&o.parentNode!==void 0;){const s=o.parentNode,a=R(s);if(r.push(a),n(a)===!0)break;o=s}return r},Ko=e=>C.from(e.dom.previousSibling).map(R),Hs=e=>C.from(e.dom.nextSibling).map(R),Pg=e=>Ts(Ag(e,Ko)),Dg=e=>Ag(e,Hs),Ot=e=>Te(e.dom.childNodes,R),Fr=(e,t)=>{const n=e.dom.childNodes;return C.from(n[t]).map(R)},Ac=e=>Fr(e,0),Tc=e=>Fr(e,e.dom.childNodes.length-1),Oc=e=>e.dom.childNodes.length,Bc=e=>jx(e)&&q(e.dom.host),Lg=Ie(Element.prototype.attachShadow)&&Ie(Node.prototype.getRootNode),$x=oe(Lg),ko=Lg?e=>R(e.dom.getRootNode()):lo,Pc=e=>Bc(e)?e:(t=>{const n=t.dom.head;if(n==null)throw new Error("Head is not available yet");return R(n)})(lo(e)),Vx=e=>R(e.dom.host),Mg=e=>{if($x()&&q(e.target)){const t=R(e.target);if(tn(t)&&qx(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return Ht(n)}}return C.from(e.target)},qx=e=>q(e.dom.shadowRoot),Ur=e=>{const t=ln(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return(o=>{const r=ko(o);return Bc(r)?C.some(r):C.none()})(R(t)).fold(()=>n.body.contains(t),Qf(Ur,Vx))};var Ig=(e,t,n,o,r)=>e(n,o)?C.some(n):Ie(r)&&r(n)?C.none():t(n,o,r);const co=(e,t,n)=>{let o=e.dom;const r=Ie(n)?n:Qe;for(;o.parentNode;){o=o.parentNode;const s=R(o);if(t(s))return C.some(s);if(r(s))break}return C.none()},Yo=(e,t,n)=>Ig((o,r)=>r(o),co,e,t,n),Fg=(e,t)=>{const n=o=>{for(let r=0;r<o.childNodes.length;r++){const s=R(o.childNodes[r]);if(t(s))return C.some(s);const a=n(o.childNodes[r]);if(a.isSome())return a}return C.none()};return n(e.dom)},$s=(e,t,n)=>co(e,o=>Nn(o,t),n),pi=(e,t)=>((n,o)=>{const r=o===void 0?document:o.dom;return Tg(r)?C.none():C.from(r.querySelector(n)).map(R)})(t,e),zr=(e,t,n)=>Ig((o,r)=>Nn(o,r),$s,e,t,n),Go=(e,t=!1)=>{return Ur(e)?e.dom.isContentEditable:(n=e,zr(n,"[contenteditable]")).fold(oe(t),o=>Wx(o)==="true");var n},Wx=e=>e.dom.contentEditable,Vs=e=>e.style!==void 0&&Ie(e.style.getPropertyValue),Ug=(e,t,n)=>{if(!Q(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Vs(e)&&e.style.setProperty(t,n)},zg=(e,t,n)=>{const o=e.dom;Ug(o,t,n)},hi=(e,t)=>{const n=e.dom;Ke(t,(o,r)=>{Ug(n,r,o)})},$n=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o!==""||Ur(e)?o:jg(n,t)},jg=(e,t)=>Vs(e)?e.style.getPropertyValue(t):"",bi=(e,t)=>{const n=e.dom,o=jg(n,t);return C.from(o).filter(r=>r.length>0)},Dc=e=>{const t={},n=e.dom;if(Vs(n))for(let o=0;o<n.style.length;o++){const r=n.style.item(o);t[r]=n.style[r]}return t},Hg=(e,t)=>{((n,o)=>{Vs(n)&&n.style.removeProperty(o)})(e.dom,t),Dr(ao(e,"style").map(Pr),"")&&St(e,"style")},Xt=(e,t)=>{Rn(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},uo=(e,t)=>{Hs(e).fold(()=>{Rn(e).each(n=>{ut(n,t)})},n=>{Xt(n,t)})},Lc=(e,t)=>{Ac(e).fold(()=>{ut(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},ut=(e,t)=>{e.dom.appendChild(t.dom)},$g=(e,t)=>{Xt(e,t),ut(t,e)},Xo=(e,t)=>{U(t,n=>{ut(e,n)})},jr=e=>{e.dom.textContent="",U(Ot(e),t=>{Ze(t)})},Ze=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},xo=e=>{const t=Ot(e);var n,o;t.length>0&&(n=e,U(o=t,(r,s)=>{const a=s===0?n:o[s-1];uo(a,r)})),Ze(e)},Mc=e=>Te(e,R),Vg=e=>e.dom.innerHTML,vi=(e,t)=>{const n=Og(e).dom,o=R(n.createDocumentFragment()),r=((s,a)=>{const i=(a||document).createElement("div");return i.innerHTML=s,Ot(R(i))})(t,n);Xo(o,r),jr(e),ut(e,o)},Kx=(e,t,n,o)=>((r,s,a,i,l)=>{const c=((d,u)=>m=>{d(m)&&u((p=>{const g=R(Mg(p).getOr(p.target)),h=()=>p.stopPropagation(),f=()=>p.preventDefault(),b=In(f,h);return((v,y,w,E,k,S,_)=>({target:v,x:y,y:w,stop:E,prevent:k,kill:S,raw:_}))(g,p.clientX,p.clientY,h,f,b,p)})(m))})(a,i);return r.dom.addEventListener(s,c,!1),{unbind:ne(Yx,r,s,c,!1)}})(e,t,n,o),Yx=(e,t,n,o)=>{e.dom.removeEventListener(t,n,o)},qg=(e,t)=>({left:e,top:t,translate:(n,o)=>qg(e+n,t+o)}),Hr=qg,yi=(e,t)=>e!==void 0?e:t!==void 0?t:0,Ic=e=>{const t=e.dom,n=t.ownerDocument.body;return n===t?Hr(n.offsetLeft,n.offsetTop):Ur(e)?(o=>{const r=o.getBoundingClientRect();return Hr(r.left,r.top)})(t):Hr(0,0)},Fc=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return Hr(n,o)},Wg=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},Kg=(e,t)=>{zn().browser.isSafari()&&Ie(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Yg=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),Gg=e=>{const t=e===void 0?window:e,n=t.document,o=Fc(R(n));return(r=>{const s=r===void 0?window:r;return zn().browser.isFirefox()?C.none():C.from(s.visualViewport)})(t).fold(()=>{const r=t.document.documentElement,s=r.clientWidth,a=r.clientHeight;return Yg(o.left,o.top,s,a)},r=>Yg(Math.max(r.pageLeft,o.left),Math.max(r.pageTop,o.top),r.width,r.height))},Xg=(e,t)=>{let n=[];return U(Ot(e),o=>{t(o)&&(n=n.concat([o])),n=n.concat(Xg(o,t))}),n},Bt=(e,t)=>((n,o)=>{const r=o===void 0?document:o.dom;return Tg(r)?[]:Te(r.querySelectorAll(n),R)})(t,e),Zg=(e,t,n)=>co(e,t,n).isSome(),Gx=(e,t)=>((n,o)=>{const r=n.dom;return r.parentNode?((s,a)=>pt(s.dom.childNodes,i=>a(R(i))).map(R))(R(r.parentNode),s=>!De(n,s)&&o(s)):C.none()})(e,t).isSome(),Qg=(e,t)=>Fg(e,t).isSome();class yt{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,o,r){if(t){if(!r&&t[n])return t[n];if(t!==this.rootNode){let s=t[o];if(s)return s;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(s=a[o],s)return s}}}findPreviousNode(t,n){if(t){const o=t.previousSibling;if(this.rootNode&&o===this.rootNode)return;if(o){if(!n){for(let s=o.lastChild;s;s=s.lastChild)if(!s.lastChild)return s}return o}const r=t.parentNode;if(r&&r!==this.rootNode)return r}}}const qs="\uFEFF",Ct=" ",Uc=e=>e===qs,Xx=/^[ \t\r\n]*$/,$r=e=>Xx.test(e),Jg=e=>e===`
`||e==="\r",ep=(e,t=4,n=!0,o=!0)=>{const r=((i,l)=>l<=0?"":new Array(l+1).join(" "))(0,t),s=e.replace(/\t/g,r);return Yt(s,(i,l)=>(c=>" \f	\v".indexOf(c)!==-1)(l)||l===Ct?i.pcIsSpace||i.str===""&&n||i.str.length===s.length-1&&o||((c,d)=>d<c.length&&d>=0&&Jg(c[d]))(s,i.str.length+1)?{pcIsSpace:!1,str:i.str+Ct}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Jg(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},Zo=e=>t=>!!t&&t.nodeType===e,Ci=e=>!!e&&!Object.getPrototypeOf(e),re=Zo(1),mo=e=>re(e)&&ui(R(e)),Ws=e=>{const t=e.toLowerCase();return n=>q(n)&&n.nodeName.toLowerCase()===t},An=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const o=n.nodeName.toLowerCase();return Ue(t,o)}return!1}},wi=(e,t)=>{const n=t.toLowerCase().split(" ");return o=>{if(re(o)){const r=o.ownerDocument.defaultView;if(r)for(let s=0;s<n.length;s++){const a=r.getComputedStyle(o,null);if((a?a.getPropertyValue(e):null)===n[s])return!0}}return!1}},Qo=e=>re(e)&&e.hasAttribute("data-mce-bogus"),Vn=e=>re(e)&&e.tagName==="TABLE",tp=e=>t=>!!(mo(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),zc=An(["textarea","input"]),j=Zo(3),Zx=Zo(4),Qx=Zo(7),_o=Zo(8),Ks=Zo(9),jc=Zo(11),rt=Ws("br"),np=Ws("img"),Cn=tp("true"),Ge=tp("false"),Ei=An(["td","th"]),Jx=An(["td","th","caption"]),qn=An(["video","audio","object","embed"]),e_=Ws("li"),Hc=Ws("details"),t_=Ws("summary"),op={skipBogus:!0,includeZwsp:!1,checkRootAsContent:!1},n_=e=>re(e)&&e.hasAttribute("data-mce-bookmark"),o_=(e,t,n,o)=>j(e)&&!((r,s,a)=>$r(r.data)&&!((i,l,c)=>{const d=R(l),u=R(i),m=c.getWhitespaceElements();return Zg(u,p=>ke(m,Oe(p)),ne(De,d))})(r,s,a))(e,t,n)&&(!o.includeZwsp||!(r=>{for(const s of r)if(!Uc(s))return!1;return!0})(e.data)),$c=(e,t,n,o)=>Ie(o.isContent)&&o.isContent(t)||((r,s)=>re(r)&&ke(s.getNonEmptyElements(),r.nodeName))(t,e)||n_(t)||(r=>re(r)&&r.nodeName==="A"&&!r.hasAttribute("href")&&(r.hasAttribute("name")||r.hasAttribute("id")))(t)||o_(t,n,e,o)||Ge(t)||Cn(t)&&(r=>gi(R(r)).exists(s=>!Go(s)))(t),fo=(e,t,n)=>{const o={...op,...n};if(o.checkRootAsContent&&$c(e,t,t,o))return!1;let r=t.firstChild,s=0;if(!r)return!0;const a=new yt(r,t);do{if(o.skipBogus&&re(r)){const i=r.getAttribute("data-mce-bogus");if(i){r=a.next(i==="all");continue}}if(_o(r))r=a.next(!0);else if(rt(r))s++,r=a.next();else{if($c(e,r,t,o))return!1;r=a.next()}}while(r);return s<=1},Pt=(e,t,n)=>fo(e,t.dom,{checkRootAsContent:!0,...n}),rp=(e,t,n)=>$c(e,t,t,{includeZwsp:op.includeZwsp,...n}),Jo=e=>e.toLowerCase()==="svg",Vc=e=>Jo(e.nodeName),sp=e=>(e==null?void 0:e.nodeName)==="svg"?"svg":"html",r_=["svg"],ki="data-mce-block",qc=e=>Te((t=>ye(Gt(t),n=>!/[A-Z]/.test(n)))(e),t=>`${t}:`+Te(r_,n=>`not(${n} ${t})`).join(":")).join(","),ap=(e,t)=>q(t.querySelector(e))?(t.setAttribute(ki,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(ki),!1),ip=(e,t)=>{const n=qc(e.getTransparentElements()),o=qc(e.getBlockElements());return ye(t.querySelectorAll(n),r=>ap(o,r))},lp=(e,t,n)=>{var o;const r=n?"lastChild":"firstChild";for(let s=t[r];s;s=s[r])if(fo(e,s,{checkRootAsContent:!0}))return void((o=s.parentNode)===null||o===void 0||o.removeChild(s))},s_=(e,t,n)=>{const o=e.getBlockElements(),r=R(t),s=i=>Oe(i)in o,a=i=>De(i,r);U(Mc(n),i=>{co(i,s,a).each(l=>{const c=((d,u)=>ye(Ot(d),m=>s(m)&&!e.isValidChild(Oe(l),Oe(m))))(i);if(c.length>0){const d=gi(l);U(c,u=>{co(u,s,a).each(m=>{((p,g,h)=>{const f=document.createRange(),b=g.parentNode;if(b){f.setStartBefore(g),f.setEndBefore(h);const v=f.extractContents();lp(p,v,!0),f.setStartAfter(h),f.setEndAfter(g);const y=f.extractContents();lp(p,y,!1),fo(p,v,{checkRootAsContent:!0})||b.insertBefore(v,g),fo(p,h,{checkRootAsContent:!0})||b.insertBefore(h,g),fo(p,y,{checkRootAsContent:!0})||b.insertBefore(y,g),b.removeChild(g)}})(e,m.dom,u.dom)})}),d.each(u=>ip(e,u.dom))}})})},Wc=(e,t)=>{const n=ip(e,t);s_(e,t,n),((o,r,s)=>{U([...s,...er(o,r)?[r]:[]],a=>U(Bt(R(a),a.nodeName.toLowerCase()),i=>{i_(o,i.dom)&&xo(i)}))})(e,t,n)},a_=(e,t)=>{if(Gc(e,t)){const n=qc(e.getBlockElements());ap(n,t)}},Kc=e=>e.hasAttribute(ki),Yc=(e,t)=>ke(e.getTransparentElements(),t),Gc=(e,t)=>re(t)&&Yc(e,t.nodeName),er=(e,t)=>Gc(e,t)&&Kc(t),i_=(e,t)=>Gc(e,t)&&!Kc(t),Xc=(e,t)=>t.type===1&&Yc(e,t.name)&&Q(t.attr(ki)),l_=zn().browser,cp=e=>pt(e,tn),dp=(e,t)=>e.children&&Ue(e.children,t),up=(e,t={})=>{let n=0;const o={},r=R(e),s=lo(r),a=u=>{ut(Pc(r),u)},i=u=>{const m=Pc(r);pi(m,"#"+u).each(Ze)},l=u=>Xe(o,u).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),c=u=>new Promise((m,p)=>{let g;const h=$._addCacheSuffix(u),f=l(h);o[h]=f,f.count++;const b=(E,k)=>{U(E,Ns),f.status=k,f.passed=[],f.failed=[],g&&(g.onload=null,g.onerror=null,g=null)},v=()=>b(f.passed,2),y=()=>b(f.failed,3);if(m&&f.passed.push(m),p&&f.failed.push(p),f.status===1)return;if(f.status===2)return void v();if(f.status===3)return void y();f.status=1;const w=vt("link",s.dom);so(w,{rel:"stylesheet",type:"text/css",id:f.id}),t.contentCssCors&&_t(w,"crossOrigin","anonymous"),t.referrerPolicy&&_t(w,"referrerpolicy",t.referrerPolicy),g=w.dom,g.onload=v,g.onerror=y,a(w),_t(w,"href",h)}),d=u=>{const m=$._addCacheSuffix(u);Xe(o,m).each(p=>{--p.count==0&&(delete o[m],i(p.id))})};return{load:c,loadRawCss:(u,m)=>{const p=l(u);o[u]=p,p.count++;const g=vt("style",s.dom);so(g,{rel:"stylesheet",type:"text/css",id:p.id}),g.dom.innerHTML=m,a(g)},loadAll:u=>Promise.allSettled(Te(u,m=>c(m).then(oe(m)))).then(m=>{const p=Tr(m,g=>g.status==="fulfilled");return p.fail.length>0?Promise.reject(Te(p.fail,g=>g.reason)):Te(p.pass,g=>g.value)}),unload:d,unloadRawCss:u=>{Xe(o,u).each(m=>{--m.count==0&&(delete o[u],i(m.id))})},unloadAll:u=>{U(u,m=>{d(m)})},_setReferrerPolicy:u=>{t.referrerPolicy=u},_setContentCssCors:u=>{t.contentCssCors=u}}},mp=(()=>{const e=new WeakMap;return{forElement:(t,n)=>{const o=ko(t).dom;return C.from(e.get(o)).getOrThunk(()=>{const r=up(o,n);return e.set(o,r),r})}}})(),fp=(e,t)=>q(e)&&(rp(t,e)||t.isInline(e.nodeName.toLowerCase())),gp=e=>(t=>t.nodeName.toLowerCase()==="span")(e)&&e.getAttribute("data-mce-type")==="bookmark",Zc=(e,t,n,o)=>{var r;const s=o||t;if(re(t)&&gp(t))return t;const a=t.childNodes;for(let i=a.length-1;i>=0;i--)Zc(e,a[i],n,s);if(re(t)){const i=t.childNodes;i.length===1&&gp(i[0])&&((r=t.parentNode)===null||r===void 0||r.insertBefore(i[0],t))}return(i=>jc(i)||Ks(i))(t)||rp(n,t)||(i=>!!re(i)&&i.childNodes.length>0)(t)||((i,l,c)=>j(i)&&i.data.length>0&&((d,u,m)=>{const p=new yt(d,u).prev(!1),g=new yt(d,u).next(!1),h=st(p)||fp(p,m),f=st(g)||fp(g,m);return h&&f})(i,l,c))(t,s,n)||e.remove(t),t},c_=$.makeMap,xi=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_i=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d_=/[<>&\"\']/g,u_=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,m_={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},tr={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},f_={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},pp=(e,t)=>{const n={};if(e){const o=e.split(",");t=t||10;for(let r=0;r<o.length;r+=2){const s=String.fromCharCode(parseInt(o[r],t));if(!tr[s]){const a="&"+o[r+1]+";";n[s]=a,n[a]=s}}return n}},Qc=pp("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),hp=(e,t)=>e.replace(t?xi:_i,n=>tr[n]||n),bp=(e,t)=>e.replace(t?xi:_i,n=>n.length>1?"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";":tr[n]||"&#"+n.charCodeAt(0)+";"),Jc=(e,t,n)=>{const o=n||Qc;return e.replace(t?xi:_i,r=>tr[r]||o[r]||r)},So={encodeRaw:hp,encodeAllRaw:e=>(""+e).replace(d_,t=>tr[t]||t),encodeNumeric:bp,encodeNamed:Jc,getEncodeFunc:(e,t)=>{const n=pp(t)||Qc,o=c_(e.replace(/\+/g,","));return o.named&&o.numeric?(r,s)=>r.replace(s?xi:_i,a=>tr[a]!==void 0?tr[a]:n[a]!==void 0?n[a]:a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":"&#"+a.charCodeAt(0)+";"):o.named?t?(r,s)=>Jc(r,s,n):Jc:o.numeric?bp:hp},decode:e=>e.replace(u_,(t,n)=>n?(n=n.charAt(0).toLowerCase()==="x"?parseInt(n.substr(1),16):parseInt(n,10))>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):m_[n]||String.fromCharCode(n):f_[t]||Qc[t]||(o=>{const r=vt("div").dom;return r.innerHTML=o,r.textContent||r.innerText||o})(t))},Nt=(e,t)=>(e=$.trim(e))?e.split(t||" "):[],vp=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),yp=e=>Object.freeze(["id","accesskey","class","dir","lang","style","tabindex","title","role",...e!=="html4"?["contenteditable","contextmenu","draggable","dropzone","hidden","spellcheck","translate"]:[],...e!=="html5-strict"?["xml:lang"]:[]]),Cp=e=>{let t,n;t="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"&&(t+=" article aside details dialog figure main header footer hgroup section nav a ins del canvas map",n+=" audio canvas command data datalist mark meter output picture progress time wbr video ruby bdi keygen svg"),e!=="html5-strict"&&(n=[n,"acronym applet basefont big font strike tt"].join(" "),t=[t,"center dir isindex noframes"].join(" "));const o=[t,n].join(" ");return{blockContent:t,phrasingContent:n,flowContent:o}},ed=e=>{const{blockContent:t,phrasingContent:n,flowContent:o}=Cp(e),r=s=>Object.freeze(s.split(" "));return Object.freeze({blockContent:r(t),phrasingContent:r(n),flowContent:r(o)})},g_={html4:Fn(()=>ed("html4")),html5:Fn(()=>ed("html5")),"html5-strict":Fn(()=>ed("html5-strict"))},wp=(e,t)=>{const{blockContent:n,phrasingContent:o,flowContent:r}=g_[e]();return t==="blocks"?C.some(n):t==="phrasing"?C.some(o):t==="flow"?C.some(r):C.none()},td=e=>C.from(/^(@?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)$/.exec(e)).map(t=>({preset:t[1]==="@",name:t[2]})),Si={},Ys=$.makeMap,Tn=$.each,Ep=$.extend,kp=$.explode,xp=(e,t={})=>{const n=Ys(e," ",Ys(e.toUpperCase()," "));return Ep(n,t)},_p=e=>xp("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),nd=(e,t)=>{if(e){const n={};return Q(e)&&(e={"*":e}),Tn(e,(o,r)=>{n[r]=n[r.toUpperCase()]=t==="map"?Ys(o,/[, ]/):kp(o,/[, ]/)}),n}},No=(e={})=>{var t;const n={},o={};let r=[];const s={},a={},i=(Z,we,Re)=>{const Ee=e[Z];if(Ee)return Ys(Ee,/[, ]/,Ys(Ee.toUpperCase(),/[, ]/));{let Pe=Si[Z];return Pe||(Pe=xp(we,Re),Si[Z]=Pe),Pe}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=(Z=>{const we=yp(Z),{phrasingContent:Re,flowContent:Ee}=Cp(Z),Pe={},qe=(Fe,Ye,ft)=>{Pe[Fe]={attributes:bc(Ye,oe({})),attributesOrder:Ye,children:bc(ft,oe({}))}},Y=(Fe,Ye="",ft="")=>{const Wt=Nt(ft),xn=Nt(Fe);let Mt=xn.length;const Jt=[...we,...Nt(Ye)];for(;Mt--;)qe(xn[Mt],Jt.slice(),Wt)},ue=(Fe,Ye)=>{const ft=Nt(Fe),Wt=Nt(Ye);let xn=ft.length;for(;xn--;){const Mt=Pe[ft[xn]];for(let Jt=0,gt=Wt.length;Jt<gt;Jt++)Mt.attributes[Wt[Jt]]={},Mt.attributesOrder.push(Wt[Jt])}};return Z!=="html5-strict"&&(U(Nt("acronym applet basefont big font strike tt"),Fe=>{Y(Fe,"",Re)}),U(Nt("center dir isindex noframes"),Fe=>{Y(Fe,"",Ee)})),Y("html","manifest","head body"),Y("head","","base command link meta noscript script style title"),Y("title hr noscript br"),Y("base","href target"),Y("link","href rel media hreflang type sizes hreflang"),Y("meta","name http-equiv content charset"),Y("style","media type scoped"),Y("script","src async defer type charset"),Y("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",Ee),Y("dd div","",Ee),Y("address dt caption","",Z==="html4"?Re:Ee),Y("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",Re),Y("blockquote","cite",Ee),Y("ol","reversed start type","li"),Y("ul","","li"),Y("li","value",Ee),Y("dl","","dt dd"),Y("a","href target rel media hreflang type",Z==="html4"?Re:Ee),Y("q","cite",Re),Y("ins del","cite datetime",Ee),Y("img","src sizes srcset alt usemap ismap width height"),Y("iframe","src name width height",Ee),Y("embed","src type width height"),Y("object","data type typemustmatch name usemap form width height",[Ee,"param"].join(" ")),Y("param","name value"),Y("map","name",[Ee,"area"].join(" ")),Y("area","alt coords shape href target rel media hreflang type"),Y("table","border","caption colgroup thead tfoot tbody tr"+(Z==="html4"?" col":"")),Y("colgroup","span","col"),Y("col","span"),Y("tbody thead tfoot","","tr"),Y("tr","","td th"),Y("td","colspan rowspan headers",Ee),Y("th","colspan rowspan headers scope abbr",Ee),Y("form","accept-charset action autocomplete enctype method name novalidate target",Ee),Y("fieldset","disabled form name",[Ee,"legend"].join(" ")),Y("label","form for",Re),Y("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),Y("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",Z==="html4"?Ee:Re),Y("select","disabled form multiple name required size","option optgroup"),Y("optgroup","disabled label","option"),Y("option","disabled label selected value"),Y("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),Y("menu","type label",[Ee,"li"].join(" ")),Y("noscript","",Ee),Z!=="html4"&&(Y("wbr"),Y("ruby","",[Re,"rt rp"].join(" ")),Y("figcaption","",Ee),Y("mark rt rp bdi","",Re),Y("summary","",[Re,"h1 h2 h3 h4 h5 h6"].join(" ")),Y("canvas","width height",Ee),Y("data","value",Re),Y("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[Ee,"track source"].join(" ")),Y("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[Ee,"track source"].join(" ")),Y("picture","","img source"),Y("source","src srcset type media sizes"),Y("track","kind src srclang label default"),Y("datalist","",[Re,"option"].join(" ")),Y("article section nav aside main header footer","",Ee),Y("hgroup","","h1 h2 h3 h4 h5 h6"),Y("figure","",[Ee,"figcaption"].join(" ")),Y("time","datetime",Re),Y("dialog","open",Ee),Y("command","type label icon disabled checked radiogroup command"),Y("output","for form name",Re),Y("progress","value max",Re),Y("meter","value min max low high optimum",Re),Y("details","open",[Ee,"summary"].join(" ")),Y("keygen","autofocus challenge disabled form keytype name"),qe("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),Z!=="html5-strict"&&(ue("script","language xml:space"),ue("style","xml:space"),ue("object","declare classid code codebase codetype archive standby align border hspace vspace"),ue("embed","align name hspace vspace"),ue("param","valuetype type"),ue("a","charset name rev shape coords"),ue("br","clear"),ue("applet","codebase archive code object alt name width height align hspace vspace"),ue("img","name longdesc align border hspace vspace"),ue("iframe","longdesc frameborder marginwidth marginheight scrolling align"),ue("font basefont","size color face"),ue("input","usemap align"),ue("select"),ue("textarea"),ue("h1 h2 h3 h4 h5 h6 div p legend caption","align"),ue("ul","type compact"),ue("li","type"),ue("ol dl menu dir","compact"),ue("pre","width xml:space"),ue("hr","align noshade size width"),ue("isindex","prompt"),ue("table","summary width frame rules cellspacing cellpadding align bgcolor"),ue("col","width align char charoff valign"),ue("colgroup","width align char charoff valign"),ue("thead","align char charoff valign"),ue("tr","align char charoff valign bgcolor"),ue("th","axis align char charoff valign nowrap bgcolor width height"),ue("form","accept"),ue("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),ue("tfoot","align char charoff valign"),ue("tbody","align char charoff valign"),ue("area","nohref"),ue("body","background bgcolor text link vlink alink")),Z!=="html4"&&(ue("input button select textarea","autofocus"),ue("input textarea","placeholder"),ue("a","download"),ue("link script img","crossorigin"),ue("img","loading"),ue("iframe","sandbox seamless allow allowfullscreen loading")),Z!=="html4"&&U([Pe.video,Pe.audio],Fe=>{delete Fe.children.audio,delete Fe.children.video}),U(Nt("a form meter progress dfn"),Fe=>{Pe[Fe]&&delete Pe[Fe].children[Fe]}),delete Pe.caption.children.table,delete Pe.script,Pe})(l);e.verify_html===!1&&(e.valid_elements="*[*]");const d=nd(e.valid_styles),u=nd(e.invalid_styles,"map"),m=nd(e.valid_classes,"map"),p=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),f=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),b="td th iframe video audio object script code",v=i("non_empty_elements",b+" pre svg textarea summary",h),y=i("move_caret_before_on_enter_elements",b+" table",h),w="h1 h2 h3 h4 h5 h6",E=i("text_block_elements",w+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),k=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",E),S=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),_=i("transparent_elements","a ins del canvas map"),T=i("wrap_block_elements","pre "+w);Tn("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),Z=>{a[Z]=new RegExp("</"+Z+"[^>]*>","gi")});const P=Z=>{const we=C.from(n["@"]),Re=/[*?+]/;U(((Ee,Pe)=>{const qe=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return an(Nt(Pe,","),Y=>{const ue=qe.exec(Y);if(ue){const Fe=ue[1],Ye=ue[2],ft=ue[3],Wt=ue[4],xn=ue[5],Mt={attributes:{},attributesOrder:[]};if(Ee.each(Jt=>((gt,sn)=>{Ke(gt.attributes,(oo,yo)=>{sn.attributes[yo]=oo}),sn.attributesOrder.push(...gt.attributesOrder)})(Jt,Mt)),Fe==="#"?Mt.paddEmpty=!0:Fe==="-"&&(Mt.removeEmpty=!0),Wt==="!"&&(Mt.removeEmptyAttrs=!0),xn&&((Jt,gt)=>{const sn=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,oo=/[*?+]/,{attributes:yo,attributesOrder:Nr}=gt;U(Nt(Jt,"|"),qf=>{const _n=sn.exec(qf);if(_n){const Ho={},xt=_n[1],zt=_n[2].replace(/[\\:]:/g,":"),Es=_n[3],$o=_n[4];if(xt==="!"&&(gt.attributesRequired=gt.attributesRequired||[],gt.attributesRequired.push(zt),Ho.required=!0),xt==="-")return delete yo[zt],void Nr.splice($.inArray(Nr,zt),1);if(Es&&(Es==="="?(gt.attributesDefault=gt.attributesDefault||[],gt.attributesDefault.push({name:zt,value:$o}),Ho.defaultValue=$o):Es==="~"?(gt.attributesForced=gt.attributesForced||[],gt.attributesForced.push({name:zt,value:$o}),Ho.forcedValue=$o):Es==="<"&&(Ho.validValues=$.makeMap($o,"?"))),oo.test(zt)){const ks=Ho;gt.attributePatterns=gt.attributePatterns||[],ks.pattern=vp(zt),gt.attributePatterns.push(ks)}else yo[zt]||Nr.push(zt),yo[zt]=Ho}})})(xn,Mt),ft&&(Mt.outputName=Ye),Ye==="@"){if(!Ee.isNone())return[];Ee=C.some(Mt)}return[ft?{name:Ye,element:Mt,aliasName:ft}:{name:Ye,element:Mt}]}return[]})})(we,Z??""),({name:Ee,element:Pe,aliasName:qe})=>{if(qe&&(n[qe]=Pe),Re.test(Ee)){const Y=Pe;Y.pattern=vp(Ee),r.push(Y)}else n[Ee]=Pe})},x=Z=>{r=[],U(Gt(n),we=>{delete n[we]}),P(Z)},N=(Z,we)=>{var Re,Ee;delete Si.text_block_elements,delete Si.block_elements;const Pe=!!we.extends&&!Me(we.extends),qe=we.extends;if(o[Z]=qe?o[qe]:{},s[Z]=qe??Z,v[Z.toUpperCase()]={},v[Z]={},Pe||(k[Z.toUpperCase()]={},k[Z]={}),qe&&!n[Z]&&n[qe]){const Y=(ue=>{const Fe=Ye=>He(Ye)?Te(Ye,Fe):(ft=>We(ft)&&ft.source&&Object.prototype.toString.call(ft)==="[object RegExp]")(Ye)?new RegExp(Ye.source,Ye.flags):We(Ye)?Bs(Ye,Fe):Ye;return Fe(ue)})(n[qe]);delete Y.removeEmptyAttrs,delete Y.removeEmpty,n[Z]=Y}else n[Z]={attributesOrder:[],attributes:{}};if(He(we.attributes)){const Y=Fe=>{ue.attributesOrder.push(Fe),ue.attributes[Fe]={}},ue=(Re=n[Z])!==null&&Re!==void 0?Re:{};delete ue.attributesDefault,delete ue.attributesForced,delete ue.attributePatterns,delete ue.attributesRequired,ue.attributesOrder=[],ue.attributes={},U(we.attributes,Fe=>{const Ye=yp(l);td(Fe).each(({preset:ft,name:Wt})=>{ft?Wt==="global"&&U(Ye,Y):Y(Wt)})}),n[Z]=ue}if(Kt(we.padEmpty)){const Y=(Ee=n[Z])!==null&&Ee!==void 0?Ee:{};Y.paddEmpty=we.padEmpty,n[Z]=Y}if(He(we.children)){const Y={},ue=Ye=>{Y[Ye]={}},Fe=Ye=>{wp(l,Ye).each(ft=>{U(ft,ue)})};U(we.children,Ye=>{td(Ye).each(({preset:ft,name:Wt})=>{ft?Fe(Wt):ue(Wt)})}),o[Z]=Y}qe&&Ke(o,(Y,ue)=>{Y[qe]&&(o[ue]=Y=Ep({},o[ue]),Y[Z]=Y[qe])})},B=Z=>{We(Z)?Ke(Z,(we,Re)=>N(Re,we)):Q(Z)&&(we=>{U((Re=>{const Ee=/^(~)?(.+)$/;return an(Nt(Re,","),Pe=>{const qe=Ee.exec(Pe);return qe?[{cloneName:qe[1]==="~"?"span":"div",name:qe[2]}]:[]})})(we??""),({name:Re,cloneName:Ee})=>{N(Re,{extends:Ee})})})(Z)},I=Z=>{U((we=>{const Re=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return an(Nt(we,","),Ee=>{const Pe=Re.exec(Ee);if(Pe){const qe=Pe[1];return[{operation:qe?(ue=>ue==="-"?"remove":"add")(qe):"replace",name:Pe[2],validChildren:an(Nt(Pe[3],"|"),ue=>td(ue).toArray())}]}return[]})})(Z??""),({operation:we,name:Re,validChildren:Ee})=>{const Pe=we==="replace"?{"#comment":{}}:o[Re],qe=Y=>{we==="remove"?delete Pe[Y]:Pe[Y]={}};U(Ee,({preset:Y,name:ue})=>{Y?(Fe=>{wp(l,Fe).each(Ye=>{U(Ye,qe)})})(ue):qe(ue)}),o[Re]=Pe})},V=Z=>{const we=n[Z];if(we)return we;let Re=r.length;for(;Re--;){const Ee=r[Re];if(Ee.pattern.test(Z))return Ee}},z=oe(d),te=oe(u),ae=oe(m),de=oe(f),le=oe(k),G=oe(E),se=oe(S),A=oe(Object.seal(h)),O=oe(g),L=oe(v),F=oe(y),X=oe(p),W=oe(_),fe=oe(T),Ce=oe(Object.seal(a)),xe=(Z,we)=>{const Re=V(Z);if(Re){if(!we)return!0;{if(Re.attributes[we])return!0;const Ee=Re.attributePatterns;if(Ee){let Pe=Ee.length;for(;Pe--;)if(Ee[Pe].pattern.test(we))return!0}}}return!1},Me=Z=>ke(le(),Z),et=Z=>!ht(Z,"#")&&xe(Z)&&!Me(Z),no=oe(s);return e.valid_elements?(x(e.valid_elements),Tn(c,(Z,we)=>{o[we]=Z.children})):(Tn(c,(Z,we)=>{n[we]={attributes:Z.attributes,attributesOrder:Z.attributesOrder},o[we]=Z.children}),Tn(Nt("strong/b em/i"),Z=>{const we=Nt(Z,"/");n[we[1]].outputName=we[0]}),Tn(S,(Z,we)=>{n[we]&&(e.padd_empty_block_inline_children&&(n[we].paddInEmptyBlock=!0),n[we].removeEmpty=!0)}),Tn(Nt("ol ul blockquote a table tbody"),Z=>{n[Z]&&(n[Z].removeEmpty=!0)}),Tn(Nt("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),Z=>{n[Z]&&(n[Z].paddEmpty=!0)}),Tn(Nt("span"),Z=>{n[Z].removeEmptyAttrs=!0})),delete n.svg,B(e.custom_elements),I(e.valid_children),P(e.extended_valid_elements),I("+ol[ul|ol],+ul[ul|ol]"),Tn({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(Z,we)=>{n[we]&&(n[we].parentsRequired=Nt(Z))}),e.invalid_elements&&Tn(kp(e.invalid_elements),Z=>{n[Z]&&delete n[Z]}),V("span")||P("span[!data-mce-type|*]"),{type:l,children:o,elements:n,getValidStyles:z,getValidClasses:ae,getBlockElements:le,getInvalidStyles:te,getVoidElements:A,getTextBlockElements:G,getTextInlineElements:se,getBoolAttrs:de,getElementRule:V,getSelfClosingElements:O,getNonEmptyElements:L,getMoveCaretBeforeOnEnterElements:F,getWhitespaceElements:X,getTransparentElements:W,getSpecialElements:Ce,isValidChild:(Z,we)=>{const Re=o[Z.toLowerCase()];return!(!Re||!Re[we.toLowerCase()])},isValid:xe,isBlock:Me,isInline:et,isWrapper:Z=>ke(fe(),Z)||et(Z),getCustomElements:no,addValidElements:P,setValidElements:x,addCustomElements:B,addValidChildren:I}},od=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},p_=e=>(t=>{return{value:(n=t,fg(n,"#").toUpperCase())};var n})(od(e.red)+od(e.green)+od(e.blue)),h_=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,b_=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Sp=(e,t,n,o)=>({red:e,green:t,blue:n,alpha:o}),Np=(e,t,n,o)=>{const r=parseInt(e,10),s=parseInt(t,10),a=parseInt(n,10),i=parseFloat(o);return Sp(r,s,a,i)},Rp=e=>{if(e==="transparent")return C.some(Sp(0,0,0,0));const t=h_.exec(e);if(t!==null)return C.some(Np(t[1],t[2],t[3],"1"));const n=b_.exec(e);return n!==null?C.some(Np(n[1],n[2],n[3],n[4])):C.none()},v_=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,Gs=e=>Rp(e).map(p_).map(t=>"#"+t.value).getOr(e),rd=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,o=/\s*([^:]+):\s*([^;]+);?/g,r=/\s+$/,s=/rgba *\(/i,a={};let i,l;const c=qs;t&&(i=t.getValidStyles(),l=t.getInvalidStyles());const d=`\\" \\' \\; \\: ; : \uFEFF`.split(" ");for(let m=0;m<d.length;m++)a[d[m]]=c+m,a[c+m]=d[m];const u={parse:m=>{const p={};let g=!1;const h=e.url_converter,f=e.url_converter_scope||u,b=(x,N,B)=>{const I=p[x+"-top"+N];if(!I)return;const V=p[x+"-right"+N];if(!V)return;const z=p[x+"-bottom"+N];if(!z)return;const te=p[x+"-left"+N];if(!te)return;const ae=[I,V,z,te];let de=ae.length-1;for(;de--&&ae[de]===ae[de+1];);de>-1&&B||(p[x+N]=de===-1?ae[0]:ae.join(" "),delete p[x+"-top"+N],delete p[x+"-right"+N],delete p[x+"-bottom"+N],delete p[x+"-left"+N])},v=x=>{const N=p[x];if(!N)return;const B=N.indexOf(",")>-1?[N]:N.split(" ");let I=B.length;for(;I--;)if(B[I]!==B[0])return!1;return p[x]=B[0],!0},y=x=>(g=!0,a[x]),w=(x,N)=>(g&&(x=x.replace(/\uFEFF[0-9]/g,B=>a[B])),N||(x=x.replace(/\\([\'\";:])/g,"$1")),x),E=x=>String.fromCharCode(parseInt(x.slice(1),16)),k=x=>x.replace(/\\[0-9a-f]+/gi,E),S=(x,N,B,I,V,z)=>{if(V=V||z)return"'"+(V=w(V)).replace(/\'/g,"\\'")+"'";if(N=w(N||B||I||""),!e.allow_script_urls){const te=N.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(te)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(te))return""}return h&&(N=h.call(f,N,"style")),"url('"+N.replace(/\'/g,"\\'")+"')"};if(m){let x;for(m=(m=m.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,y).replace(/\"[^\"]+\"|\'[^\']+\'/g,N=>N.replace(/[;:]/g,y));x=o.exec(m);){o.lastIndex=x.index+x[0].length;let N=x[1].replace(r,"").toLowerCase(),B=x[2].replace(r,"");if(N&&B){if(N=k(N),B=k(B),N.indexOf(c)!==-1||N.indexOf('"')!==-1||!e.allow_script_urls&&(N==="behavior"||/expression\s*\(|\/\*|\*\//.test(B)))continue;N==="font-weight"&&B==="700"?B="bold":N!=="color"&&N!=="background-color"||(B=B.toLowerCase()),s.test(B)||Rp(B).each(I=>{B=Gs(v_(I)).toLowerCase()}),B=B.replace(n,S),p[N]=g?w(B,!0):B}}b("border","",!0),b("border","-width"),b("border","-color"),b("border","-style"),b("padding",""),b("margin",""),T="border-style",P="border-color",v(_="border-width")&&v(T)&&v(P)&&(p.border=p[_]+" "+p[T]+" "+p[P],delete p[_],delete p[T],delete p[P]),p.border==="medium none"&&delete p.border,p["border-image"]==="none"&&delete p["border-image"]}var _,T,P;return p},serialize:(m,p)=>{let g="";const h=(f,b)=>{const v=b[f];if(v)for(let y=0,w=v.length;y<w;y++){const E=v[y],k=m[E];k&&(g+=(g.length>0?" ":"")+E+": "+k+";")}};return p&&i?(h("*",i),h(p,i)):Ke(m,(f,b)=>{f&&((v,y)=>{if(!l||!y)return!0;let w=l["*"];return!(w&&w[v]||(w=l[y],w&&w[v]))})(b,p)&&(g+=(g.length>0?" ":"")+b+": "+f+";")}),g}};return u},y_={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},Ap=(e,t)=>{const n=t??{};for(const o in e)ke(y_,o)||(n[o]=e[o]);return q(e.composedPath)&&(n.composedPath=()=>e.composedPath()),q(e.getModifierState)&&(n.getModifierState=o=>e.getModifierState(o)),q(e.getTargetRanges)&&(n.getTargetRanges=()=>e.getTargetRanges()),n},sd=(e,t,n,o)=>{var r;const s=Ap(t,o);return s.type=e,at(s.target)&&(s.target=(r=s.srcElement)!==null&&r!==void 0?r:n),(a=>at(a.preventDefault)||(i=>i instanceof Event||Ie(i.initEvent))(a))(t)&&(s.preventDefault=()=>{s.defaultPrevented=!0,s.isDefaultPrevented=dt,Ie(t.preventDefault)&&t.preventDefault()},s.stopPropagation=()=>{s.cancelBubble=!0,s.isPropagationStopped=dt,Ie(t.stopPropagation)&&t.stopPropagation()},s.stopImmediatePropagation=()=>{s.isImmediatePropagationStopped=dt,s.stopPropagation()},(a=>a.isDefaultPrevented===dt||a.isDefaultPrevented===Qe)(s)||(s.isDefaultPrevented=s.defaultPrevented===!0?dt:Qe,s.isPropagationStopped=s.cancelBubble===!0?dt:Qe,s.isImmediatePropagationStopped=Qe)),s},C_=/^(?:mouse|contextmenu)|click/,ad=(e,t,n,o)=>{e.addEventListener(t,n,o||!1)},Ni=(e,t,n,o)=>{e.removeEventListener(t,n,o||!1)},Xs=(e,t)=>{const n=sd(e.type,e,document,t);if((o=>q(o)&&C_.test(o.type))(e)&&st(e.pageX)&&!st(e.clientX)){const o=n.target.ownerDocument||document,r=o.documentElement,s=o.body,a=n;a.pageX=e.clientX+(r&&r.scrollLeft||s&&s.scrollLeft||0)-(r&&r.clientLeft||s&&s.clientLeft||0),a.pageY=e.clientY+(r&&r.scrollTop||s&&s.scrollTop||0)-(r&&r.clientTop||s&&s.clientTop||0)}return n},w_=(e,t,n)=>{const o=e.document,r={type:"ready"};if(n.domLoaded)return void t(r);const s=()=>{Ni(e,"DOMContentLoaded",s),Ni(e,"load",s),n.domLoaded||(n.domLoaded=!0,t(r)),e=null};o.readyState==="complete"||o.readyState==="interactive"&&o.body?s():ad(e,"DOMContentLoaded",s),n.domLoaded||ad(e,"load",s)};class nr{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,o,r){const s=this;let a;const i=window,l=m=>{s.executeHandlers(Xs(m||i.event),c)};if(!t||j(t)||_o(t))return o;let c;t[s.expando]?c=t[s.expando]:(c=s.count++,t[s.expando]=c,s.events[c]={}),r=r||t;const d=n.split(" ");let u=d.length;for(;u--;){let m=d[u],p=l,g=!1,h=!1;m==="DOMContentLoaded"&&(m="ready"),s.domLoaded&&m==="ready"&&t.readyState==="complete"?o.call(r,Xs({type:m})):(s.hasFocusIn||m!=="focusin"&&m!=="focusout"||(g=!0,h=m==="focusin"?"focus":"blur",p=f=>{const b=Xs(f||i.event);b.type=b.type==="focus"?"focusin":"focusout",s.executeHandlers(b,c)}),a=s.events[c][m],a?m==="ready"&&s.domLoaded?o(Xs({type:m})):a.push({func:o,scope:r}):(s.events[c][m]=a=[{func:o,scope:r}],a.fakeName=h,a.capture=g,a.nativeHandler=p,m==="ready"?w_(t,p,s):ad(t,h||m,p,g)))}return t=a=null,o}unbind(t,n,o){if(!t||j(t)||_o(t))return this;const r=t[this.expando];if(r){let s=this.events[r];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=s[l];if(c){if(o){let d=c.length;for(;d--;)if(c[d].func===o){const u=c.nativeHandler,m=c.fakeName,p=c.capture,g=c.slice(0,d).concat(c.slice(d+1));g.nativeHandler=u,g.fakeName=m,g.capture=p,s[l]=g}}o&&c.length!==0||(delete s[l],Ni(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Ke(s,(a,i)=>{Ni(t,a.fakeName||i,a.nativeHandler,a.capture)}),s={};for(const a in s)if(ke(s,a))return this;delete this.events[r];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,o){return this.dispatch(t,n,o)}dispatch(t,n,o){if(!t||j(t)||_o(t))return this;const r=Xs({type:n,target:t},o);do{const s=t[this.expando];s&&this.executeHandlers(r,s),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!r.isPropagationStopped());return this}clean(t){if(!t||j(t)||_o(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let o=n.length;for(;o--;)(t=n[o])[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const o=this.events[n],r=o&&o[t.type];if(r)for(let s=0,a=r.length;s<a;s++){const i=r[s];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}nr.Event=new nr;const id=$.each,E_=$.grep,ld="data-mce-style",k_=$.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Zs=(e,t,n)=>{at(n)||n===""?St(e,t):_t(e,t,n)},Tp=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Vr=(e,t)=>{let n=0;if(e)for(let o=e.nodeType,r=e.previousSibling;r;r=r.previousSibling){const s=r.nodeType;(!t||!j(r)||s!==o&&r.data.length)&&(n++,o=s)}return n},Op=(e,t)=>{const n=nn(t,"style"),o=e.serialize(e.parse(n),Oe(t));Zs(t,ld,o)},Bp=(e,t,n)=>{const o=Tp(t);at(n)||n===""?Hg(e,o):zg(e,o,((r,s)=>Sn(r)?ke(k_,s)?r+"":r+"px":r)(n,o))},Ve=(e,t={})=>{const n={},o=window,r={};let s=0;const a=mp.forElement(R(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),i=[],l=t.schema?t.schema:No({}),c=rd({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new nr:nr.Event,u=l.getBlockElements(),m=A=>A&&e&&Q(A)?e.getElementById(A):A,p=A=>{const O=m(A);return q(O)?R(O):null},g=(A,O,L="")=>{let F;const X=p(A);if(q(X)&&tn(X)){const W=se[O];F=W&&W.get?W.get(X.dom,O):nn(X,O)}return q(F)?F:L},h=A=>{const O=m(A);return at(O)?[]:O.attributes},f=(A,O,L)=>{_(A,F=>{if(re(F)){const X=R(F),W=L===""?null:L,fe=nn(X,O),Ce=se[O];Ce&&Ce.set?Ce.set(X.dom,W,O):Zs(X,O,W),fe!==W&&t.onSetAttrib&&t.onSetAttrib({attrElm:X.dom,attrName:O,attrValue:W})}})},b=()=>t.root_element||e.body,v=(A,O)=>((L,F,X)=>{let W=0,fe=0;const Ce=L.ownerDocument;if(X=X||L,F){if(X===L&&F.getBoundingClientRect&&$n(R(L),"position")==="static"){const Me=F.getBoundingClientRect();return W=Me.left+(Ce.documentElement.scrollLeft||L.scrollLeft)-Ce.documentElement.clientLeft,fe=Me.top+(Ce.documentElement.scrollTop||L.scrollTop)-Ce.documentElement.clientTop,{x:W,y:fe}}let xe=F;for(;xe&&xe!==X&&xe.nodeType&&!dp(xe,X);){const Me=xe;W+=Me.offsetLeft||0,fe+=Me.offsetTop||0,xe=Me.offsetParent}for(xe=F.parentNode;xe&&xe!==X&&xe.nodeType&&!dp(xe,X);)W-=xe.scrollLeft||0,fe-=xe.scrollTop||0,xe=xe.parentNode;fe+=(Me=>l_.isFirefox()&&Oe(Me)==="table"?cp(Ot(Me)).filter(et=>Oe(et)==="caption").bind(et=>cp(Dg(et)).map(no=>{const Z=no.dom.offsetTop,we=et.dom.offsetTop,Re=et.dom.offsetHeight;return Z<=we?-Re:0})).getOr(0):0)(R(F))}return{x:W,y:fe}})(e.body,m(A),O),y=(A,O,L)=>{const F=m(A);var X;if(!at(F)&&(mo(F)||re(X=F)&&X.namespaceURI==="http://www.w3.org/2000/svg"))return L?$n(R(F),Tp(O)):((O=O.replace(/-(\D)/g,(W,fe)=>fe.toUpperCase()))==="float"&&(O="cssFloat"),F.style?F.style[O]:void 0)},w=A=>{const O=m(A);if(!O)return{w:0,h:0};let L=y(O,"width"),F=y(O,"height");return L&&L.indexOf("px")!==-1||(L="0"),F&&F.indexOf("px")!==-1||(F="0"),{w:parseInt(L,10)||O.offsetWidth||O.clientWidth,h:parseInt(F,10)||O.offsetHeight||O.clientHeight}},E=(A,O)=>{if(!A)return!1;const L=He(A)?A:[A];return it(L,F=>Nn(R(F),O))},k=(A,O,L,F)=>{const X=[];let W=m(A);F=F===void 0;const fe=L||(b().nodeName!=="BODY"?b().parentNode:null);if(Q(O))if(O==="*")O=re;else{const Ce=O;O=xe=>E(xe,Ce)}for(;W&&!(W===fe||at(W.nodeType)||Ks(W)||jc(W));){if(!O||O(W)){if(!F)return[W];X.push(W)}W=W.parentNode}return F?X:null},S=(A,O,L)=>{let F=O;if(A){Q(O)&&(F=X=>E(X,O));for(let X=A[L];X;X=X[L])if(Ie(F)&&F(X))return X}return null},_=function(A,O,L){const F=L??this;if(He(A)){const X=[];return id(A,(W,fe)=>{const Ce=m(W);Ce&&X.push(O.call(F,Ce,fe))}),X}{const X=m(A);return!!X&&O.call(F,X)}},T=(A,O)=>{_(A,L=>{Ke(O,(F,X)=>{f(L,X,F)})})},P=(A,O)=>{_(A,L=>{const F=R(L);vi(F,O)})},x=(A,O,L,F,X)=>_(A,W=>{const fe=Q(O)?e.createElement(O):O;return q(L)&&T(fe,L),F&&(!Q(F)&&F.nodeType?fe.appendChild(F):Q(F)&&P(fe,F)),X?fe:W.appendChild(fe)}),N=(A,O,L)=>x(e.createElement(A),A,O,L,!0),B=So.encodeAllRaw,I=(A,O)=>_(A,L=>{const F=R(L);return O&&U(Ot(F),X=>{ln(X)&&X.dom.length===0?Ze(X):Xt(F,X)}),Ze(F),F.dom}),V=(A,O,L)=>{_(A,F=>{if(re(F)){const X=R(F),W=O.split(" ");U(W,fe=>{q(L)?(L?Mr:Us)(X,fe):((Ce,xe)=>{Fs(Ce)?Ce.dom.classList.toggle(xe):((Me,et)=>Ue(_g(Me),et)?Ng(Me,et):Sg(Me,et))(Ce,xe),Rg(Ce)})(X,fe)})}})},z=(A,O,L)=>_(O,F=>{var X;const W=He(O)?A.cloneNode(!0):A;return L&&id(E_(F.childNodes),fe=>{W.appendChild(fe)}),(X=F.parentNode)===null||X===void 0||X.replaceChild(W,F),F}),te=()=>e.createRange(),ae=(A,O,L,F)=>{if(He(A)){let X=A.length;const W=[];for(;X--;)W[X]=ae(A[X],O,L,F);return W}return!t.collect||A!==e&&A!==o||i.push([A,O,L,F]),d.bind(A,O,L,F||G)},de=(A,O,L)=>{if(He(A)){let F=A.length;const X=[];for(;F--;)X[F]=de(A[F],O,L);return X}if(i.length>0&&(A===e||A===o)){let F=i.length;for(;F--;){const[X,W,fe]=i[F];A!==X||O&&O!==W||L&&L!==fe||d.unbind(X,W,fe)}}return d.unbind(A,O,L)},le=A=>{if(A&&mo(A)){const O=A.getAttribute("data-mce-contenteditable");return O&&O!=="inherit"?O:A.contentEditable!=="inherit"?A.contentEditable:null}return null},G={doc:e,settings:t,win:o,files:r,stdMode:!0,boxModel:!0,styleSheetLoader:a,boundEvents:i,styles:c,schema:l,events:d,isBlock:A=>Q(A)?ke(u,A):re(A)&&(ke(u,A.nodeName)||er(l,A)),root:null,clone:(A,O)=>A.cloneNode(O),getRoot:b,getViewPort:A=>{const O=Gg(A);return{x:O.x,y:O.y,w:O.width,h:O.height}},getRect:A=>{const O=m(A),L=v(O),F=w(O);return{x:L.x,y:L.y,w:F.w,h:F.h}},getSize:w,getParent:(A,O,L)=>{const F=k(A,O,L,!1);return F&&F.length>0?F[0]:null},getParents:k,get:m,getNext:(A,O)=>S(A,O,"nextSibling"),getPrev:(A,O)=>S(A,O,"previousSibling"),select:(A,O)=>{var L,F;const X=(F=(L=m(O))!==null&&L!==void 0?L:t.root_element)!==null&&F!==void 0?F:e;return Ie(X.querySelectorAll)?en(X.querySelectorAll(A)):[]},is:E,add:x,create:N,createHTML:(A,O,L="")=>{let F="<"+A;for(const X in O)Br(O,X)&&(F+=" "+X+'="'+B(O[X])+'"');return Ms(L)&&ke(l.getVoidElements(),A)?F+" />":F+">"+L+"</"+A+">"},createFragment:A=>{const O=e.createElement("div"),L=e.createDocumentFragment();let F;for(L.appendChild(O),A&&(O.innerHTML=A);F=O.firstChild;)L.appendChild(F);return L.removeChild(O),L},remove:I,setStyle:(A,O,L)=>{_(A,F=>{const X=R(F);Bp(X,O,L),t.update_styles&&Op(c,X)})},getStyle:y,setStyles:(A,O)=>{_(A,L=>{const F=R(L);Ke(O,(X,W)=>{Bp(F,W,X)}),t.update_styles&&Op(c,F)})},removeAllAttribs:A=>_(A,O=>{const L=O.attributes;for(let F=L.length-1;F>=0;F--)O.removeAttributeNode(L.item(F))}),setAttrib:f,setAttribs:T,getAttrib:g,getPos:v,parseStyle:A=>c.parse(A),serializeStyle:(A,O)=>c.serialize(A,O),addStyle:A=>{if(G!==Ve.DOM&&e===document){if(n[A])return;n[A]=!0}let O=e.getElementById("mceDefaultStyles");if(!O){O=e.createElement("style"),O.id="mceDefaultStyles",O.type="text/css";const L=e.head;L.firstChild?L.insertBefore(O,L.firstChild):L.appendChild(O)}O.styleSheet?O.styleSheet.cssText+=A:O.appendChild(e.createTextNode(A))},loadCSS:A=>{A||(A=""),U(A.split(","),O=>{r[O]=!0,a.load(O).catch(Ne)})},addClass:(A,O)=>{V(A,O,!0)},removeClass:(A,O)=>{V(A,O,!1)},hasClass:(A,O)=>{const L=p(A),F=O.split(" ");return q(L)&&wo(F,X=>Rc(L,X))},toggleClass:V,show:A=>{_(A,O=>Hg(R(O),"display"))},hide:A=>{_(A,O=>zg(R(O),"display","none"))},isHidden:A=>{const O=p(A);return q(O)&&Dr(bi(O,"display"),"none")},uniqueId:A=>(A||"mce_")+s++,setHTML:P,getOuterHTML:A=>{const O=p(A);return q(O)?re(O.dom)?O.dom.outerHTML:(L=>{const F=vt("div"),X=R(L.dom.cloneNode(!0));return ut(F,X),Vg(F)})(O):""},setOuterHTML:(A,O)=>{_(A,L=>{re(L)&&(L.outerHTML=O)})},decode:So.decode,encode:B,insertAfter:(A,O)=>{const L=m(O);return _(A,F=>{const X=L==null?void 0:L.parentNode,W=L==null?void 0:L.nextSibling;return X&&(W?X.insertBefore(F,W):X.appendChild(F)),F})},replace:z,rename:(A,O)=>{if(A.nodeName!==O.toUpperCase()){const L=N(O);return id(h(A),F=>{f(L,F.nodeName,g(A,F.nodeName))}),z(L,A,!0),L}return A},findCommonAncestor:(A,O)=>{let L=A;for(;L;){let F=O;for(;F&&L!==F;)F=F.parentNode;if(L===F)break;L=L.parentNode}return!L&&A.ownerDocument?A.ownerDocument.documentElement:L},run:_,getAttribs:h,isEmpty:(A,O,L)=>Rt(O)?fo(l,A,{...L,isContent:X=>{const W=X.nodeName.toLowerCase();return!!O[W]}}):fo(l,A,L),createRng:te,nodeIndex:Vr,split:(A,O,L)=>{let F,X,W=te();if(A&&O&&A.parentNode&&O.parentNode){const fe=A.parentNode;return W.setStart(fe,Vr(A)),W.setEnd(O.parentNode,Vr(O)),F=W.extractContents(),W=te(),W.setStart(O.parentNode,Vr(O)+1),W.setEnd(fe,Vr(A)+1),X=W.extractContents(),fe.insertBefore(Zc(G,F,l),A),L?fe.insertBefore(L,A):fe.insertBefore(O,A),fe.insertBefore(Zc(G,X,l),A),I(A),L||O}},bind:ae,unbind:de,fire:(A,O,L)=>d.dispatch(A,O,L),dispatch:(A,O,L)=>d.dispatch(A,O,L),getContentEditable:le,getContentEditableParent:A=>{const O=b();let L=null;for(let F=A;F&&F!==O&&(L=le(F),L===null);F=F.parentNode);return L},isEditable:A=>{if(q(A)){const O=re(A)?A:A.parentElement;return q(O)&&mo(O)&&Go(R(O))}return!1},destroy:()=>{if(i.length>0){let A=i.length;for(;A--;){const[O,L,F]=i[A];d.unbind(O,L,F)}}Ke(r,(A,O)=>{a.unload(O),delete r[O]})},isChildOf:(A,O)=>A===O||O.contains(A),dumpRng:A=>"startContainer: "+A.startContainer.nodeName+", startOffset: "+A.startOffset+", endContainer: "+A.endContainer.nodeName+", endOffset: "+A.endOffset},se=((A,O,L)=>{const F=O.keep_values,X={set:(fe,Ce,xe)=>{const Me=R(fe);Ie(O.url_converter)&&q(Ce)&&(Ce=O.url_converter.call(O.url_converter_scope||L(),String(Ce),xe,fe)),Zs(Me,"data-mce-"+xe,Ce),Zs(Me,xe,Ce)},get:(fe,Ce)=>{const xe=R(fe);return nn(xe,"data-mce-"+Ce)||nn(xe,Ce)}},W={style:{set:(fe,Ce)=>{const xe=R(fe);F&&Zs(xe,ld,Ce),St(xe,"style"),Q(Ce)&&hi(xe,A.parse(Ce))},get:fe=>{const Ce=R(fe),xe=nn(Ce,ld)||nn(Ce,"style");return A.serialize(A.parse(xe),Oe(Ce))}}};return F&&(W.href=W.src=X),W})(c,t,oe(G));return G};Ve.DOM=Ve(document),Ve.nodeIndex=Vr;const x_=Ve.DOM;class go{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,o)=>{const r=x_;let s;const a=()=>{r.remove(i),s&&(s.onerror=s.onload=s=null)},i=r.uniqueId();s=document.createElement("script"),s.id=i,s.type="text/javascript",s.src=$._addCacheSuffix(t),this.settings.referrerPolicy&&r.setAttrib(s,"referrerpolicy",this.settings.referrerPolicy),s.onload=()=>{a(),n()},s.onerror=()=>{a(),o("Failed to load script: "+t)},(document.getElementsByTagName("head")[0]||document.body).appendChild(s)})}isDone(t){return this.states[t]===2}markDone(t){this.states[t]=2}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=0),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,o=(l,c)=>{Xe(n.scriptLoadedCallbacks,c).each(d=>{U(d,u=>u[l](c))}),delete n.scriptLoadedCallbacks[c]},r=l=>{const c=ye(l,d=>d.status==="rejected");return c.length>0?Promise.reject(an(c,({reason:d})=>He(d)?d:[d])):Promise.resolve()},s=l=>Promise.allSettled(Te(l,c=>n.states[c]===2?(o("resolve",c),Promise.resolve()):n.states[c]===3?(o("reject",c),Promise.reject(c)):(n.states[c]=1,n.loadScript(c).then(()=>{n.states[c]=2,o("resolve",c);const d=n.queue;return d.length>0?(n.queue=[],s(d).then(r)):Promise.resolve()},()=>(n.states[c]=3,o("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,s(l).then(c=>{n.loading=!1;const d=n.queueLoadedCallbacks.shift();return C.from(d).each(Ns),r(c)})),i=ig(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}go.ScriptLoader=new go;const wt=e=>{let t=e;return{get:()=>t,set:n=>{t=n}}},Qs={},cd=wt("en"),Pp=()=>Xe(Qs,cd.get()),On={getData:()=>Bs(Qs,e=>({...e})),setCode:e=>{e&&cd.set(e)},getCode:()=>cd.get(),add:(e,t)=>{let n=Qs[e];n||(Qs[e]=n={});const o=Te(Gt(t),r=>r.toLowerCase());Ke(t,(r,s)=>{const a=s.toLowerCase();a!==s&&((i,l)=>{const c=i.indexOf(l);return c!==-1&&i.indexOf(l,c+1)>c})(o,a)?(ke(t,a)||(n[a]=r),n[s]=r):n[a]=r})},translate:e=>{const t=Pp().getOr({}),n=i=>Ie(i)?Object.prototype.toString.call(i):o(i)?"":""+i,o=i=>i===""||i==null,r=i=>{const l=n(i);return ke(t,l)?n(t[l]):Xe(t,l.toLowerCase()).map(n).getOr(l)},s=i=>i.replace(/{context:\w+}$/,"");if(o(e))return"";if(We(a=e)&&ke(a,"raw"))return n(e.raw);var a;if((i=>He(i)&&i.length>1)(e)){const i=e.slice(1);return s(r(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>ke(i,c)?n(i[c]):l))}return s(r(e))},isRtl:()=>Pp().bind(e=>Xe(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>ke(Qs,e)},It=()=>{const e=[],t={},n={},o=[],r=(l,c)=>{const d=ye(o,u=>u.name===l&&u.state===c);U(d,u=>u.resolve())},s=l=>ke(t,l),a=(l,c)=>{const d=On.getCode();!d||c&&(","+(c||"")+",").indexOf(","+d+",")===-1||go.ScriptLoader.add(t[l]+"/langs/"+d+".js")},i=(l,c="added")=>c==="added"&&(d=>ke(n,d))(l)||c==="loaded"&&s(l)?Promise.resolve():new Promise(d=>{o.push({name:l,state:c,resolve:d})});return{items:e,urls:t,lookup:n,get:l=>{if(n[l])return n[l].instance},requireLangPack:(l,c)=>{It.languageLoad!==!1&&(s(l)?a(l,c):i(l,"loaded").then(()=>a(l,c)))},add:(l,c)=>(e.push(c),n[l]={instance:c},r(l,"added"),c),remove:l=>{delete t[l],delete n[l]},createUrl:(l,c)=>Q(c)?Q(l)?{prefix:"",resource:c,suffix:""}:{prefix:l.prefix,resource:c,suffix:l.suffix}:c,load:(l,c)=>{if(t[l])return Promise.resolve();let d=Q(c)?c:c.prefix+c.resource+c.suffix;d.indexOf("/")!==0&&d.indexOf("://")===-1&&(d=It.baseURL+"/"+d),t[l]=d.substring(0,d.lastIndexOf("/"));const u=()=>(r(l,"loaded"),Promise.resolve());return n[l]?u():go.ScriptLoader.add(d).then(u)},waitFor:i}};It.languageLoad=!0,It.baseURL="",It.PluginManager=It(),It.ThemeManager=It(),It.ModelManager=It();const __=e=>{const t=wt(C.none()),n=()=>t.get().each(o=>clearInterval(o));return{clear:()=>{n(),t.set(C.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:o=>{n(),t.set(C.some(setInterval(o,e)))}}},Ro=()=>{const e=(t=>{const n=wt(C.none()),o=()=>n.get().each(t);return{clear:()=>{o(),n.set(C.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:r=>{o(),n.set(C.some(r))}}})(Ne);return{...e,on:t=>e.get().each(t)}},Ri=(e,t)=>{let n=null;return{cancel:()=>{ct(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{ct(n)&&(n=setTimeout(()=>{n=null,e.apply(null,o)},t))}}},dd=(e,t)=>{let n=null;const o=()=>{ct(n)||(clearTimeout(n),n=null)};return{cancel:o,throttle:(...r)=>{o(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Js=oe("mce-annotation"),or=oe("data-mce-annotation"),qr=oe("data-mce-annotation-uid"),ea=oe("data-mce-annotation-active"),ta=oe("data-mce-annotation-classes"),na=oe("data-mce-annotation-attrs"),Dp=e=>t=>De(t,e),Lp=(e,t)=>{const n=e.selection.getRng(),o=R(n.startContainer),r=R(e.getBody()),s=t.fold(()=>"."+Js(),i=>`[${or()}="${i}"]`),a=Fr(o,n.startOffset).getOr(o);return zr(a,s,Dp(r)).bind(i=>ao(i,`${qr()}`).bind(l=>ao(i,`${or()}`).map(c=>{const d=Ip(e,l);return{uid:l,name:c,elements:d}})))},Mp=(e,t)=>Is(e,"data-mce-bogus")||((n,o,r)=>$s(n,'[data-mce-bogus="all"]',r).isSome())(e,0,Dp(t)),Ip=(e,t)=>{const n=R(e.getBody()),o=Bt(n,`[${qr()}="${t}"]`);return ye(o,r=>!Mp(r,n))},Fp=(e,t)=>{const n=R(e.getBody()),o=Bt(n,`[${or()}="${t}"]`),r={};return U(o,s=>{if(!Mp(s,n)){const a=nn(s,qr()),i=Xe(r,a).getOr([]);r[a]=i.concat([s])}}),r};let Up=0;const oa=e=>{const t=new Date().getTime(),n=Math.floor(1e9*Math.random());return Up++,e+"_"+n+Up+String(t)},zp=(e,t)=>R(e.dom.cloneNode(t)),rr=e=>zp(e,!1),jp=e=>zp(e,!0),Hp=(e,t,n=Qe)=>{const o=new yt(e,t),r=s=>{let a;do a=o[s]();while(a&&!j(a)&&!n(a));return C.from(a).filter(j)};return{current:()=>C.from(o.current()).filter(j),next:()=>r("next"),prev:()=>r("prev"),prev2:()=>r("prev2")}},sr=(e,t)=>{const n=t||(r=>e.isBlock(r)||rt(r)||Ge(r)),o=(r,s,a,i)=>{if(j(r)){const l=i(r,s,r.data);if(l!==-1)return C.some({container:r,offset:l})}return a().bind(l=>o(l.container,l.offset,a,i))};return{backwards:(r,s,a,i)=>{const l=Hp(r,i??e.getRoot(),n);return o(r,s,()=>l.prev().map(c=>({container:c,offset:c.length})),a).getOrNull()},forwards:(r,s,a,i)=>{const l=Hp(r,i??e.getRoot(),n);return o(r,s,()=>l.next().map(c=>({container:c,offset:0})),a).getOrNull()}}},ud=((e,t)=>{const n=o=>e(o)?C.from(o.dom.nodeValue):C.none();return{get:o=>{if(!e(o))throw new Error("Can only get text value of a text node");return n(o).getOr("")},getOption:n,set:(o,r)=>{if(!e(o))throw new Error("Can only set raw text value of a text node");o.dom.nodeValue=r}}})(ln),Ai=e=>ud.get(e),Wr=e=>{let t;return n=>(t=t||bc(e,dt),ke(t,Oe(n)))},ar=e=>tn(e)&&Oe(e)==="br",$p=Wr(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),md=Wr(["ul","ol","dl"]),ra=Wr(["li","dd","dt"]),S_=Wr(["thead","tbody","tfoot"]),sa=Wr(["td","th"]),Ti=Wr(["pre","script","textarea","style"]),aa=()=>{const e=vt("br");return _t(e,"data-mce-bogus","1"),e},Ao=e=>{jr(e),ut(e,aa())},Et=qs,Oi=Uc,on=e=>e.replace(/\uFEFF/g,""),N_=re,Kr=j,Yr=e=>(Kr(e)&&(e=e.parentNode),N_(e)&&e.hasAttribute("data-mce-caret")),To=e=>Kr(e)&&Oi(e.data),cn=e=>Yr(e)||To(e),Vp=e=>e.firstChild!==e.lastChild||!rt(e.firstChild),fd=e=>{const t=e.container();return!!j(t)&&(t.data.charAt(e.offset())===Et||e.isAtStart()&&To(t.previousSibling))},gd=e=>{const t=e.container();return!!j(t)&&(t.data.charAt(e.offset()-1)===Et||e.isAtEnd()&&To(t.nextSibling))},Bi=e=>Kr(e)&&e.data[0]===Et,Pi=e=>Kr(e)&&e.data[e.data.length-1]===Et,pd=e=>e&&e.hasAttribute("data-mce-caret")?((t=>{var n;const o=t.getElementsByTagName("br"),r=o[o.length-1];Qo(r)&&((n=r.parentNode)===null||n===void 0||n.removeChild(r))})(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,qp=e=>Yr(e.startContainer),Gr=Math.round,ir=e=>e?{left:Gr(e.left),top:Gr(e.top),bottom:Gr(e.bottom),right:Gr(e.right),width:Gr(e.width),height:Gr(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Wp=(e,t)=>(e=ir(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),Kp=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,ia=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&Kp(t.top-e.bottom,e,t)},la=(e,t)=>e.top>t.bottom||!(e.bottom<t.top)&&Kp(t.bottom-e.top,e,t),Yp=(e,t,n)=>{const o=Math.max(Math.min(t,e.left+e.width),e.left),r=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-o)*(t-o)+(n-r)*(n-r))},Di=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Oo=(e,t)=>{if(re(e)&&e.hasChildNodes()){const n=e.childNodes,o=((r,s,a)=>Math.min(Math.max(r,0),a))(t,0,n.length-1);return n[o]}return e},R_=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Gp=e=>Q(e)&&e.charCodeAt(0)>=768&&R_.test(e),Xp=Cn,A_=Ge,T_=rt,O_=j,B_=An(["script","style","textarea"]),Zp=An(["img","input","textarea","hr","iframe","video","audio","object","embed"]),P_=An(["table"]),D_=cn,Bn=e=>!D_(e)&&(O_(e)?!B_(e.parentNode):Zp(e)||T_(e)||P_(e)||hd(e)),hd=e=>!(t=>re(t)&&t.getAttribute("unselectable")==="true")(e)&&A_(e),Qp=(e,t)=>Bn(e)&&((n,o)=>{for(let r=n.parentNode;r&&r!==o;r=r.parentNode){if(hd(r))return!1;if(Xp(r))return!0}return!0})(e,t),Jp=re,L_=Bn,eh=wi("display","block table"),M_=wi("float","left right"),ca=((...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0})(Jp,L_,Ss(M_)),I_=Ss(wi("white-space","pre pre-line pre-wrap")),da=j,bd=rt,th=Ve.nodeIndex,Li=(e,t)=>t<0&&re(e)&&e.hasChildNodes()?void 0:Oo(e,t),vd=e=>e?e.createRange():Ve.DOM.createRng(),yd=e=>Q(e)&&/[\r\n\t ]/.test(e),nh=e=>!!e.setStart&&!!e.setEnd,Cd=e=>{const t=e.startContainer,n=e.startOffset;if(yd(e.toString())&&I_(t.parentNode)&&j(t)){const o=t.data;if(yd(o[n-1])||yd(o[n+1]))return!0}return!1},oh=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,Bo=e=>{var t;let n;const o=e.getClientRects();return n=o.length>0?ir(o[0]):ir(e.getBoundingClientRect()),!nh(e)&&bd(e)&&oh(n)?(r=>{const s=r.ownerDocument,a=vd(s),i=s.createTextNode(Ct),l=r.parentNode;l.insertBefore(i,r),a.setStart(i,0),a.setEnd(i,1);const c=ir(a.getBoundingClientRect());return l.removeChild(i),c})(e):oh(n)&&nh(e)&&(t=(r=>{const s=r.startContainer,a=r.endContainer,i=r.startOffset,l=r.endOffset;if(s===a&&j(a)&&i===0&&l===1){const c=r.cloneRange();return c.setEndAfter(a),Bo(c)}return null})(e))!==null&&t!==void 0?t:n},lr=(e,t)=>{const n=Wp(e,t);return n.width=1,n.right=n.left+1,n},M=(e,t,n)=>{const o=()=>(n||(n=(r=>{const s=[],a=d=>{var u,m;d.height!==0&&(s.length>0&&(u=d,m=s[s.length-1],u.left===m.left&&u.top===m.top&&u.bottom===m.bottom&&u.right===m.right)||s.push(d))},i=(d,u)=>{const m=vd(d.ownerDocument);if(u<d.data.length){if(Gp(d.data[u]))return;if(Gp(d.data[u-1])&&(m.setStart(d,u),m.setEnd(d,u+1),!Cd(m)))return void a(lr(Bo(m),!1))}u>0&&(m.setStart(d,u-1),m.setEnd(d,u),Cd(m)||a(lr(Bo(m),!1))),u<d.data.length&&(m.setStart(d,u),m.setEnd(d,u+1),Cd(m)||a(lr(Bo(m),!0)))},l=r.container(),c=r.offset();if(da(l))return i(l,c),s;if(Jp(l))if(r.isAtEnd()){const d=Li(l,c);da(d)&&i(d,d.data.length),ca(d)&&!bd(d)&&a(lr(Bo(d),!1))}else{const d=Li(l,c);if(da(d)&&i(d,0),ca(d)&&r.isAtEnd())return a(lr(Bo(d),!1)),s;const u=Li(r.container(),r.offset()-1);ca(u)&&!bd(u)&&(eh(u)||eh(d)||!ca(d))&&a(lr(Bo(u),!1)),ca(d)&&a(lr(Bo(d),!0))}return s})(M(e,t))),n);return{container:oe(e),offset:oe(t),toRange:()=>{const r=vd(e.ownerDocument);return r.setStart(e,t),r.setEnd(e,t),r},getClientRects:o,isVisible:()=>o().length>0,isAtStart:()=>(da(e),t===0),isAtEnd:()=>da(e)?t>=e.data.length:t>=e.childNodes.length,isEqual:r=>r&&e===r.container()&&t===r.offset(),getNode:r=>Li(e,r?t-1:t)}};M.fromRangeStart=e=>M(e.startContainer,e.startOffset),M.fromRangeEnd=e=>M(e.endContainer,e.endOffset),M.after=e=>M(e.parentNode,th(e)+1),M.before=e=>M(e.parentNode,th(e)),M.isAbove=(e,t)=>Tt(Ht(t.getClientRects()),Eo(e.getClientRects()),ia).getOr(!1),M.isBelow=(e,t)=>Tt(Eo(t.getClientRects()),Ht(e.getClientRects()),la).getOr(!1),M.isAtStart=e=>!!e&&e.isAtStart(),M.isAtEnd=e=>!!e&&e.isAtEnd(),M.isTextPosition=e=>!!e&&j(e.container()),M.isElementPosition=e=>!M.isTextPosition(e);const Mi=(e,t)=>{j(t)&&t.data.length===0&&e.remove(t)},wd=(e,t,n)=>{jc(n)?((o,r,s)=>{const a=C.from(s.firstChild),i=C.from(s.lastChild);r.insertNode(s),a.each(l=>Mi(o,l.previousSibling)),i.each(l=>Mi(o,l.nextSibling))})(e,t,n):((o,r,s)=>{r.insertNode(s),Mi(o,s.previousSibling),Mi(o,s.nextSibling)})(e,t,n)},Pn=j,rh=Qo,sh=Ve.nodeIndex,ah=e=>{const t=e.parentNode;return rh(t)?ah(t):t},Ed=e=>e?li(e.childNodes,(t,n)=>(rh(n)&&n.nodeName!=="BR"?t=t.concat(Ed(n)):t.push(n),t),[]):[],ih=e=>t=>e===t,lh=e=>(Pn(e)?"text()":e.nodeName.toLowerCase())+"["+(t=>{let n,o;n=Ed(ah(t)),o=cg(n,ih(t),t),n=n.slice(0,o+1);const r=li(n,(s,a,i)=>(Pn(a)&&Pn(n[i-1])&&s++,s),0);return n=Ds(n,An([t.nodeName])),o=cg(n,ih(t),t),o-r})(e)+"]",ch=(e,t)=>{let n,o=[],r=t.container(),s=t.offset();if(Pn(r))n=((i,l)=>{let c=i;for(;(c=c.previousSibling)&&Pn(c);)l+=c.data.length;return l})(r,s);else{const i=r.childNodes;s>=i.length?(n="after",s=i.length-1):n="before",r=i[s]}o.push(lh(r));let a=((i,l,c)=>{const d=[];for(let u=l.parentNode;u&&u!==i;u=u.parentNode)d.push(u);return d})(e,r);return a=Ds(a,Ss(Qo)),o=o.concat(wc(a,i=>lh(i))),o.reverse().join("/")+","+n},dh=(e,t)=>{if(!t)return null;const n=t.split(","),o=n[0].split("/"),r=n.length>1?n[1]:"before",s=li(o,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),((c,d,u)=>{let m=Ed(c);return m=Ds(m,(p,g)=>!Pn(p)||!Pn(m[g-1])),m=Ds(m,An([d])),m[u]})(a,l[1],parseInt(l[2],10))):null},e);if(!s)return null;if(!Pn(s)&&s.parentNode){let a;return a=r==="after"?sh(s)+1:sh(s),M(s.parentNode,a)}return((a,i)=>{let l=a,c=0;for(;Pn(l);){const d=l.data.length;if(i>=c&&i<=c+d){a=l,i-=c;break}if(!Pn(l.nextSibling)){a=l,i=d;break}c+=d,l=l.nextSibling}return Pn(a)&&i>a.data.length&&(i=a.data.length),M(a,i)})(s,parseInt(r,10))},Ii=Ge,uh=(e,t,n,o,r)=>{const s=r?o.startContainer:o.endContainer;let a=r?o.startOffset:o.endOffset;const i=[],l=e.getRoot();if(j(s))i.push(n?((c,d,u)=>{let m=c(d.data.slice(0,u)).length;for(let p=d.previousSibling;p&&j(p);p=p.previousSibling)m+=c(p.data).length;return m})(t,s,a):a);else{let c=0;const d=s.childNodes;a>=d.length&&d.length&&(c=1,a=Math.max(0,d.length-1)),i.push(e.nodeIndex(d[a],n)+c)}for(let c=s;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},kd=(e,t,n)=>{let o=0;return $.each(e.select(t),r=>r.getAttribute("data-mce-bogus")==="all"?void 0:r!==n&&void o++),o},mh=(e,t)=>{let n=t?e.startContainer:e.endContainer,o=t?e.startOffset:e.endOffset;if(re(n)&&n.nodeName==="TR"){const r=n.childNodes;n=r[Math.min(t?o:o-1,r.length-1)],n&&(o=t?0:n.childNodes.length,t?e.setStart(n,o):e.setEnd(n,o))}},fh=e=>(mh(e,!0),mh(e,!1),e),gh=(e,t)=>{if(re(e)&&(e=Oo(e,t),Ii(e)))return e;if(cn(e)){j(e)&&Yr(e)&&(e=e.parentNode);let n=e.previousSibling;if(Ii(n)||(n=e.nextSibling,Ii(n)))return n}},ph=(e,t,n)=>{const o=n.getNode(),r=n.getRng();if(o.nodeName==="IMG"||Ii(o)){const a=o.nodeName;return{name:a,index:kd(n.dom,a,o)}}const s=(a=>gh(a.startContainer,a.startOffset)||gh(a.endContainer,a.endOffset))(r);if(s){const a=s.tagName;return{name:a,index:kd(n.dom,a,s)}}return((a,i,l,c)=>{const d=i.dom,u=uh(d,a,l,c,!0),m=i.isForward(),p=qp(c)?{isFakeCaret:!0}:{};return i.isCollapsed()?{start:u,forward:m,...p}:{start:u,end:uh(d,a,l,c,!1),forward:m,...p}})(e,n,t,r)},hh=(e,t,n)=>{const o={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",o,"&#xFEFF;"):e.create("span",o)},bh=(e,t)=>{const n=e.dom;let o=e.getRng();const r=n.uniqueId(),s=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:kd(n,i,a)};const c=fh(o.cloneRange());if(!s){c.collapse(!1);const u=hh(n,r+"_end",t);wd(n,c,u)}o=fh(o),o.collapse(!0);const d=hh(n,r+"_start",t);return wd(n,o,d),e.moveToBookmark({id:r,keep:!0,forward:l}),{id:r,forward:l}},xd=ne(ph,jt,!0),vh=e=>{const t=s=>s(e),n=oe(e),o=()=>r,r={tag:!0,inner:e,fold:(s,a)=>a(e),isValue:dt,isError:Qe,map:s=>$t.value(s(e)),mapError:o,bind:t,exists:t,forall:t,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:s=>{s(e)},toOptional:()=>C.some(e)};return r},yh=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(o,r)=>o(e),isValue:Qe,isError:dt,map:t,mapError:o=>$t.error(o(e)),bind:t,exists:Qe,forall:dt,getOr:jt,or:jt,getOrThunk:pc,orThunk:pc,getOrDie:eg(String(e)),each:Ne,toOptional:C.none};return n},$t={value:vh,error:yh,fromOption:(e,t)=>e.fold(()=>yh(t),vh)},Wn=e=>{if(!He(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return U(e,(o,r)=>{const s=Gt(o);if(s.length!==1)throw new Error("one and only one name per case");const a=s[0],i=o[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!He(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...d)=>{if(d.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+d.length);return d[r].apply(null,l)},match:d=>{const u=Gt(d);if(t.length!==u.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+u.join(","));if(!wo(t,m=>Ue(u,m)))throw new Error("Not all branches were specified when using match. Specified: "+u.join(", ")+`
Required: `+t.join(", "));return d[a].apply(null,l)},log:d=>{console.log(d,{constructors:t,constructor:a,params:l})}}}}),n};Wn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const F_=e=>e.type==="inline-command"||e.type==="inline-format",U_=e=>e.type==="block-command"||e.type==="block-format",z_=e=>{var t;const n=r=>$t.error({message:r,pattern:e}),o=(r,s,a)=>{if(e.format!==void 0){let i;if(He(e.format)){if(!wo(e.format,Q))return n(r+" pattern has non-string items in the `format` array");i=e.format}else{if(!Q(e.format))return n(r+" pattern has non-string `format` parameter");i=[e.format]}return $t.value(s(i))}return e.cmd!==void 0?Q(e.cmd)?$t.value(a(e.cmd,e.value)):n(r+" pattern has non-string `cmd` parameter"):n(r+" pattern is missing both `format` and `cmd` parameters")};if(!We(e))return n("Raw pattern is not an object");if(!Q(e.start))return n("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!Q(e.end))return n("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return n("Inline pattern has empty `start` and `end` parameters");let r=e.start,s=e.end;return s.length===0&&(s=r,r=""),o("Inline",a=>({type:"inline-format",start:r,end:s,format:a}),(a,i)=>({type:"inline-command",start:r,end:s,cmd:a,value:i}))}if(e.replacement!==void 0)return Q(e.replacement)?e.start.length===0?n("Replacement pattern has empty `start` parameter"):$t.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):n("Replacement pattern has non-string `replacement` parameter");{const r=(t=e.trigger)!==null&&t!==void 0?t:"space";return e.start.length===0?n("Block pattern has empty `start` parameter"):o("Block",s=>({type:"block-format",start:e.start,format:s[0],trigger:r}),(s,a)=>({type:"block-command",start:e.start,cmd:s,value:a,trigger:r}))}},Ch=e=>ye(e,U_),wh=e=>ye(e,F_),_d=(e,t)=>({...e,blockPatterns:ye(e.blockPatterns,n=>((o,r)=>(o.type==="block-command"||o.type==="block-format")&&o.trigger===r)(n,t))}),Eh=e=>{const t=(n=>{const o=[],r=[];return U(n,s=>{s.fold(a=>{o.push(a)},a=>{r.push(a)})}),{errors:o,values:r}})(Te(e,z_));return U(t.errors,n=>console.error(n.message,n.pattern)),t.values},Sd=zn().deviceType,j_=Sd.isTouch(),H_=Ve.DOM,kh=e=>je(e,RegExp),J=e=>t=>t.options.get(e),Fi=e=>Q(e)||We(e),xh=(e,t="")=>n=>{const o=Q(n);if(o){if(n.indexOf("=")!==-1){const r=(s=>{const a=s.indexOf("=")>0?s.split(/[;,](?![^=;,]*(?:[;,]|$))/):s.split(",");return Yt(a,(i,l)=>{const c=l.split("="),d=c[0],u=c.length>1?c[1]:d;return i[Pr(d)]=Pr(u),i},{})})(n);return{value:Xe(r,e.id).getOr(t),valid:o}}return{value:n,valid:o}}return{valid:!1,message:"Must be a string."}},$_=J("iframe_attrs"),V_=J("doctype"),_h=J("document_base_url"),q_=J("body_id"),W_=J("body_class"),Sh=J("content_security_policy"),K_=J("br_in_pre"),Dt=J("forced_root_block"),ua=J("forced_root_block_attrs"),Y_=J("newline_behavior"),G_=J("br_newline_selector"),X_=J("no_newline_selector"),Z_=J("keep_styles"),Q_=J("end_container_on_empty_block"),Nh=J("automatic_uploads"),Rh=J("images_reuse_filename"),J_=J("images_replace_blob_uris"),Ah=J("icons"),eS=J("icons_url"),tS=J("images_upload_url"),nS=J("images_upload_base_path"),oS=J("images_upload_credentials"),rS=J("images_upload_handler"),sS=J("content_css_cors"),Nd=J("referrer_policy"),Th=J("language"),aS=J("language_url"),Oh=J("indent_use_margin"),iS=J("indentation"),lS=J("content_css"),cS=J("content_style"),Bh=J("font_css"),dS=J("directionality"),uS=J("inline_boundaries_selector"),Ph=J("object_resizing"),mS=J("resize_img_proportional"),fS=J("placeholder"),Dh=J("event_root"),gS=J("service_message"),Xr=J("theme"),pS=J("theme_url"),Rd=J("model"),hS=J("model_url"),ma=J("inline_boundaries"),bS=J("formats"),vS=J("preview_styles"),yS=J("format_empty_lines"),CS=J("format_noneditable_selector"),wS=J("custom_ui_selector"),Ad=J("inline"),ES=J("hidden_input"),kS=J("submit_patch"),xS=J("add_form_submit_trigger"),_S=J("add_unload_trigger"),SS=J("custom_undo_redo_levels"),NS=J("disable_nodechange"),Lh=J("readonly"),RS=J("editable_root"),Mh=J("content_css_cors"),Ui=J("plugins"),AS=J("external_plugins"),TS=J("block_unsupported_drop"),OS=J("visual"),BS=J("visual_table_class"),Ih=J("visual_anchor_class"),PS=J("iframe_aria_text"),DS=J("setup"),LS=J("init_instance_callback"),MS=J("urlconverter_callback"),IS=J("auto_focus"),FS=J("browser_spellcheck"),US=J("protect"),zS=J("paste_block_drop"),zi=J("paste_data_images"),jS=J("paste_preprocess"),HS=J("paste_postprocess"),$S=J("newdocument_content"),VS=J("paste_webkit_styles"),qS=J("paste_remove_styles_if_webkit"),WS=J("paste_merge_formats"),KS=J("smart_paste"),YS=J("paste_as_text"),GS=J("paste_tab_spaces"),XS=J("allow_html_data_urls"),ZS=J("text_patterns"),QS=J("text_patterns_lookup"),Fh=J("noneditable_class"),JS=J("editable_class"),eN=J("noneditable_regexp"),tN=J("preserve_cdata"),nN=J("highlight_on_focus"),Uh=J("xss_sanitization"),oN=J("init_content_sync"),zh=e=>$.explode(e.options.get("images_file_types")),rN=J("table_tab_navigation"),sN=J("details_initial_state"),aN=J("details_serialized_state"),jh=J("sandbox_iframes"),Td=e=>e.options.get("sandbox_iframes_exclusions"),iN=J("convert_unsafe_embeds"),lN=J("license_key"),cN=J("api_key"),dN=re,Hh=j,$h=e=>{const t=e.parentNode;t&&t.removeChild(e)},Vh=e=>{const t=on(e);return{count:e.length-t.length,text:t}},qh=e=>{let t;for(;(t=e.data.lastIndexOf(Et))!==-1;)e.deleteData(t,1)},Wh=(e,t)=>(cr(e),t),uN=(e,t)=>M.isTextPosition(t)?((n,o)=>Hh(n)&&o.container()===n?((r,s)=>{const a=Vh(r.data.substr(0,s.offset())),i=Vh(r.data.substr(s.offset()));return(a.text+i.text).length>0?(qh(r),M(r,s.offset()-a.count)):s})(n,o):Wh(n,o))(e,t):((n,o)=>o.container()===n.parentNode?((r,s)=>{const a=s.container(),i=((l,c)=>{const d=tg(l,c);return d===-1?C.none():C.some(d)})(en(a.childNodes),r).map(l=>l<s.offset()?M(a,s.offset()-1):s).getOr(s);return cr(r),i})(n,o):Wh(n,o))(e,t),cr=e=>{dN(e)&&cn(e)&&(Vp(e)?e.removeAttribute("data-mce-caret"):$h(e)),Hh(e)&&(qh(e),e.data.length===0&&$h(e))},mN=Ge,fN=qn,gN=Ei,Kh=(e,t,n)=>{const o=Wp(t.getBoundingClientRect(),n);let r,s;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;r=e.scrollLeft||i.scrollLeft,s=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();r=e.scrollLeft-i.left,s=e.scrollTop-i.top}o.left+=r,o.right+=r,o.top+=s,o.bottom+=s,o.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),o.left+=a,o.right+=a),o},pN=(e,t,n,o)=>{const r=Ro();let s,a;const i=Dt(e),l=e.dom,c=()=>{(d=>{var u,m;const p=Bt(R(d),"*[contentEditable=false],video,audio,embed,object");for(let g=0;g<p.length;g++){const h=p[g].dom;let f=h.previousSibling;if(Pi(f)){const b=f.data;b.length===1?(u=f.parentNode)===null||u===void 0||u.removeChild(f):f.deleteData(b.length-1,1)}f=h.nextSibling,Bi(f)&&(f.data.length===1?(m=f.parentNode)===null||m===void 0||m.removeChild(f):f.deleteData(0,1))}})(t),a&&(cr(a),a=null),r.on(d=>{l.remove(d.caret),r.clear()}),s&&(clearInterval(s),s=void 0)};return{show:(d,u)=>{let m;if(c(),gN(u))return null;if(!n(u))return a=((p,g)=>{var h;const f=((h=p.ownerDocument)!==null&&h!==void 0?h:document).createTextNode(Et),b=p.parentNode;if(g){const v=p.previousSibling;if(Kr(v)){if(cn(v))return v;if(Pi(v))return v.splitText(v.data.length-1)}b==null||b.insertBefore(f,p)}else{const v=p.nextSibling;if(Kr(v)){if(cn(v))return v;if(Bi(v))return v.splitText(1),v}p.nextSibling?b==null||b.insertBefore(f,p.nextSibling):b==null||b.appendChild(f)}return f})(u,d),m=u.ownerDocument.createRange(),fa(a.nextSibling)?(m.setStart(a,0),m.setEnd(a,0)):(m.setStart(a,1),m.setEnd(a,1)),m;{const p=((f,b,v)=>{var y;const w=((y=b.ownerDocument)!==null&&y!==void 0?y:document).createElement(f);w.setAttribute("data-mce-caret",v?"before":"after"),w.setAttribute("data-mce-bogus","all"),w.appendChild(aa().dom);const E=b.parentNode;return v?E==null||E.insertBefore(w,b):b.nextSibling?E==null||E.insertBefore(w,b.nextSibling):E==null||E.appendChild(w),w})(i,u,d),g=Kh(t,u,d);l.setStyle(p,"top",g.top),l.setStyle(p,"caret-color","transparent"),a=p;const h=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(h,{...g}),l.add(t,h),r.set({caret:h,element:u,before:d}),d&&l.addClass(h,"mce-visual-caret-before"),s=setInterval(()=>{r.on(f=>{o()?l.toggleClass(f.caret,"mce-visual-caret-hidden"):l.addClass(f.caret,"mce-visual-caret-hidden")})},500),m=u.ownerDocument.createRange(),m.setStart(p,0),m.setEnd(p,0)}return m},hide:c,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{r.on(d=>{const u=Kh(t,d.element,d.before);l.setStyles(d.caret,{...u})})},destroy:()=>clearInterval(s)}},Yh=()=>Be.browser.isFirefox(),fa=e=>mN(e)||fN(e),ga=e=>(fa(e)||Vn(e)&&Yh())&&gi(R(e)).exists(Go),hN=Cn,Od=Ge,bN=qn,Gh=wi("display","block table table-cell table-caption list-item"),Xh=cn,Zh=Yr,vN=re,yN=j,CN=Bn,Zr=e=>e>0,dr=e=>e<0,ji=(e,t)=>{let n;for(;n=e(t);)if(!Zh(n))return n;return null},pa=(e,t,n,o,r)=>{const s=new yt(e,o),a=Od(e)||Zh(e);let i;if(dr(t)){if(a&&(i=ji(s.prev.bind(s),!0),n(i)))return i;for(;i=ji(s.prev.bind(s),r);)if(n(i))return i}if(Zr(t)){if(a&&(i=ji(s.next.bind(s),!0),n(i)))return i;for(;i=ji(s.next.bind(s),r);)if(n(i))return i}return null},Po=(e,t)=>{for(;e&&e!==t;){if(Gh(e))return e;e=e.parentNode}return null},Kn=(e,t,n)=>Po(e.container(),n)===Po(t.container(),n),Bd=(e,t)=>{if(!t)return C.none();const n=t.container(),o=t.offset();return vN(n)?C.from(n.childNodes[o+e]):C.none()},Qh=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},wN=(e,t,n)=>Po(t,e)===Po(n,e),Jh=(e,t,n)=>{const o=e?"previousSibling":"nextSibling";let r=n;for(;r&&r!==t;){let s=r[o];if(s&&Xh(s)&&(s=s[o]),Od(s)||bN(s)){if(wN(t,s,r))return s;break}if(CN(s))break;r=r.parentNode}return null},ha=ne(Qh,!0),ba=ne(Qh,!1),Pd=(e,t,n)=>{let o;const r=ne(Jh,!0,t),s=ne(Jh,!1,t),a=n.startContainer,i=n.startOffset;if(Yr(a)){const l=yN(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(o=l.nextSibling,ga(o)))return ha(o);if(c==="after"&&(o=l.previousSibling,ga(o)))return ba(o)}if(!n.collapsed)return n;if(j(a)){if(Xh(a)){if(e===1){if(o=s(a),o)return ha(o);if(o=r(a),o)return ba(o)}if(e===-1){if(o=r(a),o)return ba(o);if(o=s(a),o)return ha(o)}return n}if(Pi(a)&&i>=a.data.length-1)return e===1&&(o=s(a),o)?ha(o):n;if(Bi(a)&&i<=1)return e===-1&&(o=r(a),o)?ba(o):n;if(i===a.data.length)return o=s(a),o?ha(o):n;if(i===0)return o=r(a),o?ba(o):n}return n},eb=(e,t)=>Bd(e?0:-1,t).filter(Od),va=(e,t,n)=>{const o=Pd(e,t,n);return e===-1?M.fromRangeStart(o):M.fromRangeEnd(o)},Hi=e=>C.from(e.getNode()).map(R),Dd=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},$i=(e,t)=>{const n=Kn(e,t);return!(n||!rt(e.getNode()))||n};var kt;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(kt||(kt={}));const EN=Ge,Yn=j,tb=re,Ld=rt,Qr=Bn,nb=e=>Zp(e)||(t=>!!hd(t)&&!Yt(en(t.getElementsByTagName("*")),(n,o)=>n||Xp(o),!1))(e),Vi=Qp,ob=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,rb=(e,t)=>{if(Zr(e)){if(Qr(t.previousSibling)&&!Yn(t.previousSibling))return M.before(t);if(Yn(t))return M(t,0)}if(dr(e)){if(Qr(t.nextSibling)&&!Yn(t.nextSibling))return M.after(t);if(Yn(t))return M(t,t.data.length)}return dr(e)?Ld(t)?M.before(t):M.after(t):M.before(t)},Md=(e,t,n)=>{let o,r,s,a;if(!tb(n)||!t)return null;if(t.isEqual(M.after(n))&&n.lastChild){if(a=M.after(n.lastChild),dr(e)&&Qr(n.lastChild)&&tb(n.lastChild))return Ld(n.lastChild)?M.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(Yn(i)){if(dr(e)&&l>0)return M(i,--l);if(Zr(e)&&l<i.length)return M(i,++l);o=i}else{if(dr(e)&&l>0&&(r=ob(i,l-1),Qr(r)))return!nb(r)&&(s=pa(r,e,Vi,r),s)?Yn(s)?M(s,s.data.length):M.after(s):Yn(r)?M(r,r.data.length):M.before(r);if(Zr(e)&&l<i.childNodes.length&&(r=ob(i,l),Qr(r)))return Ld(r)?((d,u)=>{const m=u.nextSibling;return m&&Qr(m)?Yn(m)?M(m,0):M.before(m):Md(kt.Forwards,M.after(u),d)})(n,r):!nb(r)&&(s=pa(r,e,Vi,r),s)?Yn(s)?M(s,0):M.before(s):Yn(r)?M(r,0):M.after(r);o=r||a.getNode()}if(o&&(Zr(e)&&a.isAtEnd()||dr(e)&&a.isAtStart())&&(o=pa(o,e,dt,n,!0),Vi(o,n)))return rb(e,o);r=o&&pa(o,e,Vi,n);const c=qo(ye(((d,u)=>{const m=[];let p=d;for(;p&&p!==u;)m.push(p),p=p.parentNode;return m})(i,n),EN));return!c||r&&c.contains(r)?r?rb(e,r):null:(a=Zr(e)?M.after(c):M.before(c),a)},Gn=e=>({next:t=>Md(kt.Forwards,t,e),prev:t=>Md(kt.Backwards,t,e)}),sb=e=>M.isTextPosition(e)?e.offset()===0:Bn(e.getNode()),ab=e=>{if(M.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}return Bn(e.getNode(!0))},ib=(e,t)=>!M.isTextPosition(e)&&!M.isTextPosition(t)&&e.getNode()===t.getNode(!0),dn=(e,t,n)=>{const o=Gn(t);return C.from(e?o.next(n):o.prev(n))},Jr=(e,t,n)=>dn(e,t,n).bind(o=>Kn(n,o,t)&&((r,s,a)=>{return r?!ib(s,a)&&(i=s,!(!M.isTextPosition(i)&&rt(i.getNode())))&&ab(s)&&sb(a):!ib(a,s)&&sb(s)&&ab(a);var i})(e,n,o)?dn(e,t,o):C.some(o)),lb=(e,t,n,o)=>Jr(e,t,n).bind(r=>o(r)?lb(e,t,r,o):C.some(r)),es=(e,t)=>{const n=e?t.firstChild:t.lastChild;return j(n)?C.some(M(n,e?0:n.data.length)):n?Bn(n)?C.some(e?M.before(n):rt(o=n)?M.before(o):M.after(o)):((r,s,a)=>{const i=r?M.before(a):M.after(a);return dn(r,s,i)})(e,t,n):C.none();var o},Vt=ne(dn,!0),Zt=ne(dn,!1),Lt=ne(es,!0),wn=ne(es,!1),Id="_mce_caret",un=e=>re(e)&&e.id===Id,ur=(e,t)=>{let n=t;for(;n&&n!==e;){if(un(n))return n;n=n.parentNode}return null},cb=e=>ke(e,"name"),db=e=>$.isArray(e.start),qi=e=>!(!cb(e)&&Kt(e.forward))||e.forward,ub=(e,t)=>(re(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),kN=(e,t)=>wn(e).fold(Qe,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),mb=(e,t,n)=>!(!(o=>!o.hasChildNodes())(t)||!ur(e,t)||(((o,r)=>{var s;const a=((s=o.ownerDocument)!==null&&s!==void 0?s:document).createTextNode(Et);o.appendChild(a),r.setStart(a,0),r.setEnd(a,0)})(t,n),0)),fb=(e,t,n,o)=>{const r=n[t?"start":"end"],s=e.getRoot();if(r){let a=s,i=r[0];for(let l=r.length-1;a&&l>=1;l--){const c=a.childNodes;if(mb(s,a,o))return!0;if(r[l]>c.length-1)return!!mb(s,a,o)||kN(a,o);a=c[r[l]]}j(a)&&(i=Math.min(r[0],a.data.length)),re(a)&&(i=Math.min(r[0],a.childNodes.length)),t?o.setStart(a,i):o.setEnd(a,i)}return!0},Fd=e=>j(e)&&e.data.length>0,gb=(e,t,n)=>{const o=e.get(n.id+"_"+t),r=o==null?void 0:o.parentNode,s=n.keep;if(o&&r){let a,i;if(t==="start"?s?o.hasChildNodes()?(a=o.firstChild,i=1):Fd(o.nextSibling)?(a=o.nextSibling,i=0):Fd(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=e.nodeIndex(o)+1):(a=r,i=e.nodeIndex(o)):s?o.hasChildNodes()?(a=o.firstChild,i=1):Fd(o.previousSibling)?(a=o.previousSibling,i=o.previousSibling.data.length):(a=r,i=e.nodeIndex(o)):(a=r,i=e.nodeIndex(o)),!s){const l=o.previousSibling,c=o.nextSibling;let d;for($.each($.grep(o.childNodes),u=>{j(u)&&(u.data=u.data.replace(/\uFEFF/g,""))});d=e.get(n.id+"_"+t);)e.remove(d,!0);if(j(c)&&j(l)&&!Be.browser.isOpera()){const u=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=u}}return C.some(M(a,i))}return C.none()},xN=(e,t,n)=>((o,r,s=!1)=>r===2?ph(on,s,o):r===3?(a=>{const i=a.getRng();return{start:ch(a.dom.getRoot(),M.fromRangeStart(i)),end:ch(a.dom.getRoot(),M.fromRangeEnd(i)),forward:a.isForward()}})(o):r?(a=>({rng:a.getRng(),forward:a.isForward()}))(o):bh(o,!1))(e,t,n),_N=(e,t)=>{((n,o)=>{const r=n.dom;if(o){if(db(o))return((s,a)=>{const i=s.createRng();return fb(s,!0,a,i)&&fb(s,!1,a,i)?C.some({range:i,forward:qi(a)}):C.none()})(r,o);if((s=>Q(s.start))(o))return((s,a)=>{const i=C.from(dh(s.getRoot(),a.start)),l=C.from(dh(s.getRoot(),a.end));return Tt(i,l,(c,d)=>{const u=s.createRng();return u.setStart(c.container(),c.offset()),u.setEnd(d.container(),d.offset()),{range:u,forward:qi(a)}})})(r,o);if((s=>ke(s,"id"))(o))return((s,a)=>{const i=gb(s,"start",a),l=gb(s,"end",a);return Tt(i,l.or(i),(c,d)=>{const u=s.createRng();return u.setStart(ub(s,c.container()),c.offset()),u.setEnd(ub(s,d.container()),d.offset()),{range:u,forward:qi(a)}})})(r,o);if(cb(o))return((s,a)=>C.from(s.select(a.name)[a.index]).map(i=>{const l=s.createRng();return l.selectNode(i),{range:l,forward:!0}}))(r,o);if((s=>ke(s,"rng"))(o))return C.some({range:o.rng,forward:qi(o)})}return C.none()})(e,t).each(({range:n,forward:o})=>{e.setRng(n,o)})},mn=e=>re(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Wi=(pb=Ct,e=>pb===e);var pb;const ts=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Ud=e=>!ts(e)&&!Wi(e)&&!Uc(e),zd=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},hb=(e,t)=>{const n=Bt(t,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:(o=>ye((r=>an(r,s=>{const a=Di(s);return a?[R(a)]:[]}))(o),sa))(e)},ns=e=>hb(zd(e.selection.getSel()),R(e.getBody())),ya=(e,t)=>$s(e,"table",t),bb=e=>Ac(e).fold(oe([e]),t=>[e].concat(bb(t))),jd=e=>Tc(e).fold(oe([e]),t=>Oe(t)==="br"?Ko(t).map(n=>[e].concat(jd(n))).getOr([]):[e].concat(jd(t))),Hd=(e,t)=>Tt((n=>{const o=n.startContainer,r=n.startOffset;return j(o)?r===0?C.some(R(o)):C.none():C.from(o.childNodes[r]).map(R)})(t),(n=>{const o=n.endContainer,r=n.endOffset;return j(o)?r===o.data.length?C.some(R(o)):C.none():C.from(o.childNodes[r-1]).map(R)})(t),(n,o)=>{const r=pt(bb(e),ne(De,n)),s=pt(jd(e),ne(De,o));return r.isSome()&&s.isSome()}).getOr(!1),$d=(e,t,n,o)=>{const r=n,s=new yt(n,r),a=Ps(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Ue(["td","th","table"],c.toLowerCase()));let i=n;do{if(j(i)&&$.trim(i.data).length!==0)return void(o?t.setStart(i,0):t.setEnd(i,i.data.length));if(a[i.nodeName])return void(o?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i))}while(i=o?s.next():s.prev());r.nodeName==="BODY"&&(o?t.setStart(r,0):t.setEnd(r,r.childNodes.length))},Ki=e=>{const t=e.selection.getSel();return q(t)&&t.rangeCount>0},Vd=(e,t)=>{const n=ns(e);n.length>0?U(n,o=>{const r=o.dom,s=e.dom.createRng();s.setStartBefore(r),s.setEndAfter(r),t(s,!0)}):t(e.selection.getRng(),!1)},vb=(e,t,n)=>{const o=bh(e,t);n(o),e.moveToBookmark(o)},Ca=e=>Sn(e==null?void 0:e.nodeType),qd=e=>re(e)&&!mn(e)&&!un(e)&&!Qo(e),yb=(e,t,n)=>{const{selection:o,dom:r}=e,s=o.getNode(),a=Ge(s);vb(o,!0,()=>{t()}),a&&Ge(s)&&r.isChildOf(s,e.getBody())?e.selection.select(s):n(o.getStart())&&SN(r,o)},SN=(e,t)=>{var n,o;const r=t.getRng(),{startContainer:s,startOffset:a}=r;if(!((i,l)=>{if(qd(l)&&!/^(TD|TH)$/.test(l.nodeName)){const c=i.getAttrib(l,"data-mce-selected"),d=parseInt(c,10);return!isNaN(d)&&d>0}return!1})(e,t.getNode())&&re(s)){const i=s.childNodes,l=e.getRoot();let c;if(a<i.length){const d=i[a];c=new yt(d,(n=e.getParent(d,e.isBlock))!==null&&n!==void 0?n:l)}else{const d=i[i.length-1];c=new yt(d,(o=e.getParent(d,e.isBlock))!==null&&o!==void 0?o:l),c.next(!0)}for(let d=c.current();d;d=c.next()){if(e.getContentEditable(d)==="false")return;if(j(d)&&!Kd(d))return r.setStart(d,0),void t.setRng(r)}}},Cb=(e,t,n)=>{if(e){const o=t?"nextSibling":"previousSibling";for(e=n?e:e[o];e;e=e[o])if(re(e)||!Kd(e))return e}},Wd=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||er(e,t),os=(e,t,n)=>e.schema.isValidChild(t,n),Kd=(e,t=!1)=>{if(q(e)&&j(e)){const n=t?e.data.replace(/ /g," "):e.data;return $r(n)}return!1},wb=(e,t)=>{const n=e.dom;return qd(t)&&n.getContentEditable(t)==="false"&&((o,r)=>{const s="[data-mce-cef-wrappable]",a=CS(o),i=Ms(a)?s:`${s},${a}`;return Nn(R(r),i)})(e,t)&&n.select('[contenteditable="true"]',t).length===0},Do=(e,t)=>Ie(e)?e(t):(q(t)&&(e=e.replace(/%(\w+)/g,(n,o)=>t[o]||n)),e),Yd=(e,t)=>(t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),Gd=(e,t)=>{if(at(e))return null;{let n=String(e);return t!=="color"&&t!=="backgroundColor"||(n=Gs(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Yi=(e,t,n)=>{const o=e.getStyle(t,n);return Gd(o,n)},Eb=(e,t)=>{let n;return e.getParent(t,o=>!!re(o)&&(n=e.getStyle(o,"text-decoration"),!!n&&n!=="none")),n},Gi=(e,t,n)=>e.getParents(t,n,e.getRoot()),Xd=(e,t,n)=>{const o=e.formatter.get(t);return q(o)&&it(o,n)},Xn=e=>Br(e,"block"),fn=e=>Br(e,"selector"),bt=e=>Br(e,"inline"),Zd=e=>fn(e)&&e.expand!==!1&&!bt(e),kb=e=>(t=>{const n=[];let o=t;for(;o;){if(j(o)&&o.data!==Et||o.childNodes.length>1)return[];re(o)&&n.push(o),o=o.firstChild}return n})(e).length>0,Qd=e=>un(e.dom)&&kb(e.dom),rs=mn,xb=Gi,_b=Kd,NN=Wd,Sb=(e,t)=>{let n=t;for(;n;){if(re(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},Nb=(e,t,n,o)=>{const r=t.data;if(e){for(let s=n;s>0;s--)if(o(r.charAt(s-1)))return s}else for(let s=n;s<r.length;s++)if(o(r.charAt(s)))return s;return-1},RN=(e,t,n)=>Nb(e,t,n,o=>Wi(o)||ts(o)),AN=(e,t,n)=>Nb(e,t,n,Ud),Rb=(e,t,n,o,r,s)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(c,d,u)=>{const m=sr(e),p=r?m.backwards:m.forwards;return C.from(p(c,d,(g,h)=>rs(g.parentNode)?-1:(a=g,u(r,g,h)),i))};return l(n,o,RN).bind(c=>s?l(c.container,c.offset+(r?-1:0),AN):C.some(c)).orThunk(()=>a?C.some({container:a,offset:r?0:a.length}):C.none())},Ab=(e,t,n,o,r)=>{const s=o[r];j(o)&&Ms(o.data)&&s&&(o=s);const a=xb(e,o);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){const c=t[l];if((!q(c.collapsed)||c.collapsed===n.collapsed)&&fn(c)&&e.is(a[i],c.selector))return a[i]}return o},Tb=(e,t,n,o)=>{var r;let s=n;const a=e.getRoot(),i=t[0];if(Xn(i)&&(s=i.wrapper?null:e.getParent(n,i.block,a)),!s){const l=(r=e.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&r!==void 0?r:a;s=e.getParent(j(n)?n.parentNode:n,c=>c!==a&&NN(e.schema,c),l)}if(s&&Xn(i)&&i.wrapper&&(s=xb(e,s,"ul,ol").reverse()[0]||s),!s)for(s=n;s&&s[o]&&!e.isBlock(s[o])&&(s=s[o],!Yd(s,"br")););return s||n},Ob=(e,t,n,o)=>{const r=n.parentNode;return!q(n[o])&&(!(r!==t&&!at(r)&&!e.isBlock(r))||Ob(e,t,r,o))},Xi=(e,t,n,o,r)=>{let s=n;const a=r?"previousSibling":"nextSibling",i=e.getRoot();if(j(n)&&!_b(n)&&(r?o>0:o<n.data.length))return n;for(;s;){if(!t[0].block_expand&&e.isBlock(s))return s;for(let c=s[a];c;c=c[a]){const d=j(c)&&!Ob(e,i,c,a);if(!rs(c)&&(!rt(l=c)||!l.getAttribute("data-mce-bogus")||l.nextSibling)&&!_b(c,d))return s}if(s===i||s.parentNode===i){n=s;break}s=s.parentNode}var l;return n},Bb=e=>rs(e.parentNode)||rs(e),mr=(e,t,n,o=!1)=>{let{startContainer:r,startOffset:s,endContainer:a,endOffset:i}=t;const l=n[0];return re(r)&&r.hasChildNodes()&&(r=Oo(r,s),j(r)&&(s=0)),re(a)&&a.hasChildNodes()&&(a=Oo(a,t.collapsed?i:i-1),j(a)&&(i=a.data.length)),r=Sb(e,r),a=Sb(e,a),Bb(r)&&(r=rs(r)?r:r.parentNode,r=t.collapsed?r.previousSibling||r:r.nextSibling||r,j(r)&&(s=t.collapsed?r.length:0)),Bb(a)&&(a=rs(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,j(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(Rb(e,e.getRoot(),r,s,!0,o).each(({container:c,offset:d})=>{r=c,s=d}),Rb(e,e.getRoot(),a,i,!1,o).each(({container:c,offset:d})=>{a=c,i=d})),(bt(l)||l.block_expand)&&(bt(l)&&j(r)&&s!==0||(r=Xi(e,n,r,s,!0)),bt(l)&&j(a)&&i!==a.data.length||(a=Xi(e,n,a,i,!1))),Zd(l)&&(r=Ab(e,n,t,r,"previousSibling"),a=Ab(e,n,t,a,"nextSibling")),(Xn(l)||fn(l))&&(r=Tb(e,n,r,"previousSibling"),a=Tb(e,n,a,"nextSibling"),Xn(l)&&(e.isBlock(r)||(r=Xi(e,n,r,s,!0),j(r)&&(s=0)),e.isBlock(a)||(a=Xi(e,n,a,i,!1),j(a)&&(i=a.data.length)))),re(r)&&r.parentNode&&(s=e.nodeIndex(r),r=r.parentNode),re(a)&&a.parentNode&&(i=e.nodeIndex(a)+1,a=a.parentNode),{startContainer:r,startOffset:s,endContainer:a,endOffset:i}},wa=(e,t,n)=>{var o;const r=t.startOffset,s=Oo(t.startContainer,r),a=t.endOffset,i=Oo(t.endContainer,a-1),l=f=>{const b=f[0];j(b)&&b===s&&r>=b.data.length&&f.splice(0,1);const v=f[f.length-1];return a===0&&f.length>0&&v===i&&j(v)&&f.splice(f.length-1,1),f},c=(f,b,v)=>{const y=[];for(;f&&f!==v;f=f[b])y.push(f);return y},d=(f,b)=>e.getParent(f,v=>v.parentNode===b,b),u=(f,b,v)=>{const y=v?"nextSibling":"previousSibling";for(let w=f,E=w.parentNode;w&&w!==b;w=E){E=w.parentNode;const k=c(w===f?w:w[y],y);k.length&&(v||k.reverse(),n(l(k)))}};if(s===i)return n(l([s]));const m=(o=e.findCommonAncestor(s,i))!==null&&o!==void 0?o:e.getRoot();if(e.isChildOf(s,i))return u(s,m,!0);if(e.isChildOf(i,s))return u(i,m);const p=d(s,m)||s,g=d(i,m)||i;u(s,p,!0);const h=c(p===s?p:p.nextSibling,"nextSibling",g===i?g.nextSibling:g);h.length&&n(l(h)),u(i,g)},TN=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],Pb=(e,t,n,o,r,s)=>{const{uid:a=t,...i}=n;Mr(e,Js()),_t(e,`${qr()}`,a),_t(e,`${or()}`,o);const{attributes:l={},classes:c=[]}=r(a,i);if(so(e,l),((d,u)=>{U(u,m=>{Mr(d,m)})})(e,c),s){c.length>0&&_t(e,`${ta()}`,c.join(","));const d=Gt(l);d.length>0&&_t(e,`${na()}`,d.join(","))}},Db=(e,t,n,o,r)=>{const s=vt("span",e);return Pb(s,t,n,o,r,!1),s},ON=(e,t,n,o,r,s)=>{const a=[],i=Db(e.getDoc(),n,s,o,r),l=Ro(),c=()=>{l.clear()},d=m=>{U(m,u)},u=m=>{switch(((p,g,h,f)=>Rn(g).fold(()=>"skipping",b=>f==="br"||(v=>ln(v)&&Ai(v)===Et)(g)?"valid":(v=>tn(v)&&Rc(v,Js()))(g)?"existing":un(g.dom)?"caret":it(TN,v=>Nn(g,v))?"valid-block":os(p,h,f)&&os(p,Oe(b),h)?"valid":"invalid-child"))(e,m,"span",Oe(m))){case"invalid-child":{c();const p=Ot(m);d(p),c();break}case"valid-block":c(),Pb(m,n,s,o,r,!0);break;case"valid":{const p=l.get().getOrThunk(()=>{const g=rr(i);return a.push(g),l.set(g),g});$g(m,p);break}}};return wa(e.dom,t,m=>{c(),(p=>{const g=Te(p,R);d(g)})(m)}),a},Lb=e=>{const t=(()=>{const s={};return{register:(a,i)=>{s[a]={name:a,settings:i}},lookup:a=>Xe(s,a).map(i=>i.settings),getNames:()=>Gt(s)}})();((s,a)=>{const i=or(),l=d=>C.from(d.attr(i)).bind(a.lookup),c=d=>{var u,m;d.attr(qr(),null),d.attr(or(),null),d.attr(ea(),null);const p=C.from(d.attr(na())).map(b=>b.split(",")).getOr([]),g=C.from(d.attr(ta())).map(b=>b.split(",")).getOr([]);U(p,b=>d.attr(b,null));const h=(m=(u=d.attr("class"))===null||u===void 0?void 0:u.split(" "))!==null&&m!==void 0?m:[],f=si(h,[Js()].concat(g));d.attr("class",f.length>0?f.join(" "):null),d.attr(ta(),null),d.attr(na(),null)};s.serializer.addTempAttr(ea()),s.serializer.addAttributeFilter(i,d=>{for(const u of d)l(u).each(m=>{m.persistent===!1&&(u.name==="span"?u.unwrap():c(u))})})})(e,t);const n=((s,a)=>{const i=wt({}),l=()=>({listeners:[],previous:Ro()}),c=(p,g)=>{d(p,h=>(g(h),h))},d=(p,g)=>{const h=i.get(),f=g(Xe(h,p).getOrThunk(l));h[p]=f,i.set(h)},u=(p,g)=>{U(Ip(s,p),h=>{g?_t(h,ea(),"true"):St(h,ea())})},m=dd(()=>{const p=Vo(a.getNames());U(p,g=>{d(g,h=>{const f=h.previous.get();return Lp(s,C.some(g)).fold(()=>{f.each(b=>{(v=>{c(v,y=>{U(y.listeners,w=>w(!1,v))})})(g),h.previous.clear(),u(b,!1)})},({uid:b,name:v,elements:y})=>{Dr(f,b)||(f.each(w=>u(w,!1)),((w,E,k)=>{c(w,S=>{U(S.listeners,_=>_(!0,w,{uid:E,nodes:Te(k,T=>T.dom)}))})})(v,b,y),h.previous.set(b),u(b,!0))}),{previous:h.previous,listeners:h.listeners}})})},30);return s.on("remove",()=>{m.cancel()}),s.on("NodeChange",()=>{m.throttle()}),{addListener:(p,g)=>{d(p,h=>({previous:h.previous,listeners:h.listeners.concat([g])}))}}})(e,t),o=mi("span"),r=s=>{U(s,a=>{o(a)?xo(a):(i=>{Us(i,Js()),St(i,`${qr()}`),St(i,`${or()}`),St(i,`${ea()}`);const l=ao(i,`${na()}`).map(u=>u.split(",")).getOr([]),c=ao(i,`${ta()}`).map(u=>u.split(",")).getOr([]);var d;U(l,u=>St(i,u)),d=i,U(c,u=>{Us(d,u)}),St(i,`${ta()}`),St(i,`${na()}`)})(a)})};return{register:(s,a)=>{t.register(s,a)},annotate:(s,a)=>{t.lookup(s).each(i=>{((l,c,d,u)=>{l.undoManager.transact(()=>{const m=l.selection,p=m.getRng(),g=ns(l).length>0,h=oa("mce-annotation");if(p.collapsed&&!g&&((f,b)=>{const v=mr(f.dom,b,[{inline:"span"}]);b.setStart(v.startContainer,v.startOffset),b.setEnd(v.endContainer,v.endOffset),f.selection.setRng(b)})(l,p),m.getRng().collapsed&&!g){const f=Db(l.getDoc(),h,u,c,d.decorate);vi(f,Ct),m.getRng().insertNode(f.dom),m.select(f.dom)}else vb(m,!1,()=>{Vd(l,f=>{ON(l,f,h,c,d.decorate,u)})})})})(e,s,i,a)})},annotationChanged:(s,a)=>{n.addListener(s,a)},remove:s=>{Lp(e,C.some(s)).each(({elements:a})=>{const i=e.selection.getBookmark();r(a),e.selection.moveToBookmark(i)})},removeAll:s=>{const a=e.selection.getBookmark();Ke(Fp(e,s),(i,l)=>{r(i)}),e.selection.moveToBookmark(a)},getAll:s=>{const a=Fp(e,s);return Bs(a,i=>Te(i,l=>l.dom))}}},Ea=e=>({getBookmark:ne(xN,e),moveToBookmark:ne(_N,e)});Ea.isBookmarkNode=mn;const Mb=(e,t,n)=>!n.collapsed&&it(n.getClientRects(),o=>((r,s,a)=>s>=r.left&&s<=r.right&&a>=r.top&&a<=r.bottom)(o,e,t)),Ib=(e,t,n)=>{e.dispatch(t,n)},Fb=(e,t,n,o)=>{e.dispatch("FormatApply",{format:t,node:n,vars:o})},Ub=(e,t,n,o)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:o})},zb=(e,t)=>e.dispatch("SetContent",t),jb=(e,t)=>e.dispatch("GetContent",t),Jd=(e,t)=>{e.dispatch("AutocompleterUpdateActiveRange",t)},Hb=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),ee={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||ee.metaKeyPressed(e),metaKeyPressed:e=>Be.os.isMacOS()||Be.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},fr="data-mce-selected",$b=Math.abs,Zi=Math.round,eu={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},Vb=(e,t)=>{const n=t.dom,o=t.getDoc(),r=document,s=t.getBody();let a,i,l,c,d,u,m,p,g,h,f,b,v,y,w;const E=G=>q(G)&&(np(G)||n.is(G,"figure.image")),k=G=>qn(G)||n.hasClass(G,"mce-preview-object"),S=G=>{const se=G.target;((A,O)=>{if((L=>L.type==="longpress"||L.type.indexOf("touch")===0)(A)){const L=A.touches[0];return E(A.target)&&!Mb(L.clientX,L.clientY,O)}return E(A.target)&&!Mb(A.clientX,A.clientY,O)})(G,t.selection.getRng())&&!G.isDefaultPrevented()&&t.selection.select(se)},_=G=>n.hasClass(G,"mce-preview-object")&&q(G.firstElementChild)?[G,G.firstElementChild]:n.is(G,"figure.image")?[G.querySelector("img")]:[G],T=G=>{const se=Ph(t);return!!se&&G.getAttribute("data-mce-resize")!=="false"&&G!==t.getBody()&&(n.hasClass(G,"mce-preview-object")&&q(G.firstElementChild)?Nn(R(G.firstElementChild),se):Nn(R(G),se))},P=(G,se,A)=>{if(q(A)){const O=_(G);U(O,L=>{L.style[se]||!t.schema.isValid(L.nodeName.toLowerCase(),se)?n.setStyle(L,se,A):n.setAttrib(L,se,""+A)})}},x=(G,se,A)=>{P(G,"width",se),P(G,"height",A)},N=G=>{let se,A,O,L,F;se=G.screenX-u,A=G.screenY-m,b=se*c[2]+p,v=A*c[3]+g,b=b<5?5:b,v=v<5?5:v,O=(E(a)||k(a))&&mS(t)!==!1?!ee.modifierPressed(G):ee.modifierPressed(G),O&&($b(se)>$b(A)?(v=Zi(b*h),b=Zi(v/h)):(b=Zi(v/h),v=Zi(b*h))),x(i,b,v),L=c.startPos.x+se,F=c.startPos.y+A,L=L>0?L:0,F=F>0?F:0,n.setStyles(l,{left:L,top:F,display:"block"}),l.innerHTML=b+" &times; "+v,c[2]<0&&i.clientWidth<=b&&n.setStyle(i,"left",void 0+(p-b)),c[3]<0&&i.clientHeight<=v&&n.setStyle(i,"top",void 0+(g-v)),se=s.scrollWidth-y,A=s.scrollHeight-w,se+A!==0&&n.setStyles(l,{left:L-se,top:F-A}),f||(((X,W,fe,Ce,xe)=>{X.dispatch("ObjectResizeStart",{target:W,width:fe,height:Ce,origin:xe})})(t,a,p,g,"corner-"+c.name),f=!0)},B=()=>{const G=f;f=!1,G&&(P(a,"width",b),P(a,"height",v)),n.unbind(o,"mousemove",N),n.unbind(o,"mouseup",B),r!==o&&(n.unbind(r,"mousemove",N),n.unbind(r,"mouseup",B)),n.remove(i),n.remove(l),n.remove(d),I(a),G&&(((se,A,O,L,F)=>{se.dispatch("ObjectResized",{target:A,width:O,height:L,origin:F})})(t,a,b,v,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},I=G=>{de();const se=n.getPos(G,s),A=se.x,O=se.y,L=G.getBoundingClientRect(),F=L.width||L.right-L.left,X=L.height||L.bottom-L.top;a!==G&&(z(),a=G,b=v=0);const W=t.dispatch("ObjectSelected",{target:G});T(G)&&!W.isDefaultPrevented()?Ke(eu,(fe,Ce)=>{let xe=n.get("mceResizeHandle"+Ce);xe&&n.remove(xe),xe=n.add(s,"div",{id:"mceResizeHandle"+Ce,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+Ce+"-resize; margin:0; padding:0"}),n.bind(xe,"mousedown",Me=>{Me.stopImmediatePropagation(),Me.preventDefault(),(et=>{const no=_(a)[0];u=et.screenX,m=et.screenY,p=no.clientWidth,g=no.clientHeight,h=g/p,c=fe,c.name=Ce,c.startPos={x:F*fe[0]+A,y:X*fe[1]+O},y=s.scrollWidth,w=s.scrollHeight,d=n.add(s,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(d,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=((Z,we)=>{if(k(we))return Z.create("img",{src:Be.transparentSrc});if(Vn(we)){const Re=ht(c.name,"n")?Ht:Eo,Ee=we.cloneNode(!0);return Re(Z.select("tr",Ee)).each(Pe=>{const qe=Z.select("td,th",Pe);Z.setStyle(Pe,"height",null),U(qe,Y=>Z.setStyle(Y,"height",null))}),Ee}return we.cloneNode(!0)})(n,a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:A,top:O,margin:0}),x(i,F,X),i.removeAttribute(fr),s.appendChild(i),n.bind(o,"mousemove",N),n.bind(o,"mouseup",B),r!==o&&(n.bind(r,"mousemove",N),n.bind(r,"mouseup",B)),l=n.add(s,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},p+" &times; "+g)})(Me)}),fe.elm=xe,n.setStyles(xe,{left:F*fe[0]+A-xe.offsetWidth/2,top:X*fe[1]+O-xe.offsetHeight/2})}):z(!1)},V=Ri(I,0),z=(G=!0)=>{V.cancel(),de(),a&&G&&a.removeAttribute(fr),Ke(eu,(se,A)=>{const O=n.get("mceResizeHandle"+A);O&&(n.unbind(O),n.remove(O))})},te=(G,se)=>n.isChildOf(G,se),ae=G=>{if(f||t.removed||t.composing)return;const se=G.type==="mousedown"?G.target:e.getNode(),A=zr(R(se),"table,img,figure.image,hr,video,span.mce-preview-object,details").map(L=>L.dom).filter(L=>n.isEditable(L.parentElement)||L.nodeName==="IMG"&&n.isEditable(L)).getOrUndefined(),O=q(A)?n.getAttrib(A,fr,"1"):"1";if(U(n.select(`img[${fr}],hr[${fr}]`),L=>{L.removeAttribute(fr)}),q(A)&&te(A,s)&&t.hasFocus()){le();const L=e.getStart(!0);if(te(L,A)&&te(e.getEnd(!0),A))return n.setAttrib(A,fr,O),void V.throttle(A)}z()},de=()=>{Ke(eu,G=>{G.elm&&(n.unbind(G.elm),delete G.elm)})},le=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{le(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",ae),t.on("keyup compositionend",G=>{a&&a.nodeName==="TABLE"&&ae(G)}),t.on("hide blur",z),t.on("contextmenu longpress",S,!0)}),t.on("remove",de),{isResizable:T,showResizeRect:I,hideResizeRect:z,updateResizeRect:ae,destroy:()=>{V.cancel(),a=i=d=null}}},qb=(e,t,n)=>{const o=e.document.createRange();var r;return r=o,t.fold(s=>{r.setStartBefore(s.dom)},(s,a)=>{r.setStart(s.dom,a)},s=>{r.setStartAfter(s.dom)}),((s,a)=>{a.fold(i=>{s.setEndBefore(i.dom)},(i,l)=>{s.setEnd(i.dom,l)},i=>{s.setEndAfter(i.dom)})})(o,n),o},tu=(e,t,n,o,r)=>{const s=e.document.createRange();return s.setStart(t.dom,n),s.setEnd(o.dom,r),s},ka=Wn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Wb=(e,t,n)=>t(R(n.startContainer),n.startOffset,R(n.endContainer),n.endOffset);ka.ltr,ka.rtl;const Kb=(e,t,n,o)=>({start:e,soffset:t,finish:n,foffset:o}),BN=document.caretPositionFromPoint?(e,t,n)=>{var o,r;return C.from((r=(o=e.dom).caretPositionFromPoint)===null||r===void 0?void 0:r.call(o,t,n)).bind(s=>{if(s.offsetNode===null)return C.none();const a=e.dom.createRange();return a.setStart(s.offsetNode,s.offset),a.collapse(),C.some(a)})}:document.caretRangeFromPoint?(e,t,n)=>{var o,r;return C.from((r=(o=e.dom).caretRangeFromPoint)===null||r===void 0?void 0:r.call(o,t,n))}:C.none,nu=Wn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),po={before:nu.before,on:nu.on,after:nu.after,cata:(e,t,n,o)=>e.fold(t,n,o),getStart:e=>e.fold(jt,jt,jt)},Qi=Wn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ss={domRange:Qi.domRange,relative:Qi.relative,exact:Qi.exact,exactFromRange:e=>Qi.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const t=(n=>n.match({domRange:o=>R(o.startContainer),relative:(o,r)=>po.getStart(o),exact:(o,r,s,a)=>o}))(e);return js(t)},range:Kb},Ji=(e,t)=>{const n=Oe(e);return n==="input"?po.after(e):Ue(["br","img"],n)?t===0?po.before(e):po.after(e):po.on(e,t)},PN=(e,t)=>{const n=e.fold(po.before,Ji,po.after),o=t.fold(po.before,Ji,po.after);return ss.relative(n,o)},Yb=(e,t,n,o)=>{const r=Ji(e,t),s=Ji(n,o);return ss.relative(r,s)},ou=(e,t)=>{const n=(t||document).createDocumentFragment();return U(e,o=>{n.appendChild(o.dom)}),R(n)},DN=e=>{const t=ss.getWin(e).dom,n=(r,s,a,i)=>tu(t,r,s,a,i),o=(r=>r.match({domRange:s=>{const a=R(s.startContainer),i=R(s.endContainer);return Yb(a,s.startOffset,i,s.endOffset)},relative:PN,exact:Yb}))(e);return((r,s)=>{const a=((i,l)=>l.match({domRange:c=>({ltr:oe(c),rtl:C.none}),relative:(c,d)=>({ltr:Fn(()=>qb(i,c,d)),rtl:Fn(()=>C.some(qb(i,d,c)))}),exact:(c,d,u,m)=>({ltr:Fn(()=>tu(i,c,d,u,m)),rtl:Fn(()=>C.some(tu(i,u,m,c,d)))})}))(r,s);return((i,l)=>{const c=l.ltr();return c.collapsed?l.rtl().filter(d=>d.collapsed===!1).map(d=>ka.rtl(R(d.endContainer),d.endOffset,R(d.startContainer),d.startOffset)).getOrThunk(()=>Wb(0,ka.ltr,c)):Wb(0,ka.ltr,c)})(0,a)})(t,o).match({ltr:n,rtl:n})},Gb=(e,t,n)=>((o,r,s)=>((a,i,l)=>{const c=R(a.document);return BN(c,i,l).map(d=>Kb(R(d.startContainer),d.startOffset,R(d.endContainer),d.endOffset))})(o,r,s))(js(R(n)).dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined(),ru=(e,t)=>q(e)&&q(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,Xb=(e,t,n)=>((o,r,s)=>{let a=o;for(;a&&a!==r;){if(s(a))return a;a=a.parentNode}return null})(e,t,n)!==null,LN=(e,t,n)=>Xb(e,t,o=>o.nodeName===n),MN=(e,t)=>cn(e)&&!Xb(e,t,un),Zb=(e,t,n)=>{const o=t.parentNode;if(o){const r=new yt(t,e.getParent(o,e.isBlock)||e.getRoot());let s;for(;s=r[n?"prev":"next"]();)if(rt(s))return!0}return!1},su=(e,t,n,o,r)=>{const s=e.getRoot(),a=e.schema.getNonEmptyElements(),i=r.parentNode;let l,c;if(!i)return C.none();const d=e.getParent(i,e.isBlock)||s;if(o&&rt(r)&&t&&e.isEmpty(d))return C.some(M(i,e.nodeIndex(r)));const u=new yt(r,d);for(;c=u[o?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||MN(c,s))return C.none();if(j(c)&&c.data.length>0)return LN(c,s,"A")?C.none():C.some(M(c,o?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return C.none();l=c}return _o(l)?C.none():n&&l?C.some(M(l,0)):C.none()},Qb=(e,t,n,o)=>{const r=e.getRoot();let s,a=!1,i=n?o.startContainer:o.endContainer,l=n?o.startOffset:o.endOffset;const c=re(i)&&l===i.childNodes.length,d=e.schema.getNonEmptyElements();let u=n;if(cn(i))return C.none();if(re(i)&&l>i.childNodes.length-1&&(u=!1),Ks(i)&&(i=r,l=0),i===r){if(u&&(s=i.childNodes[l>0?l-1:0],s)&&(cn(s)||d[s.nodeName]||Vn(s)))return C.none();if(i.hasChildNodes()){if(l=Math.min(!u&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=j(i)&&c?i.data.length:0,!t&&i===r.lastChild&&Vn(i)||((m,p)=>{let g=p;for(;g&&g!==m;){if(Ge(g))return!0;g=g.parentNode}return!1})(r,i)||cn(i)||Hc(i))return C.none();if(i.hasChildNodes()&&!Vn(i)){s=i;const m=new yt(i,r);do{if(Ge(s)||cn(s)){a=!1;break}if(j(s)&&s.data.length>0){l=u?0:s.data.length,i=s,a=!0;break}if(d[s.nodeName.toLowerCase()]&&!Jx(s)){l=e.nodeIndex(s),i=s.parentNode,u||l++,a=!0;break}}while(s=u?m.next():m.prev())}}}return t&&(j(i)&&l===0&&su(e,c,t,!0,i).each(m=>{i=m.container(),l=m.offset(),a=!0}),re(i)&&(s=i.childNodes[l],s||(s=i.childNodes[l-1]),!s||!rt(s)||((m,p)=>{var g;return((g=m.previousSibling)===null||g===void 0?void 0:g.nodeName)==="A"})(s)||Zb(e,s,!1)||Zb(e,s,!0)||su(e,c,t,!0,s).each(m=>{i=m.container(),l=m.offset(),a=!0}))),u&&!t&&j(i)&&l===i.data.length&&su(e,c,t,!1,i).each(m=>{i=m.container(),l=m.offset(),a=!0}),a&&i?C.some(M(i,l)):C.none()},el=(e,t)=>{const n=t.collapsed,o=t.cloneRange(),r=M.fromRangeStart(t);return Qb(e,n,!0,o).each(s=>{n&&M.isAbove(r,s)||o.setStart(s.container(),s.offset())}),n||Qb(e,n,!1,o).each(s=>{o.setEnd(s.container(),s.offset())}),n&&o.collapse(!0),ru(t,o)?C.none():C.some(o)},tl=(e,t)=>e.splitText(t),nl=e=>{let t=e.startContainer,n=e.startOffset,o=e.endContainer,r=e.endOffset;if(t===o&&j(t)){if(n>0&&n<t.data.length)if(o=tl(t,n),t=o.previousSibling,r>n){r-=n;const s=tl(o,r).previousSibling;t=o=s,r=s.data.length,n=0}else r=0}else if(j(t)&&n>0&&n<t.data.length&&(t=tl(t,n),n=0),j(o)&&r>0&&r<o.data.length){const s=tl(o,r).previousSibling;o=s,r=s.data.length}return{startContainer:t,startOffset:n,endContainer:o,endOffset:r}},gr=e=>({walk:(t,n)=>wa(e,t,n),split:nl,expand:(t,n={type:"word"})=>{if(n.type==="word"){const o=mr(e,t,[{inline:"span"}]),r=e.createRng();return r.setStart(o.startContainer,o.startOffset),r.setEnd(o.endContainer,o.endOffset),r}return t},normalize:t=>el(e,t).fold(Qe,n=>(t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),!0))});gr.compareRanges=ru,gr.getCaretRangeFromPoint=Gb,gr.getSelectedNode=Di,gr.getNode=Oo;const IN=((e,t)=>{const n=r=>{const s=(a=>{const i=a.dom;return Ur(a)?i.getBoundingClientRect().height:i.offsetHeight})(r);if(s<=0||s===null){const a=$n(r,e);return parseFloat(a)||0}return s},o=(r,s)=>Yt(s,(a,i)=>{const l=$n(r,i),c=l===void 0?0:parseInt(l,10);return isNaN(c)?a:a+c},0);return{set:(r,s)=>{if(!Sn(s)&&!s.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+s);const a=r.dom;Vs(a)&&(a.style[e]=s+"px")},get:n,getOuter:n,aggregate:o,max:(r,s,a)=>{const i=o(r,a);return s>i?s-i:0}}})("height"),Jb=()=>R(document),ev=(e,t)=>e.view(t).fold(oe([]),n=>{const o=e.owner(n),r=ev(e,o);return[n].concat(r)});var FN=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?C.none():C.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(R)},owner:e=>lo(e)});const au=e=>Oe(e)==="textarea",tv=(e,t)=>{const n=(r=>{const s=r.dom.ownerDocument,a=s.body,i=s.defaultView,l=s.documentElement;if(a===r.dom)return Hr(a.offsetLeft,a.offsetTop);const c=yi(i==null?void 0:i.pageYOffset,l.scrollTop),d=yi(i==null?void 0:i.pageXOffset,l.scrollLeft),u=yi(l.clientTop,a.clientTop),m=yi(l.clientLeft,a.clientLeft);return Ic(r).translate(d-m,c-u)})(e),o=(r=>IN.get(r))(e);return{element:e,bottom:n.top+o,height:o,pos:n,cleanup:t}},nv=(e,t,n,o)=>{zN(e,(r,s)=>UN(e,t,n,o),n)},ov=(e,t,n,o,r)=>{const s={elm:o.element.dom,alignToTop:r};((a,i)=>a.dispatch("ScrollIntoView",i).isDefaultPrevented())(e,s)||(n(e,t,Fc(t).top,o,r),((a,i)=>{a.dispatch("AfterScrollIntoView",i)})(e,s))},UN=(e,t,n,o)=>{const r=R(e.getBody()),s=R(e.getDoc());r.dom.offsetWidth;const a=((i,l)=>{const c=((u,m)=>{const p=Ot(u);if(p.length===0||au(u))return{element:u,offset:m};if(m<p.length&&!au(p[m]))return{element:p[m],offset:0};{const g=p[p.length-1];return au(g)?{element:u,offset:m}:Oe(g)==="img"?{element:g,offset:1}:ln(g)?{element:g,offset:Ai(g).length}:{element:g,offset:Ot(g).length}}})(i,l),d=fi('<span data-mce-bogus="all" style="display: inline-block;">\uFEFF</span>');return Xt(c.element,d),tv(d,()=>Ze(d))})(R(n.startContainer),n.startOffset);ov(e,s,t,a,o),a.cleanup()},rv=(e,t,n,o)=>{const r=R(e.getDoc());ov(e,r,n,(s=>tv(R(s),Ne))(t),o)},zN=(e,t,n)=>{const o=n.startContainer,r=n.startOffset,s=n.endContainer,a=n.endOffset;t(R(o),R(s));const i=e.dom.createRng();i.setStart(o,r),i.setEnd(s,a),e.selection.setRng(n)},iu=(e,t,n,o,r)=>{const s=t.pos;if(o)Wg(s.left,s.top,r);else{const a=s.top-n+t.height;Wg(-e.getBody().getBoundingClientRect().left,a,r)}},sv=(e,t,n,o,r,s)=>{const a=o+n,i=r.pos.top,l=r.bottom,c=l-i>=o;i<n?iu(e,r,o,s!==!1,t):i>a?iu(e,r,o,c?s!==!1:s===!0,t):l>a&&!c&&iu(e,r,o,s===!0,t)},av=(e,t,n,o,r)=>{const s=js(t).dom.innerHeight;sv(e,t,n,s,o,r)},iv=(e,t,n,o,r)=>{const s=js(t).dom.innerHeight;sv(e,t,n,s,o,r);const a=(l=>{const c=Jb(),d=Fc(c),u=((g,h)=>{const f=h.owner(g);return ev(h,f)})(l,FN),m=Ic(l),p=Rs(u,(g,h)=>{const f=Ic(h);return{left:g.left+f.left,top:g.top+f.top}},{left:0,top:0});return Hr(p.left+m.left+d.left,p.top+m.top+d.top)})(o.element),i=Gg(window);a.top<i.y?Kg(o.element,r!==!1):a.top>i.bottom&&Kg(o.element,r===!0)},jN=(e,t,n)=>nv(e,av,t,n),HN=(e,t,n)=>rv(e,t,av,n),$N=(e,t,n)=>nv(e,iv,t,n),VN=(e,t,n)=>rv(e,t,iv,n),xa=(e,t,n)=>{(e.inline?jN:$N)(e,t,n)},lv=(e,t=!1)=>e.dom.focus({preventScroll:t}),cv=e=>{const t=ko(e).dom;return e.dom===t.activeElement},lu=(e=Jb())=>C.from(e.dom.activeElement).map(R),dv=(e,t)=>{const n=ln(t)?Ai(t).length:Ot(t).length+1;return e>n?n:e<0?0:e},qN=e=>ss.range(e.start,dv(e.soffset,e.start),e.finish,dv(e.foffset,e.finish)),uv=(e,t)=>!Ci(t.dom)&&(io(e,t)||De(e,t)),mv=e=>t=>uv(e,t.start)&&uv(e,t.finish),WN=e=>ss.range(R(e.startContainer),e.startOffset,R(e.endContainer),e.endOffset),KN=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),C.some(t)}catch{return C.none()}},ol=e=>{const t=(o=>o.inline||Be.browser.isFirefox())(e)?(n=R(e.getBody()),(o=>{const r=o.getSelection();return(r&&r.rangeCount!==0?C.from(r.getRangeAt(0)):C.none()).map(WN)})(js(n).dom).filter(mv(n))):C.none();var n;e.bookmark=t.isSome()?t:e.bookmark},cu=e=>(e.bookmark?e.bookmark:C.none()).bind(t=>{return n=R(e.getBody()),o=t,C.from(o).filter(mv(n)).map(qN);var n,o}).bind(KN),fv={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},gn={setEditorTimeout:(e,t,n)=>((o,r)=>(Sn(r)||(r=0),setTimeout(o,r)))(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const o=((r,s)=>(Sn(s)||(s=0),setInterval(r,s)))(()=>{e.removed?clearInterval(o):t()},n);return o}};let as;const du=Ve.DOM,uu=e=>{const t=e.classList;return t!==void 0&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))},rl=(e,t)=>{const n=wS(e);return du.getParent(t,r=>(s=>re(s)&&fv.isEditorUIElement(s))(r)||!!n&&e.dom.is(r,n))!==null},mu=e=>{try{const t=ko(R(e.getElement()));return lu(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},YN=(e,t)=>{const n=t.editor;(r=>{const s=Ri(()=>{ol(r)},0);r.on("init",()=>{r.inline&&((a,i)=>{const l=()=>{i.throttle()};Ve.DOM.bind(document,"mouseup",l),a.on("remove",()=>{Ve.DOM.unbind(document,"mouseup",l)})})(r,s),((a,i)=>{((l,c)=>{l.on("mouseup touchend",d=>{c.throttle()})})(a,i),a.on("keyup NodeChange AfterSetSelectionRange",l=>{(c=>c.type==="nodechange"&&c.selectionChange)(l)||ol(a)})})(r,s)}),r.on("remove",()=>{s.cancel()})})(n);const o=(r,s)=>{nN(r)&&r.inline!==!0&&s(R(r.getContainer()),"tox-edit-focus")};n.on("focusin",()=>{const r=e.focusedEditor;uu(mu(n))&&o(n,Mr),r!==n&&(r&&r.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:r}),n.focus(!0))}),n.on("focusout",()=>{gn.setEditorTimeout(n,()=>{const r=e.focusedEditor;uu(mu(n))&&r===n||o(n,Us),rl(n,mu(n))||r!==n||(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),as||(as=r=>{const s=e.activeEditor;s&&Mg(r).each(a=>{const i=a;i.ownerDocument===document&&(i===document.body||rl(s,i)||e.focusedEditor!==s||(s.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null))})},du.bind(document,"focusin",as))},GN=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&as&&(du.unbind(document,"focusin",as),as=null)},gv=(e,t)=>{((n,o)=>(r=>r.collapsed?C.from(Oo(r.startContainer,r.startOffset)).map(R):C.none())(o).bind(r=>S_(r)?C.some(r):io(n,r)?C.none():C.some(n)))(R(e.getBody()),t).bind(n=>Lt(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},fu=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},pr=e=>e.inline?(t=>{const n=t.getBody();return n&&(o=R(n),cv(o)||(r=o,lu(ko(r)).filter(s=>r.dom.contains(s.dom))).isSome());var o,r})(e):(t=>q(t.iframeElement)&&cv(R(t.iframeElement)))(e),pv=e=>pr(e)||(t=>{const n=ko(R(t.getElement()));return lu(n).filter(o=>!uu(o.dom)&&rl(t,o.dom)).isSome()})(e),gu=e=>e.editorManager.setActive(e),hv=(e,t)=>t.collapsed?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer),bv=(e,t,n,o,r)=>{const s=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return C.from(s).map(R).map(i=>o&&t.collapsed?i:Fr(i,r(i,a)).getOr(i)).bind(i=>tn(i)?C.some(i):Rn(i).filter(tn)).map(i=>i.dom).getOr(e)},vv=(e,t,n=!1)=>bv(e,t,!0,n,(o,r)=>Math.min(Oc(o),r)),yv=(e,t,n=!1)=>bv(e,t,!1,n,(o,r)=>r>0?r-1:r),Cv=(e,t)=>{const n=e;for(;e&&j(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},pu=(e,t)=>Te(t,n=>{const o=e.dispatch("GetSelectionRange",{range:n});return o.range!==n?o.range:n}),XN={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},sl=(e,t,n)=>{const o=n?"lastChild":"firstChild",r=n?"prev":"next";if(e[o])return e[o];if(e!==t){let s=e[r];if(s)return s;for(let a=e.parent;a&&a!==t;a=a.parent)if(s=a[r],s)return s}},ZN=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!$r(n))return!1;const o=e.parent;return!o||o.name==="span"&&!o.attr("style")||!/^[ ]+$/.test(n)},wv=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class Ft{static create(t,n){const o=new Ft(t,XN[t]||1);return n&&Ke(n,(r,s)=>{o.attr(s,r)}),o}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const o=this;if(!Q(t))return q(t)&&Ke(t,(s,a)=>{o.attr(a,s)}),o;const r=o.attributes;if(r){if(n!==void 0){if(n===null){if(t in r.map){delete r.map[t];let s=r.length;for(;s--;)if(r[s].name===t)return r.splice(s,1),o}return o}if(t in r.map){let s=r.length;for(;s--;)if(r[s].name===t){r[s].value=n;break}}else r.push({name:t,value:n});return r.map[t]=n,o}return r.map[t]}}clone(){const t=this,n=new Ft(t.name,t.type),o=t.attributes;if(o){const r=[];r.map={};for(let s=0,a=o.length;s<a;s++){const i=o[s];i.name!=="id"&&(r[r.length]={name:i.name,value:i.value},r.map[i.name]=i.value)}n.attributes=r}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const o=n.next;t.insert(n,t,!0),n=o}t.remove()}remove(){const t=this,n=t.parent,o=t.next,r=t.prev;return n&&(n.firstChild===t?(n.firstChild=o,o&&(o.prev=null)):r&&(r.next=o),n.lastChild===t?(n.lastChild=r,r&&(r.next=null)):o&&(o.prev=r),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const o=n.lastChild;return o?(o.next=t,t.prev=o,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,o){t.parent&&t.remove();const r=n.parent||this;return o?(n===r.firstChild?r.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===r.lastChild?r.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=r,t}getAll(t){const n=this,o=[];for(let r=n.firstChild;r;r=sl(r,n))r.name===t&&o.push(r);return o}children(){const t=[];for(let n=this.firstChild;n;n=n.next)t.push(n);return t}empty(){const t=this;if(t.firstChild){const n=[];for(let r=t.firstChild;r;r=sl(r,t))n.push(r);let o=n.length;for(;o--;){const r=n[o];r.parent=r.firstChild=r.lastChild=r.next=r.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},o){var r;const s=this;let a=s.firstChild;if(wv(s))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||wv(a))return!1}if(a.type===8||a.type===3&&!ZN(a)||a.type===3&&a.parent&&n[a.parent.name]&&$r((r=a.value)!==null&&r!==void 0?r:"")||o&&o(a))return!1}while(a=sl(a,s));return!0}walk(t){return sl(this,null,t)}}const QN=$.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),Ev=e=>Q(e.nodeValue)&&e.nodeValue.includes(Et),kv=e=>(e.length===0?"":`${Te(e,t=>`[${t}]`).join(",")},`)+'[data-mce-bogus="all"]',xv=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,t=>Ev(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),_v=e=>document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t=>{if(Ev(t)){const n=t.parentNode;return n&&ke(QN,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_SKIP}),JN=e=>xv(e).nextNode()!==null,eR=e=>_v(e).nextNode()!==null,tR=(e,t)=>t.querySelector(kv(e))!==null,nR=(e,t)=>{U(((n,o)=>o.querySelectorAll(kv(n)))(e,t),n=>{const o=R(n);nn(o,"data-mce-bogus")==="all"?Ze(o):U(e,r=>{Is(o,r)&&St(o,r)})})},Sv=e=>{let t=e.nextNode();for(;t!==null;)t.nodeValue=null,t=e.nextNode()},oR=In(Sv,xv),rR=In(Sv,_v),Nv=(e,t)=>{const n=[{condition:ne(tR,t),action:ne(nR,t)},{condition:JN,action:oR},{condition:eR,action:rR}];let o=e,r=!1;return U(n,({condition:s,action:a})=>{s(o)&&(r||(o=e.cloneNode(!0),r=!0),a(o))}),o},Rv=e=>{const t=Bt(e,"[data-mce-bogus]");U(t,n=>{nn(n,"data-mce-bogus")==="all"?Ze(n):ar(n)?(Xt(n,Ir(qs)),Ze(n)):xo(n)})},Av=e=>{const t=Bt(e,"input");U(t,n=>{St(n,"name")})},sR=(e,t,n)=>{let o;return o=t.format==="raw"?$.trim(on(Nv(n,e.serializer.getTempAttrs()).innerHTML)):t.format==="text"?((r,s)=>{const a=r.getDoc(),i=ko(R(r.getBody())),l=vt("div",a);_t(l,"data-mce-bogus","all"),hi(l,{position:"fixed",left:"-9999999px",top:"0"}),vi(l,s.innerHTML),Rv(l),Av(l);const c=(u=>Bc(u)?u:R(lo(u).dom.body))(i);ut(c,l);const d=on(l.dom.innerText);return Ze(l),d})(e,n):t.format==="tree"?e.serializer.serialize(n,t):((r,s)=>{const a=Dt(r),i=new RegExp(`^(<${a}[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/${a}>[\r
]*|<br \\/>[\r
]*)$`);return s.replace(i,"")})(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Ti(R(n))&&Q(o)?$.trim(o):o},Tv=$.makeMap,Ov=e=>{const t=[],n=(e=e||{}).indent,o=Tv(e.indent_before||""),r=Tv(e.indent_after||""),s=So.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&o[i]&&t.length>0){const d=t[t.length-1];d.length>0&&d!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let d=0,u=l.length;d<u;d++){const m=l[d];t.push(" ",m.name,'="',s(m.value,!0),'"')}if(t[t.length]=!c||a?">":" />",c&&n&&r[i]&&t.length>0){const d=t[t.length-1];d.length>0&&d!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&r[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:s(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",s(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Lo=(e={},t=No())=>{const n=Ov(e);return e.validate=!("validate"in e)||e.validate,{serialize:o=>{const r=e.validate,s={3:i=>{var l;n.text((l=i.value)!==null&&l!==void 0?l:"",i.raw)},8:i=>{var l;n.comment((l=i.value)!==null&&l!==void 0?l:"")},7:i=>{n.pi(i.name,i.value)},10:i=>{var l;n.doctype((l=i.value)!==null&&l!==void 0?l:"")},4:i=>{var l;n.cdata((l=i.value)!==null&&l!==void 0?l:"")},11:i=>{let l=i;if(l=l.firstChild)do a(l);while(l=l.next)}};n.reset();const a=i=>{var l;const c=s[i.type];if(c)c(i);else{const d=i.name,u=d in t.getVoidElements();let m=i.attributes;if(r&&m&&m.length>1){const p=[];p.map={};const g=t.getElementRule(i.name);if(g){for(let h=0,f=g.attributesOrder.length;h<f;h++){const b=g.attributesOrder[h];if(b in m.map){const v=m.map[b];p.map[b]=v,p.push({name:b,value:v})}}for(let h=0,f=m.length;h<f;h++){const b=m[h].name;if(!(b in p.map)){const v=m.map[b];p.map[b]=v,p.push({name:b,value:v})}}m=p}}if(n.start(d,m,u),Jo(d))Q(i.value)&&n.text(i.value,!0),n.end(d);else if(!u){let p=i.firstChild;if(p){d!=="pre"&&d!=="textarea"||p.type!==3||((l=p.value)===null||l===void 0?void 0:l[0])!==`
`||n.text(`
`,!0);do a(p);while(p=p.next)}n.end(d)}}};return o.type!==1||e.inner?o.type===3?s[3](o):s[11](o):a(o),n.getContent()}}},Bv=new Set;U(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],e=>{Bv.add(e)});const Pv=["font","text-decoration","text-emphasis"],hu=(e,t)=>Gt(e.parseStyle(e.getAttrib(t,"style"))),aR=(e,t,n)=>{const o=hu(e,t),r=hu(e,n),s=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",d=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return Un(c)&&Un(d)&&c!==d};return it(o,a=>{const i=l=>it(l,c=>c===a);if(!i(r)&&i(Pv)){const l=ye(r,c=>it(Pv,d=>ht(c,d)));return it(l,s)}return s(a)})},Dv=(e,t,n)=>C.from(n.container()).filter(j).exists(o=>{const r=e?0:-1;return t(o.data.charAt(n.offset()+r))}),bu=ne(Dv,!0,ts),vu=ne(Dv,!1,ts),iR=e=>{const t=e.container();return j(t)&&(t.data.length===0||Oi(t.data)&&Ea.isBookmarkNode(t.parentNode))},Mo=(e,t)=>n=>Bd(e?0:-1,n).filter(t).isSome(),Lv=e=>np(e)&&$n(R(e),"display")==="block",Mv=e=>Ge(e)&&!(t=>re(t)&&t.getAttribute("data-mce-bogus")==="all")(e),lR=Mo(!0,Lv),cR=Mo(!1,Lv),_a=Mo(!0,qn),Sa=Mo(!1,qn),Iv=Mo(!0,Vn),Fv=Mo(!1,Vn),Io=Mo(!0,Mv),Fo=Mo(!1,Mv),Uv=(e,t)=>((n,o,r)=>io(o,n)?Bg(n,s=>r(s)||De(s,o)).slice(0,-1):[])(e,t,Qe),ho=(e,t)=>[e].concat(Uv(e,t)),yu=(e,t,n)=>lb(e,t,n,iR),zv=(e,t,n)=>pt(ho(R(t.container()),e),(o=>r=>o.isBlock(Oe(r)))(n)),jv=(e,t,n,o)=>yu(e,t.dom,n).forall(r=>zv(t,n,o).fold(()=>!Kn(r,n,t.dom),s=>!Kn(r,n,t.dom)&&io(s,R(r.container())))),Hv=(e,t,n,o)=>zv(t,n,o).fold(()=>yu(e,t.dom,n).forall(r=>!Kn(r,n,t.dom)),r=>yu(e,r.dom,n).isNone()),Cu=ne(Hv,!1),$v=ne(Hv,!0),dR=ne(jv,!1),uR=ne(jv,!0),mR=e=>Hi(e).exists(ar),al=(e,t,n,o)=>{const r=ye(ho(R(n.container()),t),a=>o.isBlock(Oe(a))),s=Ht(r).getOr(t);return dn(e,s.dom,n).filter(mR)},wu=(e,t,n)=>Hi(t).exists(ar)||al(!0,e,t,n).isSome(),Eu=(e,t,n)=>(o=>C.from(o.getNode(!0)).map(R))(t).exists(ar)||al(!1,e,t,n).isSome(),fR=ne(al,!1),gR=ne(al,!0),Vv=e=>M.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),qv=(e,t,n)=>{const o=ye(ho(R(t.container()),e),r=>n.isBlock(Oe(r)));return Ht(o).getOr(e)},Wv=(e,t,n)=>Vv(t)?vu(t):vu(t)||Zt(qv(e,t,n).dom,t).exists(vu),Kv=(e,t,n)=>Vv(t)?bu(t):bu(t)||Vt(qv(e,t,n).dom,t).exists(bu),ku=e=>Hi(e).bind(t=>Yo(t,tn)).exists(t=>(n=>Ue(["pre","pre-wrap"],n))($n(t,"white-space"))),Yv=(e,t)=>n=>{return o=new yt(n,e)[t](),q(o)&&Ge(o)&&Gh(o);var o},Gv=(e,t,n)=>!ku(t)&&(((o,r,s)=>((a,i)=>Zt(a.dom,i).isNone())(o,r)||((a,i)=>Vt(a.dom,i).isNone())(o,r)||Cu(o,r,s)||$v(o,r,s)||Eu(o,r,s)||wu(o,r,s))(e,t,n)||Wv(e,t,n)||Kv(e,t,n)),Na=(e,t,n)=>!ku(t)&&(Cu(e,t,n)||dR(e,t,n)||Eu(e,t,n)||Wv(e,t,n)||((o,r)=>{const s=Zt(o.dom,r).getOr(r),a=Yv(o.dom,"prev");return r.isAtStart()&&(a(r.container())||a(s.container()))})(e,t)),Ra=(e,t,n)=>!ku(t)&&($v(e,t,n)||uR(e,t,n)||wu(e,t,n)||Kv(e,t,n)||((o,r)=>{const s=Vt(o.dom,r).getOr(r),a=Yv(o.dom,"next");return r.isAtEnd()&&(a(r.container())||a(s.container()))})(e,t)),xu=(e,t,n)=>Na(e,t,n)||Ra(e,(o=>{const r=o.container(),s=o.offset();return j(r)&&s<r.data.length?M(r,s+1):o})(t),n),Xv=(e,t)=>Wi(e.charAt(t)),Zv=(e,t)=>ts(e.charAt(t)),Qv=(e,t,n,o)=>{const r=t.data,s=M(t,0);return n||!Xv(r,0)||xu(e,s,o)?!!(n&&Zv(r,0)&&Na(e,s,o))&&(t.data=Ct+r.slice(1),!0):(t.data=" "+r.slice(1),!0)},Jv=(e,t,n,o)=>{const r=t.data,s=M(t,r.length-1);return n||!Xv(r,r.length-1)||xu(e,s,o)?!!(n&&Zv(r,r.length-1)&&Ra(e,s,o))&&(t.data=r.slice(0,-1)+Ct,!0):(t.data=r.slice(0,-1)+" ",!0)},pR=(e,t,n)=>{const o=t.container();if(!j(o))return C.none();if((r=>{const s=r.container();return j(s)&&At(s.data,Ct)})(t)){const r=Qv(e,o,!1,n)||(s=>{const a=s.data,i=(l=>{const c=l.split("");return Te(c,(d,u)=>Wi(d)&&u>0&&u<c.length-1&&Ud(c[u-1])&&Ud(c[u+1])?" ":d).join("")})(a);return i!==a&&(s.data=i,!0)})(o)||Jv(e,o,!1,n);return Lr(r,t)}if(xu(e,t,n)){const r=Qv(e,o,!0,n)||Jv(e,o,!0,n);return Lr(r,t)}return C.none()},e0=(e,t,n,o)=>{if(n===0)return;const r=R(e),s=co(r,c=>o.isBlock(Oe(c))).getOr(r),a=e.data.slice(t,t+n),i=t+n>=e.data.length&&Ra(s,M(e,e.data.length),o),l=t===0&&Na(s,M(e,0),o);e.replaceData(t,n,ep(a,4,l,i))},il=(e,t,n)=>{const o=e.data.slice(t),r=o.length-fx(o).length;e0(e,t,r,n)},_u=(e,t,n)=>{const o=e.data.slice(0,t),r=o.length-gg(o).length;e0(e,t-r,r,n)},Su=(e,t,n,o,r=!0)=>{const s=gg(e.data).length,a=r?e:t,i=r?t:e;return r?a.appendData(i.data):a.insertData(0,i.data),Ze(R(i)),o&&il(a,s,n),a},hR=(e,t)=>((n,o)=>{const r=n.container(),s=n.offset();return!M.isTextPosition(n)&&r===o.parentNode&&s>M.before(o).offset()})(t,e)?M(t.container(),t.offset()-1):t,t0=e=>{return Bn(e.previousSibling)?C.some((t=e.previousSibling,j(t)?M(t,t.data.length):M.after(t))):e.previousSibling?wn(e.previousSibling):C.none();var t},n0=e=>{return Bn(e.nextSibling)?C.some((t=e.nextSibling,j(t)?M(t,0):M.before(t))):e.nextSibling?Lt(e.nextSibling):C.none();var t},bR=(e,t,n)=>((o,r,s)=>o?((a,i)=>n0(i).orThunk(()=>t0(i)).orThunk(()=>((l,c)=>Vt(l,M.after(c)).orThunk(()=>Zt(l,M.before(c))))(a,i)))(r,s):((a,i)=>t0(i).orThunk(()=>n0(i)).orThunk(()=>((l,c)=>C.from(c.previousSibling?c.previousSibling:c.parentNode).bind(d=>Zt(l,M.before(d))).orThunk(()=>Vt(l,M.after(c))))(a,i)))(r,s))(e,t,n).map(ne(hR,n)),o0=(e,t,n)=>{n.fold(()=>{e.focus()},o=>{e.selection.setRng(o.toRange(),t)})},vR=(e,t)=>t&&ke(e.schema.getBlockElements(),Oe(t)),hr=(e,t,n,o=!0,r=!1)=>{const s=bR(t,e.getBody(),n.dom),a=co(n,ne(vR,e),(i=e.getBody(),c=>c.dom===i));var i;const l=((c,d,u,m)=>{const p=Ko(c).filter(ln),g=Hs(c).filter(ln);return Ze(c),(h=p,f=g,b=d,v=(y,w,E)=>{const k=y.dom,S=w.dom,_=k.data.length;return Su(k,S,u,m),E.container()===S?M(k,_):E},h.isSome()&&f.isSome()&&b.isSome()?C.some(v(h.getOrDie(),f.getOrDie(),b.getOrDie())):C.none()).orThunk(()=>(m&&(p.each(y=>_u(y.dom,y.dom.length,u)),g.each(y=>il(y.dom,0,u))),d));var h,f,b,v})(n,s,e.schema,((c,d)=>ke(c.schema.getTextInlineElements(),Oe(d)))(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(c=>((d,u,m)=>{if(Pt(d,u)){const p=fi('<br data-mce-bogus="1">');return m?U(Ot(u),g=>{Qd(g)||Ze(g)}):jr(u),ut(u,p),C.some(M.before(p.dom))}return C.none()})(e.schema,c,r)).fold(()=>{o&&o0(e,t,l)},c=>{o&&o0(e,t,C.some(c))})},yR=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,br=(e,t)=>Nn(R(t),uS(e))&&!er(e.schema,t)&&e.dom.isEditable(t),r0=e=>{var t;return Ve.DOM.getStyle(e,"direction",!0)==="rtl"||(n=>yR.test(n))((t=e.textContent)!==null&&t!==void 0?t:"")},Uo=(e,t,n)=>{const o=((r,s,a)=>ye(Ve.DOM.getParents(a.container(),"*",s),r))(e,t,n);return C.from(o[o.length-1])},pn=(e,t)=>{const n=t.container(),o=t.offset();return e?To(n)?j(n.nextSibling)?M(n.nextSibling,0):M.after(n):fd(t)?M(n,o+1):t:To(n)?j(n.previousSibling)?M(n.previousSibling,n.previousSibling.data.length):M.before(n):gd(t)?M(n,o-1):t},s0=ne(pn,!0),a0=ne(pn,!1),i0=(e,t)=>{const n=o=>o.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},Nu=e=>i0(e,"Delete"),CR=e=>$p(e)||ra(e),ll=(e,t)=>io(e,t)?Yo(t,CR,(n=>o=>Dr(Rn(o),n,De))(e)):C.none(),Ru=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},l0=(e,t,n)=>Tt(Lt(n),wn(n),(o,r)=>{const s=pn(!0,o),a=pn(!1,r),i=pn(!1,t);return e?Vt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(s)):Zt(n,i).exists(l=>l.isEqual(s)&&t.isEqual(a))}).getOr(!0),c0=e=>{var t;return(Eg(t=e)===8||Oe(t)==="#comment"?Ko(e):Tc(e)).bind(c0).orThunk(()=>C.some(e))},d0=(e,t,n,o=!0)=>{var r;t.deleteContents();const s=c0(n).getOr(n),a=R((r=e.dom.getParent(s.dom,e.dom.isBlock))!==null&&r!==void 0?r:n.dom);if(a.dom===e.getBody()?Ru(e,o):Pt(e.schema,a,{checkRootAsContent:!1})&&(Ao(a),o&&e.selection.setCursorLocation(a.dom,0)),!De(n,a)){const l=Dr(Rn(a),n)?[]:Rn(i=a).map(Ot).map(c=>ye(c,d=>!De(i,d))).getOr([]);U(l.concat(Ot(n)),c=>{De(c,a)||io(c,a)||!Pt(e.schema,c)||Ze(c)})}var i},Au=e=>Bt(e,"td,th"),u0=(e,t)=>ya(R(e),t),Tu=(e,t)=>({start:e,end:t}),Aa=Wn([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),cl=(e,t)=>zr(R(e),"td,th",t),m0=e=>!De(e.start,e.end),f0=(e,t)=>ya(e.start,t).bind(n=>ya(e.end,t).bind(o=>Lr(De(n,o),n))),Ou=e=>t=>f0(t,e).map(n=>((o,r,s)=>({rng:o,table:r,cells:s}))(t,n,Au(n))),g0=(e,t,n,o)=>{if(n.collapsed||!e.forall(m0))return C.none();if(t.isSameTable){const r=e.bind(Ou(o));return C.some({start:r,end:r})}{const r=cl(n.startContainer,o),s=cl(n.endContainer,o),a=r.bind((l=>c=>ya(c,l).bind(d=>Eo(Au(d)).map(u=>Tu(c,u))))(o)).bind(Ou(o)),i=s.bind((l=>c=>ya(c,l).bind(d=>Ht(Au(d)).map(u=>Tu(u,c))))(o)).bind(Ou(o));return C.some({start:a,end:i})}},p0=(e,t)=>As(e,n=>De(n,t)),Bu=e=>Tt(p0(e.cells,e.rng.start),p0(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),h0=(e,t)=>{const{startTable:n,endTable:o}=t,r=e.cloneRange();return n.each(s=>r.setStartAfter(s.dom)),o.each(s=>r.setEndBefore(s.dom)),r},wR=(e,t)=>{const n=(s=>a=>De(s,a))(e),o=((s,a)=>{const i=cl(s.startContainer,a),l=cl(s.endContainer,a);return Tt(i,l,Tu)})(t,n),r=((s,a)=>{const i=u0(s.startContainer,a),l=u0(s.endContainer,a),c=i.isSome(),d=l.isSome(),u=Tt(i,l,De).getOr(!1);return(m=>Tt(m.startTable,m.endTable,(p,g)=>{const h=Qg(p,b=>De(b,g)),f=Qg(g,b=>De(b,p));return h||f?{...m,startTable:h?C.none():m.startTable,endTable:f?C.none():m.endTable,isSameTable:!1,isMultiTable:!1}:m}).getOr(m))({startTable:i,endTable:l,isStartInTable:c,isEndInTable:d,isSameTable:u,isMultiTable:!u&&c&&d})})(t,n);return((s,a,i)=>s.exists(l=>((c,d)=>!m0(c)&&f0(c,d).exists(u=>{const m=u.dom.rows;return m.length===1&&m[0].cells.length===1}))(l,i)&&Hd(l.start,a)))(o,t,n)?o.map(s=>Aa.singleCellTable(t,s.start)):r.isMultiTable?((s,a,i,l)=>g0(s,a,i,l).bind(({start:c,end:d})=>{const u=c.bind(Bu).getOr([]),m=d.bind(Bu).getOr([]);if(u.length>0&&m.length>0){const p=h0(i,a);return C.some(Aa.multiTable(u,m,p))}return C.none()}))(o,r,t,n):((s,a,i,l)=>g0(s,a,i,l).bind(({start:c,end:d})=>c.or(d)).bind(c=>{const{isSameTable:d}=a,u=Bu(c).getOr([]);if(d&&c.cells.length===u.length)return C.some(Aa.fullTable(c.table));if(u.length>0){if(d)return C.some(Aa.partialTable(u,C.none()));{const m=h0(i,a);return C.some(Aa.partialTable(u,C.some({...a,rng:m})))}}return C.none()}))(o,r,t,n)},b0=e=>U(e,t=>{St(t,"contenteditable"),Ao(t)}),Pu=(e,t,n,o)=>{const r=n.cloneRange();o?(r.setStart(n.startContainer,n.startOffset),r.setEndAfter(t.dom.lastChild)):(r.setStartBefore(t.dom.firstChild),r.setEnd(n.endContainer,n.endOffset)),Du(e,r,t,!1).each(s=>s())},v0=e=>{const t=ns(e),n=R(e.selection.getNode());Ei(n.dom)&&Pt(e.schema,n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&it(t,o=>De(o,n))&&_t(n,"data-mce-selected","1")},y0=(e,t,n)=>C.some(()=>{const o=e.selection.getRng(),r=n.bind(({rng:s,isStartInTable:a})=>{const i=((c,d)=>C.from(c.dom.getParent(d,c.dom.isBlock)).map(R))(e,a?s.endContainer:s.startContainer);s.deleteContents(),((c,d,u)=>{u.each(m=>{d?Ze(m):(Ao(m),c.selection.setCursorLocation(m.dom,0))})})(e,a,i.filter(ne(Pt,e.schema)));const l=a?t[0]:t[t.length-1];return Pu(e,l,o,a),Pt(e.schema,l)?C.none():C.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);b0(r),v0(e)}),ER=(e,t,n,o)=>C.some(()=>{const r=e.selection.getRng(),s=t[0],a=n[n.length-1];Pu(e,s,r,!0),Pu(e,a,r,!1);const i=Pt(e.schema,s)?t:t.slice(1),l=Pt(e.schema,a)?n:n.slice(0,-1);b0(i.concat(l)),o.deleteContents(),v0(e)}),Du=(e,t,n,o=!0)=>C.some(()=>{d0(e,t,n,o)}),kR=(e,t)=>C.some(()=>hr(e,!1,t)),C0=(e,t)=>pt(ho(t,e),sa),Lu=(e,t)=>pt(ho(t,e),mi("caption")),dl=(e,t)=>C.some(()=>{Ao(t),e.selection.setCursorLocation(t.dom,0)}),w0=(e,t)=>e?Iv(t):Fv(t),xR=(e,t,n)=>{const o=R(e.getBody());return Lu(o,n).fold(()=>((r,s,a,i)=>{const l=M.fromRangeStart(r.selection.getRng());return C0(a,i).bind(c=>Pt(r.schema,c,{checkRootAsContent:!1})?dl(r,c):((d,u,m,p,g)=>Jr(m,d.getBody(),g).bind(h=>C0(u,R(h.getNode())).bind(f=>De(f,p)?C.none():C.some(Ne))))(r,a,s,c,l))})(e,t,o,n).orThunk(()=>Lr(((r,s)=>{const a=M.fromRangeStart(r.selection.getRng());return w0(s,a)||dn(s,r.getBody(),a).exists(i=>w0(s,i))})(e,t),Ne)),r=>((s,a,i,l)=>{const c=M.fromRangeStart(s.selection.getRng());return Pt(s.schema,l)?dl(s,l):((d,u,m,p,g)=>Jr(m,d.getBody(),g).fold(()=>C.some(Ne),h=>((f,b,v,y)=>Lt(f.dom).bind(w=>wn(f.dom).map(E=>b?v.isEqual(w)&&y.isEqual(E):v.isEqual(E)&&y.isEqual(w))).getOr(!0))(p,m,g,h)?((f,b)=>dl(f,b))(d,p):((f,b,v)=>Lu(f,R(v.getNode())).fold(()=>C.some(Ne),y=>Lr(!De(y,b),Ne)))(u,p,h)))(s,i,a,l,c)})(e,t,o,r))},Mu=(e,t)=>{const n=R(e.selection.getStart(!0)),o=ns(e);return e.selection.isCollapsed()&&o.length===0?xR(e,t,n):((r,s,a)=>{const i=R(r.getBody()),l=r.selection.getRng();return a.length!==0?y0(r,a,C.none()):((c,d,u,m)=>Lu(d,m).fold(()=>((p,g,h)=>wR(g,h).bind(f=>f.fold(ne(Du,p),ne(kR,p),ne(y0,p),ne(ER,p))))(c,d,u),p=>((g,h)=>dl(g,h))(c,p)))(r,i,l,s)})(e,n,o)},vr=(e,t)=>{let n=t;for(;n&&n!==e;){if(Cn(n)||Ge(n))return n;n=n.parentNode}return null},_R=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],SR=$.each,Iu=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),o=r=>it(_R,s=>ht(r,s))||n.has(r);return{compare:(r,s)=>{if(r.nodeName!==s.nodeName||r.nodeType!==s.nodeType)return!1;const a=l=>{const c={};return SR(t.getAttribs(l),d=>{const u=d.nodeName.toLowerCase();u==="style"||o(u)||(c[u]=t.getAttrib(l,u))}),c},i=(l,c)=>{for(const d in l)if(ke(l,d)){const u=c[d];if(st(u)||l[d]!==u)return!1;delete c[d]}for(const d in c)if(ke(c,d))return!1;return!0};return re(r)&&re(s)&&(!i(a(r),a(s))||!i(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(s,"style"))))?!1:!mn(r)&&!mn(s)},isAttributeInternal:o}},E0=e=>["h1","h2","h3","h4","h5","h6"].includes(e.name),k0=(e,t,n,o)=>{const r=n.name;for(let s=0,a=e.length;s<a;s++){const i=e[s];if(i.name===r){const l=o.nodes[r];l?l.nodes.push(n):o.nodes[r]={filter:i,nodes:[n]}}}if(n.attributes)for(let s=0,a=t.length;s<a;s++){const i=t[s],l=i.name;if(l in n.attributes.map){const c=o.attributes[l];c?c.nodes.push(n):o.attributes[l]={filter:i,nodes:[n]}}}},x0=(e,t)=>{const n=(o,r)=>{Ke(o,s=>{const a=en(s.nodes);U(s.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(r?c.attr(s.filter.name)!==void 0:c.name===s.filter.name)&&!at(c.parent)||a.splice(l,1)}a.length>0&&i(a,s.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},_0=(e,t,n,o={})=>{const r=((s,a,i)=>{const l={nodes:{},attributes:{}};return i.firstChild&&((c,d)=>{let u=c;for(;u=u.walk();)k0(s,a,u,l)})(i),l})(e,t,n);x0(r,o)},Fu=(e,t,n,o)=>{if((e.pad_empty_with_br||t.insert)&&n(o)){const r=new Ft("br",1);t.insert&&r.attr("data-mce-bogus","1"),o.empty().append(r)}else o.empty().append(new Ft("#text",3)).value=Ct},S0=(e,t)=>{const n=e==null?void 0:e.firstChild;return q(n)&&n===e.lastChild&&n.name===t},Ta=(e,t,n,o)=>o.isEmpty(t,n,r=>((s,a)=>{const i=s.getElementRule(a.name);return(i==null?void 0:i.paddEmpty)===!0})(e,r)),NR=e=>{let t;for(let n=e;n;n=n.parent){const o=n.attr("contenteditable");if(o==="false")break;o==="true"&&(t=n)}return C.from(t)},Uu=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const o=e.children();for(const r of o)n&&!t.isValidChild(n.name,r.name)&&Uu(r,t,n);e.unwrap()}},zu=(e,t,n,o=Ne)=>{const r=t.getTextBlockElements(),s=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=$.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),l=new Set,c=d=>d!==n&&!i[d.name];for(let d=0;d<e.length;d++){const u=e[d];let m,p,g;if(!u.parent||l.has(u))continue;if(r[u.name]&&u.parent.name==="li"){let f=u.next;for(;f&&r[f.name];)f.name="li",l.add(f),u.parent.insert(f,u.parent),f=f.next;u.unwrap();continue}const h=[u];for(m=u.parent;m&&!t.isValidChild(m.name,u.name)&&c(m);m=m.parent)h.push(m);if(m&&h.length>1)if(ju(t,u,m))Uu(u,t);else{h.reverse(),p=h[0].clone(),o(p);let f=p;for(let b=0;b<h.length-1;b++){t.isValidChild(f.name,h[b].name)&&b>0?(g=h[b].clone(),o(g),f.append(g)):g=f;for(let v=h[b].firstChild;v&&v!==h[b+1];){const y=v.next;g.append(v),v=y}f=g}Ta(t,s,a,p)?m.insert(u,h[0],!0):(m.insert(p,h[0],!0),m.insert(u,p)),m=h[0],(Ta(t,s,a,m)||S0(m,"br"))&&m.empty().remove()}else if(u.parent){if(u.name==="li"){let f=u.prev;if(f&&(f.name==="ul"||f.name==="ol")){f.append(u);continue}if(f=u.next,f&&(f.name==="ul"||f.name==="ol")&&f.firstChild){f.insert(u,f.firstChild,!0);continue}const b=new Ft("ul",1);o(b),u.wrap(b);continue}if(t.isValidChild(u.parent.name,"div")&&t.isValidChild("div",u.name)){const f=new Ft("div",1);o(f),u.wrap(f)}else Uu(u,t)}}},ju=(e,t,n=t.parent)=>!(!n||(!e.children[t.name]||e.isValidChild(n.name,t.name))&&(t.name!=="a"||!((o,r)=>{let s=o;for(;s;){if(s.name==="a")return!0;s=s.parent}return!1})(n))&&(!(o=>o.name==="summary")(n)||!E0(t)||(n==null?void 0:n.firstChild)===t&&(n==null?void 0:n.lastChild)===t)),Hu=e=>e.collapsed?e:(t=>{const n=M.fromRangeStart(t),o=M.fromRangeEnd(t),r=t.commonAncestorContainer;return dn(!1,r,o).map(s=>!Kn(n,o,r)&&Kn(n,s,r)?((a,i,l,c)=>{const d=document.createRange();return d.setStart(a,i),d.setEnd(l,c),d})(n.container(),n.offset(),s.container(),s.offset()):t).getOr(t)})(e),RR=(e,t)=>{let n=t.firstChild,o=t.lastChild;return n&&n.name==="meta"&&(n=n.next),o&&o.attr("id")==="mce_marker"&&(o=o.prev),((r,s)=>{const a=r.getNonEmptyElements();return q(s)&&(s.isEmpty(a)||((i,l)=>i.getBlockElements()[l.name]&&(c=>q(c.firstChild)&&c.firstChild===c.lastChild)(l)&&(c=>c.name==="br"||c.value===Ct)(l.firstChild))(r,s))})(e,o)&&(o=o==null?void 0:o.prev),!(!n||n!==o||n.name!=="ul"&&n.name!=="ol")},AR=e=>{return e.length>0&&(!(n=e[e.length-1]).firstChild||q((t=n)==null?void 0:t.firstChild)&&t.firstChild===t.lastChild&&(o=>o.data===Ct||rt(o))(t.firstChild))?e.slice(0,-1):e;var t,n},$u=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},N0=(e,t)=>{const n=M.after(e),o=Gn(t).prev(n);return o?o.toRange():null},TR=(e,t,n,o)=>{const r=((u,m,p)=>{const g=m.serialize(p);return(h=>{var f,b;const v=h.firstChild,y=h.lastChild;return v&&v.nodeName==="META"&&((f=v.parentNode)===null||f===void 0||f.removeChild(v)),y&&y.id==="mce_marker"&&((b=y.parentNode)===null||b===void 0||b.removeChild(y)),h})(u.createFragment(g))})(t,e,o),s=$u(t,n.startContainer),a=AR((i=r.firstChild,ye((l=i==null?void 0:i.childNodes)!==null&&l!==void 0?l:[],u=>u.nodeName==="LI")));var i,l;const c=t.getRoot(),d=u=>{const m=M.fromRangeStart(n),p=Gn(t.getRoot()),g=u===1?p.prev(m):p.next(m),h=g==null?void 0:g.getNode();return!h||$u(t,h)!==s};return s?d(1)?((u,m,p)=>{const g=u.parentNode;return g&&$.each(m,h=>{g.insertBefore(h,u)}),((h,f)=>{const b=M.before(h),v=Gn(f).next(b);return v?v.toRange():null})(u,p)})(s,a,c):d(2)?((u,m,p,g)=>(g.insertAfter(m.reverse(),u),N0(m[0],p)))(s,a,c,t):((u,m,p,g)=>{const h=((b,v)=>{const y=v.cloneRange(),w=v.cloneRange();return y.setStartBefore(b),w.setEndAfter(b),[y.cloneContents(),w.cloneContents()]})(u,g),f=u.parentNode;return f&&(f.insertBefore(h[0],u),$.each(m,b=>{f.insertBefore(b,u)}),f.insertBefore(h[1],u),f.removeChild(u)),N0(m[m.length-1],p)})(s,a,c,n):null},OR=["pre"],Vu=Ei,BR=(e,t,n)=>{var o,r;const s=e.selection,a=e.dom,i=e.parser,l=n.merge,c=Lo({validate:!0},e.schema),d='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(t=on(t)),t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,d);let u=s.getRng();const m=u.startContainer,p=e.getBody();m===p&&s.isCollapsed()&&a.isBlock(p.firstChild)&&((y,w)=>q(w)&&!y.schema.getVoidElements()[w.nodeName])(e,p.firstChild)&&a.isEmpty(p.firstChild)&&(u=a.createRng(),u.setStart(p.firstChild,0),u.setEnd(p.firstChild,0),s.setRng(u)),s.isCollapsed()||(y=>{const w=y.dom,E=Hu(y.selection.getRng());y.selection.setRng(E);const k=w.getParent(E.startContainer,Vu);((S,_,T)=>!!q(T)&&T===S.getParent(_.endContainer,Vu)&&Hd(R(T),_))(w,E,k)?Du(y,E,R(k)):E.startContainer===E.endContainer&&E.endOffset-E.startOffset==1&&j(E.startContainer.childNodes[E.startOffset])?E.deleteContents():y.getDoc().execCommand("Delete",!1)})(e);const g=s.getNode(),h={context:g.nodeName.toLowerCase(),data:n.data,insert:!0},f=i.parse(t,h);if(n.paste===!0&&RR(e.schema,f)&&((y,w)=>!!$u(y,w))(a,g))return u=TR(c,a,s.getRng(),f),u&&s.setRng(u),t;n.paste===!0&&((y,w,E,k)=>{var S;const _=w.firstChild,T=w.lastChild,P=_===(T.attr("data-mce-type")==="bookmark"?T.prev:T),x=Ue(OR,_.name);if(P&&x){const N=_.attr("contenteditable")!=="false",B=((S=y.getParent(E,y.isBlock))===null||S===void 0?void 0:S.nodeName.toLowerCase())===_.name,I=C.from(vr(k,E)).forall(Cn);return N&&B&&I}return!1})(a,f,g,e.getBody())&&((o=f.firstChild)===null||o===void 0||o.unwrap()),(y=>{let w=y;for(;w=w.walk();)w.type===1&&w.attr("data-mce-fragment","1")})(f);let b=f.lastChild;if(b&&b.attr("id")==="mce_marker"){const y=b;for(b=b.prev;b;b=b.walk(!0))if(b.type===3||!a.isBlock(b.name)){b.parent&&e.schema.isValidChild(b.parent.name,"span")&&b.parent.insert(y,b,b.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(g),h.invalid||((y,w,E)=>{var k;return it(E.children(),E0)&&((k=y.getParent(w,y.isBlock))===null||k===void 0?void 0:k.nodeName)==="SUMMARY"})(a,g,f)){e.selection.setContent(d);let y,w=s.getNode();const E=e.getBody();for(Ks(w)?w=y=E:y=w;y&&y!==E;)w=y,y=y.parentNode;t=w===E?E.innerHTML:a.getOuterHTML(w);const k=i.parse(t),S=(N=>{for(let B=N;B;B=B.walk())if(B.attr("id")==="mce_marker")return C.some(B);return C.none()})(k),_=S.bind(NR).getOr(k);S.each(N=>N.replace(f));const T=f.children(),P=(r=f.parent)!==null&&r!==void 0?r:k;f.unwrap();const x=ye(T,N=>ju(e.schema,N,P));zu(x,e.schema,_),_0(i.getNodeFilters(),i.getAttributeFilters(),k),t=c.serialize(k),w===E?a.setHTML(E,t):a.setOuterHTML(w,t)}else t=c.serialize(f),((y,w,E)=>{var k;if(E.getAttribute("data-mce-bogus")==="all")(k=E.parentNode)===null||k===void 0||k.insertBefore(y.dom.createFragment(w),E);else{const S=E.firstChild,_=E.lastChild;!S||S===_&&S.nodeName==="BR"?y.dom.setHTML(E,w):y.selection.setContent(w,{no_events:!0})}})(e,t,g);var v;return((y,w)=>{const E=y.schema.getTextInlineElements(),k=y.dom;if(w){const S=y.getBody(),_=Iu(y);$.each(k.select("*[data-mce-fragment]"),T=>{if(q(E[T.nodeName.toLowerCase()])&&((P,x)=>wo(hu(P,x),N=>!(B=>Bv.has(B))(N)))(k,T)){for(let P=T.parentElement;q(P)&&P!==S&&!aR(k,T,P);P=P.parentElement)if(_.compare(P,T)){k.remove(T,!0);break}}})}})(e,l),((y,w)=>{var E,k,S;let _;const T=y.dom,P=y.selection;if(!w)return;P.scrollIntoView(w);const x=vr(y.getBody(),w);if(x&&T.getContentEditable(x)==="false")return T.remove(w),void P.select(x);let N=T.createRng();const B=w.previousSibling;if(j(B)){N.setStart(B,(k=(E=B.nodeValue)===null||E===void 0?void 0:E.length)!==null&&k!==void 0?k:0);const V=w.nextSibling;j(V)&&(B.appendData(V.data),(S=V.parentNode)===null||S===void 0||S.removeChild(V))}else N.setStartBefore(w),N.setEndBefore(w);const I=T.getParent(w,T.isBlock);if(T.remove(w),I&&T.isEmpty(I)){const V=Vu(I);jr(R(I)),N.setStart(I,0),N.setEnd(I,0),V||(z=>!!z.getAttribute("data-mce-fragment"))(I)||!(_=(z=>{let te=M.fromRangeStart(z);return te=Gn(y.getBody()).next(te),te==null?void 0:te.toRange()})(N))?T.add(I,T.create("br",V?{}:{"data-mce-bogus":"1"})):(N=_,T.remove(I))}P.setRng(N)})(e,a.get("mce_marker")),v=e.getBody(),$.each(v.getElementsByTagName("*"),y=>{y.removeAttribute("data-mce-fragment")}),((y,w,E)=>{C.from(y.getParent(w,"td,th")).map(R).each(k=>((S,_)=>{Tc(S).each(T=>{Ko(T).each(P=>{_.isBlock(Oe(S))&&ar(T)&&_.isBlock(Oe(P))&&Ze(T)})})})(k,E))})(a,s.getStart(),e.schema),((y,w,E)=>{const k=Bg(R(E),S=>De(S,R(w)));Os(k,k.length-2).filter(tn).fold(()=>Wc(y,w),S=>Wc(y,S.dom))})(e.schema,e.getBody(),s.getStart()),t},ul=e=>e instanceof Ft,qu=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&(o=>{pr(o)&&Lt(o.getBody()).each(r=>{const s=r.getNode(),a=Vn(s)?Lt(s).getOr(r):r;o.selection.setRng(a.toRange())})})(e)},R0=e=>Ie(e)?e:Qe,Wu=(e,t,n)=>{const o=t(e),r=R0(n);return o.orThunk(()=>r(e)?C.none():((s,a,i)=>{let l=s.dom;const c=R0(i);for(;l.parentNode;){l=l.parentNode;const d=R(l),u=a(d);if(u.isSome())return u;if(c(d))break}return C.none()})(e,t,r))},Ku=Yd,A0=(e,t,n)=>{const o=e.formatter.get(n);if(o)for(let r=0;r<o.length;r++){const s=o[r];if(fn(s)&&s.inherit===!1&&e.dom.is(t,s.selector))return!0}return!1},Yu=(e,t,n,o,r)=>{const s=e.dom.getRoot();if(t===s)return!1;const a=e.dom.getParent(t,i=>!!A0(e,i,n)||i.parentNode===s||!!Zn(e,i,n,o,!0));return!!Zn(e,a,n,o,r)},ml=(e,t,n)=>!(!bt(n)||!Ku(t,n.inline))||!(!Xn(n)||!Ku(t,n.block))||!!fn(n)&&re(t)&&e.is(t,n.selector),T0=(e,t,n,o,r,s)=>{const a=n[o],i=o==="attributes";if(Ie(n.onmatch))return n.onmatch(t,n,o);if(a){if(lg(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):Yi(e,t,a[l]))return!0}else for(const l in a)if(ke(a,l)){const c=i?e.getAttrib(t,l):Yi(e,t,l),d=Do(a[l],s),u=at(c)||Ms(c);if(u&&at(d))continue;if(r&&u&&!n.exact||(!r||n.exact)&&!Ku(c,Gd(d,l)))return!1}}return!0},Zn=(e,t,n,o,r)=>{const s=e.formatter.get(n),a=e.dom;if(s&&re(t))for(let i=0;i<s.length;i++){const l=s[i];if(ml(e.dom,t,l)&&T0(a,t,l,"attributes",r,o)&&T0(a,t,l,"styles",r,o)){const c=l.classes;if(c){for(let d=0;d<c.length;d++)if(!e.dom.hasClass(t,Do(c[d],o)))return}return l}}},Gu=(e,t,n,o,r)=>{if(o)return Yu(e,o,t,n,r);if(o=e.selection.getNode(),Yu(e,o,t,n,r))return!0;const s=e.selection.getStart();return!(s===o||!Yu(e,s,t,n,r))},Oa=Et,O0=e=>{if(e){const t=new yt(e,e);for(let n=t.current();n;n=t.next())if(j(n))return n}return null},Xu=e=>{const t=vt("span");return so(t,{id:Id,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&ut(t,Ir(Oa)),t},Zu=(e,t,n)=>{const o=e.dom,r=e.selection;if(kb(t))hr(e,!1,R(t),n,!0);else{const s=r.getRng(),a=o.getParent(t,o.isBlock),i=s.startContainer,l=s.startOffset,c=s.endContainer,d=s.endOffset,u=(m=>{const p=O0(m);return p&&p.data.charAt(0)===Oa&&p.deleteData(0,1),p})(t);o.remove(t,!0),i===u&&l>0&&s.setStart(u,l-1),c===u&&d>0&&s.setEnd(u,d-1),a&&o.isEmpty(a)&&Ao(R(a)),r.setRng(s)}},Qu=(e,t,n)=>{const o=e.dom,r=e.selection;if(t)Zu(e,t,n);else if(!(t=ur(e.getBody(),r.getStart())))for(;t=o.get(Id);)Zu(e,t,n)},B0=(e,t)=>(e.appendChild(t),t),P0=(e,t)=>{var n;const o=Rs(e,(s,a)=>B0(s,a.cloneNode(!1)),t),r=(n=o.ownerDocument)!==null&&n!==void 0?n:document;return B0(o,r.createTextNode(Oa))},PR=(e,t,n,o)=>{const r=e.dom,s=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const l=s.getRng(),c=l.startContainer,d=l.startOffset;let u=c;j(c)&&(d!==c.data.length&&(a=!0),u=u.parentNode);const m=[];let p;for(;u;){if(Zn(e,u,t,n,o)){p=u;break}u.nextSibling&&(a=!0),m.push(u),u=u.parentNode}if(p)if(a){const g=s.getBookmark();l.collapse(!0);let h=mr(r,l,i,!0);h=nl(h),e.formatter.remove(t,n,h,o),s.moveToBookmark(g)}else{const g=ur(e.getBody(),p),h=q(g)?r.getParents(p.parentNode,dt,g):[],f=Xu(!1).dom;((y,w,E)=>{var k,S;const _=y.dom,T=_.getParent(E,ne(Wd,y.schema));T&&_.isEmpty(T)?(k=E.parentNode)===null||k===void 0||k.replaceChild(w,E):((P=>{const x=Bt(P,"br"),N=ye((B=>{const I=[];let V=B.dom;for(;V;)I.push(R(V)),V=V.lastChild;return I})(P).slice(-1),ar);x.length===N.length&&U(N,Ze)})(R(E)),_.isEmpty(E)?(S=E.parentNode)===null||S===void 0||S.replaceChild(w,E):_.insertAfter(w,E))})(e,f,g??p);const b=((y,w,E,k,S,_)=>{const T=y.formatter,P=y.dom,x=ye(Gt(T.get()),B=>B!==k&&!At(B,"removeformat")),N=((B,I,V)=>Yt(V,(z,te)=>{const ae=((de,le)=>Xd(de,le,G=>{const se=A=>Ie(A)||A.length>1&&A.charAt(0)==="%";return it(["styles","attributes"],A=>Xe(G,A).exists(O=>{const L=He(O)?O:yc(O);return it(L,se)}))}))(B,te);return B.formatter.matchNode(I,te,{},ae)?z.concat([te]):z},[]))(y,E,x);if(ye(N,B=>!((I,V,z)=>{const te=["inline","block","selector","attributes","styles","classes"],ae=de=>Ps(de,(le,G)=>it(te,se=>se===G));return Xd(I,V,de=>{const le=ae(de);return Xd(I,z,G=>{const se=ae(G);return((A,O,L=_e)=>ve(L).eq(A,O))(le,se)})})})(y,B,k)).length>0){const B=E.cloneNode(!1);return P.add(w,B),T.remove(k,S,B,_),P.remove(B),C.some(B)}return C.none()})(e,f,p,t,n,o),v=P0([...m,...b.toArray(),...h],f);g&&Zu(e,g,q(g)),s.setCursorLocation(v,1),r.isEmpty(p)&&r.remove(p)}},D0=e=>{const t=Xu(!1),n=P0(e,t.dom);return{caretContainer:t,caretPosition:M(n,0)}},L0=(e,t)=>{const{caretContainer:n,caretPosition:o}=D0(t);return Xt(R(e),n),Ze(R(e)),o},M0=(e,t)=>{if(un(t.dom))return!1;const n=e.schema.getTextInlineElements();return ke(n,Oe(t))&&!un(t.dom)&&!Qo(t.dom)},Ba={},I0=An(["pre"]);((e,t)=>{Ba[e]||(Ba[e]=[]),Ba[e].push(n=>{if(!n.selection.getRng().collapsed){const o=n.selection.getSelectedBlocks(),r=ye(ye(o,I0),(s=>a=>{const i=a.previousSibling;return I0(i)&&Ue(s,i)})(o));U(r,s=>{((a,i)=>{const l=R(i),c=lo(l).dom;Ze(l),Xo(R(a),[vt("br",c),vt("br",c),...Ot(l)])})(s.previousSibling,s)})}})})("pre");const F0=["fontWeight","fontStyle","color","fontSize","fontFamily"],U0=(e,t)=>{const n=e.get(t);return He(n)?pt(n,o=>bt(o)&&o.inline==="span"&&(r=>We(r.styles)&&it(Gt(r.styles),s=>Ue(F0,s)))(o)):C.none()},z0=(e,t)=>Zt(t,M.fromRangeStart(e)).isNone(),j0=(e,t)=>Vt(t,M.fromRangeEnd(e)).exists(n=>!rt(n.getNode())||Vt(t,n).isSome())===!1,H0=e=>t=>e_(t)&&e.isEditable(t),$0=e=>ye(e.getSelectedBlocks(),H0(e.dom)),Ju=$.each,em=e=>re(e)&&!mn(e)&&!un(e)&&!Qo(e),V0=(e,t)=>{for(let n=e;n;n=n[t]){if(j(n)&&Un(n.data))return e;if(re(n)&&!mn(n))return n}return e},q0=(e,t,n)=>{const o=Iu(e),r=mo(t)&&e.dom.isEditable(t),s=mo(n)&&e.dom.isEditable(n);if(r&&s){const a=V0(t,"previousSibling"),i=V0(n,"nextSibling");if(o.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),$.each($.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},W0=(e,t,n,o)=>{var r;if(o&&t.merge_siblings!==!1){const s=(r=q0(e,Cb(o),o))!==null&&r!==void 0?r:o;q0(e,s,Cb(s,!0))}},tm=(e,t,n)=>{Ju(e.childNodes,o=>{em(o)&&(t(o)&&n(o),o.hasChildNodes()&&tm(o,t,n))})},K0=(e,t)=>n=>!(!n||!Yi(e,n,t)),Y0=(e,t,n)=>o=>{e.setStyle(o,t,n),o.getAttribute("style")===""&&o.removeAttribute("style"),((r,s)=>{s.nodeName==="SPAN"&&r.getAttribs(s).length===0&&r.remove(s,!0)})(e,o)},yr=Wn([{keep:[]},{rename:["name"]},{removed:[]}]),DR=/^(src|href|style)$/,nm=$.each,fl=Yd,G0=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),X0=(e,t,n)=>{let o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"];if(re(o)){const s=o.childNodes.length-1;!n&&r&&r--,o=o.childNodes[r>s?s:r]}return j(o)&&n&&r>=o.data.length&&(o=new yt(o,e.getBody()).next()||o),j(o)&&!n&&r===0&&(o=new yt(o,e.getBody()).prev()||o),o},Z0=(e,t)=>{const n=t?"firstChild":"lastChild",o=e[n];return(r=>/^(TR|TH|TD)$/.test(r.nodeName))(e)&&o?e.nodeName==="TR"&&o[n]||o:e},om=(e,t,n,o)=>{var r;const s=e.create(n,o);return(r=t.parentNode)===null||r===void 0||r.insertBefore(s,t),s.appendChild(t),s},Q0=(e,t,n,o,r)=>{const s=R(t),a=R(e.create(o,r)),i=n?Dg(s):Pg(s);return Xo(a,i),n?(Xt(s,a),Lc(a,s)):(uo(s,a),ut(a,s)),a.dom},J0=(e,t,n)=>{const o=t.parentNode;let r;const s=e.dom,a=Dt(e);Xn(n)&&o===s.getRoot()&&(n.list_block&&fl(t,n.list_block)||U(en(t.childNodes),i=>{os(e,a,i.nodeName.toLowerCase())?r?r.appendChild(i):(r=om(s,i,a),s.setAttribs(r,ua(e))):r=null})),(i=>fn(i)&&bt(i)&&Dr(Xe(i,"mixed"),!0))(n)&&!fl(n.inline,t)||s.remove(t,!0)},ey=(e,t,n)=>Sn(e)?{name:t,value:null}:{name:e,value:Do(t,n)},ty=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},ny=(e,t,n,o,r)=>{let s=!1;nm(n.styles,(a,i)=>{const{name:l,value:c}=ey(i,a,o),d=Gd(c,l);(n.remove_similar||ct(c)||!re(r)||fl(Yi(e,r,l),d))&&e.setStyle(t,l,""),s=!0}),s&&ty(e,t)},oy=(e,t,n,o,r)=>{const s=e.dom,a=Iu(e),i=e.schema;if(bt(t)&&Yc(i,t.inline)&&er(i,o)&&o.parentElement===e.getBody())return J0(e,o,t),yr.removed();if(!t.ceFalseOverride&&o&&s.getContentEditableParent(o)==="false"||o&&!ml(s,o,t)&&!((d,u)=>u.links&&d.nodeName==="A")(o,t))return yr.keep();const l=o,c=t.preserve_attributes;if(bt(t)&&t.remove==="all"&&He(c)){const d=ye(s.getAttribs(l),u=>Ue(c,u.name.toLowerCase()));if(s.removeAllAttribs(l),U(d,u=>s.setAttrib(l,u.name,u.value)),d.length>0)return yr.rename("span")}if(t.remove!=="all"){ny(s,l,t,n,r),nm(t.attributes,(u,m)=>{const{name:p,value:g}=ey(m,u,n);if(t.remove_similar||ct(g)||!re(r)||fl(s.getAttrib(r,p),g)){if(p==="class"){const h=s.getAttrib(l,p);if(h){let f="";if(U(h.split(/\s+/),b=>{/mce\-\w+/.test(b)&&(f+=(f?" ":"")+b)}),f)return void s.setAttrib(l,p,f)}}if(DR.test(p)&&l.removeAttribute("data-mce-"+p),p==="style"&&An(["li"])(l)&&s.getStyle(l,"list-style-type")==="none")return l.removeAttribute(p),void s.setStyle(l,"list-style-type","none");p==="class"&&l.removeAttribute("className"),l.removeAttribute(p)}}),nm(t.classes,u=>{u=Do(u,n),re(r)&&!s.hasClass(r,u)||s.removeClass(l,u)});const d=s.getAttribs(l);for(let u=0;u<d.length;u++){const m=d[u].nodeName;if(!a.isAttributeInternal(m))return yr.keep()}}return t.remove!=="none"?(J0(e,l,t),yr.removed()):yr.keep()},LR=(e,t,n,o)=>oy(e,t,n,o,o).fold(oe(o),r=>(e.dom.createFragment().appendChild(o),e.dom.rename(o,r)),oe(null)),ry=(e,t,n,o,r)=>{(o||e.selection.isEditable())&&((s,a,i,l,c)=>{const d=s.formatter.get(a),u=d[0],m=s.dom,p=s.selection,g=y=>{const w=((E,k,S,_,T)=>{let P;return k.parentNode&&U(Gi(E.dom,k.parentNode).reverse(),x=>{if(!P&&re(x)&&x.id!=="_start"&&x.id!=="_end"){const N=Zn(E,x,S,_,T);N&&N.split!==!1&&(P=x)}}),P})(s,y,a,i,c);return((E,k,S,_,T,P,x,N)=>{var B,I;let V,z;const te=E.dom;if(S){const ae=S.parentNode;for(let de=_.parentNode;de&&de!==ae;de=de.parentNode){let le=te.clone(de,!1);for(let G=0;G<k.length&&(le=LR(E,k[G],N,le),le!==null);G++);le&&(V&&le.appendChild(V),z||(z=le),V=le)}x.mixed&&te.isBlock(S)||(_=(B=te.split(S,_))!==null&&B!==void 0?B:_),V&&z&&((I=T.parentNode)===null||I===void 0||I.insertBefore(V,T),z.appendChild(T),bt(x)&&W0(E,x,0,V))}return _})(s,d,w,y,y,0,u,i)},h=y=>it(d,w=>Pa(s,w,i,y,y)),f=y=>{const w=en(y.childNodes),E=h(y)||it(d,S=>ml(m,y,S)),k=y.parentNode;if(!E&&q(k)&&Zd(u)&&h(k),u.deep&&w.length)for(let S=0;S<w.length;S++)f(w[S]);U(["underline","line-through","overline"],S=>{re(y)&&s.dom.getStyle(y,"text-decoration")===S&&y.parentNode&&Eb(m,y.parentNode)===S&&Pa(s,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:S}},void 0,y)})},b=y=>{const w=m.get(y?"_start":"_end");if(w){let E=w[y?"firstChild":"lastChild"];return(k=>mn(k)&&re(k)&&(k.id==="_start"||k.id==="_end"))(E)&&(E=E[y?"firstChild":"lastChild"]),j(E)&&E.data.length===0&&(E=y?w.previousSibling||w.nextSibling:w.nextSibling||w.previousSibling),m.remove(w,!0),E}return null},v=y=>{let w,E,k=mr(m,y,d,y.collapsed);if(u.split){if(k=nl(k),w=X0(s,k,!0),E=X0(s,k),w!==E){if(w=Z0(w,!0),E=Z0(E,!1),G0(m,w,E)){const _=C.from(w.firstChild).getOr(w);return g(Q0(m,_,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void b(!0)}if(G0(m,E,w)){const _=C.from(E.lastChild).getOr(E);return g(Q0(m,_,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void b(!1)}w=om(m,w,"span",{id:"_start","data-mce-type":"bookmark"}),E=om(m,E,"span",{id:"_end","data-mce-type":"bookmark"});const S=m.createRng();S.setStartAfter(w),S.setEndBefore(E),wa(m,S,_=>{U(_,T=>{mn(T)||mn(T.parentNode)||g(T)})}),g(w),g(E),w=b(!0),E=b()}else w=E=g(w);k.startContainer=w.parentNode?w.parentNode:w,k.startOffset=m.nodeIndex(w),k.endContainer=E.parentNode?E.parentNode:E,k.endOffset=m.nodeIndex(E)+1}wa(m,k,S=>{U(S,f)})};if(l){if(Ca(l)){const y=m.createRng();y.setStartBefore(l),y.setEndAfter(l),v(y)}else v(l);Ub(s,a,l,i)}else p.isCollapsed()&&bt(u)&&!ns(s).length?PR(s,a,i,c):(yb(s,()=>Vd(s,v),y=>bt(u)&&Gu(s,a,i,y)),s.nodeChanged()),((y,w,E)=>{w==="removeformat"?U($0(y.selection),k=>{U(F0,S=>y.dom.setStyle(k,S,"")),ty(y.dom,k)}):U0(y.formatter,w).each(k=>{U($0(y.selection),S=>ny(y.dom,S,k,E,null))})})(s,a,i),Ub(s,a,l,i)})(e,t,n,o,r)},Pa=(e,t,n,o,r)=>oy(e,t,n,o,r).fold(Qe,s=>(e.dom.rename(o,s),!0),dt),sy=$.each,gl=$.each,ay=(e,t,n,o)=>{if(gl(n.styles,(r,s)=>{e.setStyle(t,s,Do(r,o))}),n.styles){const r=e.getAttrib(t,"style");r&&e.setAttrib(t,"data-mce-style",r)}},MR=(e,t,n,o)=>{const r=e.formatter.get(t),s=r[0],a=!o&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(g,h=s)=>{Ie(h.onformat)&&h.onformat(g,h,n,o),ay(i,g,h,n),gl(h.attributes,(f,b)=>{i.setAttrib(g,b,Do(f,n))}),gl(h.classes,f=>{const b=Do(f,n);i.hasClass(g,b)||i.addClass(g,b)})},d=(g,h)=>{let f=!1;return gl(g,b=>!(!fn(b)||(i.getContentEditable(h)!=="false"||b.ceFalseOverride)&&(!q(b.collapsed)||b.collapsed===a)&&i.is(h,b.selector)&&!un(h)&&(c(h,b),f=!0,1))),f},u=g=>{if(Q(g)){const h=i.create(g);return c(h),h}return null},m=(g,h,f)=>{const b=[];let v=!0;const y=s.inline||s.block,w=u(y);wa(g,h,E=>{let k;const S=_=>{let T=!1,P=v,x=!1;const N=_.parentNode,B=N.nodeName.toLowerCase(),I=g.getContentEditable(_);q(I)&&(P=v,v=I==="true",T=!0,x=wb(e,_));const V=v&&!T;if(rt(_)&&!((z,te,ae,de)=>{if(yS(z)&&bt(te)&&ae.parentNode){const le=_p(z.schema),G=Gx(R(ae),se=>un(se.dom));return Br(le,de)&&fo(z.schema,ae.parentNode,{skipBogus:!1,includeZwsp:!0})&&!G}return!1})(e,s,_,B))return k=null,void(Xn(s)&&g.remove(_));if((z=>(te=>Xn(te)&&te.wrapper===!0)(s)&&Zn(e,z,t,n))(_))k=null;else{if(((z,te,ae)=>{const de=(le=>Xn(le)&&le.wrapper!==!0)(s)&&Wd(e.schema,z)&&os(e,te,y);return ae&&de})(_,B,V)){const z=g.rename(_,y);return c(z),b.push(z),void(k=null)}if(fn(s)){let z=d(r,_);if(!z&&q(N)&&Zd(s)&&(z=d(r,N)),!bt(s)||z)return void(k=null)}q(w)&&((z,te,ae,de)=>{const le=z.nodeName.toLowerCase(),G=os(e,y,le)&&os(e,te,y),se=!f&&j(z)&&Oi(z.data),A=un(z),O=!bt(s)||!g.isBlock(z);return(ae||de)&&G&&!se&&!A&&O})(_,B,V,x)?(k||(k=g.clone(w,!1),N.insertBefore(k,_),b.push(k)),x&&T&&(v=P),k.appendChild(_)):(k=null,U(en(_.childNodes),S),T&&(v=P),k=null)}};U(E,S)}),s.links===!0&&U(b,E=>{const k=S=>{S.nodeName==="A"&&c(S,s),U(en(S.childNodes),k)};k(E)}),U(b,E=>{const k=(S=>{let _=0;return U(S.childNodes,T=>{(P=>q(P)&&j(P)&&P.length===0)(T)||mn(T)||_++}),_})(E);!(b.length>1)&&g.isBlock(E)||k!==0?(bt(s)||Xn(s)&&s.wrapper)&&(s.exact||k!==1||(E=(S=>pt(S.childNodes,qd).filter(T=>g.getContentEditable(T)!=="false"&&ml(g,T,s)).map(T=>{const P=g.clone(T,!1);return c(P),g.replace(P,S,!0),g.remove(T,!0),P}).getOr(S))(E)),((S,_,T,P)=>{sy(_,x=>{bt(x)&&sy(S.dom.select(x.inline,P),N=>{em(N)&&Pa(S,x,T,N,x.exact?N:null)}),((N,B,I)=>{if(B.clear_child_styles){const V=B.links?"*:not(a)":"*";Ju(N.select(V,I),z=>{em(z)&&N.isEditable(z)&&Ju(B.styles,(te,ae)=>{N.setStyle(z,ae,"")})})}})(S.dom,x,P)})})(e,r,n,E),((S,_,T,P,x)=>{const N=x.parentNode;Zn(S,N,T,P)&&Pa(S,_,P,x)||_.merge_with_parents&&N&&S.dom.getParent(N,B=>!!Zn(S,B,T,P)&&(Pa(S,_,P,x),!0))})(e,s,t,n,E),((S,_,T,P)=>{if(_.styles&&_.styles.backgroundColor){const x=K0(S,"fontSize");tm(P,N=>x(N)&&S.isEditable(N),Y0(S,"backgroundColor",Do(_.styles.backgroundColor,T)))}})(g,s,n,E),((S,_,T,P)=>{const x=N=>{if(mo(N)&&re(N.parentNode)&&S.isEditable(N)){const B=Eb(S,N.parentNode);S.getStyle(N,"color")&&B?S.setStyle(N,"text-decoration",B):S.getStyle(N,"text-decoration")===B&&S.setStyle(N,"text-decoration",null)}};_.styles&&(_.styles.color||_.styles.textDecoration)&&($.walk(P,x,"childNodes"),x(P))})(g,s,0,E),((S,_,T,P)=>{if(bt(_)&&(_.inline==="sub"||_.inline==="sup")){const x=K0(S,"fontSize");tm(P,B=>x(B)&&S.isEditable(B),Y0(S,"fontSize",""));const N=ye(S.select(_.inline==="sup"?"sub":"sup",P),S.isEditable);S.remove(N,!0)}})(g,s,0,E),W0(e,s,0,E)):g.remove(E,!0)})},p=Ca(o)?o:l.getNode();if(i.getContentEditable(p)==="false"&&!wb(e,p))return d(r,o=p),void Fb(e,t,o,n);if(s){if(o)if(Ca(o)){if(!d(r,o)){const g=i.createRng();g.setStartBefore(o),g.setEndAfter(o),m(i,mr(i,g,r),!0)}}else m(i,o,!0);else a&&bt(s)&&!ns(e).length?((g,h,f)=>{let b;const v=g.selection,y=g.formatter.get(h);if(!y)return;const w=v.getRng();let E=w.startOffset;const k=w.startContainer.nodeValue;b=ur(g.getBody(),v.getStart());const S=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(k&&E>0&&E<k.length&&S.test(k.charAt(E))&&S.test(k.charAt(E-1))){const P=v.getBookmark();w.collapse(!0);let x=mr(g.dom,w,y);x=nl(x),g.formatter.apply(h,f,x),v.moveToBookmark(P)}else{let P=b?O0(b):null;b&&(P==null?void 0:P.data)===Oa||(_=g.getDoc(),T=Xu(!0).dom,b=_.importNode(T,!0),P=b.firstChild,w.insertNode(b),E=1),g.formatter.apply(h,f,b),v.setCursorLocation(P,E)}var _,T})(e,t,n):(l.setRng(Hu(l.getRng())),yb(e,()=>{Vd(e,(g,h)=>{const f=h?g:mr(i,g,r);m(i,f,!1)})},dt),e.nodeChanged()),U0(e.formatter,t).each(g=>{U((h=>ye((f=>{const b=f.getSelectedBlocks(),v=f.getRng();if(f.isCollapsed())return[];if(b.length===1)return z0(v,b[0])&&j0(v,b[0])?b:[];{const y=Ht(b).filter(k=>z0(v,k)).toArray(),w=Eo(b).filter(k=>j0(v,k)).toArray(),E=b.slice(1,-1);return y.concat(E).concat(w)}})(h),H0(h.dom)))(e.selection),h=>ay(i,h,g,n))});((g,h)=>{ke(Ba,g)&&U(Ba[g],f=>{f(h)})})(t,e)}Fb(e,t,o,n)},iy=(e,t,n,o)=>{(o||e.selection.isEditable())&&MR(e,t,n,o)},ly=e=>ke(e,"vars"),cy=e=>e.selection.getStart(),dy=(e,t,n,o,r)=>og(t,s=>{const a=e.formatter.matchNode(s,n,r??{},o);return!st(a)},s=>!!A0(e,s,n)||!o&&q(e.formatter.matchNode(s,n,r,!0))),uy=(e,t)=>{const n=t??cy(e);return ye(Gi(e.dom,n),o=>re(o)&&!Qo(o))},my=(e,t,n)=>{const o=uy(e,t);Ke(n,(r,s)=>{const a=i=>{const l=dy(e,o,s,i.similar,ly(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const d=l.getOr(t);ly(i)?i.callback(c,{node:d,format:s,parents:o}):U(i.callbacks,u=>u(c,{node:d,format:s,parents:o}))}};U([r.withSimilar,r.withoutSimilar],a),U(r.withVars,a)})},fy=$.explode,gy=()=>{const e={};return{addFilter:(t,n)=>{U(fy(t),o=>{ke(e,o)||(e[o]={name:o,callbacks:[]}),e[o].callbacks.push(n)})},getFilters:()=>yc(e),removeFilter:(t,n)=>{U(fy(t),o=>{if(ke(e,o))if(q(n)){const r=e[o],s=ye(r.callbacks,a=>a!==n);s.length>0?r.callbacks=s:delete e[o]}else delete e[o]})}}},IR=(e,t,n)=>{var o;const r=rd();t.convert_fonts_to_spans&&((s,a,i)=>{s.addNodeFilter("font",l=>{U(l,c=>{const d=a.parse(c.attr("style")),u=c.attr("color"),m=c.attr("face"),p=c.attr("size");u&&(d.color=u),m&&(d["font-family"]=m),p&&ci(p).each(g=>{d["font-size"]=i[g-1]}),c.name="span",c.attr("style",a.serialize(d)),((g,h)=>{U(["color","face","size"],f=>{g.attr(f,null)})})(c)})})})(e,r,$.explode((o=t.font_size_legacy_values)!==null&&o!==void 0?o:"")),((s,a,i)=>{s.addNodeFilter("strike",l=>{const c=a.type!=="html4";U(l,d=>{if(c)d.name="s";else{const u=i.parse(d.attr("style"));u["text-decoration"]="line-through",d.name="span",d.attr("style",i.serialize(u))}})})})(e,n,r)},rm=e=>{const[t,...n]=e.split(","),o=n.join(","),r=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(r){const s=r[2]===";base64",a=s?(i=>{const l=/([a-z0-9+\/=\s]+)/i.exec(i);return l?l[1]:""})(o):decodeURIComponent(o);return C.some({type:r[1],data:a,base64Encoded:s})}return C.none()},py=(e,t,n=!0)=>{let o=t;if(n)try{o=atob(t)}catch{return C.none()}const r=new Uint8Array(o.length);for(let s=0;s<r.length;s++)r[s]=o.charCodeAt(s);return C.some(new Blob([r],{type:e}))},hy=e=>new Promise((t,n)=>{const o=new FileReader;o.onloadend=()=>{t(o.result)},o.onerror=()=>{var r;n((r=o.error)===null||r===void 0?void 0:r.message)},o.readAsDataURL(e)});let FR=0;const by=(e,t,n)=>rm(e).bind(({data:o,type:r,base64Encoded:s})=>{if(t&&!s)return C.none();{const a=s?o:btoa(o);return n(a,r)}}),vy=(e,t,n)=>{const o=e.create("blobid"+FR++,t,n);return e.add(o),o},yy=(e,t,n=!1)=>by(t,n,(o,r)=>C.from(e.getByData(o,r)).orThunk(()=>py(r,o).map(s=>vy(e,s,o)))),UR=/^(?:(?:(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)([A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*))(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?)$/,zR=e=>C.from(e.match(UR)).bind(t=>Os(t,1)).map(t=>ht(t,"www.")?t.substring(4):t),Cy=(e,t)=>{C.from(e.attr("src")).bind(zR).forall(n=>!Ue(t,n))&&e.attr("sandbox","")},sm=(e,t)=>ht(e,`${t}/`),{entries:wy,setPrototypeOf:Ey,isFrozen:jR,getPrototypeOf:HR,getOwnPropertyDescriptor:$R}=Object;let{freeze:Qt,seal:Dn,create:VR}=Object,{apply:am,construct:im}=typeof Reflect<"u"&&Reflect;am||(am=function(e,t,n){return e.apply(t,n)}),Qt||(Qt=function(e){return e}),Dn||(Dn=function(e){return e}),im||(im=function(e,t){return new e(...t)});const qR=En(Array.prototype.forEach),WR=En(Array.prototype.pop),Da=En(Array.prototype.push),pl=En(String.prototype.toLowerCase),lm=En(String.prototype.toString),KR=En(String.prototype.match),Ln=En(String.prototype.replace),YR=En(String.prototype.indexOf),GR=En(String.prototype.trim),hn=En(RegExp.prototype.test),La=(ky=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return im(ky,t)});var ky;function En(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return am(e,t,o)}}function Le(e,t,n){var o;n=(o=n)!==null&&o!==void 0?o:pl,Ey&&Ey(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const a=n(s);a!==s&&(jR(t)||(t[r]=a),s=a)}e[s]=!0}return e}function is(e){const t=VR(null);for(const[n,o]of wy(e))t[n]=o;return t}function hl(e,t){for(;e!==null;){const n=$R(e,t);if(n){if(n.get)return En(n.get);if(typeof n.value=="function")return En(n.value)}e=HR(e)}return function(n){return console.warn("fallback value for",n),null}}const xy=Qt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),cm=Qt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dm=Qt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),XR=Qt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),um=Qt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ZR=Qt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_y=Qt(["#text"]),Sy=Qt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mm=Qt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ny=Qt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bl=Qt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),QR=Dn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),JR=Dn(/<%[\w\W]*|[\w\W]*%>/gm),eA=Dn(/\${[\w\W]*}/gm),tA=Dn(/^data-[\-\w.\u00B7-\uFFFF]/),nA=Dn(/^aria-[\-\w]+$/),Ry=Dn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oA=Dn(/^(?:\w+script|data):/i),rA=Dn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ay=Dn(/^html$/i);var Ty=Object.freeze({__proto__:null,MUSTACHE_EXPR:QR,ERB_EXPR:JR,TMPLIT_EXPR:eA,DATA_ATTR:tA,ARIA_ATTR:nA,IS_ALLOWED_URI:Ry,IS_SCRIPT_OR_DATA:oA,ATTR_WHITESPACE:rA,DOCTYPE_NAME:Ay});const sA=()=>typeof window>"u"?null:window;var Oy=function e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sA();const n=D=>e(D);if(n.version="3.0.5",n.removed=[],!t||!t.document||t.document.nodeType!==9)return n.isSupported=!1,n;const o=t.document,r=o.currentScript;let{document:s}=t;const{DocumentFragment:a,HTMLTemplateElement:i,Node:l,Element:c,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:m,DOMParser:p,trustedTypes:g}=t,h=c.prototype,f=hl(h,"cloneNode"),b=hl(h,"nextSibling"),v=hl(h,"childNodes"),y=hl(h,"parentNode");if(typeof i=="function"){const D=s.createElement("template");D.content&&D.content.ownerDocument&&(s=D.content.ownerDocument)}let w,E="";const{implementation:k,createNodeIterator:S,createDocumentFragment:_,getElementsByTagName:T}=s,{importNode:P}=o;let x={};n.isSupported=typeof wy=="function"&&typeof y=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:N,ERB_EXPR:B,TMPLIT_EXPR:I,DATA_ATTR:V,ARIA_ATTR:z,IS_SCRIPT_OR_DATA:te,ATTR_WHITESPACE:ae}=Ty;let{IS_ALLOWED_URI:de}=Ty,le=null;const G=Le({},[...xy,...cm,...dm,...um,..._y]);let se=null;const A=Le({},[...Sy,...mm,...Ny,...bl]);let O=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,F=null,X=!0,W=!0,fe=!1,Ce=!0,xe=!1,Me=!1,et=!1,no=!1,Z=!1,we=!1,Re=!1,Ee=!0,Pe=!1,qe=!0,Y=!1,ue={},Fe=null;const Ye=Le({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ft=null;const Wt=Le({},["audio","video","img","source","image","track"]);let xn=null;const Mt=Le({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jt="http://www.w3.org/1998/Math/MathML",gt="http://www.w3.org/2000/svg",sn="http://www.w3.org/1999/xhtml";let oo=sn,yo=!1,Nr=null;const qf=Le({},[Jt,gt,sn],lm);let _n;const Ho=["application/xhtml+xml","text/html"];let xt,zt=null;const Es=s.createElement("form"),$o=function(D){return D instanceof RegExp||D instanceof Function},ks=function(D){if(!zt||zt!==D){if(D&&typeof D=="object"||(D={}),D=is(D),_n=_n=Ho.indexOf(D.PARSER_MEDIA_TYPE)===-1?"text/html":D.PARSER_MEDIA_TYPE,xt=_n==="application/xhtml+xml"?lm:pl,le="ALLOWED_TAGS"in D?Le({},D.ALLOWED_TAGS,xt):G,se="ALLOWED_ATTR"in D?Le({},D.ALLOWED_ATTR,xt):A,Nr="ALLOWED_NAMESPACES"in D?Le({},D.ALLOWED_NAMESPACES,lm):qf,xn="ADD_URI_SAFE_ATTR"in D?Le(is(Mt),D.ADD_URI_SAFE_ATTR,xt):Mt,ft="ADD_DATA_URI_TAGS"in D?Le(is(Wt),D.ADD_DATA_URI_TAGS,xt):Wt,Fe="FORBID_CONTENTS"in D?Le({},D.FORBID_CONTENTS,xt):Ye,L="FORBID_TAGS"in D?Le({},D.FORBID_TAGS,xt):{},F="FORBID_ATTR"in D?Le({},D.FORBID_ATTR,xt):{},ue="USE_PROFILES"in D&&D.USE_PROFILES,X=D.ALLOW_ARIA_ATTR!==!1,W=D.ALLOW_DATA_ATTR!==!1,fe=D.ALLOW_UNKNOWN_PROTOCOLS||!1,Ce=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,xe=D.SAFE_FOR_TEMPLATES||!1,Me=D.WHOLE_DOCUMENT||!1,Z=D.RETURN_DOM||!1,we=D.RETURN_DOM_FRAGMENT||!1,Re=D.RETURN_TRUSTED_TYPE||!1,no=D.FORCE_BODY||!1,Ee=D.SANITIZE_DOM!==!1,Pe=D.SANITIZE_NAMED_PROPS||!1,qe=D.KEEP_CONTENT!==!1,Y=D.IN_PLACE||!1,de=D.ALLOWED_URI_REGEXP||Ry,oo=D.NAMESPACE||sn,O=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&$o(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(O.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&$o(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(O.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(O.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),xe&&(W=!1),we&&(Z=!0),ue&&(le=Le({},[..._y]),se=[],ue.html===!0&&(Le(le,xy),Le(se,Sy)),ue.svg===!0&&(Le(le,cm),Le(se,mm),Le(se,bl)),ue.svgFilters===!0&&(Le(le,dm),Le(se,mm),Le(se,bl)),ue.mathMl===!0&&(Le(le,um),Le(se,Ny),Le(se,bl))),D.ADD_TAGS&&(le===G&&(le=is(le)),Le(le,D.ADD_TAGS,xt)),D.ADD_ATTR&&(se===A&&(se=is(se)),Le(se,D.ADD_ATTR,xt)),D.ADD_URI_SAFE_ATTR&&Le(xn,D.ADD_URI_SAFE_ATTR,xt),D.FORBID_CONTENTS&&(Fe===Ye&&(Fe=is(Fe)),Le(Fe,D.FORBID_CONTENTS,xt)),qe&&(le["#text"]=!0),Me&&Le(le,["html","head","body"]),le.table&&(Le(le,["tbody"]),delete L.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw La('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw La('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=D.TRUSTED_TYPES_POLICY,E=w.createHTML("")}else w===void 0&&(w=function(ie,he){if(typeof ie!="object"||typeof ie.createPolicy!="function")return null;let ze=null;const Je="data-tt-policy-suffix";he&&he.hasAttribute(Je)&&(ze=he.getAttribute(Je));const nt="dompurify"+(ze?"#"+ze:"");try{return ie.createPolicy(nt,{createHTML:tt=>tt,createScriptURL:tt=>tt})}catch{return console.warn("TrustedTypes policy "+nt+" could not be created."),null}}(g,r)),w!==null&&typeof E=="string"&&(E=w.createHTML(""));Qt&&Qt(D),zt=D}},Uk=Le({},["mi","mo","mn","ms","mtext"]),zk=Le({},["foreignobject","desc","title","annotation-xml"]),QB=Le({},["title","style","font","a","script"]),uc=Le({},cm);Le(uc,dm),Le(uc,XR);const Wf=Le({},um);Le(Wf,ZR);const Rr=function(D){Da(n.removed,{element:D});try{D.parentNode.removeChild(D)}catch{D.remove()}},oi=function(D,ie){try{Da(n.removed,{attribute:ie.getAttributeNode(D),from:ie})}catch{Da(n.removed,{attribute:null,from:ie})}if(ie.removeAttribute(D),D==="is"&&!se[D])if(Z||we)try{Rr(ie)}catch{}else try{ie.setAttribute(D,"")}catch{}},jk=function(D){let ie,he;if(no)D="<remove></remove>"+D;else{const nt=KR(D,/^[\r\n\t ]+/);he=nt&&nt[0]}_n==="application/xhtml+xml"&&oo===sn&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");const ze=w?w.createHTML(D):D;if(oo===sn)try{ie=new p().parseFromString(ze,_n)}catch{}if(!ie||!ie.documentElement){ie=k.createDocument(oo,"template",null);try{ie.documentElement.innerHTML=yo?E:ze}catch{}}const Je=ie.body||ie.documentElement;return D&&he&&Je.insertBefore(s.createTextNode(he),Je.childNodes[0]||null),oo===sn?T.call(ie,Me?"html":"body")[0]:Me?ie.documentElement:Je},Hk=function(D){return S.call(D.ownerDocument||D,D,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},mc=function(D){return typeof l=="object"?D instanceof l:D&&typeof D=="object"&&typeof D.nodeType=="number"&&typeof D.nodeName=="string"},Co=function(D,ie,he){x[D]&&qR(x[D],ze=>{ze.call(n,ie,he,zt)})},$k=function(D){let ie;if(Co("beforeSanitizeElements",D,null),(he=D)instanceof m&&(typeof he.nodeName!="string"||typeof he.textContent!="string"||typeof he.removeChild!="function"||!(he.attributes instanceof u)||typeof he.removeAttribute!="function"||typeof he.setAttribute!="function"||typeof he.namespaceURI!="string"||typeof he.insertBefore!="function"||typeof he.hasChildNodes!="function"))return Rr(D),!0;var he;const ze=xt(D.nodeName);if(Co("uponSanitizeElement",D,{tagName:ze,allowedTags:le}),D.hasChildNodes()&&!mc(D.firstElementChild)&&(!mc(D.content)||!mc(D.content.firstElementChild))&&hn(/<[/\w]/g,D.innerHTML)&&hn(/<[/\w]/g,D.textContent))return Rr(D),!0;if(!le[ze]||L[ze]){if(!L[ze]&&qk(ze)&&(O.tagNameCheck instanceof RegExp&&hn(O.tagNameCheck,ze)||O.tagNameCheck instanceof Function&&O.tagNameCheck(ze)))return!1;if(qe&&!Fe[ze]){const Je=y(D)||D.parentNode,nt=v(D)||D.childNodes;if(nt&&Je)for(let tt=nt.length-1;tt>=0;--tt)Je.insertBefore(f(nt[tt],!0),b(D))}return Rr(D),!0}return D instanceof c&&!function(Je){let nt=y(Je);nt&&nt.tagName||(nt={namespaceURI:oo,tagName:"template"});const tt=pl(Je.tagName),lt=pl(nt.tagName);return!!Nr[Je.namespaceURI]&&(Je.namespaceURI===gt?nt.namespaceURI===sn?tt==="svg":nt.namespaceURI===Jt?tt==="svg"&&(lt==="annotation-xml"||Uk[lt]):!!uc[tt]:Je.namespaceURI===Jt?nt.namespaceURI===sn?tt==="math":nt.namespaceURI===gt?tt==="math"&&zk[lt]:!!Wf[tt]:Je.namespaceURI===sn?!(nt.namespaceURI===gt&&!zk[lt])&&!(nt.namespaceURI===Jt&&!Uk[lt])&&!Wf[tt]&&(QB[tt]||!uc[tt]):!(_n!=="application/xhtml+xml"||!Nr[Je.namespaceURI]))}(D)?(Rr(D),!0):ze!=="noscript"&&ze!=="noembed"&&ze!=="noframes"||!hn(/<\/no(script|embed|frames)/i,D.innerHTML)?(xe&&D.nodeType===3&&(ie=D.textContent,ie=Ln(ie,N," "),ie=Ln(ie,B," "),ie=Ln(ie,I," "),D.textContent!==ie&&(Da(n.removed,{element:D.cloneNode()}),D.textContent=ie)),Co("afterSanitizeElements",D,null),!1):(Rr(D),!0)},Vk=function(D,ie,he){if(Ee&&(ie==="id"||ie==="name")&&(he in s||he in Es))return!1;if(!(W&&!F[ie]&&hn(V,ie))){if(!(X&&hn(z,ie))){if(!se[ie]||F[ie]){if(!(qk(D)&&(O.tagNameCheck instanceof RegExp&&hn(O.tagNameCheck,D)||O.tagNameCheck instanceof Function&&O.tagNameCheck(D))&&(O.attributeNameCheck instanceof RegExp&&hn(O.attributeNameCheck,ie)||O.attributeNameCheck instanceof Function&&O.attributeNameCheck(ie))||ie==="is"&&O.allowCustomizedBuiltInElements&&(O.tagNameCheck instanceof RegExp&&hn(O.tagNameCheck,he)||O.tagNameCheck instanceof Function&&O.tagNameCheck(he))))return!1}else if(!xn[ie]){if(!hn(de,Ln(he,ae,""))){if((ie!=="src"&&ie!=="xlink:href"&&ie!=="href"||D==="script"||YR(he,"data:")!==0||!ft[D])&&!(fe&&!hn(te,Ln(he,ae,"")))){if(he)return!1}}}}}return!0},qk=function(D){return D.indexOf("-")>0},Wk=function(D){let ie,he,ze,Je;Co("beforeSanitizeAttributes",D,null);const{attributes:nt}=D;if(!nt)return;const tt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se};for(Je=nt.length;Je--;){ie=nt[Je];const{name:lt,namespaceURI:xs}=ie;he=lt==="value"?ie.value:GR(ie.value);const eP=he;if(ze=xt(lt),tt.attrName=ze,tt.attrValue=he,tt.keepAttr=!0,tt.forceKeepAttr=void 0,Co("uponSanitizeAttribute",D,tt),he=tt.attrValue,tt.forceKeepAttr)continue;if(!tt.keepAttr){oi(lt,D);continue}if(!Ce&&hn(/\/>/i,he)){oi(lt,D);continue}xe&&(he=Ln(he,N," "),he=Ln(he,B," "),he=Ln(he,I," "));const Kk=xt(D.nodeName);if(Vk(Kk,ze,he)){if(!Pe||ze!=="id"&&ze!=="name"||(oi(lt,D),he="user-content-"+he),w&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!xs)switch(g.getAttributeType(Kk,ze)){case"TrustedHTML":he=w.createHTML(he);break;case"TrustedScriptURL":he=w.createScriptURL(he)}if(he!==eP)try{xs?D.setAttributeNS(xs,lt,he):D.setAttribute(lt,he)}catch{oi(lt,D)}}else oi(lt,D)}Co("afterSanitizeAttributes",D,null)},JB=function D(ie){let he;const ze=Hk(ie);for(Co("beforeSanitizeShadowDOM",ie,null);he=ze.nextNode();)Co("uponSanitizeShadowNode",he,null),$k(he)||(he.content instanceof a&&D(he.content),Wk(he));Co("afterSanitizeShadowDOM",ie,null)};return n.sanitize=function(D){let ie,he,ze,Je,nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(yo=!D,yo&&(D="<!-->"),typeof D!="string"&&!mc(D)){if(typeof D.toString!="function")throw La("toString is not a function");if(typeof(D=D.toString())!="string")throw La("dirty is not a string, aborting")}if(!n.isSupported)return D;if(et||ks(nt),n.removed=[],typeof D=="string"&&(Y=!1),Y){if(D.nodeName){const xs=xt(D.nodeName);if(!le[xs]||L[xs])throw La("root node is forbidden and cannot be sanitized in-place")}}else if(D instanceof l)ie=jk("<!---->"),he=ie.ownerDocument.importNode(D,!0),he.nodeType===1&&he.nodeName==="BODY"||he.nodeName==="HTML"?ie=he:ie.appendChild(he);else{if(!Z&&!xe&&!Me&&D.indexOf("<")===-1)return w&&Re?w.createHTML(D):D;if(ie=jk(D),!ie)return Z?null:Re?E:""}ie&&no&&Rr(ie.firstChild);const tt=Hk(Y?D:ie);for(;ze=tt.nextNode();)$k(ze)||(ze.content instanceof a&&JB(ze.content),Wk(ze));if(Y)return D;if(Z){if(we)for(Je=_.call(ie.ownerDocument);ie.firstChild;)Je.appendChild(ie.firstChild);else Je=ie;return(se.shadowroot||se.shadowrootmode)&&(Je=P.call(o,Je,!0)),Je}let lt=Me?ie.outerHTML:ie.innerHTML;return Me&&le["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&hn(Ay,ie.ownerDocument.doctype.name)&&(lt="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+lt),xe&&(lt=Ln(lt,N," "),lt=Ln(lt,B," "),lt=Ln(lt,I," ")),w&&Re?w.createHTML(lt):lt},n.setConfig=function(D){ks(D),et=!0},n.clearConfig=function(){zt=null,et=!1},n.isValidAttribute=function(D,ie,he){zt||ks({});const ze=xt(D),Je=xt(ie);return Vk(ze,Je,he)},n.addHook=function(D,ie){typeof ie=="function"&&(x[D]=x[D]||[],Da(x[D],ie))},n.removeHook=function(D){if(x[D])return WR(x[D])},n.removeHooks=function(D){x[D]&&(x[D]=[])},n.removeAllHooks=function(){x={}},n}();const By=$.each,aA=$.trim,iA=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],lA={ftp:21,http:80,https:443,mailto:25},cA=["img","video"],Py=(e,t,n)=>{const o=(r=>{try{return decodeURIComponent(r)}catch{return unescape(r)}})(t).replace(/\s/g,"");return!e.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(o)||!e.allow_html_data_urls&&(/^data:image\//i.test(o)?((r,s)=>q(r)?!r:!q(s)||!Ue(cA,s))(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(o):/^data:/i.test(o)))};class kn{static parseDataUri(t){let n;const o=decodeURIComponent(t).split(","),r=/data:([^;]+)/.exec(o[0]);return r&&(n=r[1]),{type:n,data:o[1]}}static isDomSafe(t,n,o={}){if(o.allow_script_urls)return!0;{const r=So.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!Py(o,r,n)}}static getDocumentBaseUrl(t){var n;let o;return o=t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?(n=t.href)!==null&&n!==void 0?n:"":t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/")),o}constructor(t,n={}){this.path="",this.directory="",t=aA(t),this.settings=n;const o=n.base_uri,r=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))return void(r.source=t);const s=t.indexOf("//")===0;if(t.indexOf("/")!==0||s||(t=(o&&o.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=o?o.path:new kn(document.location.href).directory;if((o==null?void 0:o.protocol)==="")t="//mce_host"+r.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(o&&o.protocol||"http")+"://mce_host"+r.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&By(iA,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),r[i]=c}),o&&(r.protocol||(r.protocol=o.protocol),r.userInfo||(r.userInfo=o.userInfo),r.port||r.host!=="mce_host"||(r.port=o.port),r.host&&r.host!=="mce_host"||(r.host=o.host),r.source=""),s&&(r.protocol="")}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new kn(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const o=this.getURI(),r=n.getURI();if(o===r||o.charAt(o.length-1)==="/"&&o.substr(0,o.length-1)===r)return o;let s=this.toRelPath(this.path,n.path);return n.query&&(s+="?"+n.query),n.anchor&&(s+="#"+n.anchor),s}toAbsolute(t,n){const o=new kn(t,{base_uri:this});return o.getURI(n&&this.isSameOrigin(o))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?lA[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let o,r,s=0,a="";const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(o=0,r=i.length;o<r;o++)if(o>=l.length||i[o]!==l[o]){s=o+1;break}}if(i.length<l.length){for(o=0,r=l.length;o<r;o++)if(o>=i.length||i[o]!==l[o]){s=o+1;break}}if(s===1)return n;for(o=0,r=i.length-(s-1);o<r;o++)a+="../";for(o=s-1,r=l.length;o<r;o++)a+=o!==s-1?"/"+l[o]:l[o];return a}toAbsPath(t,n){let o=0;const r=/\/$/.test(n)?"/":"",s=t.split("/"),a=n.split("/"),i=[];By(s,u=>{u&&i.push(u)});const l=[];for(let u=a.length-1;u>=0;u--)a[u].length!==0&&a[u]!=="."&&(a[u]!==".."?o>0?o--:l.push(a[u]):o++);const c=i.length-o;let d;return d=c<=0?Ts(l).join("/"):i.slice(0,c).join("/")+"/"+Ts(l).join("/"),d.indexOf("/")!==0&&(d="/"+d),r&&d.lastIndexOf("/")!==d.length-1&&(d+=r),d}getURI(t=!1){let n;return this.source&&!t||(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const dA=$.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),fm="data-mce-type";let Dy=0;const Ly=(e,t,n,o,r)=>{var s,a,i,l;const c=t.validate,d=n.getSpecialElements();e.nodeType===8&&!t.allow_conditional_comments&&/^\[if/i.test((s=e.nodeValue)!==null&&s!==void 0?s:"")&&(e.nodeValue=" "+e.nodeValue);const u=(a=r==null?void 0:r.tagName)!==null&&a!==void 0?a:e.nodeName.toLowerCase();if(o!=="html"&&n.isValid(o))return void(q(r)&&(r.allowedTags[u]=!0));if(e.nodeType!==1||u==="body")return;const m=R(e),p=Is(m,fm),g=nn(m,"data-mce-bogus");if(!p&&Q(g))return void(g==="all"?Ze(m):xo(m));const h=n.getElementRule(u);if(!c||h){if(q(r)&&(r.allowedTags[u]=!0),c&&h&&!p){if(U((i=h.attributesForced)!==null&&i!==void 0?i:[],f=>{_t(m,f.name,f.value==="{$uid}"?"mce_"+Dy++:f.value)}),U((l=h.attributesDefault)!==null&&l!==void 0?l:[],f=>{Is(m,f.name)||_t(m,f.name,f.value==="{$uid}"?"mce_"+Dy++:f.value)}),h.attributesRequired&&!it(h.attributesRequired,f=>Is(m,f))||h.removeEmptyAttrs&&(f=>{const b=f.dom.attributes;return b==null||b.length===0})(m))return void xo(m);h.outputName&&h.outputName!==u&&((f,b)=>{const v=((w,E)=>{const k=vt(E),S=xg(w);return so(k,S),k})(f,b);uo(f,v);const y=Ot(f);Xo(v,y),Ze(f)})(m,h.outputName)}}else ke(d,u)?Ze(m):xo(m)},My=(e,t,n,o,r,s)=>n!=="html"&&!Jo(o)||!(r in dA&&Py(e,s,o))&&(!e.validate||t.isValid(o,r)||ht(r,"data-")||ht(r,"aria-")),Iy=(e,t)=>e.hasAttribute(fm)&&(t==="id"||t==="class"||t==="style"),Fy=(e,t)=>e in t.getBoolAttrs(),uA=(e,t,n,o)=>{const{attributes:r}=e;for(let s=r.length-1;s>=0;s--){const a=r[s],i=a.name,l=a.value;My(t,n,o,e.tagName.toLowerCase(),i,l)||Iy(e,i)?Fy(i,n)&&e.setAttribute(i,i):e.removeAttribute(i)}},mA=(e,t,n)=>{const o=Oy();return o.addHook("uponSanitizeElement",(r,s)=>{Ly(r,e,t,n.track(r),s)}),o.addHook("uponSanitizeAttribute",(r,s)=>{((a,i,l,c,d)=>{const u=a.tagName.toLowerCase(),{attrName:m,attrValue:p}=d;d.keepAttr=My(i,l,c,u,m,p),d.keepAttr?(d.allowedAttributes[m]=!0,Fy(m,l)&&(d.attrValue=m),i.allow_svg_data_urls&&ht(p,"data:image/svg+xml")&&(d.forceKeepAttr=!0)):Iy(a,m)&&(d.forceKeepAttr=!0)})(r,e,t,n.current(),s)}),o},fA=e=>{const t=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(o=>`xlink:${o}`),n={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:t};return Oy().sanitize(e,n),e.innerHTML},Uy=$.makeMap,zy=$.extend,jy=(e,t,n,o)=>{const r=e.name,s=r in n&&r!=="title"&&r!=="textarea",a=t.childNodes;for(let i=0,l=a.length;i<l;i++){const c=a[i],d=new Ft(c.nodeName.toLowerCase(),c.nodeType);if(re(c)){const u=c.attributes;for(let m=0,p=u.length;m<p;m++){const g=u[m];d.attr(g.name,g.value)}Jo(d.name)&&(o(c),d.value=c.innerHTML)}else j(c)?(d.value=c.data,s&&(d.raw=!0)):(_o(c)||Zx(c)||Qx(c))&&(d.value=c.data);Jo(d.name)||jy(d,c,n,o),e.append(d)}},ls=(e={},t=No())=>{const n=gy(),o=gy(),r={validate:!0,root_name:"body",sanitize:!0,...e},s=new DOMParser,a=((h,f)=>{const b=(()=>{let v=[];const y=()=>v[v.length-1];return{track:w=>{Vc(w)&&v.push(w);let E=y();return E&&!E.contains(w)&&(v.pop(),E=y()),sp(E)},current:()=>sp(y()),reset:()=>{v=[]}}})();if(h.sanitize){const v=mA(h,f,b);return{sanitizeHtmlElement:(w,E)=>{v.sanitize(w,((k,S)=>{const _={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]};return _.PARSER_MEDIA_TYPE=S,k.allow_script_urls?_.ALLOWED_URI_REGEXP=/.*/:k.allow_html_data_urls&&(_.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),_})(h,E)),v.removed=[],b.reset()},sanitizeNamespaceElement:fA}}return{sanitizeHtmlElement:(v,y)=>{const w=document.createNodeIterator(v,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let E;for(;E=w.nextNode();){const k=b.track(E);Ly(E,h,f,k),re(E)&&uA(E,h,f,k)}b.reset()},sanitizeNamespaceElement:Ne}})(r,t),i=n.addFilter,l=n.getFilters,c=n.removeFilter,d=o.addFilter,u=o.getFilters,m=o.removeFilter,p=(h,f)=>{const b=Q(f.attr(fm)),v=f.type===1&&!ke(h,f.name)&&!Xc(t,f)&&!Jo(f.name);return f.type===3||v&&!b},g={schema:t,addAttributeFilter:d,getAttributeFilters:u,removeAttributeFilter:m,addNodeFilter:i,getNodeFilters:l,removeNodeFilter:c,parse:(h,f={})=>{var b;const v=r.validate,y=(b=f.context)!==null&&b!==void 0?b:r.root_name,w=((B,I,V="html")=>{const z=V==="xhtml"?"application/xhtml+xml":"text/html",te=ke(t.getSpecialElements(),I.toLowerCase()),ae=te?`<${I}>${B}</${I}>`:B,de=V==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${ae}</body></html>`:`<body>${ae}</body>`,le=s.parseFromString(de,z).body;return a.sanitizeHtmlElement(le,z),te?le.firstChild:le})(h,y,f.format);Wc(t,w);const E=new Ft(y,11);jy(E,w,t.getSpecialElements(),a.sanitizeNamespaceElement),w.innerHTML="";const[k,S]=((B,I,V,z)=>{const te=V.validate,ae=I.getNonEmptyElements(),de=I.getWhitespaceElements(),le=zy(Uy("script,style,head,html,body,title,meta,param"),I.getBlockElements()),G=_p(I),se=/[ \t\r\n]+/g,A=/^[ \t\r\n]+/,O=/[ \t\r\n]+$/,L=W=>{let fe=W.parent;for(;q(fe);){if(fe.name in de)return!0;fe=fe.parent}return!1},F=W=>W.name in le||Xc(I,W)||Jo(W.name)&&W.parent===B,X=(W,fe)=>{const Ce=fe?W.prev:W.next;return!q(Ce)&&!at(W.parent)&&F(W.parent)&&(W.parent!==B||z.isRootContent===!0)};return[W=>{var fe;if(W.type===3&&!L(W)){let Ce=(fe=W.value)!==null&&fe!==void 0?fe:"";Ce=Ce.replace(se," "),(((xe,Me)=>q(xe)&&(Me(xe)||xe.name==="br"))(W.prev,F)||X(W,!0))&&(Ce=Ce.replace(A,"")),Ce.length===0?W.remove():W.value=Ce}},W=>{var fe;if(W.type===1){const Ce=I.getElementRule(W.name);if(te&&Ce){const xe=Ta(I,ae,de,W);Ce.paddInEmptyBlock&&xe&&(Me=>{let et=Me;for(;q(et);){if(et.name in G)return Ta(I,ae,de,et);et=et.parent}return!1})(W)?Fu(V,z,F,W):Ce.removeEmpty&&xe?F(W)?W.remove():W.unwrap():Ce.paddEmpty&&(xe||(Me=>{var et;return S0(Me,"#text")&&((et=Me==null?void 0:Me.firstChild)===null||et===void 0?void 0:et.value)===Ct})(W))&&Fu(V,z,F,W)}}else if(W.type===3&&!L(W)){let Ce=(fe=W.value)!==null&&fe!==void 0?fe:"";(W.next&&F(W.next)||X(W,!1))&&(Ce=Ce.replace(O,"")),Ce.length===0?W.remove():W.value=Ce}}]})(E,t,r,f),_=[],T=v?B=>((I,V)=>{ju(t,I)&&V.push(I)})(B,_):Ne,P={nodes:{},attributes:{}},x=B=>k0(l(),u(),B,P);if(((B,I,V)=>{const z=[];for(let te=B,ae=te;te;ae=te,te=te.walk()){const de=te;U(I,le=>le(de)),at(de.parent)&&de!==B?te=ae:z.push(de)}for(let te=z.length-1;te>=0;te--){const ae=z[te];U(V,de=>de(ae))}})(E,[k,x],[S,T]),_.reverse(),v&&_.length>0)if(f.context){const{pass:B,fail:I}=Tr(_,V=>V.parent===E);zu(I,t,E,x),f.invalid=B.length>0}else zu(_,t,E,x);const N=((B,I)=>{var V;const z=(V=I.forced_root_block)!==null&&V!==void 0?V:B.forced_root_block;return z===!1?"":z===!0?"p":z})(r,f);return N&&(E.name==="body"||f.isRootContent)&&((B,I)=>{const V=zy(Uy("script,style,head,html,body,title,meta,param"),t.getBlockElements()),z=/^[ \t\r\n]+/,te=/[ \t\r\n]+$/;let ae=B.firstChild,de=null;const le=G=>{var se,A;G&&(ae=G.firstChild,ae&&ae.type===3&&(ae.value=(se=ae.value)===null||se===void 0?void 0:se.replace(z,"")),ae=G.lastChild,ae&&ae.type===3&&(ae.value=(A=ae.value)===null||A===void 0?void 0:A.replace(te,"")))};if(t.isValidChild(B.name,I.toLowerCase())){for(;ae;){const G=ae.next;p(V,ae)?(de||(de=new Ft(I,1),de.attr(r.forced_root_block_attrs),B.insert(de,ae)),de.append(ae)):(le(de),de=null),ae=G}le(de)}})(E,N),f.invalid||x0(P,f),E}};return((h,f)=>{var b,v;const y=h.schema;h.addAttributeFilter("href",S=>{let _=S.length;const T=P=>{const x=P?$.trim(P):"";return/\b(noopener)\b/g.test(x)?x:(N=>N.split(" ").filter(B=>B.length>0).concat(["noopener"]).sort().join(" "))(x)};if(!f.allow_unsafe_link_target)for(;_--;){const P=S[_];P.name==="a"&&P.attr("target")==="_blank"&&P.attr("rel",T(P.attr("rel")))}}),f.allow_html_in_named_anchor||h.addAttributeFilter("id,name",S=>{let _,T,P,x,N=S.length;for(;N--;)if(x=S[N],x.name==="a"&&x.firstChild&&!x.attr("href"))for(P=x.parent,_=x.lastChild;_&&P;)T=_.prev,P.insert(_,x),_=T}),f.fix_list_elements&&h.addNodeFilter("ul,ol",S=>{let _,T,P=S.length;for(;P--;)if(_=S[P],T=_.parent,T&&(T.name==="ul"||T.name==="ol"))if(_.prev&&_.prev.name==="li")_.prev.append(_);else{const x=new Ft("li",1);x.attr("style","list-style-type: none"),_.wrap(x)}});const w=y.getValidClasses();f.validate&&w&&h.addAttributeFilter("class",S=>{var _;let T=S.length;for(;T--;){const P=S[T],x=(_=P.attr("class"))!==null&&_!==void 0?_:"",N=$.explode(x," ");let B="";for(let I=0;I<N.length;I++){const V=N[I];let z=!1,te=w["*"];te&&te[V]&&(z=!0),te=w[P.name],!z&&te&&te[V]&&(z=!0),z&&(B&&(B+=" "),B+=V)}B.length||(B=null),P.attr("class",B)}}),((S,_)=>{const{blob_cache:T}=_;if(T){const P=x=>{const N=x.attr("src");(B=>B.attr("src")===Be.transparentSrc||q(B.attr("data-mce-placeholder")))(x)||(B=>q(B.attr("data-mce-bogus")))(x)||at(N)||yy(T,N,!0).each(B=>{x.attr("src",B.blobUri())})};S.addAttributeFilter("src",x=>U(x,P))}})(h,f);const E=(b=f.sandbox_iframes)!==null&&b!==void 0&&b,k=sg((v=f.sandbox_iframes_exclusions)!==null&&v!==void 0?v:[]);f.convert_unsafe_embeds&&h.addNodeFilter("object,embed",S=>U(S,_=>{_.replace((({type:T,src:P,width:x,height:N}={},B,I)=>{const V=(te=>st(te)?"iframe":sm(te,"image")?"img":sm(te,"video")?"video":sm(te,"audio")?"audio":"iframe")(T),z=new Ft(V,1);return z.attr(V==="audio"?{src:P}:{src:P,width:x,height:N}),V!=="audio"&&V!=="video"||z.attr("controls",""),V==="iframe"&&B&&Cy(z,I),z})({type:_.attr("type"),src:_.name==="object"?_.attr("data"):_.attr("src"),width:_.attr("width"),height:_.attr("height")},E,k))})),E&&h.addNodeFilter("iframe",S=>U(S,_=>Cy(_,k)))})(g,r),((h,f,b)=>{f.inline_styles&&IR(h,f,b)})(g,r,t),g},Hy=(e,t,n)=>{const o=(s=>ul(s)?Lo({validate:!1}).serialize(s):s)(e),r=t(o);if(r.isDefaultPrevented())return r;if(ul(e)){if(r.content!==o){const s=ls({validate:!1,forced_root_block:!1,...n}).parse(r.content,{context:e.name});return{...r,content:s}}return{...r,content:e}}return r},$y=e=>({sanitize:Uh(e),sandbox_iframes:jh(e),sandbox_iframes_exclusions:Td(e)}),Vy=(e,t)=>{if(t.no_events)return $t.value(t);{const n=((o,r)=>o.dispatch("BeforeGetContent",r))(e,t);return n.isDefaultPrevented()?$t.error(jb(e,{content:"",...n}).content):$t.value(n)}},qy=(e,t,n)=>n.no_events?t:Hy(t,r=>jb(e,{...n,content:r}),$y(e)).content,gm=(e,t)=>{if(t.no_events)return $t.value(t);{const n=Hy(t.content,o=>((r,s)=>r.dispatch("BeforeSetContent",s))(e,{...t,content:o}),$y(e));return n.isDefaultPrevented()?(zb(e,n),$t.error(void 0)):$t.value(n)}},pm=(e,t,n)=>{n.no_events||zb(e,{...n,content:t})},hm=(e,t,n)=>({element:e,width:t,rows:n}),Wy=(e,t)=>({element:e,cells:t}),gA=(e,t)=>({x:e,y:t}),Ky=(e,t)=>ao(e,t).bind(ci).getOr(1),pA=(e,t,n)=>{const o=e.rows;return!!(o[n]?o[n].cells:[])[t]},Yy=e=>Yt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),Gy=(e,t)=>{const n=e.rows;for(let o=0;o<n.length;o++){const r=n[o].cells;for(let s=0;s<r.length;s++)if(De(r[s],t))return C.some(gA(s,o))}return C.none()},Xy=(e,t,n,o,r)=>{const s=[],a=e.rows;for(let i=n;i<=r;i++){const l=a[i].cells,c=t<o?l.slice(t,o+1):l.slice(o,t+1);s.push(Wy(a[i].element,c))}return s},hA=e=>((t,n)=>{const o=rr(t.element),r=vt("tbody");return Xo(r,n),ut(o,r),o})(e,(t=>Te(t.rows,n=>{const o=Te(n.cells,s=>{const a=jp(s);return St(a,"colspan"),St(a,"rowspan"),a}),r=rr(n.element);return Xo(r,o),r}))(e)),bA=(e,t,n)=>{const o=R(t.commonAncestorContainer),r=ho(o,e),s=ye(r,l=>n.isWrapper(Oe(l))),a=((l,c)=>pt(l,d=>Oe(d)==="li"&&Hd(d,c)).fold(oe([]),d=>(u=>pt(u,m=>Oe(m)==="ul"||Oe(m)==="ol"))(l).map(u=>{const m=vt(Oe(u)),p=Ps(Dc(u),(g,h)=>ht(h,"list-style"));return hi(m,p),[vt("li"),m]}).getOr([])))(r,t),i=s.concat(a.length?a:(l=>ra(l)?Rn(l).filter(md).fold(oe([]),c=>[l,c]):md(l)?[l]:[])(o));return Te(i,rr)},Zy=()=>ou([]),vA=(e,t)=>((n,o)=>$s(o,"table",ne(De,n)))(e,t[0]).bind(n=>{const o=t[0],r=t[t.length-1],s=(a=>{const i=hm(rr(a),0,[]);return U(Bt(a,"tr"),(l,c)=>{U(Bt(l,"td,th"),(d,u)=>{((m,p,g,h,f)=>{const b=Ky(f,"rowspan"),v=Ky(f,"colspan"),y=m.rows;for(let w=g;w<g+b;w++){y[w]||(y[w]=Wy(jp(h),[]));for(let E=p;E<p+v;E++)y[w].cells[E]=w===g&&E===p?f:rr(f)}})(i,((m,p,g)=>{for(;pA(m,p,g);)p++;return p})(i,u,c),c,l,d)})}),hm(i.element,Yy(i.rows),i.rows)})(n);return((a,i,l)=>Gy(a,i).bind(c=>Gy(a,l).map(d=>((u,m,p)=>{const g=m.x,h=m.y,f=p.x,b=p.y,v=h<b?Xy(u,g,h,f,b):Xy(u,g,b,f,h);return hm(u.element,Yy(v),v)})(a,c,d))))(s,o,r).map(a=>ou([hA(a)]))}).getOrThunk(Zy),yA=(e,t,n)=>{const o=hb(t,e);return o.length>0?vA(e,o):((r,s,a)=>s.length>0&&s[0].collapsed?Zy():((i,l,c)=>((d,u)=>{const m=Yt(u,(p,g)=>(ut(g,p),g),d);return u.length>0?ou([m]):m})(R(l.cloneContents()),bA(i,l,c)))(r,s[0],a))(e,t,n)},vl=(e,t)=>t>=0&&t<e.length&&ts(e.charAt(t)),Qy=e=>on(e.innerText),Jy=e=>re(e)?e.outerHTML:j(e)?So.encodeRaw(e.data,!1):_o(e)?"<!--"+e.data+"-->":"",CA=(e,t)=>(((n,o)=>{let r=0;U(n,s=>{s[0]===0?r++:s[0]===1?(((a,i,l)=>{const c=(d=>{let u;const m=document.createElement("div"),p=document.createDocumentFragment();for(d&&(m.innerHTML=d);u=m.firstChild;)p.appendChild(u);return p})(i);if(a.hasChildNodes()&&l<a.childNodes.length){const d=a.childNodes[l];a.insertBefore(c,d)}else a.appendChild(c)})(o,s[1],r),r++):s[0]===2&&((a,i)=>{if(a.hasChildNodes()&&i<a.childNodes.length){const l=a.childNodes[i];a.removeChild(l)}})(o,r)})})(((n,o)=>{const r=n.length+o.length+2,s=new Array(r),a=new Array(r),i=(u,m,p,g,h)=>{const f=c(u,m,p,g);if(f===null||f.start===m&&f.diag===m-g||f.end===u&&f.diag===u-p){let b=u,v=p;for(;b<m||v<g;)b<m&&v<g&&n[b]===o[v]?(h.push([0,n[b]]),++b,++v):m-u>g-p?(h.push([2,n[b]]),++b):(h.push([1,o[v]]),++v)}else{i(u,f.start,p,f.start-f.diag,h);for(let b=f.start;b<f.end;++b)h.push([0,n[b]]);i(f.end,m,f.end-f.diag,g,h)}},l=(u,m,p,g)=>{let h=u;for(;h-m<g&&h<p&&n[h]===o[h-m];)++h;return((f,b,v)=>({start:f,end:b,diag:v}))(u,h,m)},c=(u,m,p,g)=>{const h=m-u,f=g-p;if(h===0||f===0)return null;const b=h-f,v=f+h,y=(v%2==0?v:v+1)/2;let w,E,k,S,_;for(s[1+y]=u,a[1+y]=m+1,w=0;w<=y;++w){for(E=-w;E<=w;E+=2){for(k=E+y,E===-w||E!==w&&s[k-1]<s[k+1]?s[k]=s[k+1]:s[k]=s[k-1]+1,S=s[k],_=S-u+p-E;S<m&&_<g&&n[S]===o[_];)s[k]=++S,++_;if(b%2!=0&&b-w<=E&&E<=b+w&&a[k-b]<=s[k])return l(a[k-b],E+u-p,m,g)}for(E=b-w;E<=b+w;E+=2){for(k=E+y-b,E===b-w||E!==b+w&&a[k+1]<=a[k-1]?a[k]=a[k+1]-1:a[k]=a[k-1],S=a[k]-1,_=S-u+p-E;S>=u&&_>=p&&n[S]===o[_];)a[k]=S--,_--;if(b%2==0&&-w<=E&&E<=w&&a[k]<=s[k+b])return l(a[k],E+u-p,m,g)}}return null},d=[];return i(0,n.length,0,o.length,d),d})(Te(en(t.childNodes),Jy),e),t),t),wA=Fn(()=>document.implementation.createHTMLDocument("undo")),yl=e=>{const t=e.serializer.getTempAttrs(),n=Nv(e.getBody(),t);return(o=>o.querySelector("iframe")!==null)(n)?{type:"fragmented",fragments:ye(Te(en(n.childNodes),In(on,Jy)),o=>o.length>0),content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:on(n.innerHTML),bookmark:null,beforeBookmark:null}},bm=(e,t,n)=>{const o=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?CA(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!q(o)||!db(o)||!o.isFakeCaret}),o&&(e.selection.moveToBookmark(o),e.selection.scrollIntoView())},vm=e=>e.type==="fragmented"?e.fragments.join(""):e.content,eC=e=>{const t=vt("body",wA());return vi(t,vm(e)),U(Bt(t,"*[data-mce-bogus]"),xo),Vg(t)},ym=(e,t)=>!(!e||!t)&&(!!((n,o)=>vm(n)===vm(o))(e,t)||((n,o)=>eC(n)===eC(o))(e,t)),Cm=e=>e.get()===0,Cl=(e,t,n)=>{Cm(n)&&(e.typing=t)},tC=(e,t)=>{e.typing&&(Cl(e,!1,t),e.add())},nC=e=>({init:{bindEvents:Ne},undoManager:{beforeChange:(t,n)=>((o,r,s)=>{Cm(r)&&s.set(xd(o.selection))})(e,t,n),add:(t,n,o,r,s,a)=>((i,l,c,d,u,m,p)=>{const g=yl(i),h=$.extend(m||{},g);if(!Cm(d)||i.removed)return null;const f=l.data[c.get()];if(i.dispatch("BeforeAddUndo",{level:h,lastLevel:f,originalEvent:p}).isDefaultPrevented()||f&&ym(f,h))return null;l.data[c.get()]&&u.get().each(y=>{l.data[c.get()].beforeBookmark=y});const b=SS(i);if(b&&l.data.length>b){for(let y=0;y<l.data.length-1;y++)l.data[y]=l.data[y+1];l.data.length--,c.set(l.data.length)}h.bookmark=xd(i.selection),c.get()<l.data.length-1&&(l.data.length=c.get()+1),l.data.push(h),c.set(l.data.length-1);const v={level:h,lastLevel:f,originalEvent:p};return c.get()>0?(i.setDirty(!0),i.dispatch("AddUndo",v),i.dispatch("change",v)):i.dispatch("AddUndo",v),h})(e,t,n,o,r,s,a),undo:(t,n,o)=>((r,s,a,i)=>{let l;return s.typing&&(s.add(),s.typing=!1,Cl(s,!1,a)),i.get()>0&&(i.set(i.get()-1),l=s.data[i.get()],bm(r,l,!0),r.setDirty(!0),r.dispatch("Undo",{level:l})),l})(e,t,n,o),redo:(t,n)=>((o,r,s)=>{let a;return r.get()<s.length-1&&(r.set(r.get()+1),a=s[r.get()],bm(o,a,!1),o.setDirty(!0),o.dispatch("Redo",{level:a})),a})(e,t,n),clear:(t,n)=>((o,r,s)=>{r.data=[],s.set(0),r.typing=!1,o.dispatch("ClearUndos")})(e,t,n),reset:t=>(n=>{n.clear(),n.add()})(t),hasUndo:(t,n)=>((o,r,s)=>s.get()>0||r.typing&&r.data[0]&&!ym(yl(o),r.data[0]))(e,t,n),hasRedo:(t,n)=>((o,r)=>r.get()<o.data.length-1&&!o.typing)(t,n),transact:(t,n,o)=>((r,s,a)=>(tC(r,s),r.beforeChange(),r.ignore(a),r.add()))(t,n,o),ignore:(t,n)=>((o,r)=>{try{o.set(o.get()+1),r()}finally{o.set(o.get()-1)}})(t,n),extra:(t,n,o,r)=>((s,a,i,l,c)=>{if(a.transact(l)){const d=a.data[i.get()].bookmark,u=a.data[i.get()-1];bm(s,u,!0),a.transact(c)&&(a.data[i.get()-1].beforeBookmark=d)}})(e,t,n,o,r)},formatter:{match:(t,n,o,r)=>Gu(e,t,n,o,r),matchAll:(t,n)=>((o,r,s)=>{const a=[],i={},l=o.selection.getStart();return o.dom.getParent(l,c=>{for(let d=0;d<r.length;d++){const u=r[d];!i[u]&&Zn(o,c,u,s)&&(i[u]=!0,a.push(u))}},o.dom.getRoot()),a})(e,t,n),matchNode:(t,n,o,r)=>Zn(e,t,n,o,r),canApply:t=>((n,o)=>{const r=n.formatter.get(o),s=n.dom;if(r&&n.selection.isEditable()){const a=n.selection.getStart(),i=Gi(s,a);for(let l=r.length-1;l>=0;l--){const c=r[l];if(!fn(c))return!0;for(let d=i.length-1;d>=0;d--)if(s.is(i[d],c.selector))return!0}}return!1})(e,t),closest:t=>((n,o)=>{const r=s=>De(s,R(n.getBody()));return C.from(n.selection.getStart(!0)).bind(s=>Wu(R(s),a=>Or(o,i=>((l,c)=>Zn(n,l.dom,c)?C.some(c):C.none())(a,i)),r)).getOrNull()})(e,t),apply:(t,n,o)=>iy(e,t,n,o),remove:(t,n,o,r)=>ry(e,t,n,o,r),toggle:(t,n,o)=>((r,s,a,i)=>{const l=r.formatter.get(s);l&&(!Gu(r,s,a,i)||"toggle"in l[0]&&!l[0].toggle?iy(r,s,a,i):ry(r,s,a,i))})(e,t,n,o),formatChanged:(t,n,o,r,s)=>((a,i,l,c,d,u)=>(((m,p,g,h,f,b)=>{const v=p.get();U(g.split(","),y=>{const w=Xe(v,y).getOrThunk(()=>{const k={withSimilar:{state:wt(!1),similar:!0,callbacks:[]},withoutSimilar:{state:wt(!1),similar:!1,callbacks:[]},withVars:[]};return v[y]=k,k}),E=()=>{const k=uy(m);return dy(m,k,y,f,b).isSome()};if(st(b)){const k=f?w.withSimilar:w.withoutSimilar;k.callbacks.push(h),k.callbacks.length===1&&k.state.set(E())}else w.withVars.push({state:wt(E()),similar:f,vars:b,callback:h})}),p.set(v)})(a,i,l,c,d,u),{unbind:()=>((m,p,g)=>{const h=m.get();U(p.split(","),f=>Xe(h,f).each(b=>{h[f]={withSimilar:{...b.withSimilar,callbacks:ye(b.withSimilar.callbacks,v=>v!==g)},withoutSimilar:{...b.withoutSimilar,callbacks:ye(b.withoutSimilar.callbacks,v=>v!==g)},withVars:ye(b.withVars,v=>v.callback!==g)}})),m.set(h)})(i,l,c)}))(e,t,n,o,r,s)},editor:{getContent:t=>((n,o)=>C.from(n.getBody()).fold(oe(o.format==="tree"?new Ft("body",11):""),r=>sR(n,o,r)))(e,t),setContent:(t,n)=>((o,r,s)=>C.from(o.getBody()).map(a=>ul(r)?((i,l,c,d)=>{_0(i.parser.getNodeFilters(),i.parser.getAttributeFilters(),c);const u=Lo({validate:!1},i.schema).serialize(c),m=on(Ti(R(l))?u:$.trim(u));return qu(i,m,d.no_selection),{content:c,html:m}})(o,a,r,s):((i,l,c,d)=>{if((c=on(c)).length===0||/^\s+$/.test(c)){const u='<br data-mce-bogus="1">';l.nodeName==="TABLE"?c="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(l.nodeName)&&(c="<li>"+u+"</li>");const m=Dt(i);return i.schema.isValidChild(l.nodeName.toLowerCase(),m.toLowerCase())?(c=u,c=i.dom.createHTML(m,ua(i),c)):c||(c=u),qu(i,c,d.no_selection),{content:c,html:c}}{d.format!=="raw"&&(c=Lo({validate:!1},i.schema).serialize(i.parser.parse(c,{isRootContent:!0,insert:!0})));const u=Ti(R(l))?c:$.trim(c);return qu(i,u,d.no_selection),{content:u,html:u}}})(o,a,r,s)).getOr({content:r,html:ul(s.content)?"":s.content}))(e,t,n),insertContent:(t,n)=>BR(e,t,n),addVisual:t=>((n,o)=>{const r=n.dom,s=q(o)?o:n.getBody();U(r.select("table,a",s),a=>{switch(a.nodeName){case"TABLE":const i=BS(n),l=r.getAttrib(a,"border");l&&l!=="0"||!n.hasVisual?r.removeClass(a,i):r.addClass(a,i);break;case"A":if(!r.getAttrib(a,"href")){const c=r.getAttrib(a,"name")||a.id,d=Ih(n);c&&n.hasVisual?r.addClass(a,d):r.removeClass(a,d)}}}),n.dispatch("VisualAid",{element:o,hasVisual:n.hasVisual})})(e,t)},selection:{getContent:(t,n)=>((o,r,s={})=>{const a=((i,l)=>({...i,format:l,get:!0,selection:!0,getInner:!0}))(s,r);return Vy(o,a).fold(jt,i=>{const l=((c,d)=>{if(d.format==="text")return(u=>C.from(u.selection.getRng()).map(m=>{var p;const g=C.from(u.dom.getParent(m.commonAncestorContainer,u.dom.isBlock)),h=u.getBody(),f=(E=>E.map(k=>k.nodeName).getOr("div").toLowerCase())(g),b=R(m.cloneContents());Rv(b),Av(b);const v=u.dom.add(h,f,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},b.dom),y=Qy(v),w=on((p=v.textContent)!==null&&p!==void 0?p:"");if(u.dom.remove(v),vl(w,0)||vl(w,w.length-1)){const E=g.getOr(h),k=Qy(E),S=k.indexOf(y);return S===-1?y:(vl(k,S-1)?" ":"")+y+(vl(k,S+y.length)?" ":"")}return y}).getOr(""))(c);{const u=((m,p)=>{const g=m.selection.getRng(),h=m.dom.create("body"),f=m.selection.getSel(),b=pu(m,zd(f)),v=p.contextual?yA(R(m.getBody()),b,m.schema).dom:g.cloneContents();return v&&h.appendChild(v),m.selection.serializer.serialize(h,p)})(c,d);return d.format==="tree"?u:c.selection.isCollapsed()?"":u}})(o,i);return qy(o,l,i)})})(e,t,n)},autocompleter:{addDecoration:Ne,removeDecoration:Ne},raw:{getModel:()=>C.none()}}),Qn=e=>ke(e.plugins,"rtc"),wm=e=>e.rtcInstance?e.rtcInstance:nC(e),mt=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},oC=e=>mt(e).init.bindEvents(),rC=e=>e.dom.length===0?(Ze(e),C.none()):C.some(e),sC=(e,t,n,o,r)=>{e.bind(s=>((o?_u:il)(s.dom,o?s.dom.length:0,r),t.filter(ln).map(a=>((i,l,c,d,u)=>{const m=i.dom,p=l.dom,g=d?m.length:p.length;d?(Su(m,p,u,!1,!d),c.setStart(p,g)):(Su(p,m,u,!1,!d),c.setEnd(p,g))})(s,a,n,o,r)))).orThunk(()=>((a,i)=>a.filter(l=>Ea.isBookmarkNode(l.dom)).bind(i?Hs:Ko))(t,o).or(t).filter(ln).map(a=>((i,l,c)=>{Rn(i).each(d=>{const u=i.dom;l&&Na(d,M(u,0),c)?il(u,0,c):!l&&Ra(d,M(u,u.length),c)&&_u(u,u.length,c)})})(a,o,r)))},aC=(e,t,n)=>{if(ke(e,t)){const o=ye(e[t],r=>r!==n);o.length===0?delete e[t]:e[t]=o}},iC=e=>!(!e||!e.ownerDocument)&&io(R(e.ownerDocument),R(e)),lC=(e,t,n,o)=>{let r,s;const{selectorChangedWithUnbind:a}=((f,b)=>{let v,y;const w=(k,S)=>pt(S,_=>f.is(_,k)),E=k=>f.getParents(k,void 0,f.getRoot());return{selectorChangedWithUnbind:(k,S)=>(v||(v={},y={},b.on("NodeChange",_=>{const T=_.element,P=E(T),x={};Ke(v,(N,B)=>{w(B,P).each(I=>{y[B]||(U(N,V=>{V(!0,{node:I,selector:B,parents:P})}),y[B]=N),x[B]=N})}),Ke(y,(N,B)=>{x[B]||(delete y[B],U(N,I=>{I(!1,{node:T,selector:B,parents:P})}))})})),v[k]||(v[k]=[]),v[k].push(S),w(k,E(b.selection.getStart())).each(()=>{y[k]=v[k]}),{unbind:()=>{aC(v,k,S),aC(y,k,S)}})}})(e,o),i=(f,b)=>((v,y,w={})=>{const E=((k,S)=>({format:"html",...k,set:!0,selection:!0,content:S}))(w,y);gm(v,E).each(k=>{const S=((T,P)=>{if(P.format!=="raw"){const x=T.selection.getRng(),N=T.dom.getParent(x.commonAncestorContainer,T.dom.isBlock),B=N?{context:N.nodeName.toLowerCase()}:{},I=T.parser.parse(P.content,{forced_root_block:!1,...B,...P});return Lo({validate:!1},T.schema).serialize(I)}return P.content})(v,k),_=v.selection.getRng();((T,P,x)=>{const N=C.from(P.firstChild).map(R),B=C.from(P.lastChild).map(R);T.deleteContents(),T.insertNode(P);const I=N.bind(Ko).filter(ln).bind(rC),V=B.bind(Hs).filter(ln).bind(rC);sC(I,N,T,!0,x),sC(V,B,T,!1,x),T.collapse(!1)})(_,_.createContextualFragment(S),v.schema),v.selection.setRng(_),xa(v,_),pm(v,S,k)})})(o,f,b),l=f=>{const b=d();b.collapse(!!f),u(b)},c=()=>t.getSelection?t.getSelection():t.document.selection,d=()=>{let f;const b=(y,w,E)=>{try{return w.compareBoundaryPoints(y,E)}catch{return-1}},v=t.document;if(q(o.bookmark)&&!pr(o)){const y=cu(o);if(y.isSome())return y.map(w=>pu(o,[w])[0]).getOr(v.createRange())}try{const y=c();y&&!Ci(y.anchorNode)&&(f=y.rangeCount>0?y.getRangeAt(0):v.createRange(),f=pu(o,[f])[0])}catch{}if(f||(f=v.createRange()),Ks(f.startContainer)&&f.collapsed){const y=e.getRoot();f.setStart(y,0),f.setEnd(y,0)}return r&&s&&(b(f.START_TO_START,f,r)===0&&b(f.END_TO_END,f,r)===0?f=s:(r=null,s=null)),f},u=(f,b)=>{if(!(y=>!!y&&iC(y.startContainer)&&iC(y.endContainer))(f))return;const v=c();if(f=o.dispatch("SetSelectionRange",{range:f,forward:b}).range,v){s=f;try{v.removeAllRanges(),v.addRange(f)}catch{}b===!1&&v.extend&&(v.collapse(f.endContainer,f.endOffset),v.extend(f.startContainer,f.startOffset)),r=v.rangeCount>0?v.getRangeAt(0):null}if(!f.collapsed&&f.startContainer===f.endContainer&&(v!=null&&v.setBaseAndExtent)&&f.endOffset-f.startOffset<2&&f.startContainer.hasChildNodes()){const y=f.startContainer.childNodes[f.startOffset];y&&y.nodeName==="IMG"&&(v.setBaseAndExtent(f.startContainer,f.startOffset,f.endContainer,f.endOffset),v.anchorNode===f.startContainer&&v.focusNode===f.endContainer||v.setBaseAndExtent(y,0,y,1))}o.dispatch("AfterSetSelectionRange",{range:f,forward:b})},m=()=>{const f=c(),b=f==null?void 0:f.anchorNode,v=f==null?void 0:f.focusNode;if(!f||!b||!v||Ci(b)||Ci(v))return!0;const y=e.createRng(),w=e.createRng();try{y.setStart(b,f.anchorOffset),y.collapse(!0),w.setStart(v,f.focusOffset),w.collapse(!0)}catch{return!0}return y.compareBoundaryPoints(y.START_TO_START,w)<=0},p={dom:e,win:t,serializer:n,editor:o,expand:(f={type:"word"})=>u(gr(e).expand(d(),f)),collapse:l,setCursorLocation:(f,b)=>{const v=e.createRng();q(f)&&q(b)?(v.setStart(f,b),v.setEnd(f,b),u(v),l(!1)):($d(e,v,o.getBody(),!0),u(v))},getContent:f=>((b,v={})=>((y,w,E)=>mt(y).selection.getContent(w,E))(b,v.format?v.format:"html",v))(o,f),setContent:i,getBookmark:(f,b)=>g.getBookmark(f,b),moveToBookmark:f=>g.moveToBookmark(f),select:(f,b)=>(((v,y,w)=>C.from(y).bind(E=>C.from(E.parentNode).map(k=>{const S=v.nodeIndex(E),_=v.createRng();return _.setStart(k,S),_.setEnd(k,S+1),w&&($d(v,_,E,!0),$d(v,_,E,!1)),_})))(e,f,b).each(u),f),isCollapsed:()=>{const f=d(),b=c();return!(!f||f.item)&&(f.compareEndPoints?f.compareEndPoints("StartToEnd",f)===0:!b||f.collapsed)},isEditable:()=>{const f=d(),b=o.getBody().querySelectorAll('[data-mce-selected="1"]');return b.length>0?wo(b,v=>e.isEditable(v.parentElement)):hv(e,f)},isForward:m,setNode:f=>(i(e.getOuterHTML(f)),f),getNode:()=>((f,b)=>{if(!b)return f;let v=b.startContainer,y=b.endContainer;const w=b.startOffset,E=b.endOffset;let k=b.commonAncestorContainer;b.collapsed||(v===y&&E-w<2&&v.hasChildNodes()&&(k=v.childNodes[w]),j(v)&&j(y)&&(v=v.length===w?Cv(v.nextSibling,!0):v.parentNode,y=E===0?Cv(y.previousSibling,!1):y.parentNode,v&&v===y&&(k=v)));const S=j(k)?k.parentNode:k;return mo(S)?S:f})(o.getBody(),d()),getSel:c,setRng:u,getRng:d,getStart:f=>vv(o.getBody(),d(),f),getEnd:f=>yv(o.getBody(),d(),f),getSelectedBlocks:(f,b)=>((v,y,w,E)=>{const k=[],S=v.getRoot(),_=v.getParent(w||vv(S,y,y.collapsed),v.isBlock),T=v.getParent(E||yv(S,y,y.collapsed),v.isBlock);if(_&&_!==S&&k.push(_),_&&T&&_!==T){let P;const x=new yt(_,S);for(;(P=x.next())&&P!==T;)v.isBlock(P)&&k.push(P)}return T&&_!==T&&T!==S&&k.push(T),k})(e,d(),f,b),normalize:()=>{const f=d(),b=c();if(!(zd(b).length>1)&&Ki(o)){const v=el(e,f);return v.each(y=>{u(y,m())}),v.getOr(f)}return f},selectorChanged:(f,b)=>(a(f,b),p),selectorChangedWithUnbind:a,getScrollContainer:()=>{let f,b=e.getRoot();for(;b&&b.nodeName!=="BODY";){if(b.scrollHeight>b.clientHeight){f=b;break}b=b.parentNode}return f},scrollIntoView:(f,b)=>{q(f)?((v,y,w)=>{(v.inline?HN:VN)(v,y,w)})(o,f,b):xa(o,d(),b)},placeCaretAt:(f,b)=>u(Gb(f,b,o.getDoc())),getBoundingClientRect:()=>{const f=d();return f.collapsed?M.fromRangeStart(f).getClientRects()[0]:f.getBoundingClientRect()},destroy:()=>{t=r=s=null,h.destroy()}},g=Ea(p),h=Vb(p,o);return p.bookmarkManager=g,p.controlSelection=h,p},EA=(e,t,n)=>{$.inArray(t,n)===-1&&(e.addAttributeFilter(n,(o,r)=>{let s=o.length;for(;s--;)o[s].attr(r,null)}),t.push(n))},kA=(e,t)=>{const n=["data-mce-selected"],o={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},r=t&&t.dom?t.dom:Ve.DOM,s=t&&t.schema?t.schema:No(o),a=ls(o,s);return((i,l,c)=>{i.addAttributeFilter("data-mce-tabindex",(d,u)=>{let m=d.length;for(;m--;){const p=d[m];p.attr("tabindex",p.attr("data-mce-tabindex")),p.attr(u,null)}}),i.addAttributeFilter("src,href,style",(d,u)=>{const m="data-mce-"+u,p=l.url_converter,g=l.url_converter_scope;let h=d.length;for(;h--;){const f=d[h];let b=f.attr(m);b!==void 0?(f.attr(u,b.length>0?b:null),f.attr(m,null)):(b=f.attr(u),u==="style"?b=c.serializeStyle(c.parseStyle(b),f.name):p&&(b=p.call(g,b,u,f.name)),f.attr(u,b.length>0?b:null))}}),i.addAttributeFilter("class",d=>{let u=d.length;for(;u--;){const m=d[u];let p=m.attr("class");p&&(p=p.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),m.attr("class",p.length>0?p:null))}}),i.addAttributeFilter("data-mce-type",(d,u,m)=>{let p=d.length;for(;p--;){const g=d[p];g.attr("data-mce-type")==="bookmark"&&!m.cleanup&&(C.from(g.firstChild).exists(f=>{var b;return!Oi((b=f.value)!==null&&b!==void 0?b:"")})?g.unwrap():g.remove())}}),i.addNodeFilter("noscript",d=>{var u;let m=d.length;for(;m--;){const p=d[m].firstChild;p&&(p.value=So.decode((u=p.value)!==null&&u!==void 0?u:""))}}),i.addNodeFilter("script,style",(d,u)=>{var m;const p=h=>h.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let g=d.length;for(;g--;){const h=d[g],f=h.firstChild,b=(m=f==null?void 0:f.value)!==null&&m!==void 0?m:"";if(u==="script"){const v=h.attr("type");v&&h.attr("type",v==="mce-no/type"?null:v.replace(/^mce\-/,"")),l.element_format==="xhtml"&&f&&b.length>0&&(f.value=`// <![CDATA[
`+p(b)+`
// ]]>`)}else l.element_format==="xhtml"&&f&&b.length>0&&(f.value=`<!--
`+p(b)+`
-->`)}}),i.addNodeFilter("#comment",d=>{let u=d.length;for(;u--;){const m=d[u],p=m.value;l.preserve_cdata&&(p==null?void 0:p.indexOf("[CDATA["))===0?(m.name="#cdata",m.type=4,m.value=c.decode(p.replace(/^\[CDATA\[|\]\]$/g,""))):(p==null?void 0:p.indexOf("mce:protected "))===0&&(m.name="#text",m.type=3,m.raw=!0,m.value=unescape(p).substr(14))}}),i.addNodeFilter("xml:namespace,input",(d,u)=>{let m=d.length;for(;m--;){const p=d[m];p.type===7?p.remove():p.type===1&&(u!=="input"||p.attr("type")||p.attr("type","text"))}}),i.addAttributeFilter("data-mce-type",d=>{U(d,u=>{u.attr("data-mce-type")==="format-caret"&&(u.isEmpty(i.schema.getNonEmptyElements())?u.remove():u.unwrap())})}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(d,u)=>{let m=d.length;for(;m--;)d[m].attr(u,null)}),l.remove_trailing_brs&&((d,u,m)=>{u.addNodeFilter("br",(p,g,h)=>{const f=$.extend({},m.getBlockElements()),b=m.getNonEmptyElements(),v=m.getWhitespaceElements();f.body=1;const y=w=>w.name in f||Xc(m,w);for(let w=0,E=p.length;w<E;w++){let k=p[w],S=k.parent;if(S&&y(S)&&k===S.lastChild){let _=k.prev;for(;_;){const T=_.name;if(T!=="span"||_.attr("data-mce-type")!=="bookmark"){T==="br"&&(k=null);break}_=_.prev}if(k&&(k.remove(),Ta(m,b,v,S))){const T=m.getElementRule(S.name);T&&(T.removeEmpty?S.remove():T.paddEmpty&&Fu(d,h,y,S))}}else{let _=k;for(;S&&S.firstChild===_&&S.lastChild===_&&(_=S,!f[S.name]);)S=S.parent;if(_===S){const T=new Ft("#text",3);T.value=Ct,k.replace(T)}}}})})(l,i,i.schema)})(a,o,r),{schema:s,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:(i,l={})=>{const c={format:"html",...l},d=((p,g,h)=>((f,b)=>q(f)&&f.hasEventListeners("PreProcess")&&!b.no_events)(p,h)?((f,b,v)=>{let y;const w=f.dom;let E=b.cloneNode(!0);const k=document.implementation;if(k.createHTMLDocument){const S=k.createHTMLDocument("");$.each(E.nodeName==="BODY"?E.childNodes:[E],_=>{S.body.appendChild(S.importNode(_,!0))}),E=E.nodeName!=="BODY"?S.body.firstChild:S.body,y=w.doc,w.doc=S}return((S,_)=>{S.dispatch("PreProcess",_)})(f,{...v,node:E}),y&&(w.doc=y),E})(p,g,h):g)(t,i,c),u=((p,g,h)=>{const f=on(h.getInner?g.innerHTML:p.getOuterHTML(g));return h.selection||Ti(R(g))?f:$.trim(f)})(r,d,c),m=((p,g,h)=>{const f=h.selection?{forced_root_block:!1,...h}:h,b=p.parse(g,f);return(v=>{const y=E=>(E==null?void 0:E.name)==="br",w=v.lastChild;if(y(w)){const E=w.prev;y(E)&&(w.remove(),E.remove())}})(b),b})(a,u,c);return c.format==="tree"?m:((p,g,h,f,b)=>{const v=((y,w,E)=>Lo(y,w).serialize(E))(g,h,f);return((y,w,E)=>!w.no_events&&y?((S,_)=>S.dispatch("PostProcess",_))(y,{...w,content:E}).content:E)(p,b,v)})(t,o,s,m,c)},addRules:s.addValidElements,setRules:s.setValidElements,addTempAttr:ne(EA,a,n),getTempAttrs:oe(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},cC=(e,t)=>{const n=kA(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},Em=(e,t,n={})=>{const o=((r,s)=>({format:"html",...r,set:!0,content:s}))(n,t);return gm(e,o).map(r=>{const s=((a,i,l)=>wm(a).editor.setContent(i,l))(e,r.content,r);return pm(e,s.html,r),s.content}).getOr(t)},xA="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists,template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),_A=[],SA="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,template,textcolor,rtc".split(","),dC=[],uC=(e,t)=>{const n=ye(t,o=>ke(e,o));return Vo(n)},NA=e=>{const t=uC(e,xA),n=e.forced_root_block;return n!==!1&&n!==""||t.push("forced_root_block (false only)"),Vo(t)},RA=e=>uC(e,_A),mC=(e,t)=>{const n=$.makeMap(e.plugins," "),o=ye(t,r=>ke(n,r));return Vo(o)},AA=e=>mC(e,SA),TA=e=>mC(e,dC.map(t=>t.name)),OA=e=>pt(dC,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),wl=Ve.DOM,El=e=>C.from(e).each(t=>t.destroy()),kl=(()=>{const e={};return{add:(t,n)=>{e[t]=n},get:t=>e[t]?e[t]:{icons:{}},has:t=>ke(e,t)}})(),cs=It.ModelManager,fC=(e,t)=>t.dom[e],gC=(e,t)=>parseInt($n(t,e),10),BA=ne(fC,"clientWidth"),PA=ne(fC,"clientHeight"),DA=ne(gC,"margin-top"),LA=ne(gC,"margin-left"),pC=e=>{const t=[],n=()=>{const l=e.theme;return l&&l.getNotificationManagerImpl?l.getNotificationManagerImpl():(()=>{const c=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:c,close:c,getArgs:c}})()},o=()=>C.from(t[0]),r=()=>{U(t,l=>{l.reposition()})},s=l=>{As(t,c=>c===l).each(c=>{t.splice(c,1)})},a=(l,c=!0)=>e.removed||!(d=>{return(u=d.inline?d.getBody():d.getContentAreaContainer(),C.from(u).map(R)).map(Ur).getOr(!1);var u})(e)?{}:(c&&e.dispatch("BeforeOpenNotification",{notification:l}),pt(t,d=>{return u=n().getArgs(d),m=l,!(u.type!==m.type||u.text!==m.text||u.progressBar||u.timeout||m.progressBar||m.timeout);var u,m}).getOrThunk(()=>{e.editorManager.setActive(e);const d=n().open(l,()=>{s(d),r(),pv(e)&&o().fold(()=>e.focus(),u=>lv(R(u.getEl())))});return(u=>{t.push(u)})(d),r(),e.dispatch("OpenNotification",{notification:{...d}}),d})),i=oe(t);return(l=>{l.on("SkinLoaded",()=>{const c=gS(l);c&&a({text:c,type:"warning",timeout:0},!1),r()}),l.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),l.on("remove",()=>{U(t.slice(),c=>{n().close(c)})})})(e),{open:a,close:()=>{o().each(l=>{n().close(l),s(l),r()})},getNotifications:i}},ds=It.PluginManager,Cr=It.ThemeManager,hC=e=>{let t=[];const n=()=>{const a=e.theme;return a&&a.getWindowManagerImpl?a.getWindowManagerImpl():(()=>{const i=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:i,openUrl:i,alert:i,confirm:i,close:i}})()},o=(a,i)=>(...l)=>i?i.apply(a,l):void 0,r=a=>{(i=>{e.dispatch("CloseWindow",{dialog:i})})(a),t=ye(t,i=>i!==a),t.length===0&&e.focus()},s=a=>{e.editorManager.setActive(e),ol(e),e.ui.show();const i=a();return(l=>{t.push(l),(c=>{e.dispatch("OpenWindow",{dialog:c})})(l)})(i),i};return e.on("remove",()=>{U(t,a=>{n().close(a)})}),{open:(a,i)=>s(()=>n().open(a,i,r)),openUrl:a=>s(()=>n().openUrl(a,r)),alert:(a,i,l)=>{const c=n();c.alert(a,o(l||c,i))},confirm:(a,i,l)=>{const c=n();c.confirm(a,o(l||c,i))},close:()=>{C.from(t[t.length-1]).each(a=>{n().close(a),r(a)})}}},bC=(e,t)=>{e.notificationManager.open({type:"error",text:t})},xl=(e,t)=>{e._skinLoaded?bC(e,t):e.on("SkinLoaded",()=>{bC(e,t)})},Ma=(e,t,n)=>{Ib(e,t,{message:n}),console.error(n)},Ia=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,_l=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},km=e=>"content/"+e+"/content.css",vC=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return Te(t,r=>(s=>tinymce.Resource.has(km(s)))(r)?r:(s=>/^[a-z0-9\-]+$/i.test(s))(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},MA=(e,t)=>{const n={};return{findAll:(o,r=dt)=>{const s=ye((i=>i?en(i.getElementsByTagName("img")):[])(o),i=>{const l=i.src;return!i.hasAttribute("data-mce-bogus")&&!i.hasAttribute("data-mce-placeholder")&&!(!l||l===Be.transparentSrc)&&(ht(l,"blob:")?!e.isUploaded(l)&&r(i):!!ht(l,"data:")&&r(i))}),a=Te(s,i=>{const l=i.src;if(ke(n,l))return n[l].then(c=>Q(c)?c:{image:i,blobInfo:c.blobInfo});{const c=((d,u)=>{const m=()=>Promise.reject("Invalid data URI");if(ht(u,"blob:")){const h=d.getByUri(u);return q(h)?Promise.resolve(h):(p=u,ht(p,"blob:")?(f=>fetch(f).then(b=>b.ok?b.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${f} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})))(p):ht(p,"data:")?(g=p,new Promise((f,b)=>{rm(g).bind(({type:v,data:y,base64Encoded:w})=>py(v,y,w)).fold(()=>b("Invalid data URI"),f)})):Promise.reject("Unknown URI format")).then(f=>hy(f).then(b=>by(b,!1,v=>C.some(vy(d,f,v))).getOrThunk(m)))}var p,g;return ht(u,"data:")?yy(d,u).fold(m,h=>Promise.resolve(h)):Promise.reject("Unknown image data format")})(t,l).then(d=>(delete n[l],{image:i,blobInfo:d})).catch(d=>(delete n[l],d));return n[l]=c,c}});return Promise.all(a)}}},yC=()=>{let e={};const t=(o,r)=>({status:o,resultUri:r}),n=o=>o in e;return{hasBlobUri:n,getResultUri:o=>{const r=e[o];return r?r.resultUri:null},isPending:o=>!!n(o)&&e[o].status===1,isUploaded:o=>!!n(o)&&e[o].status===2,markPending:o=>{e[o]=t(1,null)},markUploaded:(o,r)=>{e[o]=t(2,r)},removeFailed:o=>{delete e[o]},destroy:()=>{e={}}}};let IA=0;const FA=(e,t)=>{const n={},o=(l,c)=>new Promise((d,u)=>{const m=new XMLHttpRequest;m.open("POST",t.url),m.withCredentials=t.credentials,m.upload.onprogress=g=>{c(g.loaded/g.total*100)},m.onerror=()=>{u("Image upload failed due to a XHR Transport error. Code: "+m.status)},m.onload=()=>{if(m.status<200||m.status>=300)return void u("HTTP Error: "+m.status);const g=JSON.parse(m.responseText);var h,f;g&&Q(g.location)?d((h=t.basePath,f=g.location,h?h.replace(/\/$/,"")+"/"+f.replace(/^\//,""):f)):u("Invalid JSON: "+m.responseText)};const p=new FormData;p.append("file",l.blob(),l.filename()),m.send(p)}),r=Ie(t.handler)?t.handler:o,s=(l,c)=>({url:c,blobInfo:l,status:!0}),a=(l,c)=>({url:"",blobInfo:l,status:!1,error:c}),i=(l,c)=>{$.each(n[l],d=>{d(c)}),delete n[l]};return{upload:(l,c)=>t.url||r!==o?((d,u)=>(d=$.grep(d,m=>!e.isUploaded(m.blobUri())),Promise.all($.map(d,m=>e.isPending(m.blobUri())?(p=>{const g=p.blobUri();return new Promise(h=>{n[g]=n[g]||[],n[g].push(h)})})(m):((p,g,h)=>(e.markPending(p.blobUri()),new Promise(f=>{let b,v;try{const y=()=>{b&&(b.close(),v=Ne)},w=k=>{y(),e.markUploaded(p.blobUri(),k),i(p.blobUri(),s(p,k)),f(s(p,k))},E=k=>{y(),e.removeFailed(p.blobUri()),i(p.blobUri(),a(p,k)),f(a(p,k))};v=k=>{k<0||k>100||C.from(b).orThunk(()=>C.from(h).map(pc)).each(S=>{b=S,S.progressBar.value(k)})},g(p,v).then(w,k=>{E(Q(k)?{message:k}:k)})}catch(y){f(a(p,y))}})))(m,r,u)))))(l,c):new Promise(d=>{d([])})}},CC=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),wC=(e,t)=>FA(t,{url:tS(e),basePath:nS(e),credentials:oS(e),handler:rS(e)}),UA=e=>{const t=(()=>{let h=[];const f=y=>{if(!y.blob||!y.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const w=y.id||"blobid"+IA+++(()=>{const _=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+new Date().getTime().toString(36)+_()+_()+_()})(),E=y.name||w,k=y.blob;var S;return{id:oe(w),name:oe(E),filename:oe(y.filename||E+"."+(S=k.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[S.toLowerCase()]||"dat")),blob:oe(k),base64:oe(y.base64),blobUri:oe(y.blobUri||URL.createObjectURL(k)),uri:oe(y.uri)}},b=y=>pt(h,y).getOrUndefined(),v=y=>b(w=>w.id()===y);return{create:(y,w,E,k,S)=>{if(Q(y))return f({id:y,name:k,filename:S,blob:w,base64:E});if(We(y))return f(y);throw new Error("Unknown input type")},add:y=>{v(y.id())||h.push(y)},get:v,getByUri:y=>b(w=>w.blobUri()===y),getByData:(y,w)=>b(E=>E.base64()===y&&E.blob().type===w),findFirst:b,removeByUri:y=>{h=ye(h,w=>w.blobUri()!==y||(URL.revokeObjectURL(w.blobUri()),!1))},destroy:()=>{U(h,y=>{URL.revokeObjectURL(y.blobUri())}),h=[]}}})();let n,o;const r=yC(),s=[],a=h=>f=>e.selection?h(f):[],i=(h,f,b)=>{let v=0;do v=h.indexOf(f,v),v!==-1&&(h=h.substring(0,v)+b+h.substr(v+f.length),v+=b.length-f.length+1);while(v!==-1);return h},l=(h,f,b)=>{const v=`src="${b}"${b===Be.transparentSrc?' data-mce-placeholder="1"':""}`;return h=i(h,`src="${f}"`,v),i(h,'data-mce-src="'+f+'"','data-mce-src="'+b+'"')},c=(h,f)=>{U(e.undoManager.data,b=>{b.type==="fragmented"?b.fragments=Te(b.fragments,v=>l(v,h,f)):b.content=l(b.content,h,f)})},d=()=>(n||(n=wC(e,r)),p().then(a(h=>{const f=Te(h,b=>b.blobInfo);return n.upload(f,CC(e)).then(a(b=>{const v=[];let y=!1;const w=Te(b,(E,k)=>{const{blobInfo:S,image:_}=h[k];let T=!1;return E.status&&J_(e)?(E.url&&!At(_.src,E.url)&&(y=!0),t.removeByUri(_.src),Qn(e)||((P,x)=>{const N=e.convertURL(x,"src");var B;c(P.src,x),so(R(P),{src:Rh(e)?(B=x,B+(B.indexOf("?")===-1?"?":"&")+new Date().getTime()):x,"data-mce-src":N})})(_,E.url)):E.error&&(E.error.remove&&(c(_.src,Be.transparentSrc),v.push(_),T=!0),((P,x)=>{xl(P,On.translate(["Failed to upload image: {0}",x]))})(e,E.error.message)),{element:_,status:E.status,uploadUri:E.url,blobInfo:S,removed:T}});return v.length>0&&!Qn(e)?e.undoManager.transact(()=>{U(Mc(v),E=>{const k=Rn(E);Ze(E),k.each((S=>_=>{((T,P)=>T.dom.isEmpty(P.dom)&&q(T.schema.getTextBlockElements()[Oe(P)]))(S,_)&&ut(_,fi('<br data-mce-bogus="1" />'))})(e)),t.removeByUri(E.dom.src)})}):y&&e.undoManager.dispatchChange(),w}))}))),u=()=>Nh(e)?d():Promise.resolve([]),m=h=>wo(s,f=>f(h)),p=()=>(o||(o=MA(r,t)),o.findAll(e.getBody(),m).then(a(h=>{const f=ye(h,b=>Q(b)?(xl(e,b),!1):b.uriType!=="blob");return Qn(e)||U(f,b=>{c(b.image.src,b.blobInfo.blobUri()),b.image.src=b.blobInfo.blobUri(),b.image.removeAttribute("data-mce-src")}),f}))),g=h=>h.replace(/src="(blob:[^"]+)"/g,(f,b)=>{const v=r.getResultUri(b);if(v)return'src="'+v+'"';let y=t.getByUri(b);return y||(y=Yt(e.editorManager.get(),(w,E)=>w||E.editorUpload&&E.editorUpload.blobCache.getByUri(b),void 0)),y?'src="data:'+y.blob().type+";base64,"+y.base64()+'"':f});return e.on("SetContent",()=>{Nh(e)?u():p()}),e.on("RawSaveContent",h=>{h.content=g(h.content)}),e.on("GetContent",h=>{h.source_view||h.format==="raw"||h.format==="tree"||(h.content=g(h.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",h=>{U(h,f=>{const b=f.attr("src");if(!b||t.getByUri(b))return;const v=r.getResultUri(b);v&&f.attr("src",v)})})}),{blobCache:t,addFilter:h=>{s.push(h)},uploadImages:d,uploadImagesAuto:u,scanForImages:p,destroy:()=>{t.destroy(),r.destroy(),o=n=null}}},EC={remove_similar:!0,inherit:!1},us={selector:"td,th",...EC},zA={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...us},tablecellverticalalign:{styles:{"vertical-align":"%value"},...us},tablecellbordercolor:{styles:{borderColor:"%value"},...us},tablecellclass:{classes:["%value"],...us},tableclass:{selector:"table",classes:["%value"],...EC},tablecellborderstyle:{styles:{borderStyle:"%value"},...us},tablecellborderwidth:{styles:{borderWidth:"%value"},...us}},jA=oe(zA),Sl=$.each,bn=Ve.DOM,xm=e=>q(e)&&We(e),kC=(e,t)=>{const n=t&&t.schema||No({}),o=a=>{const i=Q(a)?{name:a,classes:[],attrs:{}}:a,l=bn.create(i.name);return((c,d)=>{d.classes.length>0&&bn.addClass(c,d.classes.join(" ")),bn.setAttribs(c,d.attrs)})(l,i),l},r=(a,i,l)=>{let c;const d=i[0],u=xm(d)?d.name:void 0,m=((h,f)=>{const b=n.getElementRule(h.nodeName.toLowerCase()),v=b==null?void 0:b.parentsRequired;return!(!v||!v.length)&&(f&&Ue(v,f)?f:v[0])})(a,u);if(m)u===m?(c=d,i=i.slice(1)):c=m;else if(d)c=d,i=i.slice(1);else if(!l)return a;const p=c?o(c):bn.create("div");p.appendChild(a),l&&$.each(l,h=>{const f=o(h);p.insertBefore(f,a)});const g=xm(c)?c.siblings:void 0;return r(p,i,g)},s=bn.create("div");if(e.length>0){const a=e[0],i=o(a),l=xm(a)?a.siblings:void 0;s.appendChild(r(i,e.slice(1),l))}return s},HA=e=>{let t="div";const n={name:t,classes:[],attrs:{},selector:e=$.trim(e)};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(o,r,s,a,i)=>{switch(r){case"#":n.attrs.id=s;break;case".":n.classes.push(s);break;case":":$.inArray("checked disabled enabled read-only required".split(" "),s)!==-1&&(n.attrs[s]=s)}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},$A=(e,t)=>{let n="",o=vS(e);if(o==="")return"";const r=p=>Q(p)?p.replace(/%(\w+)/g,""):"",s=(p,g)=>bn.getStyle(g??e.getBody(),p,!0);if(Q(t)){const p=e.formatter.get(t);if(!p)return"";t=p[0]}if("preview"in t){const p=t.preview;if(p===!1)return"";o=p||o}let a,i=t.block||t.inline||"span";const l=(c=t.selector,Q(c)?(c=(c=c.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),$.map(c.split(/(?:>|\s+(?![^\[\]]+\]))/),p=>{const g=$.map(p.split(/(?:~\+|~|\+)/),HA),h=g.pop();return g.length&&(h.siblings=g),h}).reverse()):[]);var c;l.length>0?(l[0].name||(l[0].name=i),i=t.selector,a=kC(l,e)):a=kC([i],e);const d=bn.select(i,a)[0]||a.firstChild;Sl(t.styles,(p,g)=>{const h=r(p);h&&bn.setStyle(d,g,h)}),Sl(t.attributes,(p,g)=>{const h=r(p);h&&bn.setAttrib(d,g,h)}),Sl(t.classes,p=>{const g=r(p);bn.hasClass(d,g)||bn.addClass(d,g)}),e.dispatch("PreviewFormats"),bn.setStyles(a,{position:"absolute",left:-65535}),e.getBody().appendChild(a);const u=s("fontSize"),m=/px$/.test(u)?parseInt(u,10):0;return Sl(o.split(" "),p=>{let g=s(p,d);if(!(p==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(g)&&(g=s(p),Gs(g).toLowerCase()==="#ffffff")||p==="color"&&Gs(g).toLowerCase()==="#000000")){if(p==="font-size"&&/em|%$/.test(g)){if(m===0)return;g=parseFloat(g)/(/%$/.test(g)?100:1)*m+"px"}p==="border"&&g&&(n+="padding:0 2px;"),n+=p+":"+g+";"}}),e.dispatch("AfterPreviewFormats"),bn.remove(a),n},xC=e=>{const t=(o=>{const r={},s=(a,i)=>{a&&(Q(a)?(He(i)||(i=[i]),U(i,l=>{st(l.deep)&&(l.deep=!fn(l)),st(l.split)&&(l.split=!fn(l)||bt(l)),st(l.remove)&&fn(l)&&!bt(l)&&(l.remove="none"),fn(l)&&bt(l)&&(l.mixed=!0,l.block_expand=!0),Q(l.classes)&&(l.classes=l.classes.split(/\s+/))}),r[a]=i):Ke(a,(l,c)=>{s(c,l)}))};return s((a=>{const i=a.dom,l=a.schema.type,c={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:d=>{i.setStyle(d,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:d=>{i.setStyle(d,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const d={inline:"span",styles:{textDecoration:"line-through"},exact:!0},u={inline:"strike",remove:"all",preserve_attributes:["class","style"]},m={inline:"s",remove:"all",preserve_attributes:["class","style"]};return l!=="html4"?[m,d,u]:[d,m,u]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(d,u,m)=>re(d)&&d.hasAttribute("href"),onformat:(d,u,m)=>{$.each(m,(p,g)=>{i.setAttrib(d,g,p)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":d=>{var u;return(u=d==null?void 0:d.customValue)!==null&&u!==void 0?u:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return $.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),d=>{c[d]={block:d,remove:"all"}}),c})(o)),s(jA()),s(bS(o)),{get:a=>q(a)?r[a]:r,has:a=>ke(r,a),register:s,unregister:a=>(a&&r[a]&&delete r[a],r)}})(e),n=wt({});return(o=>{o.addShortcut("meta+b","","Bold"),o.addShortcut("meta+i","","Italic"),o.addShortcut("meta+u","","Underline");for(let r=1;r<=6;r++)o.addShortcut("access+"+r,"",["FormatBlock",!1,"h"+r]);o.addShortcut("access+7","",["FormatBlock",!1,"p"]),o.addShortcut("access+8","",["FormatBlock",!1,"div"]),o.addShortcut("access+9","",["FormatBlock",!1,"address"])})(e),(o=>{o.on("mouseup keydown",r=>{var s;((a,i,l)=>{const c=a.selection,d=a.getBody();Qu(a,null,l),i!==8&&i!==46||!c.isCollapsed()||c.getStart().innerHTML!==Oa||Qu(a,ur(d,c.getStart()),!0),i!==37&&i!==39||Qu(a,ur(d,c.getStart()),!0)})(o,r.keyCode,(s=o.selection.getRng().endContainer,j(s)&&kc(s.data,Ct)))})})(e),Qn(e)||((o,r)=>{o.set({}),r.on("NodeChange",s=>{my(r,s.element,o.get())}),r.on("FormatApply FormatRemove",s=>{const a=C.from(s.node).map(i=>Ca(i)?i:i.startContainer).bind(i=>re(i)?C.some(i):C.from(i.parentElement)).getOrThunk(()=>cy(r));my(r,a,o.get())})})(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(o,r,s)=>{((a,i,l,c)=>{mt(a).formatter.apply(i,l,c)})(e,o,r,s)},remove:(o,r,s,a)=>{((i,l,c,d,u)=>{mt(i).formatter.remove(l,c,d,u)})(e,o,r,s,a)},toggle:(o,r,s)=>{((a,i,l,c)=>{mt(a).formatter.toggle(i,l,c)})(e,o,r,s)},match:(o,r,s,a)=>((i,l,c,d,u)=>mt(i).formatter.match(l,c,d,u))(e,o,r,s,a),closest:o=>((r,s)=>mt(r).formatter.closest(s))(e,o),matchAll:(o,r)=>((s,a,i)=>mt(s).formatter.matchAll(a,i))(e,o,r),matchNode:(o,r,s,a)=>((i,l,c,d,u)=>mt(i).formatter.matchNode(l,c,d,u))(e,o,r,s,a),canApply:o=>((r,s)=>mt(r).formatter.canApply(s))(e,o),formatChanged:(o,r,s,a)=>((i,l,c,d,u,m)=>mt(i).formatter.formatChanged(l,c,d,u,m))(e,n,o,r,s,a),getCssText:ne($A,e)}},_C=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},SC=e=>{const t=Ro(),n=wt(0),o=wt(0),r={data:[],typing:!1,beforeChange:()=>{((s,a,i)=>{mt(s).undoManager.beforeChange(a,i)})(e,n,t)},add:(s,a)=>((i,l,c,d,u,m,p)=>mt(i).undoManager.add(l,c,d,u,m,p))(e,r,o,n,t,s,a),dispatchChange:()=>{e.setDirty(!0);const s=yl(e);s.bookmark=xd(e.selection),e.dispatch("change",{level:s,lastLevel:Os(r.data,o.get()).getOrUndefined()})},undo:()=>((s,a,i,l)=>mt(s).undoManager.undo(a,i,l))(e,r,n,o),redo:()=>((s,a,i)=>mt(s).undoManager.redo(a,i))(e,o,r.data),clear:()=>{((s,a,i)=>{mt(s).undoManager.clear(a,i)})(e,r,o)},reset:()=>{((s,a)=>{mt(s).undoManager.reset(a)})(e,r)},hasUndo:()=>((s,a,i)=>mt(s).undoManager.hasUndo(a,i))(e,r,o),hasRedo:()=>((s,a,i)=>mt(s).undoManager.hasRedo(a,i))(e,r,o),transact:s=>((a,i,l,c)=>mt(a).undoManager.transact(i,l,c))(e,r,n,s),ignore:s=>{((a,i,l)=>{mt(a).undoManager.ignore(i,l)})(e,n,s)},extra:(s,a)=>{((i,l,c,d,u)=>{mt(i).undoManager.extra(l,c,d,u)})(e,r,o,s,a)}};return Qn(e)||((s,a,i)=>{const l=wt(!1),c=d=>{Cl(a,!1,i),a.add({},d)};s.on("init",()=>{a.add()}),s.on("BeforeExecCommand",d=>{const u=d.command;_C(u)||(tC(a,i),a.beforeChange())}),s.on("ExecCommand",d=>{const u=d.command;_C(u)||c(d)}),s.on("ObjectResizeStart cut",()=>{a.beforeChange()}),s.on("SaveContent ObjectResized blur",c),s.on("dragend",c),s.on("keyup",d=>{const u=d.keyCode;if(d.isDefaultPrevented())return;const m=Be.os.isMacOS()&&d.key==="Meta";(u>=33&&u<=36||u>=37&&u<=40||u===45||d.ctrlKey||m)&&(c(),s.nodeChanged()),u!==46&&u!==8||s.nodeChanged(),l.get()&&a.typing&&!ym(yl(s),a.data[0])&&(s.isDirty()||s.setDirty(!0),s.dispatch("TypingUndo"),l.set(!1),s.nodeChanged())}),s.on("keydown",d=>{const u=d.keyCode;if(d.isDefaultPrevented())return;if(u>=33&&u<=36||u>=37&&u<=40||u===45)return void(a.typing&&c(d));const m=d.ctrlKey&&!d.altKey||d.metaKey;if((u<16||u>20)&&u!==224&&u!==91&&!a.typing&&!m)return a.beforeChange(),Cl(a,!0,i),a.add({},d),void l.set(!0);(Be.os.isMacOS()?d.metaKey:d.ctrlKey&&!d.altKey)&&a.beforeChange()}),s.on("mousedown",d=>{a.typing&&c(d)}),s.on("input",d=>{var u;d.inputType&&(d.inputType==="insertReplacementText"||(u=d).inputType==="insertText"&&u.data===null||(m=>m.inputType==="insertFromPaste"||m.inputType==="insertFromDrop")(d))&&c(d)}),s.on("AddUndo Undo Redo ClearUndos",d=>{d.isDefaultPrevented()||s.nodeChanged()})})(e,r,n),(s=>{s.addShortcut("meta+z","","Undo"),s.addShortcut("meta+y,meta+shift+z","","Redo")})(e),r},VA=[9,27,ee.HOME,ee.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,ee.DOWN,ee.UP,ee.LEFT,ee.RIGHT].concat(Be.browser.isFirefox()?[224]:[]),NC="data-mce-placeholder",RC=e=>e.type==="keydown"||e.type==="keyup",AC=e=>{const t=e.keyCode;return t===ee.BACKSPACE||t===ee.DELETE},qA=(e,t)=>({from:e,to:t}),_m=(e,t)=>{const n=R(e),o=R(t.container());return ll(n,o).map(r=>((s,a)=>({block:s,position:a}))(r,t))},TC=(e,t)=>Yo(t,n=>sa(n)||Cn(n.dom),n=>De(n,e)).filter(tn).getOr(e),OC=(e,t)=>{const n=((o,r)=>{const s=Ot(o);return As(s,a=>r.isBlock(Oe(a))).fold(oe(s),a=>s.slice(0,a))})(e,t);return U(n,Ze),n},BC=(e,t,n)=>{const o=ho(n,t);return pt(o.reverse(),r=>Pt(e,r)).each(Ze)},WA=(e,t,n,o,r)=>{if(Pt(o,n))return Ao(n),Lt(n.dom);((a,i)=>ye(Pg(i),l=>!Pt(a,l)).length===0)(o,r)&&Pt(o,t)&&Xt(r,vt("br"));const s=Zt(n.dom,M.before(r.dom));return U(OC(t,o),a=>{Xt(r,a)}),BC(o,e,t),s},KA=(e,t,n,o)=>{if(Pt(o,n)){if(Pt(o,t)){const s=i=>{const l=(c,d)=>Ac(c).fold(()=>d,u=>((m,p)=>m.isInline(Oe(p)))(o,u)?l(u,d.concat(rr(u))):d);return l(i,[])},a=Rs(s(n),(i,l)=>($g(i,l),l),aa());jr(t),ut(t,a)}return Ze(n),Lt(t.dom)}const r=wn(n.dom);return U(OC(t,o),s=>{ut(n,s)}),BC(o,e,t),r},PC=(e,t)=>{es(e,t.dom).bind(n=>C.from(n.getNode())).map(R).filter(ar).each(Ze)},DC=(e,t,n,o)=>(PC(!0,t),PC(!1,n),((r,s)=>io(s,r)?((a,i)=>{const l=ho(i,a);return C.from(l[l.length-1])})(s,r):C.none())(t,n).fold(ne(KA,e,t,n,o),ne(WA,e,t,n,o))),LC=(e,t,n,o,r)=>t?DC(e,o,n,r):DC(e,n,o,r),Sm=(e,t)=>{const n=R(e.getBody());return((r,s,a,i)=>i.collapsed?((l,c,d,u)=>{const m=_m(c,M.fromRangeStart(u)),p=m.bind(g=>dn(d,c,g.position).bind(h=>_m(c,h).map(f=>((b,v,y,w)=>rt(w.position.getNode())&&!Pt(b,w.block)?es(!1,w.block.dom).bind(E=>E.isEqual(w.position)?dn(y,v,E).bind(k=>_m(v,k)):C.some(w)).getOr(w):w)(l,c,d,f))));return Tt(m,p,qA).filter(g=>(h=>!De(h.from.block,h.to.block))(g)&&((h,f)=>{const b=R(h);return De(TC(b,f.from.block),TC(b,f.to.block))})(c,g)&&(h=>Ge(h.from.block.dom)===!1&&Ge(h.to.block.dom)===!1)(g)&&(h=>{const f=b=>$p(b)||Kc(b.dom);return f(h.from.block)&&f(h.to.block)})(g))})(r,s,a,i):C.none())(e.schema,n.dom,t,e.selection.getRng()).map(r=>()=>{LC(n,t,r.from.block,r.to.block,e.schema).each(s=>{e.selection.setRng(s.toRange())})})},MC=(e,t)=>{const n=R(t),o=ne(De,e);return co(n,sa,o).isSome()},YA=e=>{const t=R(e.getBody());return((n,o)=>{const r=Zt(n.dom,M.fromRangeStart(o)).isNone(),s=Vt(n.dom,M.fromRangeEnd(o)).isNone();return!((a,i)=>MC(a,i.startContainer)||MC(a,i.endContainer))(n,o)&&r&&s})(t,e.selection.getRng())?(n=>C.some(()=>{n.setContent(""),n.selection.setCursorLocation()}))(e):((n,o,r)=>{const s=o.getRng();return Tt(ll(n,R(s.startContainer)),ll(n,R(s.endContainer)),(a,i)=>De(a,i)?C.none():C.some(()=>{s.deleteContents(),LC(n,!0,a,i,r).each(l=>{o.setRng(l.toRange())})})).getOr(C.none())})(t,e.selection,e.schema)},Nm=(e,t)=>e.selection.isCollapsed()?C.none():YA(e),bo=(e,t,n,o,r)=>C.from(t._selectionOverrides.showCaret(e,n,o,r)),Fa=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?C.none():C.some((n=>{const o=n.ownerDocument.createRange();return o.selectNode(n),o})(t)),Rm=(e,t,n)=>t.collapsed?((o,r,s)=>{const a=Pd(1,o.getBody(),r),i=M.fromRangeStart(a),l=i.getNode();if(fa(l))return bo(1,o,l,!i.isAtEnd(),!1);const c=i.getNode(!0);if(fa(c))return bo(1,o,c,!1,!1);const d=vr(o.dom.getRoot(),i.getNode());return fa(d)?bo(1,o,d,!1,s):C.none()})(e,t,n).getOr(t):t,GA=e=>Io(e)||_a(e),XA=e=>Fo(e)||Sa(e),IC=(e,t,n,o,r,s)=>{bo(o,e,s.getNode(!r),r,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();r?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),((a,i)=>{j(i)&&i.data.length===0&&a.remove(i)})(e.dom,n)},Am=(e,t)=>((n,o)=>{const r=n.selection.getRng();if(!j(r.commonAncestorContainer))return C.none();const s=o?kt.Forwards:kt.Backwards,a=Gn(n.getBody()),i=ne(Dd,o?a.next:a.prev),l=o?GA:XA,c=va(s,n.getBody(),r),d=i(c),u=d&&pn(o,d);if(!u||!$i(c,u))return C.none();if(l(u))return C.some(()=>IC(n,r,c.getNode(),s,o,u));const m=i(u);return m&&l(m)&&$i(u,m)?C.some(()=>IC(n,r,c.getNode(),s,o,m)):C.none()})(e,t),Tm=(e,t)=>{const n=e.getBody();return t?Lt(n).filter(Io):wn(n).filter(Fo)},Om=e=>{const t=e.selection.getRng();return!t.collapsed&&(Tm(e,!0).exists(n=>n.isEqual(M.fromRangeStart(t)))||Tm(e,!1).exists(n=>n.isEqual(M.fromRangeEnd(t))))},vn=Wn([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),FC=(e,t,n,o)=>dn(t,e,n).bind(r=>{return s=r.getNode(),q(s)&&(sa(R(s))||ra(R(s)))||((a,i,l,c,d)=>{const u=m=>d.isInline(m.nodeName.toLowerCase())&&!Kn(l,c,a);return eb(!i,l).fold(()=>eb(i,c).fold(Qe,u),u)})(e,t,n,r,o)?C.none():t&&Ge(r.getNode())||!t&&Ge(r.getNode(!0))?((a,i,l,c,d)=>{const u=d.getNode(!l);return ll(R(i),R(c.getNode())).map(m=>Pt(a,m)?vn.remove(m.dom):vn.moveToElement(u)).orThunk(()=>C.some(vn.moveToElement(u)))})(o,e,t,n,r):t&&Fo(n)||!t&&Io(n)?C.some(vn.moveToPosition(r)):C.none();var s}),UC=(e,t)=>C.from(vr(e.getBody(),t)),ZA=(e,t)=>{const n=e.selection.getNode();return UC(e,n).filter(Ge).fold(()=>((o,r,s,a)=>{const i=Pd(r?1:-1,o,s),l=M.fromRangeStart(i),c=R(o);return!r&&Fo(l)?C.some(vn.remove(l.getNode(!0))):r&&Io(l)?C.some(vn.remove(l.getNode())):!r&&Io(l)&&Eu(c,l,a)?fR(c,l,a).map(d=>vn.remove(d.getNode())):r&&Fo(l)&&wu(c,l,a)?gR(c,l,a).map(d=>vn.remove(d.getNode())):((d,u,m,p)=>((g,h)=>{const f=h.getNode(!g),b=g?"after":"before";return re(f)&&f.getAttribute("data-mce-caret")===b})(u,m)?((g,h)=>at(h)?C.none():g&&Ge(h.nextSibling)?C.some(vn.moveToElement(h.nextSibling)):!g&&Ge(h.previousSibling)?C.some(vn.moveToElement(h.previousSibling)):C.none())(u,m.getNode(!u)).orThunk(()=>FC(d,u,m,p)):FC(d,u,m,p).bind(g=>((h,f,b)=>b.fold(v=>C.some(vn.remove(v)),v=>C.some(vn.moveToElement(v)),v=>Kn(f,v,h)?C.none():C.some(vn.moveToPosition(v))))(d,m,g)))(o,r,l,a)})(e.getBody(),t,e.selection.getRng(),e.schema).map(o=>()=>o.fold(((r,s)=>a=>(r._selectionOverrides.hideFakeCaret(),hr(r,s,R(a)),!0))(e,t),((r,s)=>a=>{const i=s?M.before(a):M.after(a);return r.selection.setRng(i.toRange()),!0})(e,t),(r=>s=>(r.selection.setRng(s.toRange()),!0))(e))),()=>C.some(Ne))},zC=e=>{const t=e.dom,n=e.selection,o=vr(e.getBody(),n.getNode());if(Cn(o)&&t.isBlock(o)&&t.isEmpty(o)){const r=t.create("br",{"data-mce-bogus":"1"});t.setHTML(o,""),o.appendChild(r),n.setRng(M.before(r).toRange())}return!0},Bm=(e,t)=>e.selection.isCollapsed()?ZA(e,t):((n,o)=>{const r=n.selection.getNode();return Ge(r)&&!Ei(r)?UC(n,r.parentNode).filter(Ge).fold(()=>C.some(()=>{var s;s=R(n.getBody()),U(Bt(s,".mce-offscreen-selection"),Ze),hr(n,o,R(n.selection.getNode())),Ru(n)}),()=>C.some(Ne)):Om(n)?C.some(()=>{d0(n,n.selection.getRng(),R(n.getBody()))}):C.none()})(e,t),Pm=(e,t)=>e.selection.isCollapsed()?((n,o)=>{const r=M.fromRangeStart(n.selection.getRng());return dn(o,n.getBody(),r).filter(s=>o?lR(s):cR(s)).bind(s=>Bd(o?0:-1,s)).map(s=>()=>n.selection.select(s))})(e,t):C.none(),ms=j,jC=e=>ms(e)&&e.data[0]===Et,HC=e=>ms(e)&&e.data[e.data.length-1]===Et,$C=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(Et)},Nl=(e,t)=>e?(n=>{var o;if(ms(n.previousSibling))return HC(n.previousSibling)||n.previousSibling.appendData(Et),n.previousSibling;if(ms(n))return jC(n)||n.insertData(0,Et),n;{const r=$C(n);return(o=n.parentNode)===null||o===void 0||o.insertBefore(r,n),r}})(t):(n=>{var o,r;if(ms(n.nextSibling))return jC(n.nextSibling)||n.nextSibling.insertData(0,Et),n.nextSibling;if(ms(n))return HC(n)||n.appendData(Et),n;{const s=$C(n);return n.nextSibling?(o=n.parentNode)===null||o===void 0||o.insertBefore(s,n.nextSibling):(r=n.parentNode)===null||r===void 0||r.appendChild(s),s}})(t),QA=ne(Nl,!0),JA=ne(Nl,!1),VC=(e,t)=>j(e.container())?Nl(t,e.container()):Nl(t,e.getNode()),qC=(e,t)=>{const n=t.get();return n&&e.container()===n&&To(n)},Dm=(e,t)=>t.fold(n=>{cr(e.get());const o=QA(n);return e.set(o),C.some(M(o,o.length-1))},n=>Lt(n).map(o=>{if(qC(o,e)){const r=e.get();return M(r,1)}{cr(e.get());const r=VC(o,!0);return e.set(r),M(r,1)}}),n=>wn(n).map(o=>{if(qC(o,e)){const r=e.get();return M(r,r.length-1)}{cr(e.get());const r=VC(o,!1);return e.set(r),M(r,r.length-1)}}),n=>{cr(e.get());const o=JA(n);return e.set(o),C.some(M(o,1))}),WC=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n].apply(null,t);if(o.isSome())return o}return C.none()},Ut=Wn([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),KC=(e,t)=>Po(t,e)||e,eT=(e,t,n)=>{const o=s0(n),r=KC(t,o.container());return Uo(e,r,o).fold(()=>Vt(r,o).bind(ne(Uo,e,r)).map(s=>Ut.before(s)),C.none)},tT=(e,t)=>ur(e,t)===null,YC=(e,t,n)=>Uo(e,t,n).filter(ne(tT,t)),nT=(e,t,n)=>{const o=a0(n);return YC(e,t,o).bind(r=>Zt(r,o).isNone()?C.some(Ut.start(r)):C.none())},oT=(e,t,n)=>{const o=s0(n);return YC(e,t,o).bind(r=>Vt(r,o).isNone()?C.some(Ut.end(r)):C.none())},rT=(e,t,n)=>{const o=a0(n),r=KC(t,o.container());return Uo(e,r,o).fold(()=>Zt(r,o).bind(ne(Uo,e,r)).map(s=>Ut.after(s)),C.none)},GC=e=>!r0(Lm(e)),Jn=(e,t,n)=>WC([eT,nT,oT,rT],[e,t,n]).filter(GC),Lm=e=>e.fold(jt,jt,jt,jt),XC=e=>e.fold(oe("before"),oe("start"),oe("end"),oe("after")),Rl=e=>e.fold(Ut.before,Ut.before,Ut.after,Ut.after),Mm=e=>e.fold(Ut.start,Ut.start,Ut.end,Ut.end),sT=(e,t,n,o,r,s)=>Tt(Uo(t,n,o),Uo(t,n,r),(a,i)=>a!==i&&((l,c,d)=>{const u=Po(c,l),m=Po(d,l);return q(u)&&u===m})(n,a,i)?Ut.after(e?a:i):s).getOr(s),aT=(e,t)=>e.fold(dt,n=>{return r=t,!(XC(o=n)===XC(r)&&Lm(o)===Lm(r));var o,r}),iT=(e,t)=>e?t.fold(In(C.some,Ut.start),C.none,In(C.some,Ut.after),C.none):t.fold(C.none,In(C.some,Ut.before),C.none,In(C.some,Ut.end)),ZC=(e,t,n)=>{const o=e?1:-1;return t.setRng(M(n.container(),n.offset()+o).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0};var eo;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(eo||(eo={}));const Al=(e,t)=>e===kt.Backwards?Ts(t):t,lT=(e,t,n)=>e===kt.Forwards?t.next(n):t.prev(n),cT=(e,t,n,o)=>rt(o.getNode(t===kt.Forwards))?eo.Br:Kn(n,o)===!1?eo.Block:eo.Wrap,QC=(e,t,n,o)=>{const r=Gn(n);let s=o;const a=[];for(;s;){const i=lT(t,r,s);if(!i)break;if(rt(i.getNode(!1)))return t===kt.Forwards?{positions:Al(t,a).concat([i]),breakType:eo.Br,breakAt:C.some(i)}:{positions:Al(t,a),breakType:eo.Br,breakAt:C.some(i)};if(i.isVisible()){if(e(s,i)){const l=cT(0,t,s,i);return{positions:Al(t,a),breakType:l,breakAt:C.some(i)}}a.push(i),s=i}else s=i}return{positions:Al(t,a),breakType:eo.Eol,breakAt:C.none()}},JC=(e,t,n,o)=>t(n,o).breakAt.map(r=>{const s=t(n,r).positions;return e===kt.Backwards?s.concat(r):[r].concat(s)}).getOr([]),Im=(e,t)=>Yt(e,(n,o)=>n.fold(()=>C.some(o),r=>Tt(Ht(r.getClientRects()),Ht(o.getClientRects()),(s,a)=>{const i=Math.abs(t-s.left);return Math.abs(t-a.left)<=i?o:r}).or(n)),C.none()),Tl=(e,t)=>Ht(t.getClientRects()).bind(n=>Im(e,n.left)),Ua=ne(QC,M.isAbove,-1),za=ne(QC,M.isBelow,1),e1=ne(JC,-1,Ua),t1=ne(JC,1,za),n1=(e,t)=>Ua(e,t).breakAt.isNone(),o1=(e,t)=>za(e,t).breakAt.isNone(),dT=(e,t)=>Tl(e1(e,t),t),uT=(e,t)=>Tl(t1(e,t),t),mT=Ge,r1=(e,t)=>Math.abs(e.left-t),s1=(e,t)=>Math.abs(e.right-t),a1=(e,t)=>li(e,(n,o)=>{const r=Math.min(r1(n,t),s1(n,t)),s=Math.min(r1(o,t),s1(o,t));return s===r&&Br(o,"node")&&mT(o.node)||s<r?o:n}),fT=e=>{const t=n=>Te(n,o=>{const r=ir(o);return r.node=e,r});if(re(e))return t(e.getClientRects());if(j(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}return[]},i1=e=>an(e,fT);var ja;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(ja||(ja={}));const l1=(e,t,n,o,r,s)=>{let a=0;const i=[],l=u=>{let m=i1([u]);e===-1&&(m=m.reverse());for(let p=0;p<m.length;p++){const g=m[p];if(!n(g,c)){if(i.length>0&&t(g,qo(i))&&a++,g.line=a,r(g))return!0;i.push(g)}}return!1},c=qo(s.getClientRects());if(!c)return i;const d=s.getNode();return d&&(l(d),((u,m,p,g)=>{let h=g;for(;h=pa(h,u,Qp,m);)if(p(h))return})(e,o,l,d)),i},gT=ne(l1,ja.Up,ia,la),pT=ne(l1,ja.Down,la,ia),c1=e=>qo(e.getClientRects()),d1=e=>t=>((n,o)=>o.line>n)(e,t),Fm=e=>t=>((n,o)=>o.line===n)(e,t),vo=(e,t)=>{e.selection.setRng(t),xa(e,e.selection.getRng())},Um=(e,t,n)=>C.some(Rm(e,t,n)),u1=(e,t,n,o,r,s)=>{const a=t===kt.Forwards,i=Gn(e.getBody()),l=ne(Dd,a?i.next:i.prev),c=a?o:r;if(!n.collapsed){const g=Di(n);if(s(g))return bo(t,e,g,t===kt.Backwards,!1);if(Om(e)){const h=n.cloneRange();return h.collapse(t===kt.Backwards),C.from(h)}}const d=va(t,e.getBody(),n);if(c(d))return Fa(e,d.getNode(!a));let u=l(d);const m=qp(n);if(!u)return m?C.some(n):C.none();if(u=pn(a,u),c(u))return bo(t,e,u.getNode(!a),a,!1);const p=l(u);return p&&c(p)&&$i(u,p)?bo(t,e,p.getNode(!a),a,!1):m?Um(e,u.toRange(),!1):C.none()},m1=(e,t,n,o,r,s)=>{const a=va(t,e.getBody(),n),i=qo(a.getClientRects()),l=t===ja.Down,c=e.getBody();if(!i)return C.none();if(Om(e)){const h=l?M.fromRangeEnd(n):M.fromRangeStart(n);return(l?uT:dT)(c,h).orThunk(()=>C.from(h)).map(f=>f.toRange())}const d=(l?pT:gT)(c,d1(1),a),u=ye(d,Fm(1)),m=i.left,p=a1(u,m);if(p&&s(p.node)){const h=Math.abs(m-p.left),f=Math.abs(m-p.right);return bo(t,e,p.node,h<f,!1)}let g;if(g=o(a)?a.getNode():r(a)?a.getNode(!0):Di(n),g){const h=((b,v,y,w)=>{const E=Gn(v);let k,S,_,T;const P=[];let x=0;b===1?(k=E.next,S=la,_=ia,T=M.after(w)):(k=E.prev,S=ia,_=la,T=M.before(w));const N=c1(T);do{if(!T.isVisible())continue;const B=c1(T);if(_(B,N))continue;P.length>0&&S(B,qo(P))&&x++;const I=ir(B);if(I.position=T,I.line=x,y(I))return P;P.push(I)}while(T=k(T));return P})(t,c,d1(1),g);let f=a1(ye(h,Fm(1)),m);if(f||(f=qo(ye(h,Fm(0))),f))return Um(e,f.position.toRange(),!1)}return u.length===0?zm(e,l).filter(l?r:o).map(h=>Rm(e,h.toRange(),!1)):C.none()},zm=(e,t)=>{const n=e.selection.getRng(),o=t?M.fromRangeEnd(n):M.fromRangeStart(n),r=(s=o.container(),a=e.getBody(),co(R(s),i=>hN(i.dom),i=>i.dom===a).map(i=>i.dom).getOr(a));var s,a;if(t){const i=za(r,o);return Eo(i.positions)}{const i=Ua(r,o);return Ht(i.positions)}},f1=(e,t,n)=>zm(e,t).filter(n).exists(o=>(e.selection.setRng(o.toRange()),!0)),Ol=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},g1=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},p1=(e,t,n)=>Dm(t,n).map(o=>(Ol(e,o),n)),hT=(e,t,n)=>{const o=e.getBody(),r=((s,a,i)=>{const l=M.fromRangeStart(s);if(s.collapsed)return l;{const c=M.fromRangeEnd(s);return i?Zt(a,c).getOr(c):Vt(a,l).getOr(l)}})(e.selection.getRng(),o,n);return((s,a,i,l)=>{const c=pn(s,l),d=Jn(a,i,c);return Jn(a,i,c).bind(ne(iT,s)).orThunk(()=>((u,m,p,g,h)=>{const f=pn(u,h);return dn(u,p,f).map(ne(pn,u)).fold(()=>g.map(Rl),b=>Jn(m,p,b).map(ne(sT,u,m,p,f,b)).filter(ne(aT,g))).filter(GC)})(s,a,i,d,l))})(n,ne(br,e),o,r).bind(s=>p1(e,t,s))},h1=(e,t,n)=>!!ma(e)&&hT(e,t,n).isSome(),b1=(e,t,n)=>!!ma(t)&&((o,r)=>{const s=r.selection.getRng(),a=o?M.fromRangeEnd(s):M.fromRangeStart(s);return!!(i=>Ie(i.selection.getSel().modify))(r)&&(o&&fd(a)?ZC(!0,r.selection,a):!(o||!gd(a))&&ZC(!1,r.selection,a))})(e,t),bT=e=>{const t=wt(null),n=ne(br,e);return e.on("NodeChange",o=>{ma(e)&&(((r,s,a)=>{const i=Te(Bt(R(s.getRoot()),'*[data-mce-selected="inline-boundary"]'),d=>d.dom),l=ye(i,r),c=ye(a,r);U(si(l,c),ne(g1,!1)),U(si(c,l),ne(g1,!0))})(n,e.dom,o.parents),((r,s)=>{const a=s.get();if(r.selection.isCollapsed()&&!r.composing&&a){const i=M.fromRangeStart(r.selection.getRng());M.isTextPosition(i)&&!(l=>fd(l)||gd(l))(i)&&(Ol(r,uN(a,i)),s.set(null))}})(e,t),((r,s,a,i)=>{if(s.selection.isCollapsed()){const l=ye(i,r);U(l,c=>{const d=M.fromRangeStart(s.selection.getRng());Jn(r,s.getBody(),d).bind(u=>p1(s,a,u))})}})(n,e,t,o.parents))}),t},vT=ne(b1,!0),yT=ne(b1,!1),Bl=(e,t,n)=>{if(ma(e)){const o=zm(e,t).getOrThunk(()=>{const r=e.selection.getRng();return t?M.fromRangeEnd(r):M.fromRangeStart(r)});return Jn(ne(br,e),e.getBody(),o).exists(r=>{const s=Rl(r);return Dm(n,s).exists(a=>(Ol(e,a),!0))})}return!1},v1=(e,t)=>n=>Dm(t,n).map(o=>()=>Ol(e,o)),y1=(e,t,n,o)=>{const r=e.getBody(),s=ne(br,e);e.undoManager.ignore(()=>{e.selection.setRng(((a,i)=>{const l=document.createRange();return l.setStart(a.container(),a.offset()),l.setEnd(i.container(),i.offset()),l})(n,o)),Nu(e),Jn(s,r,M.fromRangeStart(e.selection.getRng())).map(Mm).bind(v1(e,t)).each(Ns)}),e.nodeChanged()},jm=(e,t,n)=>{if(e.selection.isCollapsed()&&ma(e)){const o=M.fromRangeStart(e.selection.getRng());return((r,s,a,i)=>{const l=((u,m)=>Po(m,u)||u)(r.getBody(),i.container()),c=ne(br,r),d=Jn(c,l,i);return d.bind(u=>a?u.fold(oe(C.some(Mm(u))),C.none,oe(C.some(Rl(u))),C.none):u.fold(C.none,oe(C.some(Rl(u))),C.none,oe(C.some(Mm(u))))).map(v1(r,s)).getOrThunk(()=>{const u=Jr(a,l,i),m=u.bind(p=>Jn(c,l,p));return Tt(d,m,()=>Uo(c,l,i).bind(p=>(g=>Tt(Lt(g),wn(g),(h,f)=>{const b=pn(!0,h),v=pn(!1,f);return Vt(g,b).forall(y=>y.isEqual(v))}).getOr(!0))(p)?C.some(()=>{hr(r,a,R(p))}):C.none())).getOrThunk(()=>m.bind(()=>u.map(p=>()=>{a?y1(r,s,i,p):y1(r,s,p,i)})))})})(e,t,n,o)}return C.none()},C1=(e,t)=>{const n=R(e.getBody()),o=R(e.selection.getStart()),r=ho(o,n);return As(r,t).fold(oe(r),s=>r.slice(0,s))},CT=e=>Oc(e)===1,w1=(e,t)=>{const n=ne(M0,e);return an(t,o=>n(o)?[o.dom]:[])},E1=e=>{const t=(n=>C1(n,o=>n.schema.isBlock(Oe(o))))(e);return w1(e,t)},wT=(e,t)=>{const n=ye((o=>C1(o,r=>o.schema.isBlock(Oe(r))||(s=>Oc(s)>1)(r)))(e),CT);return Eo(n).bind(o=>{const r=M.fromRangeStart(e.selection.getRng());return l0(t,r,o.dom)&&!Qd(o)?C.some(()=>((s,a,i,l)=>{const c=w1(a,l);if(c.length===0)hr(a,s,i);else{const d=L0(i.dom,c);a.selection.setRng(d.toRange())}})(t,e,o,n)):C.none()})},k1=(e,t)=>{const n=e.selection.getStart(),o=((r,s)=>{const a=s.parentElement;return rt(s)&&!ct(a)&&r.dom.isEmpty(a)})(e,n)||Qd(R(n))?L0(n,t):((r,s)=>{const{caretContainer:a,caretPosition:i}=D0(s);return r.insertNode(a.dom),i})(e.selection.getRng(),t);e.selection.setRng(o.toRange())},x1=e=>j(e.startContainer),ET=e=>{const t=e.selection.getRng();return(n=>n.startOffset===0&&x1(n))(t)&&((n,o)=>{const r=o.startContainer.parentElement;return!ct(r)&&M0(n,R(r))})(e,t)&&(n=>(o=>(r=>{const s=r.startContainer.parentNode,a=r.endContainer.parentNode;return!ct(s)&&!ct(a)&&s.isEqualNode(a)})(o)&&(r=>{const s=r.endContainer;return r.endOffset===(j(s)?s.length:s.childNodes.length)})(o))(n)||(o=>!o.endContainer.isEqualNode(o.commonAncestorContainer))(n))(t)},Hm=(e,t)=>e.selection.isCollapsed()?wT(e,t):(n=>{if(ET(n)){const o=E1(n);return C.some(()=>{Nu(n),((r,s)=>{const a=si(s,E1(r));a.length>0&&k1(r,a)})(n,o)})}return C.none()})(e),Ha=e=>((t=>{const n=t.selection.getRng();return n.collapsed&&(x1(n)||t.dom.isEmpty(n.startContainer))&&!(o=>{return r=R(o.selection.getStart()),s=o.schema,Zg(r,a=>un(a.dom),a=>s.isBlock(Oe(a)));var r,s})(t)})(e)&&k1(e,[]),!0),$m=(e,t,n)=>q(n)?C.some(()=>{e._selectionOverrides.hideFakeCaret(),hr(e,t,R(n))}):C.none(),Vm=(e,t)=>e.selection.isCollapsed()?((n,o)=>{const r=o?_a:Sa,s=o?kt.Forwards:kt.Backwards,a=va(s,n.getBody(),n.selection.getRng());return r(a)?$m(n,o,a.getNode(!o)):C.from(pn(o,a)).filter(i=>r(i)&&$i(a,i)).bind(i=>$m(n,o,i.getNode(!o)))})(e,t):((n,o)=>{const r=n.selection.getNode();return qn(r)?$m(n,o,r):C.none()})(e,t),qm=e=>ci(e??"").getOr(0),_1=(e,t)=>(e||Oe(t)==="table"?"margin":"padding")+($n(t,"direction")==="rtl"?"-right":"-left"),S1=e=>{const t=R1(e);return!e.mode.isReadOnly()&&(t.length>1||((n,o)=>wo(o,r=>{const s=_1(Oh(n),r),a=bi(r,s).map(qm).getOr(0);return n.dom.getContentEditable(r.dom)!=="false"&&a>0}))(e,t))},N1=e=>md(e)||ra(e),R1=e=>ye(Mc(e.selection.getSelectedBlocks()),t=>!N1(t)&&!(n=>Rn(n).exists(N1))(t)&&Yo(t,n=>Cn(n.dom)||Ge(n.dom)).exists(n=>Cn(n.dom))),A1=(e,t)=>{var n,o;const{dom:r}=e,s=iS(e),a=(o=(n=/[a-z%]+$/i.exec(s))===null||n===void 0?void 0:n[0])!==null&&o!==void 0?o:"px",i=qm(s),l=Oh(e);U(R1(e),c=>{((d,u,m,p,g,h)=>{const f=_1(m,R(h)),b=qm(d.getStyle(h,f));if(u==="outdent"){const v=Math.max(0,b-p);d.setStyle(h,f,v?v+g:"")}else{const v=b+p+g;d.setStyle(h,f,v)}})(r,t,l,i,a,c.dom)})},T1=e=>A1(e,"outdent"),O1=e=>{if(e.selection.isCollapsed()&&S1(e)){const t=e.dom,n=e.selection.getRng(),o=M.fromRangeStart(n),r=t.getParent(n.startContainer,t.isBlock);if(r!==null&&Cu(R(r),o,e.schema))return C.some(()=>T1(e))}return C.none()},B1=(e,t,n)=>Or([O1,Bm,Am,(o,r)=>jm(o,t,r),Sm,Mu,Pm,Vm,Nm,Hm],o=>o(e,n)).filter(o=>e.selection.isEditable()),kT=(e,t)=>{e.addCommand("delete",()=>{((n,o)=>{B1(n,o,!1).fold(()=>{n.selection.isEditable()&&(Nu(n),Ru(n))},Ns)})(e,t)}),e.addCommand("forwardDelete",()=>{((n,o)=>{B1(n,o,!0).fold(()=>{n.selection.isEditable()&&(r=>{i0(r,"ForwardDelete")})(n)},Ns)})(e,t)})},P1=e=>e.touches===void 0||e.touches.length!==1?C.none():C.some(e.touches[0]),Wm=(e,t)=>ke(e,t.nodeName),xT=(e,t)=>!!j(t)||!!re(t)&&!(Wm(e.getBlockElements(),t)||mn(t)||er(e,t)||Vc(t)),_T=(e,t)=>{if(j(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data))return!t.nextSibling||Wm(e,t.nextSibling)||Vc(t.nextSibling)}return!1},D1=e=>e.dom.create(Dt(e),ua(e)),ST=e=>{const t=e.dom,n=e.selection,o=e.schema,r=o.getBlockElements(),s=n.getStart(),a=e.getBody();let i,l,c=!1;const d=Dt(e);if(!s||!re(s))return;const u=a.nodeName.toLowerCase();if(!o.isValidChild(u,d.toLowerCase())||((y,w,E)=>it(Uv(R(E),R(w)),k=>Wm(y,k.dom)))(r,a,s))return;const m=n.getRng(),{startContainer:p,startOffset:g,endContainer:h,endOffset:f}=m,b=pr(e);let v=a.firstChild;for(;v;)if(re(v)&&a_(o,v),xT(o,v)){if(_T(r,v)){l=v,v=v.nextSibling,t.remove(l);continue}i||(i=D1(e),a.insertBefore(i,v),c=!0),l=v,v=v.nextSibling,i.appendChild(l)}else i=null,v=v.nextSibling;c&&b&&(m.setStart(p,g),m.setEnd(h,f),n.setRng(m),e.nodeChanged())},L1=(e,t,n)=>{const o=R(D1(e)),r=aa();ut(o,r),n(t,o);const s=document.createRange();return s.setStartBefore(r.dom),s.setEndBefore(r.dom),s},M1=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,NT=(e,t,n)=>function(o){const r=arguments,s=r[r.length-2],a=s>0?t.charAt(s-1):"";if(a==='"')return o;if(a===">"){const i=t.lastIndexOf("<",s);if(i!==-1&&t.substring(i,s).indexOf('contenteditable="false"')!==-1)return o}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(r[0])+'">'+e.dom.encode(typeof r[1]=="string"?r[1]:r[0])+"</span>"},I1=(e,t)=>{t.hasAttribute("data-mce-caret")&&(pd(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},RT=(e,t)=>{const n=(o=>pi(R(o.getBody()),"*[data-mce-caret]").map(r=>r.dom).getOrNull())(e);if(n)return t.type==="compositionstart"?(t.preventDefault(),t.stopPropagation(),void I1(e,n)):void(Vp(n)&&(I1(e,n),e.undoManager.add()))},F1=Ge,U1=(e,t,n)=>{const o=Gn(e.getBody()),r=ne(Dd,t===1?o.next:o.prev);if(n.collapsed){const s=e.dom.getParent(n.startContainer,"PRE");if(!s)return;if(!r(M.fromRangeStart(n))){const a=R((i=>{const l=i.dom.create(Dt(i));return l.innerHTML='<br data-mce-bogus="1">',l})(e));t===1?uo(R(s),a):Xt(R(s),a),e.selection.select(a.dom,!0),e.selection.collapse()}}},z1=(e,t)=>((n,o)=>{const r=o?kt.Forwards:kt.Backwards,s=n.selection.getRng();return((a,i,l)=>u1(i,a,l,Io,Fo,F1))(r,n,s).orThunk(()=>(U1(n,r,s),C.none()))})(e,((n,o)=>{const r=o?n.getEnd(!0):n.getStart(!0);return r0(r)?!o:o})(e.selection,t)).exists(n=>(vo(e,n),!0)),j1=(e,t)=>((n,o)=>{const r=o?1:-1,s=n.selection.getRng();return((a,i,l)=>m1(i,a,l,c=>Io(c)||Iv(c),c=>Fo(c)||Fv(c),F1))(r,n,s).orThunk(()=>(U1(n,r,s),C.none()))})(e,t).exists(n=>(vo(e,n),!0)),H1=(e,t)=>f1(e,t,t?Fo:Io),Pl=(e,t)=>Tm(e,!t).map(n=>{const o=n.toRange(),r=e.selection.getRng();return t?o.setStart(r.startContainer,r.startOffset):o.setEnd(r.endContainer,r.endOffset),o}).exists(n=>(vo(e,n),!0)),AT=e=>Ue(["figcaption"],Oe(e)),$1=(e,t)=>!!e.selection.isCollapsed()&&((n,o)=>{const r=R(n.getBody()),s=M.fromRangeStart(n.selection.getRng());return((a,i,l)=>{const c=ne(De,i);return Yo(R(a.container()),d=>l.isBlock(Oe(d)),c).filter(AT)})(s,r,n.schema).exists(()=>{if(((a,i,l)=>i?o1(a.dom,l):n1(a.dom,l))(r,o,s)){const a=L1(n,r,o?ut:Lc);return n.selection.setRng(a),!0}return!1})})(e,t),V1=(e,t)=>((n,o)=>o?C.from(n.dom.getParent(n.selection.getNode(),"details")).map(r=>((s,a)=>{const i=s.selection.getRng(),l=M.fromRangeStart(i);return!(s.getBody().lastChild!==a||!o1(a,l)||(s.execCommand("InsertNewBlockAfter"),0))})(n,r)).getOr(!1):C.from(n.dom.getParent(n.selection.getNode(),"summary")).bind(r=>C.from(n.dom.getParent(r,"details")).map(s=>((a,i,l)=>{const c=a.selection.getRng(),d=M.fromRangeStart(c);return!(a.getBody().firstChild!==i||!n1(l,d)||(a.execCommand("InsertNewBlockBefore"),0))})(n,s,r))).getOr(!1))(e,t),q1={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},W1=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,pe=(e,...t)=>()=>e.apply(null,t),$a=(e,t)=>pt(((n,o)=>an((r=>Te(r,s=>({...q1,...s})))(n),r=>W1(r,o)?[r]:[]))(e,t),n=>n.action()),K1=(e,t)=>Or(((n,o)=>an((r=>Te(r,s=>({...q1,...s})))(n),r=>W1(r,o)?[r]:[]))(e,t),n=>n.action()),Y1=(e,t)=>{const n=t?kt.Forwards:kt.Backwards,o=e.selection.getRng();return u1(e,n,o,_a,Sa,qn).exists(r=>(vo(e,r),!0))},G1=(e,t)=>{const n=t?1:-1,o=e.selection.getRng();return m1(e,n,o,_a,Sa,qn).exists(r=>(vo(e,r),!0))},X1=(e,t)=>f1(e,t,t?Sa:_a),Z1=Wn([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Va={...Z1,none:e=>Z1.none(e)},Q1=(e,t,n)=>an(Ot(e),o=>Nn(o,t)?n(o)?[o]:[]:Q1(o,t,n)),J1=(e,t)=>zr(e,"table",t),Km=(e,t,n,o,r=dt)=>{const s=o===1;if(!s&&n<=0)return Va.first(e[0]);if(s&&n>=e.length-1)return Va.last(e[e.length-1]);{const a=n+o,i=e[a];return r(i)?Va.middle(t,i):Km(e,t,a,o,r)}},ew=(e,t)=>J1(e,t).bind(n=>{const o=Q1(n,"th,td",dt);return As(o,r=>De(e,r)).map(r=>({index:r,all:o}))}),TT=["img","br"],OT=e=>{return(t=e,ud.getOption(t)).filter(n=>n.trim().length!==0||n.indexOf(Ct)>-1).isSome()||Ue(TT,Oe(e))||(n=>ui(n)&&nn(n,"contenteditable")==="false")(e);var t},tw=(e,t,n,o,r)=>{const s=Bt(R(n),"td,th,caption").map(i=>i.dom),a=ye(((i,l)=>an(l,c=>{const d=((u,m)=>({left:u.left-m,top:u.top-m,right:u.right+-2,bottom:u.bottom+-2,width:u.width+m,height:u.height+m}))(ir(c.getBoundingClientRect()),-1);return[{x:d.left,y:i(d),cell:c},{x:d.right,y:i(d),cell:c}]}))(e,s),i=>t(i,r));return((i,l,c)=>Yt(i,(d,u)=>d.fold(()=>C.some(u),m=>{const p=Math.sqrt(Math.abs(m.x-l)+Math.abs(m.y-c)),g=Math.sqrt(Math.abs(u.x-l)+Math.abs(u.y-c));return C.some(g<p?u:m)}),C.none()))(a,o,r).map(i=>i.cell)},BT=ne(tw,e=>e.bottom,(e,t)=>e.y<t),PT=ne(tw,e=>e.top,(e,t)=>e.y>t),nw=(e,t,n)=>{const o=e(t,n);return(r=>r.breakType===eo.Wrap&&r.positions.length===0)(o)||!rt(n.getNode())&&(r=>r.breakType===eo.Br&&r.positions.length===1)(o)?!((r,s,a)=>a.breakAt.exists(i=>r(s,i).breakAt.isSome()))(e,t,o):o.breakAt.isNone()},DT=ne(nw,Ua),LT=ne(nw,za),MT=(e,t,n,o)=>{const r=e.selection.getRng(),s=t?1:-1;return!(!Yh()||!((a,i,l)=>{const c=M.fromRangeStart(i);return es(!a,l).exists(d=>d.isEqual(c))})(t,r,n)||(bo(s,e,n,!t,!1).each(a=>{vo(e,a)}),0))},ow=(e,t,n)=>{const o=((s,a)=>{const i=a.getNode(s);return Vn(i)?C.some(i):C.none()})(!!t,n),r=t===!1;o.fold(()=>vo(e,n.toRange()),s=>es(r,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>vo(e,n.toRange()),a=>((i,l,c)=>{l.undoManager.transact(()=>{const d=i?uo:Xt,u=L1(l,R(c),d);vo(l,u)})})(t,e,s)))},IT=(e,t,n,o)=>{const r=e.selection.getRng(),s=M.fromRangeStart(r),a=e.getBody();if(!t&&DT(o,s)){const i=((l,c,d)=>((u,m)=>Ht(m.getClientRects()).bind(p=>BT(u,p.left,p.top)).bind(p=>{return Tl(wn(g=p).map(h=>Ua(g,h).positions.concat(h)).getOr([]),m);var g}))(c,d).orThunk(()=>Ht(d.getClientRects()).bind(u=>Im(e1(l,M.before(c)),u.left))).getOr(M.before(c)))(a,n,s);return ow(e,t,i),!0}if(t&&LT(o,s)){const i=((l,c,d)=>((u,m)=>Eo(m.getClientRects()).bind(p=>PT(u,p.left,p.top)).bind(p=>{return Tl(Lt(g=p).map(h=>[h].concat(za(g,h).positions)).getOr([]),m);var g}))(c,d).orThunk(()=>Ht(d.getClientRects()).bind(u=>Im(t1(l,M.after(c)),u.left))).getOr(M.after(c)))(a,n,s);return ow(e,t,i),!0}return!1},rw=(e,t,n)=>C.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(o=>C.from(e.dom.getParent(o,"table")).map(r=>n(e,t,r,o))).getOr(!1),sw=(e,t)=>rw(e,t,MT),Ym=(e,t)=>rw(e,t,IT),aw=(e,t,n)=>n.fold(C.none,C.none,(o,r)=>{return(s=r,Fg(s,OT)).map(a=>(i=>{const l=ss.exact(i,0,i,0);return DN(l)})(a));var s},o=>(e.execCommand("mceTableInsertRowAfter"),iw(e,t,o))),iw=(e,t,n)=>{return aw(e,t,(r=Go,ew(o=n,void 0).fold(()=>Va.none(o),s=>Km(s.all,o,s.index,1,r))));var o,r},FT=(e,t,n)=>{return aw(e,t,(r=Go,ew(o=n,void 0).fold(()=>Va.none(),s=>Km(s.all,o,s.index,-1,r))));var o,r},lw=(e,t)=>{const n=["table","li","dl"],o=R(e.getBody()),r=a=>{const i=Oe(a);return De(a,o)||Ue(n,i)},s=e.selection.getRng();return((a,i)=>((l,c,d=Qe)=>d(c)?C.none():Ue(l,Oe(c))?C.some(c):$s(c,l.join(","),u=>Nn(u,"table")||d(u)))(["td","th"],a,i))(R(t?s.endContainer:s.startContainer),r).map(a=>(J1(a,r).each(i=>{e.model.table.clearSelectedCells(i.dom)}),e.selection.collapse(!t),(t?iw:FT)(e,r,a).each(i=>{e.selection.setRng(i)}),!0)).getOr(!1)},Mn=(e,t)=>({container:e,offset:t}),Dl=Ve.DOM,Ll=e=>t=>e===t?-1:0,Gm=(e,t,n)=>{if(j(e)&&t>=0)return C.some(Mn(e,t));{const o=sr(Dl);return C.from(o.backwards(e,t,Ll(e),n)).map(r=>Mn(r.container,r.container.data.length))}},Xm=(e,t,n)=>{if(!j(e))return C.none();const o=e.data;if(t>=0&&t<=o.length)return C.some(Mn(e,t));{const r=sr(Dl);return C.from(r.backwards(e,t,Ll(e),n)).bind(s=>{const a=s.container.data;return Xm(s.container,t+a.length,n)})}},cw=(e,t,n)=>{if(!j(e))return C.none();const o=e.data;if(t<=o.length)return C.some(Mn(e,t));{const r=sr(Dl);return C.from(r.forwards(e,t,Ll(e),n)).bind(s=>cw(s.container,t-o.length,n))}},Zm=(e,t,n,o,r)=>{const s=sr(e,(a=>i=>a.isBlock(i)||Ue(["BR","IMG","HR","INPUT"],i.nodeName)||a.getContentEditable(i)==="false")(e));return C.from(s.backwards(t,n,o,r))},dw=e=>e!==""&&`  \f
\r	\v`.indexOf(e)!==-1,UT=(e,t)=>e.substring(t.length),Qm=(e,t,n,o=!1)=>{if(!(r=t).collapsed||!j(r.startContainer))return C.none();var r;const s={text:"",offset:0},a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return Zm(e,t.startContainer,t.startOffset,(i,l,c)=>(s.text=c+s.text,s.offset+=l,((d,u,m,p=!1)=>{let g;const h=m.charAt(0);for(g=u-1;g>=0;g--){const f=d.charAt(g);if(!p&&dw(f))return C.none();if(h===f&&At(d,m,g,u))break}return C.some(g)})(s.text,s.offset,n,o).getOr(l)),a).bind(i=>{const l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return C.none();const c=(d=>on(d.toString().replace(/\u00A0/g," ")))(l);return c.lastIndexOf(n)!==0?C.none():C.some({text:UT(c,n),range:l,trigger:n})})},uw=e=>{if((t=>t.nodeType===3)(e))return Mn(e,e.data.length);{const t=e.childNodes;return t.length>0?uw(t[t.length-1]):Mn(e,t.length)}},mw=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?mw(n[t],0):n.length>0&&(o=>o.nodeType===1)(e)&&n.length===t?uw(n[n.length-1]):Mn(e,t)},fw=(e,t,n,o={})=>{var r;const s=t(),a=(r=e.selection.getRng().startContainer.nodeValue)!==null&&r!==void 0?r:"",i=ye(s.lookupByTrigger(n.trigger),c=>n.text.length>=c.minChars&&c.matches.getOrThunk(()=>(d=>u=>{const m=mw(u.startContainer,u.startOffset);return!((p,g)=>{var h;const f=(h=p.getParent(g.container,p.isBlock))!==null&&h!==void 0?h:p.getRoot();return Zm(p,g.container,g.offset,(b,v)=>v===0?-1:v,f).filter(b=>{const v=b.container.data.charAt(b.offset-1);return!dw(v)}).isSome()})(d,m)})(e.dom))(n.range,a,n.text));if(i.length===0)return C.none();const l=Promise.all(Te(i,c=>c.fetch(n.text,c.maxResults,o).then(d=>({matchText:n.text,items:d,columns:c.columns,onAction:c.onAction,highlightOn:c.highlightOn}))));return C.some({lookupData:l,context:n})};var to;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(to||(to={}));const Jm=(e,t,n)=>e.stype===to.Error?t(e.serror):n(e.svalue),fs=e=>({stype:to.Value,svalue:e}),qa=e=>({stype:to.Error,serror:e}),zT=Jm,ef=e=>We(e)&&Gt(e).length>100?" removed due to size":JSON.stringify(e,null,2),Ml=(e,t)=>qa([{path:e,getErrorInfo:t}]),jT=(e,t)=>({extract:(n,o)=>Xe(o,e).fold(()=>((r,s)=>Ml(r,()=>'Choice schema did not contain choice key: "'+s+'"'))(n,e),r=>((s,a,i,l)=>Xe(i,l).fold(()=>((c,d,u)=>Ml(c,()=>'The chosen schema: "'+u+'" did not exist in branches: '+ef(d)))(s,i,l),c=>c.extract(s.concat(["branch: "+l]),a)))(n,o,t,r)),toString:()=>"chooseOn("+e+"). Possible values: "+Gt(t)}),HT=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let o=0;o<t.length;o++){const r=t[o];for(const s in r)ke(r,s)&&(n[s]=e(n[s],r[s]))}return n},tf=HT((e,t)=>Rt(e)&&Rt(t)?tf(e,t):t),gw=e=>({tag:"defaultedThunk",process:oe(e)}),$T=e=>{const t=(o=>{const r=[],s=[];return U(o,a=>{Jm(a,i=>s.push(i),i=>r.push(i))}),{values:r,errors:s}})(e);return t.errors.length>0?(n=t.errors,In(qa,rg)(n)):fs(t.values);var n},pw=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},nf=e=>({extract:(t,n)=>{return o=e(n),r=s=>((a,i)=>Ml(a,oe(i)))(t,s),o.stype===to.Error?r(o.serror):o;var o,r},toString:oe("val")}),VT=nf(fs),hw=(e,t,n,o)=>o(Xe(e,t).getOrThunk(()=>n(e))),qT=(e,t,n,o,r)=>{const s=i=>r.extract(t.concat([o]),i),a=i=>i.fold(()=>fs(C.none()),l=>{return d=r.extract(t.concat([o]),l),u=C.some,d.stype===to.Value?{stype:to.Value,svalue:u(d.svalue)}:d;var d,u});switch(e.tag){case"required":return((i,l,c,d)=>Xe(l,c).fold(()=>((u,m,p)=>Ml(u,()=>'Could not find valid *required* value for "'+m+'" in '+ef(p)))(i,c,l),d))(t,n,o,s);case"defaultedThunk":return hw(n,o,e.process,s);case"option":return((i,l,c)=>c(Xe(i,l)))(n,o,a);case"defaultedOptionThunk":return((i,l,c,d)=>d(Xe(i,l).map(u=>u===!0?c(i):u)))(n,o,e.process,a);case"mergeWithThunk":return hw(n,o,oe({}),i=>{const l=tf(e.process(n),i);return s(l)})}},of=e=>({extract:(t,n)=>((o,r,s)=>{const a={},i=[];for(const l of s)pw(l,(c,d,u,m)=>{const p=qT(u,o,r,c,m);zT(p,g=>{i.push(...g)},g=>{a[d]=g})},(c,d)=>{a[c]=d(r)});return i.length>0?qa(i):fs(a)})(t,n,e),toString:()=>`obj{
`+Te(e,n=>pw(n,(o,r,s,a)=>o+" -> "+a.toString(),(o,r)=>"state("+o+")")).join(`
`)+"}"}),bw=e=>({extract:(t,n)=>{const o=Te(n,(r,s)=>e.extract(t.concat(["["+s+"]"]),r));return $T(o)},toString:()=>"array("+e.toString()+")"}),WT=(e,t,n)=>{return o=((r,s,a)=>((i,l)=>i.stype===to.Error?{stype:to.Error,serror:l(i.serror)}:i)(s.extract([r],a),i=>({input:a,errors:i})))(e,t,n),Jm(o,$t.error,$t.value);var o},vw=(e,t)=>jT(e,Bs(t,of)),KT=oe(VT),Il=(e,t)=>nf(n=>{const o=typeof n;return e(n)?fs(n):qa(`Expected type: ${t} but got: ${o}`)}),YT=Il(Sn,"number"),Fl=Il(Q,"string"),GT=Il(Kt,"boolean"),rf=Il(Ie,"function"),Wa=(e,t,n,o)=>({tag:"field",key:e,newKey:t,presence:n,prop:o}),yw=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),Cw=(e,t)=>Wa(e,e,{tag:"required",process:{}},t),ww=e=>Cw(e,Fl),Ew=e=>Cw(e,rf),sf=(e,t)=>Wa(e,e,{tag:"option",process:{}},t),Ul=e=>sf(e,Fl),gs=(e,t,n)=>Wa(e,e,gw(t),n),kw=(e,t)=>gs(e,t,YT),xw=(e,t,n)=>gs(e,t,(o=>{return r=s=>Ue(o,s)?$t.value(s):$t.error(`Unsupported value: "${s}", choose one of "${o.join(", ")}".`),nf(s=>r(s).fold(qa,fs));var r})(n)),af=(e,t)=>gs(e,t,GT),lf=(e,t)=>gs(e,t,rf),XT=ww("type"),ZT=Ew("fetch"),cf=Ew("onAction"),QT=lf("onSetup",()=>Ne),JT=Ul("text"),eO=Ul("icon"),tO=Ul("tooltip"),nO=Ul("label"),oO=af("active",!1),rO=af("enabled",!0),_w=af("primary",!1),Ka=e=>((t,n)=>gs("type",n,Fl))(0,e),sO=of([XT,ww("trigger"),kw("minChars",1),((e,t)=>Wa(e,e,gw(1),KT()))("columns"),kw("maxResults",10),sf("matches",rf),ZT,cf,(Sw=Fl,gs("highlightOn",[],bw(Sw)))]);var Sw;const df=[rO,tO,eO,JT,QT],Nw=[oO].concat(df),aO=[lf("predicate",Qe),xw("scope","node",["node","editor"]),xw("position","selection",["node","selection","line"])],iO=df.concat([Ka("contextformbutton"),_w,cf,yw("original",jt)]),lO=Nw.concat([Ka("contextformbutton"),_w,cf,yw("original",jt)]),cO=df.concat([Ka("contextformbutton")]),dO=Nw.concat([Ka("contextformtogglebutton")]),uO=vw("type",{contextformbutton:iO,contextformtogglebutton:lO});of([Ka("contextform"),lf("initValue",oe("")),nO,((e,t)=>Wa(e,e,{tag:"required",process:{}},bw(t)))("commands",uO),sf("launch",vw("type",{contextformbutton:cO,contextformtogglebutton:dO}))].concat(aO));const mO=e=>{const t=e.ui.registry.getAll().popups,n=Bs(t,s=>{return(a=s,WT("Autocompleter",sO,a)).fold(i=>{throw new Error(`Errors: 
`+(c=>{const d=c.length>10?c.slice(0,10).concat([{path:[],getErrorInfo:oe("... (only showing first ten failures)")}]):c;return Te(d,u=>"Failed path: ("+u.path.join(" > ")+`)
`+u.getErrorInfo())})((l=i).errors).join(`
`)+`

Input object: `+ef(l.input));var l},jt);var a}),o=ig(ai(n,s=>s.trigger)),r=yc(n);return{dataset:n,triggers:o,lookupByTrigger:s=>ye(r,a=>a.trigger===s)}},fO=e=>{const t=Ro(),n=wt(!1),o=t.isSet,r=()=>{o()&&((l=>{l.dispatch("AutocompleterEnd")})(e),n.set(!1),t.clear())},s=Fn(()=>mO(e)),a=l=>{(c=>t.get().map(d=>Qm(e.dom,e.selection.getRng(),d.trigger,!0).bind(u=>fw(e,s,u,c))).getOrThunk(()=>((d,u)=>{const m=u(),p=d.selection.getRng();return((g,h,f)=>Or(f.triggers,b=>Qm(g,h,b)))(d.dom,p,m).bind(g=>fw(d,u,g))})(e,s)))(l).fold(r,c=>{(d=>{o()||t.set({trigger:d.trigger,matchLength:d.text.length})})(c.context),c.lookupData.then(d=>{t.get().map(u=>{const m=c.context;u.trigger===m.trigger&&(m.text.length-u.matchLength>=10?r():(t.set({...u,matchLength:m.text.length}),n.get()?(Jd(e,{range:m.range}),((p,g)=>{p.dispatch("AutocompleterUpdate",g)})(e,{lookupData:d})):(n.set(!0),Jd(e,{range:m.range}),((p,g)=>{p.dispatch("AutocompleterStart",g)})(e,{lookupData:d}))))})})})},i=()=>t.get().bind(({trigger:l})=>{const c=e.selection.getRng();return Qm(e.dom,c,l,n.get()).filter(({range:d})=>((u,m)=>{const p=u.compareBoundaryPoints(window.Range.START_TO_START,m),g=u.compareBoundaryPoints(window.Range.END_TO_END,m);return p>=0&&g<=0})(c,d)).map(({range:d})=>d)});e.addCommand("mceAutocompleterReload",(l,c)=>{const d=We(c)?c.fetchOptions:{};a(d)}),e.addCommand("mceAutocompleterClose",r),e.addCommand("mceAutocompleterRefreshActiveRange",()=>{i().each(l=>{Jd(e,{range:l})})}),e.editorCommands.addQueryStateHandler("mceAutoCompleterInRange",()=>i().isSome()),((l,c)=>{const d=dd(c.load,50);l.on("input",()=>{d.throttle()}),l.on("keydown",u=>{const m=u.which;m===8?d.throttle():m===27?(d.cancel(),c.cancelIfNecessary()):m!==38&&m!==40||d.cancel()},!0),l.on("remove",d.cancel)})(e,{cancelIfNecessary:r,load:a})},gO=zn().browser.isSafari(),Rw=e=>Ao(R(e)),Aw=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},zl=(e,t)=>C.from(e.getParent(t.container(),"details")),Tw=(e,t)=>zl(e,t).isSome(),Ow=(e,t)=>{const n=t.getNode();st(n)||e.selection.setCursorLocation(n,t.offset())},Bw=(e,t,n)=>{const o=e.dom.getParent(t.container(),"details");if(o&&!o.open){const r=e.dom.select("summary",o)[0];r&&(n?Lt(r):wn(r)).each(s=>Ow(e,s))}else Ow(e,t)},Pw=(e,t,n)=>{const{dom:o,selection:r}=e,s=e.getBody();if(n==="character"){const a=M.fromRangeStart(r.getRng()),i=o.getParent(a.container(),o.isBlock),l=zl(o,a),c=i&&o.isEmpty(i),d=ct(i==null?void 0:i.previousSibling),u=ct(i==null?void 0:i.nextSibling);return!!(c&&(t?u:d)&&Jr(!t,s,a).exists(m=>Tw(o,m)&&!Cg(l,zl(o,m))))||Jr(t,s,a).fold(Qe,m=>{const p=zl(o,m);if(Tw(o,m)&&!Cg(l,p)){if(t||Bw(e,m,!1),i&&c){if(t&&d||!t&&u)return!0;Bw(e,m,t),e.dom.remove(i)}return!0}return!1})}return!1},pO=(e,t,n,o)=>{const r=e.selection.getRng(),s=M.fromRangeStart(r),a=e.getBody();return o==="selection"?((i,l)=>{const c=l.startSummary.exists(m=>m.contains(i.startContainer)),d=l.startSummary.exists(m=>m.contains(i.endContainer)),u=l.startDetails.forall(m=>l.endDetails.forall(p=>m!==p));return(c||d)&&!(c&&d)||u})(r,t):n?((i,l)=>l.startSummary.exists(c=>((d,u)=>wn(u).exists(m=>rt(m.getNode())&&Zt(u,m).exists(p=>p.isEqual(d))||m.isEqual(d)))(i,c)))(s,t)||((i,l,c)=>c.startDetails.exists(d=>Vt(i,l).forall(u=>!d.contains(u.container()))))(a,s,t):((i,l)=>l.startSummary.exists(c=>((d,u)=>Lt(u).exists(m=>m.isEqual(d)))(i,c)))(s,t)||((i,l)=>l.startDetails.exists(c=>Zt(c,i).forall(d=>l.startSummary.exists(u=>!u.contains(i.container())&&u.contains(d.container())))))(s,t)},wr=(e,t,n)=>((o,r,s)=>((a,i)=>{const l=C.from(a.getParent(i.startContainer,"details")),c=C.from(a.getParent(i.endContainer,"details"));if(l.isSome()||c.isSome()){const d=l.bind(u=>C.from(a.select("summary",u)[0]));return C.some({startSummary:d,startDetails:l,endDetails:c})}return C.none()})(o.dom,o.selection.getRng()).fold(()=>Pw(o,r,s),a=>pO(o,a,r,s)||Pw(o,r,s)))(e,t,n)||gO&&((o,r,s)=>{const a=o.selection,i=a.getNode(),l=a.getRng(),c=M.fromRangeStart(l);return!!t_(i)&&(s==="selection"&&Aw(l,i)||l0(r,c,i)?Rw(i):o.undoManager.transact(()=>{const d=a.getSel();let{anchorNode:u,anchorOffset:m,focusNode:p,focusOffset:g}=d??{};const h=()=>{q(u)&&q(m)&&q(p)&&q(g)&&(d==null||d.setBaseAndExtent(u,m,p,g))},f=(v,y)=>{U(v.childNodes,w=>{Ca(w)&&y.appendChild(w)})},b=o.dom.create("span",{"data-mce-bogus":"1"});f(i,b),i.appendChild(b),h(),s!=="word"&&s!=="line"||d==null||d.modify("extend",r?"right":"left",s),!a.isCollapsed()&&Aw(a.getRng(),b)?Rw(i):(o.execCommand(r?"ForwardDelete":"Delete"),u=d==null?void 0:d.anchorNode,m=d==null?void 0:d.anchorOffset,p=d==null?void 0:d.focusNode,g=d==null?void 0:d.focusOffset,f(b,i),h()),o.dom.remove(b)}),!0)})(e,t,n)?C.some(Ne):C.none(),Dw=e=>(t,n,o={})=>{const r=t.getBody(),s={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:r,currentTarget:r,eventPhase:Event.AT_TARGET,originalTarget:r,explicitOriginalTarget:r,isTrusted:!1,srcElement:r,cancelable:!1,preventDefault:Ne,inputType:n},a=Ap(new InputEvent(e));return t.dispatch(e,{...a,...s,...o})},Ya=Dw("input"),jl=Dw("beforeinput"),Lw=zn(),Mw=Lw.os,Iw=Mw.isMacOS()||Mw.isiOS(),hO=Lw.browser.isFirefox(),ps=(e,t)=>{const n=e.dom,o=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const s=(a=>{for(;a;){if(re(a)||j(a)&&a.data&&/[\r\n\s]/.test(a.data))return a;a=a.nextSibling}return null})(t.firstChild);s&&/^(UL|OL|DL)$/.test(s.nodeName)&&t.insertBefore(n.doc.createTextNode(Ct),t.firstChild)}const r=n.createRng();if(t.normalize(),t.hasChildNodes()){const s=new yt(t,t);let a,i=t;for(;a=s.current();){if(j(a)){r.setStart(a,0),r.setEnd(a,0);break}if(o[a.nodeName.toLowerCase()]){r.setStartBefore(a),r.setEndBefore(a);break}i=a,a=s.next()}a||(r.setStart(i,0),r.setEnd(i,0))}else rt(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(r.setStartBefore(t),r.setEndBefore(t)):(r.setStartAfter(t),r.setEndAfter(t)):(r.setStart(t,0),r.setEnd(t,0));e.selection.setRng(r),xa(e,r)},Ga=(e,t)=>{const n=e.getRoot();let o,r=t;for(;r!==n&&r&&e.getContentEditable(r)!=="false";){if(e.getContentEditable(r)==="true"){o=r;break}r=r.parentNode}return r!==n?o:n},uf=e=>C.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),mf=e=>{e.innerHTML='<br data-mce-bogus="1">'},Xa=(e,t)=>{Dt(e).toLowerCase()===t.tagName.toLowerCase()&&((n,o,r)=>{const s=n.dom;C.from(r.style).map(s.parseStyle).each(d=>{const u={...Dc(R(o)),...d};s.setStyles(o,u)});const a=C.from(r.class).map(d=>d.split(/\s+/)),i=C.from(o.className).map(d=>ye(d.split(/\s+/),u=>u!==""));Tt(a,i,(d,u)=>{const m=ye(u,g=>!Ue(d,g)),p=[...d,...m];s.setAttrib(o,"class",p.join(" "))});const l=["style","class"],c=Ps(r,(d,u)=>!Ue(l,u));s.setAttribs(o,c)})(e,t,ua(e))},Fw=(e,t,n,o,r=!0,s,a)=>{const i=e.dom,l=e.schema,c=Dt(e),d=n?n.nodeName.toUpperCase():"";let u=t;const m=l.getTextInlineElements();let p;p=s||d==="TABLE"||d==="HR"?i.create(s||c,a||{}):n.cloneNode(!1);let g=p;if(r)do if(m[u.nodeName]){if(un(u)||mn(u))continue;const h=u.cloneNode(!1);i.setAttrib(h,"id",""),p.hasChildNodes()?(h.appendChild(p.firstChild),p.appendChild(h)):(g=h,p.appendChild(h))}while((u=u.parentNode)&&u!==o);else i.setAttrib(p,"style",null),i.setAttrib(p,"class",null);return Xa(e,p),mf(g),p},Uw=(e,t)=>{const n=e==null?void 0:e.parentNode;return q(n)&&n.nodeName===t},zw=e=>q(e)&&/^(OL|UL|LI)$/.test(e.nodeName),ff=e=>q(e)&&/^(LI|DT|DD)$/.test(e.nodeName),Hl=e=>{const t=e.parentNode;return ff(t)?t:e},$l=(e,t,n)=>{let o=e[n?"firstChild":"lastChild"];for(;o&&!re(o);)o=o[n?"nextSibling":"previousSibling"];return o===t},jw=e=>Yt(ai(Dc(R(e)),(t,n)=>`${n}: ${t};`),(t,n)=>t+n,""),bO=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),gf=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,pf=(e,t)=>q(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",hf=(e,t,n)=>j(t)?e?n===1&&t.data.charAt(n-1)===Et?0:n:n===t.data.length-1&&t.data.charAt(n)===Et?t.data.length:n:n,Hw={insert:(e,t)=>{let n,o,r,s,a=!1;const i=e.dom,l=e.schema.getNonEmptyElements(),c=e.selection.getRng(),d=Dt(e),u=R(c.startContainer),m=Fr(u,c.startOffset),p=m.exists(T=>ui(T)&&!Go(T)),g=c.collapsed&&p,h=(T,P)=>Fw(e,n,E,w,Z_(e),T,P),f=T=>{const P=hf(T,n,o);if(j(n)&&(T?P>0:P<n.data.length))return!1;if((n.parentNode===E||n===E)&&a&&!T||T&&re(n)&&n===E.firstChild)return!0;if(gf(n,"TABLE")||gf(n,"HR"))return a&&!T||!a&&T;const x=new yt(n,E);let N;for(j(n)&&(T&&P===0?x.prev():T||P!==n.data.length||x.next());N=x.current();){if(re(N)){if(!N.getAttribute("data-mce-bogus")){const B=N.nodeName.toLowerCase();if(l[B]&&B!=="br")return!1}}else if(j(N)&&!$r(N.data))return!1;T?x.prev():x.next()}return!0},b=()=>{let T;return T=/^(H[1-6]|PRE|FIGURE)$/.test(r)&&k!=="HGROUP"?h(d):h(),((P,x)=>{const N=Q_(P);return!at(x)&&(Q(N)?Ue($.explode(N),x.nodeName.toLowerCase()):N)})(e,s)&&pf(i,s)&&i.isEmpty(E,void 0,{includeZwsp:!0})?T=i.split(s,E):i.insertAfter(T,E),ps(e,T),T};el(i,c).each(T=>{c.setStart(T.startContainer,T.startOffset),c.setEnd(T.endContainer,T.endOffset)}),n=c.startContainer,o=c.startOffset;const v=!(!t||!t.shiftKey),y=!(!t||!t.ctrlKey);re(n)&&n.hasChildNodes()&&!g&&(a=o>n.childNodes.length-1,n=n.childNodes[Math.min(o,n.childNodes.length-1)]||n,o=a&&j(n)?n.data.length:0);const w=Ga(i,n);if(!w||((T,P)=>{const x=T.dom.getParent(P,"ol,ul,dl");return x!==null&&T.dom.getContentEditableParent(x)==="false"})(e,n))return;v||(n=((T,P,x,N,B)=>{var I,V;const z=T.dom,te=(I=Ga(z,N))!==null&&I!==void 0?I:z.getRoot();let ae=z.getParent(N,z.isBlock);if(!ae||!pf(z,ae)){if(ae=ae||te,!ae.hasChildNodes()){const se=z.create(P);return Xa(T,se),ae.appendChild(se),x.setStart(se,0),x.setEnd(se,0),se}let de,le=N;for(;le&&le.parentNode!==ae;)le=le.parentNode;for(;le&&!z.isBlock(le);)de=le,le=le.previousSibling;const G=(V=de==null?void 0:de.parentElement)===null||V===void 0?void 0:V.nodeName;if(de&&G&&T.schema.isValidChild(G,P.toLowerCase())){const se=de.parentNode,A=z.create(P);for(Xa(T,A),se.insertBefore(A,de),le=de;le&&!z.isBlock(le);){const O=le.nextSibling;A.appendChild(le),le=O}x.setStart(N,B),x.setEnd(N,B)}}return N})(e,d,c,n,o));let E=i.getParent(n,i.isBlock)||i.getRoot();s=q(E==null?void 0:E.parentNode)?i.getParent(E.parentNode,i.isBlock):null,r=E?E.nodeName.toUpperCase():"";const k=s?s.nodeName.toUpperCase():"";if(k!=="LI"||y||(E=s,s=s.parentNode,r=k),re(s)&&((T,P,x)=>!P&&x.nodeName.toLowerCase()===Dt(T)&&T.dom.isEmpty(x)&&((N,B,I)=>{let V=B;for(;V&&V!==N&&ct(V.nextSibling);){const te=V.parentElement;if(!te||(z=te,!ke(T.schema.getTextBlockElements(),z.nodeName.toLowerCase())))return Hc(te);V=te}var z;return!1})(T.getBody(),x))(e,v,E))return((T,P,x)=>{var N,B,I;const V=P(Dt(T)),z=((te,ae)=>te.dom.getParent(ae,Hc))(T,x);z&&(T.dom.insertAfter(V,z),ps(T,V),((I=(B=(N=x.parentElement)===null||N===void 0?void 0:N.childNodes)===null||B===void 0?void 0:B.length)!==null&&I!==void 0?I:0)>1&&T.dom.remove(x))})(e,h,E);if(/^(LI|DT|DD)$/.test(r)&&re(s)&&i.isEmpty(E))return void((T,P,x,N,B)=>{const I=T.dom,V=T.selection.getRng(),z=x.parentNode;if(x===T.getBody()||!z)return;var te;zw(te=x)&&zw(te.parentNode)&&(B="LI");const ae=ff(N)?jw(N):void 0;let de=ff(N)&&ae?P(B,{style:jw(N)}):P(B);if($l(x,N,!0)&&$l(x,N,!1))if(Uw(x,"LI")){const le=Hl(x);I.insertAfter(de,le),(G=>{var se;return((se=G.parentNode)===null||se===void 0?void 0:se.firstChild)===G})(x)?I.remove(le):I.remove(x)}else I.replace(de,x);else if($l(x,N,!0))Uw(x,"LI")?(I.insertAfter(de,Hl(x)),de.appendChild(I.doc.createTextNode(" ")),de.appendChild(x)):z.insertBefore(de,x),I.remove(N);else if($l(x,N,!1))I.insertAfter(de,Hl(x)),I.remove(N);else{x=Hl(x);const le=V.cloneRange();le.setStartAfter(N),le.setEndAfter(x);const G=le.extractContents();if(B==="LI"&&((se,A)=>se.firstChild&&se.firstChild.nodeName==="LI")(G)){const se=ye(Te(de.children,R),Ss(mi("br")));de=G.firstChild,I.insertAfter(G,x),U(se,A=>Lc(R(de),A)),ae&&de.setAttribute("style",ae)}else I.insertAfter(G,x),I.insertAfter(de,x);I.remove(N)}ps(T,de)})(e,h,s,E,d);if(!(g||E!==e.getBody()&&pf(i,E)))return;const S=E.parentNode;let _;if(g)_=h(d),m.fold(()=>{ut(u,R(_))},T=>{Xt(T,R(_))}),e.selection.setCursorLocation(_,0);else if(Yr(E))_=pd(E),i.isEmpty(E)&&mf(E),Xa(e,_),ps(e,_);else if(f(!1))_=b();else if(f(!0)&&S){_=S.insertBefore(h(),E);const T=R(c.startContainer).dom.hasChildNodes()&&c.collapsed;ps(e,gf(E,"HR")||T?_:E)}else{const T=(x=>{const N=x.cloneRange();return N.setStart(x.startContainer,hf(!0,x.startContainer,x.startOffset)),N.setEnd(x.endContainer,hf(!1,x.endContainer,x.endOffset)),N})(c).cloneRange();T.setEndAfter(E);const P=T.extractContents();(x=>{U(Xg(R(x),ln),N=>{const B=N.dom;B.nodeValue=on(B.data)})})(P),(x=>{let N=x;do j(N)&&(N.data=N.data.replace(/^[\r\n]+/,"")),N=N.firstChild;while(N)})(P),_=P.firstChild,i.insertAfter(P,E),((x,N,B)=>{var I;const V=[];if(!B)return;let z=B;for(;z=z.firstChild;){if(x.isBlock(z))return;re(z)&&!N[z.nodeName.toLowerCase()]&&V.push(z)}let te=V.length;for(;te--;)z=V[te],(!z.hasChildNodes()||z.firstChild===z.lastChild&&((I=z.firstChild)===null||I===void 0?void 0:I.nodeValue)===""||bO(x,z))&&x.remove(z)})(i,l,_),((x,N)=>{N.normalize();const B=N.lastChild;(!B||re(B)&&/^(left|right)$/gi.test(x.getStyle(B,"float",!0)))&&x.add(N,"br")})(i,E),i.isEmpty(E)&&mf(E),_.normalize(),i.isEmpty(_)?(i.remove(_),b()):(Xa(e,_),ps(e,_))}i.setAttrib(_,"id",""),e.dispatch("NewBlock",{newBlock:_})},fakeEventName:"insertParagraph"},$w=(e,t,n)=>{const o=e.dom.createRng();n?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),e.selection.setRng(o),xa(e,o)},vO=(e,t)=>{const n=vt("br");Xt(R(t),n),e.undoManager.add()},yO=(e,t)=>{CO(e.getBody(),t)||uo(R(t),vt("br"));const n=vt("br");uo(R(t),n),$w(e,n.dom,!1),e.undoManager.add()},CO=(e,t)=>{return n=M.after(t),!!rt(n.getNode())||Vt(e,M.after(t)).map(o=>rt(o.getNode())).getOr(!1);var n},Vw=e=>e&&e.nodeName==="A"&&"href"in e,wO=e=>e.fold(Qe,Vw,Vw,Qe),EO=(e,t)=>{t.fold(Ne,ne(vO,e),ne(yO,e),Ne)},qw={insert:(e,t)=>{const n=(o=>{const r=ne(br,o),s=M.fromRangeStart(o.selection.getRng());return Jn(r,o.getBody(),s).filter(wO)})(e);n.isSome()?n.each(ne(EO,e)):((o,r)=>{const s=o.selection,a=o.dom,i=s.getRng();let l,c=!1;el(a,i).each(f=>{i.setStart(f.startContainer,f.startOffset),i.setEnd(f.endContainer,f.endOffset)});let d=i.startOffset,u=i.startContainer;if(re(u)&&u.hasChildNodes()){const f=d>u.childNodes.length-1;u=u.childNodes[Math.min(d,u.childNodes.length-1)]||u,d=f&&j(u)?u.data.length:0}let m=a.getParent(u,a.isBlock);const p=m&&m.parentNode?a.getParent(m.parentNode,a.isBlock):null,g=p?p.nodeName.toUpperCase():"",h=!(!r||!r.ctrlKey);g!=="LI"||h||(m=p),j(u)&&d>=u.data.length&&(((f,b,v)=>{const y=new yt(b,v);let w;const E=f.getNonEmptyElements();for(;w=y.next();)if(E[w.nodeName.toLowerCase()]||j(w)&&w.length>0)return!0;return!1})(o.schema,u,m||a.getRoot())||(l=a.create("br"),i.insertNode(l),i.setStartAfter(l),i.setEndAfter(l),c=!0)),l=a.create("br"),wd(a,i,l),$w(o,l,c),o.undoManager.add()})(e,t)},fakeEventName:"insertLineBreak"},Ww=(e,t)=>uf(e).filter(n=>t.length>0&&Nn(R(n),t)).isSome(),rn=Wn([{br:[]},{block:[]},{none:[]}]),kO=(e,t)=>(n=>Ww(n,X_(n)))(e),Kw=e=>(t,n)=>(o=>uf(o).filter(r=>ra(R(r))).isSome())(t)===e,Yw=(e,t)=>(n,o)=>(s=>uf(s).fold(oe(""),a=>a.nodeName.toUpperCase()))(n)===e.toUpperCase()===t,xO=e=>{const t=Ga(e.dom,e.selection.getStart());return at(t)},Za=e=>Yw("pre",e),Vl=e=>(t,n)=>K_(t)===e,_O=(e,t)=>(n=>Ww(n,G_(n)))(e),ql=(e,t)=>t,SO=e=>{const t=Dt(e),n=Ga(e.dom,e.selection.getStart());return q(n)&&e.schema.isValidChild(n.nodeName,t)},NO=e=>{const t=e.selection.getRng(),n=R(t.startContainer),o=Fr(n,t.startOffset).map(r=>ui(r)&&!Go(r));return t.collapsed&&o.getOr(!0)},yn=(e,t)=>(n,o)=>Yt(e,(r,s)=>r&&s(n,o),!0)?C.some(t):C.none(),Wl=(e,t,n)=>{t.selection.isCollapsed()||(o=>{o.execCommand("delete")})(t),q(n)&&jl(t,e.fakeEventName).isDefaultPrevented()||(e.insert(t,n),q(n)&&Ya(t,e.fakeEventName))},Gw=(e,t)=>{const n=()=>Wl(qw,e,t),o=()=>Wl(Hw,e,t),r=((s,a)=>WC([yn([kO],rn.none()),yn([Za(!0),xO],rn.none()),yn([Yw("summary",!0)],rn.br()),yn([Za(!0),Vl(!1),ql],rn.br()),yn([Za(!0),Vl(!1)],rn.block()),yn([Za(!0),Vl(!0),ql],rn.block()),yn([Za(!0),Vl(!0)],rn.br()),yn([Kw(!0),ql],rn.br()),yn([Kw(!0)],rn.block()),yn([_O],rn.br()),yn([ql],rn.br()),yn([SO],rn.block()),yn([NO],rn.block())],[s,!(!a||!a.shiftKey)]).getOr(rn.none()))(e,t);switch(Y_(e)){case"linebreak":r.fold(n,n,Ne);break;case"block":r.fold(o,o,Ne);break;case"invert":r.fold(o,n,Ne);break;default:r.fold(n,o,Ne)}},Xw=zn(),RO=Xw.os.isiOS()&&Xw.browser.isSafari(),Zw=(e,t)=>{var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact(()=>{Gw(e,t)}))},AO=zn(),Qw=e=>e.stopImmediatePropagation(),Jw=e=>e.keyCode===ee.PAGE_UP||e.keyCode===ee.PAGE_DOWN,eE=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",Qw,!0):!n&&e.get()&&t.off("NodeChange",Qw),e.set(n)},tE=(e,t)=>{const n=t.container(),o=t.offset();return j(n)?(n.insertData(o,e),C.some(M(n,o+e.length))):Hi(t).map(r=>{const s=Ir(e);return t.isAtEnd()?uo(r,s):Xt(r,s),M(s.dom,e.length)})},nE=ne(tE,Ct),oE=ne(tE," "),rE=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},TO=e=>{const t=M.fromRangeStart(e.selection.getRng()),n=R(e.getBody());if(e.selection.isCollapsed()){const o=ne(br,e),r=M.fromRangeStart(e.selection.getRng());return Jn(o,e.getBody(),r).bind((s=>a=>a.fold(i=>Zt(s.dom,M.before(i)),i=>Lt(i),i=>wn(i),i=>Vt(s.dom,M.after(i))))(n)).map(s=>()=>((a,i,l)=>c=>Gv(a,c,l)?nE(i):oE(i))(n,t,e.schema)(s).each(rE(e)))}return C.none()},OO=e=>{return Lr(Be.browser.isFirefox()&&e.selection.isEditable()&&(t=e.dom,n=e.selection.getRng().startContainer,t.isEditable(t.getParent(n,"summary"))),()=>{const o=R(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete"),((r,s,a)=>Gv(r,s,a)?nE(s):oE(s))(o,M.fromRangeStart(e.selection.getRng()),e.schema).each(rE(e))});var t,n},BO=e=>rN(e)?[{keyCode:ee.TAB,action:pe(lw,e,!0)},{keyCode:ee.TAB,shiftKey:!0,action:pe(lw,e,!1)}]:[],PO=e=>{if(e.addShortcut("Meta+P","","mcePrint"),fO(e),Qn(e))return wt(null);{const t=bT(e);return(n=>{n.on("beforeinput",o=>{n.selection.isEditable()&&!it(o.getTargetRanges(),r=>!hv(n.dom,r))||o.preventDefault()})})(e),(n=>{n.on("keyup compositionstart",ne(RT,n))})(e),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Be.os.isMacOS()||Be.os.isiOS();$a([{keyCode:ee.RIGHT,action:pe(z1,s,!0)},{keyCode:ee.LEFT,action:pe(z1,s,!1)},{keyCode:ee.UP,action:pe(j1,s,!1)},{keyCode:ee.DOWN,action:pe(j1,s,!0)},...l?[{keyCode:ee.UP,action:pe(Pl,s,!1),metaKey:!0,shiftKey:!0},{keyCode:ee.DOWN,action:pe(Pl,s,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:ee.RIGHT,action:pe(sw,s,!0)},{keyCode:ee.LEFT,action:pe(sw,s,!1)},{keyCode:ee.UP,action:pe(Ym,s,!1)},{keyCode:ee.DOWN,action:pe(Ym,s,!0)},{keyCode:ee.UP,action:pe(Ym,s,!1)},{keyCode:ee.UP,action:pe(V1,s,!1)},{keyCode:ee.DOWN,action:pe(V1,s,!0)},{keyCode:ee.RIGHT,action:pe(Y1,s,!0)},{keyCode:ee.LEFT,action:pe(Y1,s,!1)},{keyCode:ee.UP,action:pe(G1,s,!1)},{keyCode:ee.DOWN,action:pe(G1,s,!0)},{keyCode:ee.RIGHT,action:pe(h1,s,a,!0)},{keyCode:ee.LEFT,action:pe(h1,s,a,!1)},{keyCode:ee.RIGHT,ctrlKey:!l,altKey:l,action:pe(vT,s,a)},{keyCode:ee.LEFT,ctrlKey:!l,altKey:l,action:pe(yT,s,a)},{keyCode:ee.UP,action:pe($1,s,!1)},{keyCode:ee.DOWN,action:pe($1,s,!0)}],i).each(c=>{i.preventDefault()})})(n,o,r)})})(e,t),((n,o)=>{let r=!1;n.on("keydown",s=>{r=s.keyCode===ee.BACKSPACE,s.isDefaultPrevented()||((a,i,l)=>{const c=l.keyCode===ee.BACKSPACE?"deleteContentBackward":"deleteContentForward",d=a.selection.isCollapsed(),u=d?"character":"selection",m=p=>d?p?"word":"line":"selection";K1([{keyCode:ee.BACKSPACE,action:pe(O1,a)},{keyCode:ee.BACKSPACE,action:pe(Bm,a,!1)},{keyCode:ee.DELETE,action:pe(Bm,a,!0)},{keyCode:ee.BACKSPACE,action:pe(Am,a,!1)},{keyCode:ee.DELETE,action:pe(Am,a,!0)},{keyCode:ee.BACKSPACE,action:pe(jm,a,i,!1)},{keyCode:ee.DELETE,action:pe(jm,a,i,!0)},{keyCode:ee.BACKSPACE,action:pe(Mu,a,!1)},{keyCode:ee.DELETE,action:pe(Mu,a,!0)},{keyCode:ee.BACKSPACE,action:pe(wr,a,!1,u)},{keyCode:ee.DELETE,action:pe(wr,a,!0,u)},...Iw?[{keyCode:ee.BACKSPACE,altKey:!0,action:pe(wr,a,!1,m(!0))},{keyCode:ee.DELETE,altKey:!0,action:pe(wr,a,!0,m(!0))},{keyCode:ee.BACKSPACE,metaKey:!0,action:pe(wr,a,!1,m(!1))}]:[{keyCode:ee.BACKSPACE,ctrlKey:!0,action:pe(wr,a,!1,m(!0))},{keyCode:ee.DELETE,ctrlKey:!0,action:pe(wr,a,!0,m(!0))}],{keyCode:ee.BACKSPACE,action:pe(Pm,a,!1)},{keyCode:ee.DELETE,action:pe(Pm,a,!0)},{keyCode:ee.BACKSPACE,action:pe(Vm,a,!1)},{keyCode:ee.DELETE,action:pe(Vm,a,!0)},{keyCode:ee.BACKSPACE,action:pe(Nm,a,!1)},{keyCode:ee.DELETE,action:pe(Nm,a,!0)},{keyCode:ee.BACKSPACE,action:pe(Sm,a,!1)},{keyCode:ee.DELETE,action:pe(Sm,a,!0)},{keyCode:ee.BACKSPACE,action:pe(Hm,a,!1)},{keyCode:ee.DELETE,action:pe(Hm,a,!0)}],l).filter(p=>a.selection.isEditable()).each(p=>{l.preventDefault(),jl(a,c).isDefaultPrevented()||(p(),Ya(a,c))})})(n,o,s)}),n.on("keyup",s=>{s.isDefaultPrevented()||((a,i,l)=>{$a([{keyCode:ee.BACKSPACE,action:pe(zC,a)},{keyCode:ee.DELETE,action:pe(zC,a)},...Iw?[{keyCode:ee.BACKSPACE,altKey:!0,action:pe(Ha,a)},{keyCode:ee.DELETE,altKey:!0,action:pe(Ha,a)},...l?[{keyCode:hO?224:91,action:pe(Ha,a)}]:[]]:[{keyCode:ee.BACKSPACE,ctrlKey:!0,action:pe(Ha,a)},{keyCode:ee.DELETE,ctrlKey:!0,action:pe(Ha,a)}]],i)})(n,s,r),r=!1})})(e,t),(n=>{let o=C.none();n.on("keydown",r=>{r.keyCode===ee.ENTER&&(RO&&(s=>{if(!s.collapsed)return!1;const a=s.startContainer;if(j(a)){const i=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,l=a.data.charAt(s.startOffset-1);return i.test(l)}return!1})(n.selection.getRng())?(s=>{o=C.some(s.selection.getBookmark()),s.undoManager.add()})(n):Zw(n,r))}),n.on("keyup",r=>{r.keyCode===ee.ENTER&&o.each(()=>((s,a)=>{s.undoManager.undo(),o.fold(Ne,i=>s.selection.moveToBookmark(i)),Zw(s,a),o=C.none()})(n,r))})})(e),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{K1([{keyCode:ee.SPACEBAR,action:pe(TO,r)},{keyCode:ee.SPACEBAR,action:pe(OO,r)}],s).each(a=>{s.preventDefault(),jl(r,"insertText",{data:" "}).isDefaultPrevented()||(a(),Ya(r,"insertText",{data:" "}))})})(n,o)})})(e),(n=>{n.on("input",o=>{o.isComposing||(r=>{const s=R(r.getBody());r.selection.isCollapsed()&&pR(s,M.fromRangeStart(r.selection.getRng()),r.schema).each(a=>{r.selection.setRng(a.toRange())})})(n)})})(e),(n=>{n.on("keydown",o=>{o.isDefaultPrevented()||((r,s)=>{$a([...BO(r)],s).each(a=>{s.preventDefault()})})(n,o)})})(e),((n,o)=>{n.on("keydown",r=>{r.isDefaultPrevented()||((s,a,i)=>{const l=Be.os.isMacOS()||Be.os.isiOS();$a([{keyCode:ee.END,action:pe(H1,s,!0)},{keyCode:ee.HOME,action:pe(H1,s,!1)},...l?[]:[{keyCode:ee.HOME,action:pe(Pl,s,!1),ctrlKey:!0,shiftKey:!0},{keyCode:ee.END,action:pe(Pl,s,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:ee.END,action:pe(X1,s,!0)},{keyCode:ee.HOME,action:pe(X1,s,!1)},{keyCode:ee.END,action:pe(Bl,s,!0,a)},{keyCode:ee.HOME,action:pe(Bl,s,!1,a)}],i).each(c=>{i.preventDefault()})})(n,o,r)})})(e,t),((n,o)=>{if(AO.os.isMacOS())return;const r=wt(!1);n.on("keydown",s=>{Jw(s)&&eE(r,n,!0)}),n.on("keyup",s=>{s.isDefaultPrevented()||((a,i,l)=>{$a([{keyCode:ee.PAGE_UP,action:pe(Bl,a,!1,i)},{keyCode:ee.PAGE_DOWN,action:pe(Bl,a,!0,i)}],l)})(n,o,s),Jw(s)&&r.get()&&(eE(r,n,!1),n.nodeChanged())})})(e,t),t}};class DO{constructor(t){let n;this.lastPath=[],this.editor=t;const o=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",r=>{const s=t.selection.getRng(),a={startContainer:s.startContainer,startOffset:s.startOffset,endContainer:s.endContainer,endOffset:s.endOffset};r.type!=="nodechange"&&ru(a,n)||t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{ol(t),t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const r=t.selection.getStart(!0);r&&Ki(t)&&!o.isSameElementPath(r)&&t.dom.isChildOf(r,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",r=>{!r.isDefaultPrevented()&&Ki(t)&&(t.selection.getNode().nodeName==="IMG"?gn.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor.selection;let o;if(this.editor.initialized&&n&&!NS(this.editor)&&!this.editor.mode.isReadOnly()){const r=this.editor.getBody();o=n.getStart(!0)||r,o.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(o,r)||(o=r);const s=[];this.editor.dom.getParent(o,a=>a===r||(s.push(a),!1)),this.editor.dispatch("NodeChange",{...t,element:o,parents:s})}}isSameElementPath(t){let n;const o=this.editor,r=Ts(o.dom.getParents(t,dt,o.getBody()));if(r.length===this.lastPath.length){for(n=r.length;n>=0&&r[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=r,!0}return this.lastPath=r,!1}}const sE=oa("image"),bf=oa("event"),Kl=e=>t=>{t[bf]=e},aE=Kl(0),LO=Kl(2),MO=Kl(1),IO=e=>{const t=e;return C.from(t[bf]).exists(n=>n===0)},vf=oa("mode"),Yl=e=>t=>{t[vf]=e},iE=(e,t)=>Yl(t)(e),lE=Yl(0),yf=Yl(2),FO=Yl(1),cE=e=>t=>{const n=t;return C.from(n[vf]).exists(o=>o===e)},hs=cE(0),dE=cE(1),UO=["none","copy","link","move"],zO=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],Cf=()=>{const e=new window.DataTransfer;let t="move",n="all";const o={get dropEffect(){return t},set dropEffect(r){Ue(UO,r)&&(t=r)},get effectAllowed(){return n},set effectAllowed(r){IO(o)&&Ue(zO,r)&&(n=r)},get items(){return((r,s)=>({...s,get length(){return s.length},add:(a,i)=>{if(hs(r)){if(!Q(a))return s.add(a);if(!st(i))return s.add(a,i)}return null},remove:a=>{hs(r)&&s.remove(a)},clear:()=>{hs(r)&&s.clear()}}))(o,e.items)},get files(){return dE(o)?Object.freeze({length:0,item:r=>null}):e.files},get types(){return e.types},setDragImage:(r,s,a)=>{var i;hs(o)&&(i={image:r,x:s,y:a},o[sE]=i,e.setDragImage(r,s,a))},getData:r=>dE(o)?"":e.getData(r),setData:(r,s)=>{hs(o)&&e.setData(r,s)},clearData:r=>{hs(o)&&e.clearData(r)}};return lE(o),o},uE=(e,t)=>e.setData("text/html",t),mE="x-tinymce/html",Gl=oe(mE),wf="<!-- "+mE+" -->",jO=e=>wf+e,fE=e=>e.indexOf(wf)!==-1,gE="%MCEPASTEBIN%",Ef=e=>e.dom.get("mcepastebin"),HO=e=>q(e)&&e.id==="mcepastebin",pE=e=>e===gE,hE=(e,t)=>($.each(t,n=>{e=je(n,RegExp)?e.replace(n,""):e.replace(n[0],n[1])}),e),bE=e=>hE(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(t,n,o)=>n||o?Ct:" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),vE=(e,t)=>({content:e,cancelled:t}),kf=(e,t)=>(e.insertContent(t,{merge:WS(e),paste:!0}),!0),xf=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),$O=(e,t,n)=>!(e.selection.isCollapsed()||!xf(t))&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.execCommand("mceInsertLink",!1,r)}),!0))(e,t,n),VO=(e,t,n)=>!!((o,r)=>xf(r)&&it(zh(o),s=>kc(r.toLowerCase(),`.${s.toLowerCase()}`)))(e,t)&&((o,r,s)=>(o.undoManager.extra(()=>{s(o,r)},()=>{o.insertContent('<img src="'+r+'">')}),!0))(e,t,n),qO=(e=>{let t=0;return()=>"mceclip"+t++})(),WO=e=>{const t=Cf();return uE(t,e),yf(t),t},yE=(e,t,n,o,r)=>{const s=((a,i,l)=>((c,d,u)=>{const m=((g,h,f)=>g.dispatch("PastePreProcess",{content:h,internal:f}))(c,d,u),p=((g,h)=>{const f=ls({sanitize:Uh(g),sandbox_iframes:jh(g),sandbox_iframes_exclusions:Td(g),convert_unsafe_embeds:iN(g)},g.schema);f.addNodeFilter("meta",v=>{$.each(v,y=>{y.remove()})});const b=f.parse(h,{forced_root_block:!1,isRootContent:!0});return Lo({validate:!0},g.schema).serialize(b)})(c,m.content);return c.hasEventListeners("PastePostProcess")&&!m.isDefaultPrevented()?((g,h,f)=>{const b=g.dom.create("div",{style:"display:none"},h),v=((y,w,E)=>y.dispatch("PastePostProcess",{node:w,internal:E}))(g,b,f);return vE(v.node.innerHTML,v.isDefaultPrevented())})(c,p,u):vE(p,m.isDefaultPrevented())})(a,i,l))(e,t,n);if(!s.cancelled){const a=s.content,i=()=>((l,c,d)=>{d||!KS(l)?kf(l,c):((u,m)=>{$.each([$O,VO,kf],p=>!p(u,m,kf))})(l,c)})(e,a,o);r?jl(e,"insertFromPaste",{dataTransfer:WO(a)}).isDefaultPrevented()||(i(),Ya(e,"insertFromPaste")):i()}},Xl=(e,t,n,o)=>{const r=n||fE(t);yE(e,(s=>s.replace(wf,""))(t),r,!1,o)},_f=(e,t,n)=>{const o=e.dom.encode(t).replace(/\r\n/g,`
`),r=((s,a,i)=>{const l=s.split(/\n\n/),c=((m,p)=>{let g="<"+m;const h=ai(p,(f,b)=>b+'="'+So.encodeAllRaw(f)+'"');return h.length&&(g+=" "+h.join(" ")),g+">"})(a,i),d="</"+a+">",u=Te(l,m=>m.split(/\n/).join("<br />"));return u.length===1?u[0]:Te(u,m=>c+m+d).join("")})(ep(o,GS(e)),Dt(e),ua(e));yE(e,r,!1,!0,n)},CE=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const o=e.types[n];try{t[o]=e.getData(o)}catch{t[o]=""}}return t},zo=(e,t)=>t in e&&e[t].length>0,wE=e=>zo(e,"text/html")||zo(e,"text/plain"),EE=(e,t,n)=>{const o=t.type==="paste"?t.clipboardData:t.dataTransfer;var r;if(zi(e)&&o){const s=((a,i)=>{const l=i.items?an(en(i.items),d=>d.kind==="file"?[d.getAsFile()]:[]):[],c=i.files?en(i.files):[];return ye(l.length>0?l:c,(d=>{const u=zh(d);return m=>ht(m.type,"image/")&&it(u,p=>(g=>{const h=g.toLowerCase(),f={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return $.hasOwn(f,h)?"image/"+f[h]:"image/"+h})(p)===m.type)})(a))})(e,o);if(s.length>0)return t.preventDefault(),(r=s,Promise.all(Te(r,a=>hy(a).then(i=>({file:a,uri:i}))))).then(a=>{n&&e.selection.setRng(n),U(a,i=>{((l,c)=>{rm(c.uri).each(({data:d,type:u,base64Encoded:m})=>{const p=m?d:btoa(d),g=c.file,h=l.editorUpload.blobCache,f=h.getByData(p,u),b=f??((v,y,w,E)=>{const k=qO(),S=Rh(v)&&q(w.name),_=S?((x,N)=>{const B=N.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return q(B)?x.dom.encode(B[1]):void 0})(v,w.name):k,T=S?w.name:void 0,P=y.create(k,w,E,_,T);return y.add(P),P})(l,h,g,p);Xl(l,`<img src="${b.blobUri()}">`,!1,!0)})})(e,i)})}),!0}return!1},Sf=(e,t,n,o,r)=>{let s=bE(n);const a=zo(t,Gl())||fE(n),i=!a&&(c=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(c))(s),l=xf(s);(pE(s)||!s.length||i&&!l)&&(o=!0),(o||l)&&(s=zo(t,"text/plain")&&i?t["text/plain"]:(c=>{const d=No(),u=ls({},d);let m="";const p=d.getVoidElements(),g=$.makeMap("script noscript style textarea video audio iframe object"," "),h=d.getBlockElements(),f=b=>{const v=b.name,y=b;if(v!=="br"){if(v!=="wbr")if(p[v]&&(m+=" "),g[v])m+=" ";else{if(b.type===3&&(m+=b.value),!(b.name in d.getVoidElements())){let w=b.firstChild;if(w)do f(w);while(w=w.next)}h[v]&&y.next&&(m+=`
`,v==="p"&&(m+=`
`))}}else m+=`
`};return c=hE(c,[/<!\[[^\]]+\]>/g]),f(u.parse(c)),m})(s)),pE(s)||(o?_f(e,s,r):Xl(e,s,a,r))},KO=(e,t,n)=>{((o,r,s)=>{let a;o.on("keydown",i=>{(l=>ee.metaKeyPressed(l)&&l.keyCode===86||l.shiftKey&&l.keyCode===45)(i)&&!i.isDefaultPrevented()&&(a=i.shiftKey&&i.keyCode===86)}),o.on("paste",i=>{if(i.isDefaultPrevented()||(d=>{var u,m;return Be.os.isAndroid()&&((m=(u=d.clipboardData)===null||u===void 0?void 0:u.items)===null||m===void 0?void 0:m.length)===0})(i))return;const l=s.get()==="text"||a;a=!1;const c=CE(i.clipboardData);!wE(c)&&EE(o,i,r.getLastRng()||o.selection.getRng())||(zo(c,"text/html")?(i.preventDefault(),Sf(o,c,c["text/html"],l,!0)):zo(c,"text/plain")&&zo(c,"text/uri-list")?(i.preventDefault(),Sf(o,c,c["text/plain"],l,!0)):(r.create(),gn.setEditorTimeout(o,()=>{const d=r.getHtml();r.remove(),Sf(o,c,d,l,!1)},0)))})})(e,t,n),(o=>{const r=a=>ht(a,"webkit-fake-url"),s=a=>ht(a,"data:");o.parser.addNodeFilter("img",(a,i,l)=>{if(!zi(o)&&(c=>{var d;return((d=c.data)===null||d===void 0?void 0:d.paste)===!0})(l))for(const c of a){const d=c.attr("src");Q(d)&&!c.attr("data-mce-object")&&d!==Be.transparentSrc&&(r(d)||!XS(o)&&s(d))&&c.remove()}})})(e)},kE=(e,t,n,o)=>{((r,s,a)=>{if(!r)return!1;try{return r.clearData(),r.setData("text/html",s),r.setData("text/plain",a),r.setData(Gl(),s),!0}catch{return!1}})(e.clipboardData,t.html,t.text)?(e.preventDefault(),o()):n(t.html,o)},xE=e=>(t,n)=>{const{dom:o,selection:r}=e,s=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=o.create("div",{contenteditable:"true"},t);o.setStyles(s,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),s.appendChild(a),o.add(e.getBody(),s);const i=r.getRng();a.focus();const l=o.createRng();l.selectNodeContents(a),r.setRng(l),gn.setEditorTimeout(e,()=>{r.setRng(i),o.remove(s),n()},0)},_E=e=>({html:jO(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),SE=e=>!e.selection.isCollapsed()||(t=>!!t.dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody()))(e),NE=(e,t)=>{var n,o;return gr.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(o=t.clientY)!==null&&o!==void 0?o:0,e.getDoc())},RE=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},YO=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,AE=e=>$.trim(e).replace(YO,Gs).toLowerCase(),GO=(e,t,n)=>{const o=VS(e);if(n||o==="all"||!qS(e))return t;const r=o?o.split(/[, ]/):[];if(r&&o!=="none"){const s=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,d)=>{const u=s.parseStyle(s.decode(c)),m={};for(let g=0;g<r.length;g++){const h=u[r[g]];let f=h,b=s.getStyle(a,r[g],!0);/color/.test(r[g])&&(f=AE(f),b=AE(b)),b!==f&&(m[r[g]]=h)}const p=s.serializeStyle(m,"span");return p?l+' style="'+p+'"'+d:l+d})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(s,a,i,l)=>a+' style="'+i+'"'+l),t},XO=e=>{const t=wt(!1),n=wt(YS(e)?"text":"html"),o=(r=>{const s=wt(null);return{create:()=>((a,i)=>{const{dom:l,selection:c}=a,d=a.getBody();i.set(c.getRng());const u=l.add(a.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},gE);Be.browser.isFirefox()&&l.setStyle(u,"left",l.getStyle(d,"direction",!0)==="rtl"?65535:-65535),l.bind(u,"beforedeactivate focusin focusout",m=>{m.stopPropagation()}),u.focus(),c.select(u,!0)})(r,s),remove:()=>((a,i)=>{const l=a.dom;if(Ef(a)){let c;const d=i.get();for(;c=Ef(a);)l.remove(c),l.unbind(c);d&&a.selection.setRng(d)}i.set(null)})(r,s),getEl:()=>Ef(r),getHtml:()=>(a=>{const i=a.dom,l=(m,p)=>{m.appendChild(p),i.remove(p,!0)},[c,...d]=ye(a.getBody().childNodes,HO);U(d,m=>{l(c,m)});const u=i.select("div[id=mcepastebin]",c);for(let m=u.length-1;m>=0;m--){const p=i.create("div");c.insertBefore(p,u[m]),l(p,u[m])}return c?c.innerHTML:""})(r),getLastRng:s.get}})(e);(r=>{(Be.browser.isChromium()||Be.browser.isSafari())&&((s,a)=>{s.on("PastePreProcess",i=>{i.content=a(s,i.content,i.internal)})})(r,GO)})(e),((r,s)=>{r.addCommand("mceTogglePlainTextPaste",()=>{((a,i)=>{i.get()==="text"?(i.set("html"),Hb(a,!1)):(i.set("text"),Hb(a,!0)),a.focus()})(r,s)}),r.addCommand("mceInsertClipboardContent",(a,i)=>{i.html&&Xl(r,i.html,i.internal,!1),i.text&&_f(r,i.text,!1)})})(e,n),(r=>{const s=l=>c=>{l(r,c)},a=jS(r);Ie(a)&&r.on("PastePreProcess",s(a));const i=HS(r);Ie(i)&&r.on("PastePostProcess",s(i))})(e),e.on("PreInit",()=>{(r=>{r.on("cut",(s=>a=>{!a.isDefaultPrevented()&&SE(s)&&s.selection.isEditable()&&kE(a,_E(s),xE(s),()=>{if(Be.browser.isChromium()||Be.browser.isFirefox()){const i=s.selection.getRng();gn.setEditorTimeout(s,()=>{s.selection.setRng(i),s.execCommand("Delete")},0)}else s.execCommand("Delete")})})(r)),r.on("copy",(s=>a=>{!a.isDefaultPrevented()&&SE(s)&&kE(a,_E(s),xE(s),Ne)})(r))})(e),((r,s)=>{zS(r)&&r.on("dragend dragover draggesture dragdrop drop drag",a=>{a.preventDefault(),a.stopPropagation()}),zi(r)||r.on("drop",a=>{const i=a.dataTransfer;i&&(l=>it(l.files,c=>/^image\//.test(c.type)))(i)&&a.preventDefault()}),r.on("drop",a=>{if(a.isDefaultPrevented())return;const i=NE(r,a);if(at(i))return;const l=CE(a.dataTransfer),c=zo(l,Gl());if((!wE(l)||(g=>{const h=g["text/plain"];return!!h&&h.indexOf("file://")===0})(l))&&EE(r,a,i))return;const d=l[Gl()],u=d||l["text/html"]||l["text/plain"],m=((g,h,f,b)=>{const v=g.getParent(f,y=>er(h,y));if(!ct(g.getParent(f,"summary")))return!0;if(v&&ke(b,"text/html")){const y=new DOMParser().parseFromString(b["text/html"],"text/html").body;return!ct(y.querySelector(v.nodeName.toLowerCase()))}return!1})(r.dom,r.schema,i.startContainer,l),p=s.get();p&&!m||u&&(a.preventDefault(),gn.setEditorTimeout(r,()=>{r.undoManager.transact(()=>{(d||p&&m)&&r.execCommand("Delete"),RE(r,i);const g=bE(u);l["text/html"]?Xl(r,g,c,!0):_f(r,g,!0)})}))}),r.on("dragstart",a=>{s.set(!0)}),r.on("dragover dragend",a=>{zi(r)&&!s.get()&&(a.preventDefault(),RE(r,NE(r,a))),a.type==="dragend"&&s.set(!1)}),(a=>{a.on("input",i=>{const l=c=>ct(c.querySelector("summary"));if(i.inputType==="deleteByDrag"){const c=ye(a.dom.select("details"),l);U(c,d=>{rt(d.firstChild)&&d.firstChild.remove();const u=a.dom.create("summary");u.appendChild(aa().dom),d.prepend(u)})}})})(r)})(e,t),KO(e,o,n)})},ZO=rt,TE=j,QO=e=>Ge(e.dom),OE=e=>t=>De(R(e),t),BE=(e,t)=>Yo(R(e),QO,OE(t)),PE=(e,t,n)=>{const o=new yt(e,t),r=n?o.next.bind(o):o.prev.bind(o);let s=e;for(let a=n?e:r();a&&!ZO(a);a=r())Bn(a)&&(s=a);return s},JO=e=>{const t=((n,o,r)=>{const s=M.fromRangeStart(n).getNode(),a=((d,u,m)=>Yo(R(d),p=>(g=>Cn(g.dom))(p)||m.isBlock(Oe(p)),OE(u)).getOr(R(u)).dom)(s,o,r),i=PE(s,a,!1),l=PE(s,a,!0),c=document.createRange();return BE(i,a).fold(()=>{TE(i)?c.setStart(i,0):c.setStartBefore(i)},d=>c.setStartBefore(d.dom)),BE(l,a).fold(()=>{TE(l)?c.setEnd(l,l.data.length):c.setEndAfter(l)},d=>c.setEndAfter(d.dom)),c})(e.selection.getRng(),e.getBody(),e.schema);e.selection.setRng(Hu(t))};var bs;(function(e){e.Before="before",e.After="after"})(bs||(bs={}));const eB=(e,t)=>Math.abs(e.left-t),tB=(e,t)=>Math.abs(e.right-t),nB=(e,t)=>(n=>Yt(n,(o,r)=>o.fold(()=>C.some(r),s=>{const a=Math.min(r.left,s.left),i=Math.min(r.top,s.top),l=Math.max(r.right,s.right),c=Math.max(r.bottom,s.bottom);return C.some({top:i,right:l,bottom:c,left:a,width:l-a,height:c-i})}),C.none()))(ye(e,n=>{return(o=t)>=(r=n).top&&o<=r.bottom;var o,r})).fold(()=>[[],e],n=>{const{pass:o,fail:r}=Tr(e,s=>((a,i)=>{const l=((c,d)=>Math.max(0,Math.min(c.bottom,d.bottom)-Math.max(c.top,d.top)))(a,i)/Math.min(a.height,i.height);return((c,d)=>c.top<d.bottom&&c.bottom>d.top)(a,i)&&l>.5})(s,n));return[o,r]}),oB=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),Nf=(e,t,n,o)=>{const r=d=>Bn(d.node)?C.some(d):re(d.node)?Nf(en(d.node.childNodes),t,n,!1):C.none(),s=(d,u)=>{const m=Vo(d,(p,g)=>u(p,t,n)-u(g,t,n));return Or(m,r).map(p=>o&&!j(p.node)&&m.length>1?((g,h,f)=>r(h).filter(b=>Math.abs(f(g,t,n)-f(b,t,n))<2&&j(b.node)))(p,m[1],u).getOr(p):p)},[a,i]=nB(i1(e),n),{pass:l,fail:c}=Tr(i,d=>d.top<n);return s(a,oB).orThunk(()=>s(c,Yp)).orThunk(()=>s(l,Yp))},DE=(e,t,n)=>((o,r,s)=>{const a=R(o),i=lo(a),l=Hx(i,r,s).filter(c=>io(a,c)).getOr(a);return((c,d,u,m)=>{const p=(g,h)=>{const f=ye(g.dom.childNodes,Ss(b=>re(b)&&b.classList.contains("mce-drag-container")));return h.fold(()=>Nf(f,u,m,!0),b=>{const v=ye(f,y=>y!==b.dom);return Nf(v,u,m,!0)}).orThunk(()=>(De(g,c)?C.none():gi(g)).bind(b=>p(b,C.some(g))))};return p(d,C.none())})(a,l,r,s)})(e,t,n).filter(o=>ga(o.node)).map(o=>((r,s)=>({node:r.node,position:eB(r,s)<tB(r,s)?bs.Before:bs.After}))(o,t)),LE=e=>{var t,n;const o=e.getBoundingClientRect(),r=e.ownerDocument,s=r.documentElement,a=r.defaultView;return{top:o.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-s.clientTop,left:o.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-s.clientLeft}},ME=e=>({target:e,srcElement:e}),rB=(e,t,n,o)=>{const r=((s,a)=>{const i=(l=>{const c=Cf(),d=(u=>{const m=u;return C.from(m[vf])})(l);return yf(l),aE(c),c.dropEffect=l.dropEffect,c.effectAllowed=l.effectAllowed,(u=>{const m=u;return C.from(m[sE])})(l).each(u=>c.setDragImage(u.image,u.x,u.y)),U(l.types,u=>{u!=="Files"&&c.setData(u,l.getData(u))}),U(l.files,u=>c.items.add(u)),(u=>{const m=u;return C.from(m[bf])})(l).each(u=>{((m,p)=>{Kl(p)(m)})(c,u)}),d.each(u=>{iE(l,u),iE(c,u)}),c})(s);return a==="dragstart"?(aE(i),lE(i)):a==="drop"?(LO(i),yf(i)):(MO(i),FO(i)),i})(n,e);return st(o)?((s,a,i)=>{const l=eg("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:s,composedPath:l,initEvent:l,preventDefault:Ne,stopImmediatePropagation:Ne,stopPropagation:Ne,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:l,initMouseEvent:l,getModifierState:l,dataTransfer:i,...ME(a)}})(e,t,r):((s,a,i,l)=>({...a,dataTransfer:l,type:s,...ME(i)}))(e,o,t,r)},IE=Ge,sB=((...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1})(IE,Cn),aB=(e,t,n,o)=>{const r=e.dom,s=t.cloneNode(!0);r.setStyles(s,{width:n,height:o}),r.setAttrib(s,"data-mce-selected",null);const a=r.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return r.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),r.setStyles(s,{margin:0,boxSizing:"border-box"}),a.appendChild(s),a},Zl=(e,t)=>n=>()=>{const o=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:o+t,behavior:"smooth"})},FE=Zl("left",-32),UE=Zl("left",32),zE=Zl("top",-32),jE=Zl("top",32),HE=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},Qa=(e,t,n,o,r)=>{t==="dragstart"&&uE(o,e.dom.getOuterHTML(n));const s=rB(t,n,o,r);return e.dispatch(t,s)},iB=(e,t)=>{const n=Ri((r,s)=>((a,i,l)=>{a._selectionOverrides.hideFakeCaret(),DE(a.getBody(),i,l).fold(()=>a.selection.placeCaretAt(i,l),c=>{const d=a._selectionOverrides.showCaret(1,c.node,c.position===bs.Before,!1);d?a.selection.setRng(d):a.selection.placeCaretAt(i,l)})})(t,r,s),0);t.on("remove",n.cancel);const o=e;return r=>e.on(s=>{const a=Math.max(Math.abs(r.screenX-s.screenX),Math.abs(r.screenY-s.screenY));if(!s.dragging&&a>10){const c=Qa(t,"dragstart",s.element,s.dataTransfer,r);if(q(c.dataTransfer)&&(s.dataTransfer=c.dataTransfer),c.isDefaultPrevented())return;s.dragging=!0,t.focus()}if(s.dragging){const c=r.currentTarget===t.getDoc().documentElement,d=((u,m)=>({pageX:m.pageX-u.relX,pageY:m.pageY+5}))(s,((u,m)=>{return p=(f=>f.inline?LE(f.getBody()):{left:0,top:0})(u),g=(f=>{const b=f.getBody();return f.inline?{left:b.scrollLeft,top:b.scrollTop}:{left:0,top:0}})(u),h=((f,b)=>{if(b.target.ownerDocument!==f.getDoc()){const v=LE(f.getContentAreaContainer()),y=(w=>{const E=w.getBody(),k=w.getDoc().documentElement,S={left:E.scrollLeft,top:E.scrollTop},_={left:E.scrollLeft||k.scrollLeft,top:E.scrollTop||k.scrollTop};return w.inline?S:_})(f);return{left:b.pageX-v.left+y.left,top:b.pageY-v.top+y.top}}return{left:b.pageX,top:b.pageY}})(u,m),{pageX:h.left-p.left+g.left,pageY:h.top-p.top+g.top};var p,g,h})(t,r));i=s.ghost,l=t.getBody(),i.parentNode!==l&&l.appendChild(i),((u,m,p,g,h,f,b,v,y,w,E,k)=>{let S=0,_=0;u.style.left=m.pageX+"px",u.style.top=m.pageY+"px",m.pageX+p>h&&(S=m.pageX+p-h),m.pageY+g>f&&(_=m.pageY+g-f),u.style.width=p-S+"px",u.style.height=g-_+"px";const T=y.clientHeight,P=y.clientWidth,x=b+y.getBoundingClientRect().top,N=v+y.getBoundingClientRect().left;E.on(B=>{B.intervalId.clear(),B.dragging&&k&&(b+8>=T?B.intervalId.set(jE(w)):b-8<=0?B.intervalId.set(zE(w)):v+8>=P?B.intervalId.set(UE(w)):v-8<=0?B.intervalId.set(FE(w)):x+16>=window.innerHeight?B.intervalId.set(jE(window)):x-16<=0?B.intervalId.set(zE(window)):N+16>=window.innerWidth?B.intervalId.set(UE(window)):N-16<=0&&B.intervalId.set(FE(window)))})})(s.ghost,d,s.width,s.height,s.maxX,s.maxY,r.clientY,r.clientX,t.getContentAreaContainer(),t.getWin(),o,c),n.throttle(r.clientX,r.clientY)}var i,l})},$E=(e,t,n)=>{e.on(o=>{o.intervalId.clear(),o.dragging&&n.fold(()=>Qa(t,"dragend",o.element,o.dataTransfer),r=>Qa(t,"dragend",o.element,o.dataTransfer,r))}),VE(e)},VE=e=>{e.on(t=>{t.intervalId.clear(),HE(t.ghost)}),e.clear()},lB=e=>{const t=Ro(),n=Ve.DOM,o=document,r=((l,c)=>d=>{if((u=>u.button===0)(d)){const u=pt(c.dom.getParents(d.target),sB).getOr(null);if(q(u)&&((m,p,g)=>IE(g)&&g!==p&&m.isEditable(g.parentElement))(c.dom,c.getBody(),u)){const m=c.dom.getPos(u),p=c.getBody(),g=c.getDoc().documentElement;l.set({element:u,dataTransfer:Cf(),dragging:!1,screenX:d.screenX,screenY:d.screenY,maxX:(c.inline?p.scrollWidth:g.offsetWidth)-2,maxY:(c.inline?p.scrollHeight:g.offsetHeight)-2,relX:d.pageX-m.x,relY:d.pageY-m.y,width:u.offsetWidth,height:u.offsetHeight,ghost:aB(c,u,u.offsetWidth,u.offsetHeight),intervalId:__(100)})}}})(t,e),s=iB(t,e),a=((l,c)=>d=>{l.on(u=>{var m;if(u.intervalId.clear(),u.dragging){if(((p,g,h)=>!at(g)&&g!==h&&!p.dom.isChildOf(g,h)&&p.dom.isEditable(g))(c,(p=>{const g=p.getSel();if(q(g)){const h=g.getRangeAt(0).startContainer;return j(h)?h.parentNode:h}return null})(c.selection),u.element)){const p=(m=c.getDoc().elementFromPoint(d.clientX,d.clientY))!==null&&m!==void 0?m:c.getBody();Qa(c,"drop",p,u.dataTransfer,d).isDefaultPrevented()||c.undoManager.transact(()=>{((g,h)=>{const f=g.getParent(h.parentNode,g.isBlock);HE(h),f&&f!==g.getRoot()&&g.isEmpty(f)&&Ao(R(f))})(c.dom,u.element),(g=>{const h=g.getData("text/html");return h===""?C.none():C.some(h)})(u.dataTransfer).each(g=>c.insertContent(g)),c._selectionOverrides.hideFakeCaret()})}Qa(c,"dragend",c.getBody(),u.dataTransfer,d)}}),VE(l)})(t,e),i=((l,c)=>d=>$E(l,c,C.some(d)))(t,e);e.on("mousedown",r),e.on("mousemove",s),e.on("mouseup",a),n.bind(o,"mousemove",s),n.bind(o,"mouseup",i),e.on("remove",()=>{n.unbind(o,"mousemove",s),n.unbind(o,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===ee.ESC&&$E(t,e,C.none())})},Ja=Ge,qE=(e,t)=>vr(e.getBody(),t),cB=e=>{const t=e.selection,n=e.dom,o=e.getBody(),r=pN(e,o,n.isBlock,()=>pr(e)),s="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=f=>f!==o&&(Ja(f)||qn(f))&&n.isChildOf(f,o)&&n.isEditable(f.parentNode),c=(f,b,v,y=!0)=>e.dispatch("ShowCaret",{target:b,direction:f,before:v}).isDefaultPrevented()?null:(y&&t.scrollIntoView(b,f===-1),r.show(v,b)),d=f=>cn(f)||Bi(f)||Pi(f),u=f=>d(f.startContainer)||d(f.endContainer),m=f=>{const b=e.schema.getVoidElements(),v=n.createRng(),y=f.startContainer,w=f.startOffset,E=f.endContainer,k=f.endOffset;return ke(b,y.nodeName.toLowerCase())?w===0?v.setStartBefore(y):v.setStartAfter(y):v.setStart(y,w),ke(b,E.nodeName.toLowerCase())?k===0?v.setEndBefore(E):v.setEndAfter(E):v.setEnd(E,k),v},p=(f,b)=>{if(!f)return null;if(f.collapsed){if(!u(f)){const E=b?1:-1,k=va(E,o,f),S=k.getNode(!b);if(q(S)){if(ga(S))return c(E,S,!!b&&!k.isAtEnd(),!1);if(To(S)&&Ge(S.nextSibling)){const T=n.createRng();return T.setStart(S,0),T.setEnd(S,0),T}}const _=k.getNode(b);if(q(_)){if(ga(_))return c(E,_,!b&&!k.isAtEnd(),!1);if(To(_)&&Ge(_.previousSibling)){const T=n.createRng();return T.setStart(_,1),T.setEnd(_,1),T}}}return null}let v=f.startContainer,y=f.startOffset;const w=f.endOffset;if(j(v)&&y===0&&Ja(v.parentNode)&&(v=v.parentNode,y=n.nodeIndex(v),v=v.parentNode),!re(v))return null;if(w===y+1&&v===f.endContainer){const E=v.childNodes[y];if(l(E))return(k=>{const S=k.cloneNode(!0),_=e.dispatch("ObjectSelected",{target:k,targetClone:S});if(_.isDefaultPrevented())return null;const T=((x,N)=>{const B=R(e.getBody()),I=e.getDoc(),V=pi(B,"#"+s).getOrThunk(()=>{const ae=fi('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',I);return _t(ae,"id",s),ut(B,ae),ae}),z=n.createRng();jr(V),Xo(V,[Ir(Ct,I),R(N),Ir(Ct,I)]),z.setStart(V.dom.firstChild,1),z.setEnd(V.dom.lastChild,0),hi(V,{top:n.getPos(x,e.getBody()).y+"px"}),lv(V);const te=t.getSel();return te&&(te.removeAllRanges(),te.addRange(z)),z})(k,_.targetClone),P=R(k);return U(Bt(R(e.getBody()),`*[${a}]`),x=>{De(P,x)||St(x,a)}),n.getAttrib(k,a)||k.setAttribute(a,"1"),i=k,h(),T})(E)}return null},g=()=>{i&&i.removeAttribute(a),pi(R(e.getBody()),"#"+s).each(Ze),i=null},h=()=>{r.hide()};return Qn(e)||(e.on("click",f=>{n.isEditable(f.target)||(f.preventDefault(),e.focus())}),e.on("blur NewBlock",g),e.on("ResizeWindow FullscreenStateChanged",r.reposition),e.on("tap",f=>{const b=f.target,v=qE(e,b);Ja(v)?(f.preventDefault(),Fa(e,v).each(p)):l(b)&&Fa(e,b).each(p)},!0),e.on("mousedown",f=>{const b=f.target;if(b!==o&&b.nodeName!=="HTML"&&!n.isChildOf(b,o)||!((y,w,E)=>{const k=R(y.getBody()),S=y.inline?k:R(lo(k).dom.documentElement),_=((T,P,x,N)=>{const B=(I=>I.dom.getBoundingClientRect())(P);return{x:x-(T?B.left+P.dom.clientLeft+LA(P):0),y:N-(T?B.top+P.dom.clientTop+DA(P):0)}})(y.inline,S,w,E);return((T,P,x)=>{const N=BA(T),B=PA(T);return P>=0&&x>=0&&P<=N&&x<=B})(S,_.x,_.y)})(e,f.clientX,f.clientY))return;g(),h();const v=qE(e,b);Ja(v)?(f.preventDefault(),Fa(e,v).each(p)):DE(o,f.clientX,f.clientY).each(y=>{var w;f.preventDefault(),(w=c(1,y.node,y.position===bs.Before,!1))&&t.setRng(w),mo(v)?v.focus():e.getBody().focus()})}),e.on("keypress",f=>{ee.modifierPressed(f)||Ja(t.getNode())&&f.preventDefault()}),e.on("GetSelectionRange",f=>{let b=f.range;if(i){if(!i.parentNode)return void(i=null);b=b.cloneRange(),b.selectNode(i),f.range=b}}),e.on("SetSelectionRange",f=>{f.range=m(f.range);const b=p(f.range,f.forward);b&&(f.range=b)}),e.on("AfterSetSelectionRange",f=>{const b=f.range,v=b.startContainer.parentElement;var y;u(b)||re(y=v)&&y.id==="mcepastebin"||h(),(w=>q(w)&&n.hasClass(w,"mce-offscreen-selection"))(v)||g()}),(f=>{lB(f),TS(f)&&(b=>{const v=E=>{if(!E.isDefaultPrevented()){const k=E.dataTransfer;k&&(Ue(k.types,"Files")||k.files.length>0)&&(E.preventDefault(),E.type==="drop"&&xl(b,"Dropped file type is not supported"))}},y=E=>{rl(b,E.target)&&v(E)},w=()=>{const E=Ve.DOM,k=b.dom,S=document,_=b.inline?b.getBody():b.getDoc(),T=["drop","dragover"];U(T,P=>{E.bind(S,P,y),k.bind(_,P,v)}),b.on("remove",()=>{U(T,P=>{E.unbind(S,P,y),k.unbind(_,P,v)})})};b.on("init",()=>{gn.setEditorTimeout(b,w,0)})})(f)})(e),(f=>{const b=Ri(()=>{if(!f.removed&&f.getBody().contains(document.activeElement)){const v=f.selection.getRng();if(v.collapsed){const y=Rm(f,v,!1);f.selection.setRng(y)}}},0);f.on("focus",()=>{b.throttle()}),f.on("blur",()=>{b.cancel()})})(e),(f=>{f.on("init",()=>{f.on("focusin",b=>{const v=b.target;if(qn(v)){const y=vr(f.getBody(),v),w=Ge(y)?y:v;f.selection.getNode()!==w&&Fa(f,w).each(E=>f.selection.setRng(E))}})})})(e)),{showCaret:c,showBlockCaretContainer:f=>{f.hasAttribute("data-mce-caret")&&(pd(f),t.scrollIntoView(f))},hideFakeCaret:h,destroy:()=>{r.destroy(),i=null}}},dB=(e,t)=>{let n=t;for(let o=e.previousSibling;j(o);o=o.previousSibling)n+=o.data.length;return n},WE=(e,t,n,o,r)=>{if(j(n)&&(o<0||o>n.data.length))return[];const s=r&&j(n)?[dB(n,o)]:[o];let a=n;for(;a!==t&&a.parentNode;)s.push(e.nodeIndex(a,r)),a=a.parentNode;return a===t?s.reverse():[]},Rf=(e,t,n,o,r,s,a=!1)=>({start:WE(e,t,n,o,a),end:WE(e,t,r,s,a)}),KE=(e,t)=>{const n=t.slice(),o=n.pop();return Sn(o)?Yt(n,(r,s)=>r.bind(a=>C.from(a.childNodes[s])),C.some(e)).bind(r=>j(r)&&(o<0||o>r.data.length)?C.none():C.some({node:r,offset:o})):C.none()},YE=(e,t)=>KE(e,t.start).bind(({node:n,offset:o})=>KE(e,t.end).map(({node:r,offset:s})=>{const a=document.createRange();return a.setStart(n,o),a.setEnd(r,s),a})),vs=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const o=t.parentNode;e.remove(t,j(t.firstChild)&&$r(t.firstChild.data)),vs(e,o,n)}},Ql=(e,t,n,o=!0)=>{const r=t.startContainer.parentNode,s=t.endContainer.parentNode;t.deleteContents(),o&&!n(t.startContainer)&&(j(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),j(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),vs(e,r,n),r!==s&&vs(e,s,n))},Jl=(e,t)=>C.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),Af=(e,t,n)=>{const o=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:Ch(o).concat(e.blockPatterns),inlinePatterns:wh(o).concat(e.inlinePatterns)}},Tf=(e,t,n,o)=>{const r=e.createRng();return r.setStart(t,0),r.setEnd(n,o),r.toString()},GE=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),ec=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},XE=(e,t,n)=>{const o=YE(e.getRoot(),n).getOrDie("Unable to resolve path range"),r=o.startContainer,s=o.endContainer,a=o.endOffset===0?s:s.splitText(o.endOffset),i=o.startOffset===0?r:r.splitText(o.startOffset),l=i.parentNode;return{prefix:t,end:a.parentNode.insertBefore(GE(e,t+"-end"),a),start:l.insertBefore(GE(e,t+"-start"),i)}},ZE=(e,t,n)=>{vs(e,e.get(t.prefix+"-end"),n),vs(e,e.get(t.prefix+"-start"),n)},Of=e=>e.start.length===0,QE=(e,t,n,o)=>{const r=t.start;var s;return Zm(e,o.container,o.offset,(s=r,(a,i)=>{const l=a.data.substring(0,i),c=l.lastIndexOf(s.charAt(s.length-1)),d=l.lastIndexOf(s);return d!==-1?d+s.length:c!==-1?c+1:-1}),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(r))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+r.length){const d=e.createRng();return d.setStart(a.container,a.offset-r.length),d.setEnd(a.container,a.offset),C.some(d)}{const d=a.offset-r.length;return Xm(a.container,d,n).map(u=>{const m=e.createRng();return m.setStart(u.container,u.offset),m.setEnd(a.container,a.offset),m}).filter(u=>u.toString()===r).orThunk(()=>QE(e,t,n,Mn(a.container,0)))}})},uB=(e,t,n,o)=>{const r=e.dom,s=r.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return Xm(i,l-n.pattern.end.length,t).bind(c=>{const d=Rf(r,s,c.container,c.offset,i,l,o);if(Of(a))return C.some({matches:[{pattern:a,startRng:d,endRng:d}],position:c});{const u=tc(e,n.remainingPatterns,c.container,c.offset,t,o),m=u.getOr({matches:[],position:c}),p=m.position;return((h,f,b,v,y,w=!1)=>{if(f.start.length===0&&!w){const E=h.createRng();return E.setStart(b,v),E.setEnd(b,v),C.some(E)}return Gm(b,v,y).bind(E=>QE(h,f,y,E).bind(k=>{var S;return w&&(k.endContainer===E.container&&k.endOffset===E.offset||E.offset===0&&((S=k.endContainer.textContent)===null||S===void 0?void 0:S.length)===k.endOffset)?C.none():C.some(k)}))})(r,a,p.container,p.offset,t,u.isNone()).map(h=>{const f=((b,v,y,w=!1)=>Rf(b,v,y.startContainer,y.startOffset,y.endContainer,y.endOffset,w))(r,s,h,o);return{matches:m.matches.concat([{pattern:a,startRng:f,endRng:d}]),position:Mn(h.startContainer,h.startOffset)}})}})},tc=(e,t,n,o,r,s)=>{const a=e.dom;return Gm(n,o,a.getRoot()).bind(i=>{const l=Tf(a,r,n,o);for(let c=0;c<t.length;c++){const d=t[c];if(!kc(l,d.end))continue;const u=t.slice();u.splice(c,1);const m=uB(e,r,{pattern:d,remainingPatterns:u,position:i},s);if(m.isNone()&&o>0)return tc(e,t,n,o-1,r,s);if(m.isSome())return m}return C.none()})},JE=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?U(t.format,o=>{e.formatter.apply(o)}):e.execCommand(t.cmd,!1,t.value)},ek=(e,t,n,o,r,s)=>{var a;return((i,l)=>{const c=wo(i,d=>it(l,u=>d.pattern.start===u.pattern.start&&d.pattern.end===u.pattern.end));return i.length===l.length?c?i:l:i.length>l.length?i:l})(tc(e,r.inlinePatterns,n,o,t,s).fold(()=>[],i=>i.matches),tc(e,(a=r.inlinePatterns,Vo(a,(i,l)=>l.end.length-i.end.length)),n,o,t,s).fold(()=>[],i=>i.matches))},tk=(e,t)=>{if(t.length===0)return;const n=e.dom,o=e.selection.getBookmark(),r=((s,a)=>{const i=oa("mce_textpattern"),l=Rs(a,(c,d)=>{const u=XE(s,i+`_end${c.length}`,d.endRng);return c.concat([{...d,endMarker:u}])},[]);return Rs(l,(c,d)=>{const u=l.length-c.length-1,m=Of(d.pattern)?d.endMarker:XE(s,i+`_start${u}`,d.startRng);return c.concat([{...d,startMarker:m}])},[])})(n,t);U(r,s=>{const a=n.getParent(s.startMarker.start,n.isBlock),i=l=>l===a;Of(s.pattern)?((l,c,d,u)=>{const m=ec(l.dom,d);Ql(l.dom,m,u),JE(l,c,m)})(e,s.pattern,s.endMarker,i):((l,c,d,u,m)=>{const p=l.dom,g=ec(p,u),h=ec(p,d);Ql(p,h,m),Ql(p,g,m);const f={prefix:d.prefix,start:d.end,end:u.start},b=ec(p,f);JE(l,c,b)})(e,s.pattern,s.startMarker,s.endMarker,i),ZE(n,s.endMarker,i),ZE(n,s.startMarker,i)}),e.selection.moveToBookmark(o)},nk=(e,t,n)=>((o,r,s)=>{if(j(o)&&0>=o.length)return C.some(Mn(o,0));{const a=sr(Dl);return C.from(a.forwards(o,0,Ll(o),s)).map(i=>Mn(i.container,0))}})(t,0,t).map(o=>{const r=o.container;return cw(r,n.start.length,t).each(s=>{const a=e.createRng();a.setStart(r,0),a.setEnd(s.container,s.offset),Ql(e,a,i=>i===t)}),r}),ok=e=>(t,n)=>{const o=t.dom,r=n.pattern,s=YE(o.getRoot(),n.range).getOrDie("Unable to resolve path range");return Jl(t,s).each(a=>{r.type==="block-format"?((i,l)=>{const c=l.get(i);return He(c)&&Ht(c).exists(d=>ke(d,"block"))})(r.format,t.formatter)&&t.undoManager.transact(()=>{e(t.dom,a,r),t.formatter.apply(r.format)}):r.type==="block-command"&&t.undoManager.transact(()=>{e(t.dom,a,r),t.execCommand(r.cmd,!1,r.value)})}),!0},rk=e=>(t,n)=>{const o=(s=>Vo(s,(a,i)=>i.start.length-a.start.length))(t),r=n.replace(Ct," ");return pt(o,s=>e(s,n,r))},sk=(e,t)=>(n,o,r,s,a)=>{var i;a===void 0&&(a=(i=o.textContent)!==null&&i!==void 0?i:"");const l=n.dom,c=Dt(n);return l.is(o,c)?e(r.blockPatterns,a).map(d=>t&&$.trim(a).length===d.start.length?[]:[{pattern:d,range:Rf(l,l.getRoot(),o,0,o,0,s)}]).getOr([]):[]},mB=ok((e,t,n)=>{nk(e,t,n).each(o=>{const r=R(o),s=Ai(r);/^\s[^\s]/.test(s)&&((a,i)=>{ud.set(a,i)})(r,s.slice(1))})}),fB=rk((e,t,n)=>t.indexOf(e.start)===0||n.indexOf(e.start)===0),gB=sk(fB,!0),pB=ok(nk),hB=rk((e,t,n)=>t===e.start||n===e.start),bB=sk(hB,!1),ak=(e,t,n)=>{for(let o=0;o<e.length;o++)if(n(e[o],t))return!0;return!1},vB=e=>{const t=[",",".",";",":","!","?"],n=[32],o=()=>{return a=ZS(e),i=QS(e),{inlinePatterns:wh(a),blockPatterns:Ch(a),dynamicPatternsLookup:i};var a,i},r=()=>(a=>a.options.isSet("text_patterns_lookup"))(e);e.on("keydown",a=>{if(a.keyCode===13&&!ee.modifierPressed(a)&&e.selection.isCollapsed()){const i=_d(o(),"enter");(i.inlinePatterns.length>0||i.blockPatterns.length>0||r())&&((l,c)=>((d,u)=>{const m=d.selection.getRng();return Jl(d,m).map(p=>{var g;const h=Math.max(0,m.startOffset),f=Af(u,p,(g=p.textContent)!==null&&g!==void 0?g:"");return{inlineMatches:ek(d,p,m.startContainer,h,f,!0),blockMatches:gB(d,p,f,!0)}}).filter(({inlineMatches:p,blockMatches:g})=>g.length>0||p.length>0)})(l,c).fold(Qe,({inlineMatches:d,blockMatches:u})=>(l.undoManager.add(),l.undoManager.extra(()=>{l.execCommand("mceInsertNewLine")},()=>{(g=>{g.insertContent(Et,{preserve_zwsp:!0})})(l),tk(l,d),((g,h)=>{if(h.length===0)return;const f=g.selection.getBookmark();U(h,b=>mB(g,b)),g.selection.moveToBookmark(f)})(l,u);const m=l.selection.getRng(),p=Gm(m.startContainer,m.startOffset,l.dom.getRoot());l.execCommand("mceInsertNewLine"),p.each(g=>{const h=g.container;h.data.charAt(g.offset-1)===qs&&(h.deleteData(g.offset-1,1),vs(l.dom,h.parentNode,f=>f===l.dom.getRoot()))})}),!0)))(e,i)&&a.preventDefault()}},!0),e.on("keydown",a=>{if(a.keyCode===32&&e.selection.isCollapsed()){const i=_d(o(),"space");(i.blockPatterns.length>0||r())&&((l,c)=>((d,u)=>{const m=d.selection.getRng();return Jl(d,m).map(p=>{const g=Math.max(0,m.startOffset),h=Tf(d.dom,p,m.startContainer,g),f=Af(u,p,h);return bB(d,p,f,!1,h)}).filter(p=>p.length>0)})(l,c).fold(Qe,d=>(l.undoManager.transact(()=>{((u,m)=>{U(m,p=>pB(u,p))})(l,d)}),!0)))(e,i)&&a.preventDefault()}},!0);const s=()=>{if(e.selection.isCollapsed()){const a=_d(o(),"space");(a.inlinePatterns.length>0||r())&&((i,l)=>{const c=i.selection.getRng();Jl(i,c).map(d=>{const u=Math.max(0,c.startOffset-1),m=Tf(i.dom,d,c.startContainer,u),p=Af(l,d,m),g=ek(i,d,c.startContainer,u,p,!1);g.length>0&&i.undoManager.transact(()=>{tk(i,g)})})})(e,a)}};e.on("keyup",a=>{ak(n,a,(i,l)=>i===l.keyCode&&!ee.modifierPressed(l))&&s()}),e.on("keypress",a=>{ak(t,a,(i,l)=>i.charCodeAt(0)===l.charCode)&&gn.setEditorTimeout(e,s)})},yB=e=>{const t=$.each,n=ee.BACKSPACE,o=ee.DELETE,r=e.dom,s=e.selection,a=e.parser,i=Be.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),d=Be.deviceType.isiPhone()||Be.deviceType.isiPad(),u=Be.os.isMacOS()||Be.os.isiOS(),m=(x,N)=>{try{e.getDoc().execCommand(x,!1,String(N))}catch{}},p=x=>x.isDefaultPrevented(),g=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{e.inline||r.bind(e.getDoc(),"mousedown mouseup",x=>{let N;if(x.target===e.getDoc().documentElement)if(N=s.getRng(),e.getBody().focus(),x.type==="mousedown"){if(cn(N.startContainer))return;s.placeCaretAt(x.clientX,x.clientY)}else s.setRng(N)})},f=()=>{Range.prototype.getClientRects||e.on("mousedown",x=>{if(!p(x)&&x.target.nodeName==="HTML"){const N=e.getBody();N.blur(),gn.setEditorTimeout(e,()=>{N.focus()})}})},b=()=>{const x=Ih(e);e.on("click",N=>{const B=N.target;/^(IMG|HR)$/.test(B.nodeName)&&r.isEditable(B)&&(N.preventDefault(),e.selection.select(B),e.nodeChanged()),B.nodeName==="A"&&r.hasClass(B,x)&&B.childNodes.length===0&&r.isEditable(B.parentNode)&&(N.preventDefault(),s.select(B))})},v=()=>{e.on("keydown",x=>{if(!p(x)&&x.keyCode===n&&s.isCollapsed()&&s.getRng().startOffset===0){const N=s.getNode().previousSibling;if(N&&N.nodeName&&N.nodeName.toLowerCase()==="table")return x.preventDefault(),!1}return!0})},y=()=>{Lh(e)||e.on("BeforeExecCommand mousedown",()=>{m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),Ph(e)||m("enableObjectResizing",!1)})},w=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},E=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},k=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",x=>{let N;x.target.nodeName==="HTML"&&(N=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(N),e.selection.normalize(),e.nodeChanged())}))},S=()=>{u&&e.on("keydown",x=>{!ee.metaKeyPressed(x)||x.shiftKey||x.keyCode!==37&&x.keyCode!==39||(x.preventDefault(),e.selection.getSel().modify("move",x.keyCode===37?"backward":"forward","lineboundary"))})},_=()=>{e.on("click",x=>{let N=x.target;do if(N.tagName==="A")return void x.preventDefault();while(N=N.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},T=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",x=>{x.preventDefault()})})},P=Ne;return Qn(e)?(c&&(h(),b(),T(),g(),d&&(E(),k(),_())),l&&(f(),y(),w(),S())):(e.on("keydown",x=>{if(p(x)||x.keyCode!==ee.BACKSPACE)return;let N=s.getRng();const B=N.startContainer,I=N.startOffset,V=r.getRoot();let z=B;if(N.collapsed&&I===0){for(;z.parentNode&&z.parentNode.firstChild===z&&z.parentNode!==V;)z=z.parentNode;z.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,z),N=r.createRng(),N.setStart(B,0),N.setEnd(B,0),s.setRng(N))}}),(()=>{const x=N=>{const B=r.create("body"),I=N.cloneContents();return B.appendChild(I),s.serializer.serialize(B,{format:"html"})};e.on("keydown",N=>{const B=N.keyCode;if(!p(N)&&(B===o||B===n)&&e.selection.isEditable()){const I=e.selection.isCollapsed(),V=e.getBody();if(I&&!fo(e.schema,V)||!I&&!(z=>{const te=x(z),ae=r.createRng();return ae.selectNode(e.getBody()),te===x(ae)})(e.selection.getRng()))return;N.preventDefault(),e.setContent(""),V.firstChild&&r.isBlock(V.firstChild)?e.selection.setCursorLocation(V.firstChild,0):e.selection.setCursorLocation(V,0),e.nodeChanged()}})})(),Be.windowsPhone||e.on("keyup focusin mouseup",x=>{ee.modifierPressed(x)||(N=>{const B=N.getBody(),I=N.selection.getRng();return I.startContainer===I.endContainer&&I.startContainer===B&&I.startOffset===0&&I.endOffset===B.childNodes.length})(e)||s.normalize()},!0),c&&(h(),b(),e.on("init",()=>{m("DefaultParagraphSeparator",Dt(e))}),T(),v(),a.addNodeFilter("br",x=>{let N=x.length;for(;N--;)x[N].attr("class")==="Apple-interchange-newline"&&x[N].remove()}),d?(E(),k(),_()):g()),l&&(e.on("keydown",x=>{if(!p(x)&&x.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&s.getRng().startOffset===0){const N=s.getNode(),B=N.previousSibling;if(N.nodeName==="HR")return r.remove(N),void x.preventDefault();B&&B.nodeName&&B.nodeName.toLowerCase()==="hr"&&(r.remove(B),x.preventDefault())}}}),f(),(()=>{const x=()=>{const B=r.getAttribs(s.getStart().cloneNode(!1));return()=>{const I=s.getStart();I!==e.getBody()&&(r.setAttrib(I,"style",null),t(B,V=>{I.setAttributeNode(V.cloneNode(!0))}))}},N=()=>!s.isCollapsed()&&r.getParent(s.getStart(),r.isBlock)!==r.getParent(s.getEnd(),r.isBlock);e.on("keypress",B=>{let I;return!(!(p(B)||B.keyCode!==8&&B.keyCode!==46)&&N()&&(I=x(),e.getDoc().execCommand("delete",!1),I(),B.preventDefault(),1))}),r.bind(e.getDoc(),"cut",B=>{if(!p(B)&&N()){const I=x();gn.setEditorTimeout(e,()=>{I()})}})})(),y(),e.on("SetContent ExecCommand",x=>{x.type!=="setcontent"&&x.command!=="mceInsertLink"||t(r.select("a:not([data-mce-block])"),N=>{var B;let I=N.parentNode;const V=r.getRoot();if((I==null?void 0:I.lastChild)===N){for(;I&&!r.isBlock(I);){if(((B=I.parentNode)===null||B===void 0?void 0:B.lastChild)!==I||I===V)return;I=I.parentNode}r.add(I,"br",{"data-mce-bogus":1})}})}),w(),S(),v())),{refreshContentEditable:P,isHidden:()=>{if(!l||e.removed)return!1;const x=e.selection.getSel();return!x||!x.rangeCount||x.rangeCount===0}}},Bf=Ve.DOM,CB=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,Pf=e=>Ps(e,t=>st(t)===!1),ik=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return Pf({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_unsafe_embeds:t("convert_unsafe_embeds"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:CB(e),sandbox_iframes:t("sandbox_iframes"),sandbox_iframes_exclusions:Td(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},lk=e=>{const t=e.options.get;return Pf({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},Df=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,ck=e=>{const t=Df(e),n=Bh(e),o=e.contentCSS,r=()=>{t.unloadAll(o),e.inline||e.ui.styleSheetLoader.unloadAll(n)},s=()=>{e.removed?r():e.on("remove",r)};if(e.contentStyles.length>0){let l="";$.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(((l,c,d)=>{const{pass:u,fail:m}=Tr(c,h=>tinymce.Resource.has(km(h))),p=u.map(h=>{const f=tinymce.Resource.get(km(h));return Q(f)?Promise.resolve(Df(l).loadRawCss(h,f)):Promise.resolve()}),g=[...p,Df(l).loadAll(m)];return l.inline?g:g.concat([l.ui.styleSheetLoader.loadAll(d)])})(e,o,n)).then(s).catch(s),i=cS(e);return i&&((l,c)=>{const d=R(l.getBody()),u=Pc(ko(d)),m=vt("style");_t(m,"type","text/css"),ut(m,Ir(c)),ut(u,m),l.on("remove",()=>{Ze(m)})})(e,i),a},Lf=e=>{e.removed!==!0&&((t=>{Qn(t)||t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"})})(e),(t=>{t.bindPendingEventDelegates(),t.initialized=!0,(o=>{o.dispatch("Init")})(t),t.focus(!0),(o=>{const r=o.dom.getRoot();o.inline||Ki(o)&&o.selection.getStart(!0)!==r||Lt(r).each(s=>{const a=s.getNode(),i=Vn(a)?Lt(a).getOr(s):s;o.selection.setRng(i.toRange())})})(t),t.nodeChanged({initial:!0});const n=LS(t);Ie(n)&&n.call(t,t),(o=>{const r=IS(o);r&&gn.setEditorTimeout(o,()=>{let s;s=r===!0?o:o.editorManager.get(r),s&&!s.destroyed&&(s.focus(),s.selection.scrollIntoView())},100)})(t)})(e))},dk=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(Bf.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const o=e.getBody();o.disabled=!0,e.readonly=Lh(e),e._editableRoot=RS(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&Bf.getStyle(o,"position",!0)==="static"&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,e.editorUpload=UA(e),e.schema=No(lk(e)),e.dom=Ve(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:sS(e),referrerPolicy:Nd(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=(a=>{const i=ls(ik(a),a.schema);return i.addAttributeFilter("src,href,style,tabindex",(l,c)=>{const d=a.dom,u="data-mce-"+c;let m=l.length;for(;m--;){const p=l[m];let g=p.attr(c);if(g&&!p.attr(u)){if(g.indexOf("data:")===0||g.indexOf("blob:")===0)continue;c==="style"?(g=d.serializeStyle(d.parseStyle(g),p.name),g.length||(g=null),p.attr(u,g),p.attr(c,g)):c==="tabindex"?(p.attr(u,g),p.attr(c,null)):p.attr(u,a.convertURL(g,c,p.name))}}}),i.addNodeFilter("script",l=>{let c=l.length;for(;c--;){const d=l[c],u=d.attr("type")||"no/type";u.indexOf("mce-")!==0&&d.attr("type","mce-"+u)}}),tN(a)&&i.addNodeFilter("#cdata",l=>{var c;let d=l.length;for(;d--;){const u=l[d];u.type=8,u.name="#comment",u.value="[CDATA["+a.dom.encode((c=u.value)!==null&&c!==void 0?c:"")+"]]"}}),i.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",l=>{let c=l.length;const d=a.schema.getNonEmptyElements();for(;c--;){const u=l[c];u.isEmpty(d)&&u.getAll("br").length===0&&u.append(new Ft("br",1))}}),i})(e),e.serializer=cC((a=>{const i=a.options.get;return{...ik(a),...lk(a),...Pf({remove_trailing_brs:i("remove_trailing_brs"),pad_empty_with_br:i("pad_empty_with_br"),url_converter:i("url_converter"),url_converter_scope:i("url_converter_scope"),element_format:i("element_format"),entities:i("entities"),entity_encoding:i("entity_encoding"),indent:i("indent"),indent_after:i("indent_after"),indent_before:i("indent_before")})}})(e),e),e.selection=lC(e.dom,e.getWin(),e.serializer,e),e.annotator=Lb(e),e.formatter=xC(e),e.undoManager=SC(e),e._nodeChangeDispatcher=new DO(e),e._selectionOverrides=cB(e),(a=>{const i=Ro(),l=wt(!1),c=dd(d=>{a.dispatch("longpress",{...d,type:"longpress"}),l.set(!0)},400);a.on("touchstart",d=>{P1(d).each(u=>{c.cancel();const m={x:u.clientX,y:u.clientY,target:d.target};c.throttle(d),l.set(!1),i.set(m)})},!0),a.on("touchmove",d=>{c.cancel(),P1(d).each(u=>{i.on(m=>{((p,g)=>{const h=Math.abs(p.clientX-g.x),f=Math.abs(p.clientY-g.y);return h>5||f>5})(u,m)&&(i.clear(),l.set(!1),a.dispatch("longpresscancel"))})})},!0),a.on("touchend touchcancel",d=>{c.cancel(),d.type!=="touchcancel"&&i.get().filter(u=>u.target.isEqualNode(d.target)).each(()=>{l.get()?d.preventDefault():a.dispatch("tap",{...d,type:"tap"})})},!0)})(e),(a=>{(i=>{i.on("click",l=>{i.dom.getParent(l.target,"details")&&l.preventDefault()})})(a),(i=>{i.parser.addNodeFilter("details",l=>{const c=sN(i);U(l,d=>{c==="expanded"?d.attr("open","open"):c==="collapsed"&&d.attr("open",null)})}),i.serializer.addNodeFilter("details",l=>{const c=aN(i);U(l,d=>{c==="expanded"?d.attr("open","open"):c==="collapsed"&&d.attr("open",null)})})})(a)})(e),(a=>{const i="contenteditable",l=" "+$.trim(JS(a))+" ",c=" "+$.trim(Fh(a))+" ",d=M1(l),u=M1(c),m=eN(a);m.length>0&&a.on("BeforeSetContent",p=>{((g,h,f)=>{let b=h.length,v=f.content;if(f.format!=="raw"){for(;b--;)v=v.replace(h[b],NT(g,v,Fh(g)));f.content=v}})(a,m,p)}),a.parser.addAttributeFilter("class",p=>{let g=p.length;for(;g--;){const h=p[g];d(h)?h.attr(i,"true"):u(h)&&h.attr(i,"false")}}),a.serializer.addAttributeFilter(i,p=>{let g=p.length;for(;g--;){const h=p[g];(d(h)||u(h))&&(m.length>0&&h.attr("data-mce-content")?(h.name="#text",h.type=3,h.raw=!0,h.value=h.attr("data-mce-content")):h.attr(i,null))}})})(e),Qn(e)||((a=>{a.on("mousedown",i=>{i.detail>=3&&(i.preventDefault(),JO(a))})})(e),(a=>{vB(a)})(e));const r=PO(e);kT(e,r),(a=>{a.on("NodeChange",ne(ST,a))})(e),(a=>{var i;const l=a.dom,c=Dt(a),d=(i=fS(a))!==null&&i!==void 0?i:"",u=(m,p)=>{if((f=>{if(RC(f)){const b=f.keyCode;return!AC(f)&&(ee.metaKeyPressed(f)||f.altKey||b>=112&&b<=123||Ue(VA,b))}return!1})(m))return;const g=a.getBody(),h=!(f=>RC(f)&&!(AC(f)||f.type==="keyup"&&f.keyCode===229))(m)&&((f,b,v)=>{if(f.isEmpty(b,void 0,{skipBogus:!1,includeZwsp:!0})){const y=b.firstElementChild;return!y||!f.getStyle(b.firstElementChild,"padding-left")&&!f.getStyle(b.firstElementChild,"padding-right")&&v===y.nodeName.toLowerCase()}return!1})(l,g,c);(l.getAttrib(g,NC)!==""!==h||p)&&(l.setAttrib(g,NC,h?d:null),((f,b)=>{f.dispatch("PlaceholderToggle",{state:b})})(a,h),a.on(h?"keydown":"keyup",u),a.off(h?"keyup":"keydown",u))};Un(d)&&a.on("init",m=>{u(m,!0),a.on("change SetContent ExecCommand",u),a.on("paste",p=>gn.setEditorTimeout(a,()=>u(p)))})})(e),XO(e);const s=(a=>{const i=a;return(l=>Xe(l.plugins,"rtc").bind(c=>C.from(c.setup)))(a).fold(()=>(i.rtcInstance=nC(a),C.none()),l=>(i.rtcInstance=(()=>{const c=oe(null),d=oe("");return{init:{bindEvents:Ne},undoManager:{beforeChange:Ne,add:c,undo:c,redo:c,clear:Ne,reset:Ne,hasUndo:Qe,hasRedo:Qe,transact:c,ignore:Ne,extra:Ne},formatter:{match:Qe,matchAll:oe([]),matchNode:oe(void 0),canApply:Qe,closest:d,apply:Ne,remove:Ne,toggle:Ne,formatChanged:oe({unbind:Ne})},editor:{getContent:d,setContent:oe({content:"",html:""}),insertContent:oe(""),addVisual:Ne},selection:{getContent:d},autocompleter:{addDecoration:Ne,removeDecoration:Ne},raw:{getModel:oe(C.none())}}})(),C.some(()=>l().then(c=>(i.rtcInstance=(d=>{const u=y=>We(y)?y:{},{init:m,undoManager:p,formatter:g,editor:h,selection:f,autocompleter:b,raw:v}=d;return{init:{bindEvents:m.bindEvents},undoManager:{beforeChange:p.beforeChange,add:p.add,undo:p.undo,redo:p.redo,clear:p.clear,reset:p.reset,hasUndo:p.hasUndo,hasRedo:p.hasRedo,transact:(y,w,E)=>p.transact(E),ignore:(y,w)=>p.ignore(w),extra:(y,w,E,k)=>p.extra(E,k)},formatter:{match:(y,w,E,k)=>g.match(y,u(w),k),matchAll:g.matchAll,matchNode:g.matchNode,canApply:y=>g.canApply(y),closest:y=>g.closest(y),apply:(y,w,E)=>g.apply(y,u(w)),remove:(y,w,E,k)=>g.remove(y,u(w)),toggle:(y,w,E)=>g.toggle(y,u(w)),formatChanged:(y,w,E,k,S)=>g.formatChanged(w,E,k,S)},editor:{getContent:y=>h.getContent(y),setContent:(y,w)=>({content:h.setContent(y,w),html:""}),insertContent:(y,w)=>(h.insertContent(y),""),addVisual:h.addVisual},selection:{getContent:(y,w)=>f.getContent(w)},autocompleter:{addDecoration:b.addDecoration,removeDecoration:b.removeDecoration},raw:{getModel:()=>C.some(v.getRawModel())}}})(c),c.rtc.isRemote)))))})(e);(a=>{const i=a.getDoc(),l=a.getBody();(u=>{u.dispatch("PreInit")})(a),FS(a)||(i.body.spellcheck=!1,Bf.setAttrib(l,"spellcheck","false")),a.quirks=yB(a),(u=>{u.dispatch("PostRender")})(a);const c=dS(a);c!==void 0&&(l.dir=c);const d=US(a);d&&a.on("BeforeSetContent",u=>{$.each(d,m=>{u.content=u.content.replace(m,p=>"<!--mce:protected "+escape(p)+"-->")})}),a.on("SetContent",()=>{a.addVisual(a.getBody())}),a.on("compositionstart compositionend",u=>{a.composing=u.type==="compositionstart"})})(e),(a=>{const i=lN(a);Q(cN(a))||!st(i)&&(l=>(c=>c.toLowerCase()==="gpl")(l)||(c=>c.length>=64&&c.length<=255)(l)?"VALID":"INVALID")(i)!=="INVALID"||console.warn("TinyMCE is running in evaluation mode. Provide a valid license key or add license_key: 'gpl' to the init config to agree to the open source license terms. Read more at https://www.tiny.cloud/license-key/")})(e),s.fold(()=>{const a=(i=>{let l=!1;const c=setTimeout(()=>{l||i.setProgressState(!0)},500);return()=>{clearTimeout(c),l=!0,i.setProgressState(!1)}})(e);ck(e).then(()=>{Lf(e),a()})},a=>{e.setProgressState(!0),ck(e).then(()=>{a().then(i=>{e.setProgressState(!1),Lf(e),oC(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Lf(e),oC(e)})})})},wB=dt,Mf=Ve.DOM,uk=Ve.DOM,mk=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),fk=e=>{const t=e.getElement();return e.inline?mk(null):(n=>{const o=uk.create("div");return uk.insertAfter(o,n),mk(o,o)})(t)},EB=async e=>{e.dispatch("ScriptsLoaded"),(n=>{const o=$.trim(Ah(n)),r=n.ui.registry.getAll().icons,s={...kl.get("default").icons,...kl.get(o).icons};Ke(s,(a,i)=>{ke(r,i)||n.ui.registry.addIcon(i,a)})})(e),(n=>{const o=Xr(n);if(Q(o)){const r=Cr.get(o);n.theme=r(n,Cr.urls[o])||{},Ie(n.theme.init)&&n.theme.init(n,Cr.urls[o]||n.documentBaseUrl.replace(/\/$/,""))}else n.theme={}})(e),(n=>{const o=Rd(n),r=cs.get(o);n.model=r(n,cs.urls[o])})(e),(n=>{const o=[];U(Ui(n),r=>{((s,a,i)=>{const l=ds.get(i),c=ds.urls[i]||s.documentBaseUrl.replace(/\/$/,"");if(i=$.trim(i),l&&$.inArray(a,i)===-1){if(s.plugins[i])return;try{const d=l(s,c)||{};s.plugins[i]=d,Ie(d.init)&&(d.init(s,c),a.push(i))}catch(d){((u,m,p)=>{const g=On.translate(["Failed to initialize plugin: {0}",m]);Ib(u,"PluginLoadError",{message:g}),_l(g,p),xl(u,g)})(s,i,d)}}})(n,o,(s=>s.replace(/^\-/,""))(r))})})(e);const t=await(n=>{const o=n.getElement();return n.orgDisplay=o.style.display,Q(Xr(n))?(r=>{const s=r.theme.renderUI;return s?s():fk(r)})(n):Ie(Xr(n))?(r=>{const s=r.getElement(),a=Xr(r)(r,s);return a.editorContainer.nodeType&&(a.editorContainer.id=a.editorContainer.id||r.id+"_parent"),a.iframeContainer&&a.iframeContainer.nodeType&&(a.iframeContainer.id=a.iframeContainer.id||r.id+"_iframecontainer"),a.height=a.iframeHeight?a.iframeHeight:s.offsetHeight,a})(n):fk(n)})(e);((n,o)=>{const r={show:C.from(o.show).getOr(Ne),hide:C.from(o.hide).getOr(Ne),isEnabled:C.from(o.isEnabled).getOr(dt),setEnabled:s=>{n.mode.isReadOnly()||C.from(o.setEnabled).each(a=>a(s))}};n.ui={...n.ui,...r}})(e,C.from(t.api).getOr({})),e.editorContainer=t.editorContainer,(n=>{n.contentCSS=n.contentCSS.concat((o=>vC(o,lS(o)))(n),(o=>vC(o,Bh(o)))(n))})(e),e.inline?dk(e):((n,o)=>{((r,s)=>{const a=r.translate("Rich Text Area"),i=ao(R(r.getElement()),"tabindex").bind(ci),l=((c,d,u,m)=>{const p=vt("iframe");return m.each(g=>_t(p,"tabindex",g)),so(p,u),so(p,{id:c+"_ifr",frameBorder:"0",allowTransparency:"true",title:d}),Mr(p,"tox-edit-area__iframe"),p})(r.id,a,$_(r),i).dom;l.onload=()=>{l.onload=null,r.dispatch("load")},r.contentAreaContainer=s.iframeContainer,r.iframeElement=l,r.iframeHTML=(c=>{let d=V_(c)+"<html><head>";_h(c)!==c.documentBaseUrl&&(d+='<base href="'+c.documentBaseURI.getURI()+'" />'),d+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const u=q_(c),m=W_(c),p=c.translate(PS(c));return Sh(c)&&(d+='<meta http-equiv="Content-Security-Policy" content="'+Sh(c)+'" />'),d+=`</head><body id="${u}" class="mce-content-body ${m}" data-id="${c.id}" aria-label="${p}"><br></body></html>`,d})(r),Mf.add(s.iframeContainer,l)})(n,o),o.editorContainer&&(o.editorContainer.style.display=n.orgDisplay,n.hidden=Mf.isHidden(o.editorContainer)),n.getElement().style.display="none",Mf.setAttrib(n.id,"aria-hidden","true"),n.getElement().style.visibility=n.orgVisibility,(r=>{const s=r.iframeElement,a=()=>{r.contentDocument=s.contentDocument,dk(r)};if(oN(r)||Be.browser.isFirefox()){const l=r.getDoc();l.open(),l.write(r.iframeHTML),l.close(),a()}else{const l=(i=R(s),Kx(i,"load",wB,()=>{l.unbind(),a()}));s.srcdoc=r.iframeHTML}var i})(n)})(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},Er=Ve.DOM,gk=e=>e.charAt(0)==="-",pk=(e,t,n)=>C.from(t).filter(o=>Un(o)&&!kl.has(o)).map(o=>({url:`${e.editorManager.baseURL}/icons/${o}/icons${n}.js`,name:C.some(o)})),kB=(e,t)=>{const n=go.ScriptLoader,o=()=>{!e.removed&&(r=>{const s=Xr(r);return!Q(s)||q(Cr.get(s))})(e)&&(r=>{const s=Rd(r);return q(cs.get(s))})(e)&&EB(e)};((r,s)=>{const a=Xr(r);if(Q(a)&&!gk(a)&&!ke(Cr.urls,a)){const i=pS(r),l=i?r.documentBaseURI.toAbsolute(i):`themes/${a}/theme${s}.js`;Cr.load(a,l).catch(()=>{((c,d,u)=>{Ma(c,"ThemeLoadError",Ia("theme",d,u))})(r,l,a)})}})(e,t),((r,s)=>{const a=Rd(r);if(a!=="plugin"&&!ke(cs.urls,a)){const i=hS(r),l=Q(i)?r.documentBaseURI.toAbsolute(i):`models/${a}/model${s}.js`;cs.load(a,l).catch(()=>{((c,d,u)=>{Ma(c,"ModelLoadError",Ia("model",d,u))})(r,l,a)})}})(e,t),((r,s)=>{const a=Th(s),i=aS(s);if(!On.hasCode(a)&&a!=="en"){const l=Un(i)?i:`${s.editorManager.baseURL}/langs/${a}.js`;r.add(l).catch(()=>{((c,d,u)=>{Ma(c,"LanguageLoadError",Ia("language",d,u))})(s,l,a)})}})(n,e),((r,s,a)=>{const i=pk(s,"default",a),l=(c=>C.from(eS(c)).filter(Un).map(d=>({url:d,name:C.none()})))(s).orThunk(()=>pk(s,Ah(s),""));U((c=>{const d=[],u=m=>{d.push(m)};for(let m=0;m<c.length;m++)c[m].each(u);return d})([i,l]),c=>{r.add(c.url).catch(()=>{((d,u,m)=>{Ma(d,"IconsLoadError",Ia("icons",u,m))})(s,c.url,c.name.getOrUndefined())})})})(n,e,t),((r,s)=>{const a=(i,l)=>{ds.load(i,l).catch(()=>{((c,d,u)=>{Ma(c,"PluginLoadError",Ia("plugin",d,u))})(r,l,i)})};Ke(AS(r),(i,l)=>{a(l,i),r.options.set("plugins",Ui(r).concat(l))}),U(Ui(r),i=>{!(i=$.trim(i))||ds.urls[i]||gk(i)||a(i,`plugins/${i}/plugin${s}.js`)})})(e,t),n.loadQueue().then(o,o)},hk=zn().deviceType,bk=hk.isPhone(),xB=hk.isTablet(),ei=e=>{if(at(e))return[];{const t=He(e)?e:e.split(/[ ,]/),n=Te(t,Pr);return ye(n,Un)}},_B=(e,t)=>{const n=((s,a)=>{const i={},l={};return ag(s,(c,d)=>Ue(e,d),vc(i),vc(l)),{t:i,f:l}})(t);return o=n.t,r=n.f,{sections:oe(o),options:oe(r)};var o,r},If=(e,t)=>ke(e.sections(),t),SB=(e,t)=>({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Xe(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1,...t?{menubar:!1}:{}}),NB=(e,t)=>{var n;const o=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?$.extend({},e.external_plugins,o):o},RB=(e,t,n,o,r)=>{var s;const a=e?{mobile:SB((s=r.mobile)!==null&&s!==void 0?s:{},t)}:{},i=_B(["mobile"],tf(a,r)),l=$.extend(n,o,i.options(),((c,d)=>c&&If(d,"mobile"))(e,i)?((c,d,u={})=>{const m=c.sections(),p=Xe(m,d).getOr({});return $.extend({},u,p)})(i,"mobile"):{},{external_plugins:NB(o,i.options())});return((c,d,u,m)=>{const p=ei(u.forced_plugins),g=ei(m.plugins),h=((v,y)=>If(v,y)?v.sections()[y]:{})(d,"mobile"),f=((v,y,w,E)=>v&&If(y,"mobile")?E:w)(c,d,g,h.plugins?ei(h.plugins):g),b=((v,y)=>[...ei(v),...ei(y)])(p,f);return $.extend(m,{forced_plugins:p,plugins:b})})(e,i,o,l)},AB=e=>{(t=>{const n=o=>()=>{U("left,center,right,justify".split(","),r=>{o!==r&&t.formatter.remove("align"+r)}),o!=="none"&&((r,s)=>{t.formatter.toggle(r,void 0),t.nodeChanged()})("align"+o)};t.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})})(e),(t=>{const n=o=>()=>{const r=t.selection,s=r.isCollapsed()?[t.dom.getParent(r.getNode(),t.dom.isBlock)]:r.getSelectedBlocks();return it(s,a=>q(t.formatter.matchNode(a,o)))};t.editorCommands.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify")},"state")})(e)},TB=(e,t)=>{const n=e.selection,o=e.dom;return/^ | $/.test(t)?((r,s,a,i)=>{const l=R(r.getRoot());return a=Na(l,M.fromRangeStart(s),i)?a.replace(/^ /,"&nbsp;"):a.replace(/^&nbsp;/," "),Ra(l,M.fromRangeEnd(s),i)?a.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):a.replace(/&nbsp;(<br( \/)?>)?$/," ")})(o,n.getRng(),t,e.schema):t},nc=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:o}=(r=>{if(typeof r!="string"){const s=$.extend({paste:r.paste,data:{paste:r.paste}},r);return{content:r.content,details:s}}return{content:r,details:{}}})(t);gm(e,{...o,content:TB(e,n),format:"html",set:!1,selection:!0}).each(r=>{const s=((a,i,l)=>wm(a).editor.insertContent(i,l))(e,r.content,o);pm(e,s,r),e.addVisual()})}},OB={"font-size":"size","font-family":"face"},BB=mi("font"),vk=e=>(t,n)=>C.from(n).map(R).filter(tn).bind(o=>((r,s,a)=>Wu(R(a),i=>(l=>bi(l,r).orThunk(()=>BB(l)?Xe(OB,r).bind(c=>ao(l,c)):C.none()))(i),i=>De(R(s),i)))(e,t,o.dom).or(((r,s)=>C.from(Ve.DOM.getStyle(s,r,!0)))(e,o.dom))).getOr(""),PB=vk("font-size"),DB=In(e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),vk("font-family")),LB=e=>Lt(e.getBody()).bind(t=>{const n=t.container();return C.from(j(n)?n.parentNode:n)}),Ff=(e,t)=>((n,o)=>(r=>C.from(r.selection.getRng()).bind(s=>{const a=r.getBody();return s.startContainer===a&&s.startOffset===0?C.none():C.from(r.selection.getStart(!0))}))(n).orThunk(ne(LB,n)).map(R).filter(tn).bind(o))(e,Qf(C.some,t)),yk=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const o=(s=>$.explode(s.options.get("font_size_style_values")))(e),r=(s=>$.explode(s.options.get("font_size_classes")))(e);return r.length>0?r[n-1]||t:o[n-1]||t}return t}return t},MB=e=>{const t=e.split(/\s*,\s*/);return Te(t,n=>n.indexOf(" ")===-1||ht(n,'"')||ht(n,"'")?n:`'${n}'`).join(",")},Ck=(e,t)=>{const n=e.dom,o=e.selection.getRng(),r=t?e.selection.getStart():e.selection.getEnd(),s=t?o.startContainer:o.endContainer,a=Ga(n,s);if(!a||!a.isContentEditable)return;const i=t?Xt:uo,l=Dt(e);((c,d,u,m)=>{const p=c.dom,g=f=>p.isBlock(f)&&f.parentElement===u,h=g(d)?d:p.getParent(m,g,u);return C.from(h).map(R)})(e,r,a,s).each(c=>{const d=Fw(e,s,c.dom,a,!1,l);i(c,R(d)),e.selection.setCursorLocation(d,0),e.dispatch("NewBlock",{newBlock:d}),Ya(e,"insertParagraph")})},IB=e=>{AB(e),(t=>{t.editorCommands.addCommands({"Cut,Copy,Paste":n=>{const o=t.getDoc();let r;try{o.execCommand(n)}catch{r=!0}if(n!=="paste"||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){let s=t.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Be.os.isMacOS()||Be.os.isiOS())&&(s=s.replace(/Ctrl\+/g,"⌘+")),t.notificationManager.open({text:s,type:"error"})}}})})(e),(t=>{t.editorCommands.addCommands({mceAddUndoLevel:()=>{t.undoManager.add()},mceEndUndoLevel:()=>{t.undoManager.add()},Undo:()=>{t.undoManager.undo()},Redo:()=>{t.undoManager.redo()}})})(e),(t=>{t.editorCommands.addCommands({mceSelectNodeDepth:(n,o,r)=>{let s=0;t.dom.getParent(t.selection.getNode(),a=>!re(a)||s++!==r||(t.selection.select(a),!1),t.getBody())},mceSelectNode:(n,o,r)=>{t.selection.select(r)},selectAll:()=>{const n=t.dom.getParent(t.selection.getStart(),Cn);if(n){const o=t.dom.createRng();o.selectNodeContents(n),t.selection.setRng(o)}}})})(e),(t=>{t.editorCommands.addCommands({mceCleanup:()=>{const n=t.selection.getBookmark();t.setContent(t.getContent()),t.selection.moveToBookmark(n)},insertImage:(n,o,r)=>{nc(t,t.dom.createHTML("img",{src:r}))},insertHorizontalRule:()=>{t.execCommand("mceInsertContent",!1,"<hr>")},insertText:(n,o,r)=>{nc(t,t.dom.encode(r))},insertHTML:(n,o,r)=>{nc(t,r)},mceInsertContent:(n,o,r)=>{nc(t,r)},mceSetContent:(n,o,r)=>{t.setContent(r)},mceReplaceContent:(n,o,r)=>{t.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,t.selection.getContent({format:"text"})))},mceNewDocument:()=>{t.setContent($S(t))}})})(e),(t=>{const n=(o,r,s)=>{const a=Q(s)?{href:s}:s,i=t.dom.getParent(t.selection.getNode(),"a");We(a)&&Q(a.href)&&(a.href=a.href.replace(/ /g,"%20"),i&&a.href||t.formatter.remove("link"),a.href&&t.formatter.apply("link",a,i))};t.editorCommands.addCommands({unlink:()=>{if(t.selection.isEditable()){if(t.selection.isCollapsed()){const o=t.dom.getParent(t.selection.getStart(),"a");return void(o&&t.dom.remove(o,!0))}t.formatter.remove("link")}},mceInsertLink:n,createLink:n})})(e),(t=>{t.editorCommands.addCommands({Indent:()=>{(n=>{A1(n,"indent")})(t)},Outdent:()=>{T1(t)}}),t.editorCommands.addCommands({Outdent:()=>S1(t)},"state")})(e),(t=>{t.editorCommands.addCommands({InsertNewBlockBefore:()=>{(n=>{Ck(n,!0)})(t)},InsertNewBlockAfter:()=>{(n=>{Ck(n,!1)})(t)}})})(e),(t=>{t.editorCommands.addCommands({insertParagraph:()=>{Wl(Hw,t)},mceInsertNewLine:(n,o,r)=>{Gw(t,r)},InsertLineBreak:(n,o,r)=>{Wl(qw,t)}})})(e),(t=>{(n=>{const o=(r,s)=>{n.formatter.toggle(r,s),n.nodeChanged()};n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>{o(r)},"ForeColor,HiliteColor":(r,s,a)=>{o(r,{value:a})},BackColor:(r,s,a)=>{o("hilitecolor",{value:a})},FontName:(r,s,a)=>{((i,l)=>{const c=yk(i,l);i.formatter.toggle("fontname",{value:MB(c)}),i.nodeChanged()})(n,a)},FontSize:(r,s,a)=>{((i,l)=>{i.formatter.toggle("fontsize",{value:yk(i,l)}),i.nodeChanged()})(n,a)},LineHeight:(r,s,a)=>{((i,l)=>{i.formatter.toggle("lineheight",{value:String(l)}),i.nodeChanged()})(n,a)},Lang:(r,s,a)=>{var i;o(r,{value:a.code,customValue:(i=a.customCode)!==null&&i!==void 0?i:null})},RemoveFormat:r=>{n.formatter.remove(r)},mceBlockQuote:()=>{o("blockquote")},FormatBlock:(r,s,a)=>{o(Q(a)?a:"p")},mceToggleFormat:(r,s,a)=>{o(a)}})})(t),(n=>{const o=r=>n.formatter.match(r);n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":r=>o(r),mceBlockQuote:()=>o("blockquote")},"state"),n.editorCommands.addQueryValueHandler("FontName",()=>(r=>Ff(r,s=>DB(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("FontSize",()=>(r=>Ff(r,s=>PB(r.getBody(),s.dom)).getOr(""))(n)),n.editorCommands.addQueryValueHandler("LineHeight",()=>(r=>Ff(r,s=>{const a=R(r.getBody());return Wu(s,l=>bi(l,"line-height"),ne(De,a)).getOrThunk(()=>{const l=parseFloat($n(s,"line-height")),c=parseFloat($n(s,"font-size"));return String(l/c)})}).getOr(""))(n))})(t)})(e),(t=>{t.editorCommands.addCommands({mceRemoveNode:(n,o,r)=>{const s=r??t.selection.getNode();if(s!==t.getBody()){const a=t.selection.getBookmark();t.dom.remove(s,!0),t.selection.moveToBookmark(a)}},mcePrint:()=>{t.getWin().print()},mceFocus:(n,o,r)=>{((s,a)=>{s.removed||(a?gu(s):(i=>{const l=i.selection,c=i.getBody();let d=l.getRng();i.quirks.refreshContentEditable(),q(i.bookmark)&&!pr(i)&&cu(i).each(m=>{i.selection.setRng(m),d=m});const u=((m,p)=>m.dom.getParent(p,g=>m.dom.getContentEditable(g)==="true"))(i,l.getNode());if(u&&i.dom.isChildOf(u,c))return fu(u),gv(i,d),void gu(i);i.inline||(Be.browser.isOpera()||fu(c),i.getWin().focus()),(Be.browser.isFirefox()||i.inline)&&(fu(c),gv(i,d)),gu(i)})(s))})(t,r===!0)},mceToggleVisualAid:()=>{t.hasVisual=!t.hasVisual,t.addVisual()}})})(e)},FB=["toggleview"],wk=e=>Ue(FB,e.toLowerCase());class Ek{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,o,r){const s=this.editor,a=t.toLowerCase(),i=r==null?void 0:r.skip_focus;if(s.removed||(a!=="mcefocus"&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)||i?(c=>{cu(c).each(d=>c.selection.setRng(d))})(s):s.focus()),s.dispatch("BeforeExecCommand",{command:t,ui:n,value:o}).isDefaultPrevented()))return!1;const l=this.commands.exec[a];return!!Ie(l)&&(l(a,n,o),s.dispatch("ExecCommand",{command:t,ui:n,value:o}),!0)}queryCommandState(t){if(!wk(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),o=this.commands.state[n];return!!Ie(o)&&o(n)}queryCommandValue(t){if(!wk(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),o=this.commands.value[n];return Ie(o)?o(n):""}addCommands(t,n="exec"){const o=this.commands;Ke(t,(r,s)=>{U(s.toLowerCase().split(","),a=>{o[n][a]=r})})}addCommand(t,n,o){const r=t.toLowerCase();this.commands.exec[r]=(s,a,i)=>n.call(o??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,o){this.commands.state[t.toLowerCase()]=()=>n.call(o??this.editor)}addQueryValueHandler(t,n,o){this.commands.value[t.toLowerCase()]=()=>n.call(o??this.editor)}}const kr="data-mce-contenteditable",Uf=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},oc=(e,t)=>{e.dom.contentEditable=t?"true":"false"},xr=e=>e.readonly,kk=e=>{e.parser.addAttributeFilter("contenteditable",t=>{xr(e)&&U(t,n=>{n.attr(kr,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(kr,t=>{xr(e)&&U(t,n=>{n.attr("contenteditable",n.attr(kr))})}),e.serializer.addTempAttr(kr)},UB=["copy"],zB=$.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class zf{static isNative(t){return!!zB[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Qe}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const o=t.toLowerCase(),r=sd(o,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(r);const s=this.bindings[o];if(s)for(let a=0,i=s.length;a<i;a++){const l=s[a];if(!l.removed){if(l.once&&this.off(o,l.func),r.isImmediatePropagationStopped())return r;if(l.func.call(this.scope,r)===!1)return r.preventDefault(),r}}return r}on(t,n,o,r){if(n===!1&&(n=Qe),n){const s={func:n,removed:!1};r&&$.extend(s,r);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),c=o?[s,...c]:[...c,s],this.bindings[l]=c}}return this}off(t,n){if(t){const o=t.toLowerCase().split(" ");let r=o.length;for(;r--;){const s=o[r];let a=this.bindings[s];if(!s)return Ke(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(n){const i=Tr(a,l=>l.func===n);a=i.fail,this.bindings[s]=a,U(i.pass,l=>{l.removed=!0})}else a.length=0;a.length||(this.toggleEvent(t,!1),delete this.bindings[s])}}}else Ke(this.bindings,(o,r)=>{this.toggleEvent(r,!1)}),this.bindings={};return this}once(t,n,o){return this.on(t,n,o,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const ti=e=>(e._eventDispatcher||(e._eventDispatcher=new zf({scope:e,toggleEvent:(t,n)=>{zf.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),jf={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const o=this;if(o.removed&&e!=="remove"&&e!=="detach")return sd(e.toLowerCase(),t??{},o);const r=ti(o).dispatch(e,t);if(n!==!1&&o.parent){let s=o.parent();for(;s&&!r.isPropagationStopped();)s.dispatch(e,r,!1),s=s.parent?s.parent():void 0}return r},on(e,t,n){return ti(this).on(e,t,n)},off(e,t){return ti(this).off(e,t)},once(e,t){return ti(this).once(e,t)},hasEventListeners(e){return ti(this).has(e)}},rc=Ve.DOM;let _r;const sc=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=Dh(e);return n?(e.eventRoot||(e.eventRoot=rc.select(n)[0]),e.eventRoot):e.getBody()},xk=(e,t,n)=>{(o=>!o.hidden&&!xr(o))(e)?e.dispatch(t,n):xr(e)&&((o,r)=>{if((s=>s.type==="click")(r)&&!ee.metaKeyPressed(r)){const s=R(r.target);((a,i)=>zr(i,"a",l=>De(l,R(a.getBody()))).bind(l=>ao(l,"href")))(o,s).each(a=>{if(r.preventDefault(),/^#/.test(a)){const i=o.dom.select(`${a},[name="${fg(a,"#")}"]`);i.length&&o.selection.scrollIntoView(i[0],!0)}else window.open(a,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else(s=>Ue(UB,s.type))(r)&&o.dispatch(r.type,r)})(e,n)},_k=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=sc(e,t);if(Dh(e)){if(_r||(_r={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||_r&&(Ke(_r,(r,s)=>{e.dom.unbind(sc(e,s))}),_r=null)})),_r[t])return;const o=r=>{const s=r.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===s||rc.isChildOf(s,l))&&xk(a[i],t,r)}};_r[t]=o,rc.bind(n,t,o)}else{const o=r=>{xk(e,t,r)};rc.bind(n,t,o),e.delegates[t]=o}},Sk={...jf,bindPendingEventDelegates(){const e=this;$.each(e._pendingNativeEvents,t=>{_k(e,t)})},toggleNativeEvent(e,t){const n=this;e!=="focus"&&e!=="blur"&&(n.removed||(t?n.initialized?_k(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(sc(n,e),e,n.delegates[e]),delete n.delegates[e])))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Ke(e.delegates,(o,r)=>{e.dom.unbind(sc(e,r),r,o)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},jB=e=>Q(e)?{value:e.split(/[ ,]/),valid:!0}:Ar(e,Q)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},Nk=(e,t)=>e+(Ms(t.message)?"":`. ${t.message}`),Rk=e=>e.valid,Hf=(e,t,n="")=>{const o=t(e);return Kt(o)?o?{value:e,valid:!0}:{valid:!1,message:n}:o},HB=["design","readonly"],Ak=(e,t,n,o)=>{const r=n[t.get()],s=n[o];try{s.activate()}catch(a){return void console.error(`problem while activating editor mode ${o}:`,a)}r.deactivate(),r.editorReadOnly!==s.editorReadOnly&&((a,i)=>{const l=R(a.getBody());((c,d,u)=>{Rc(c,d)&&!u?Us(c,d):u&&Mr(c,d)})(l,"mce-content-readonly",i),i?(a.selection.controlSelection.hideResizeRect(),a._selectionOverrides.hideFakeCaret(),(c=>{C.from(c.selection.getNode()).each(d=>{d.removeAttribute("data-mce-selected")})})(a),a.readonly=!0,oc(l,!1),U(Bt(l,'*[contenteditable="true"]'),c=>{_t(c,kr,"true"),oc(c,!1)})):(a.readonly=!1,a.hasEditableRoot()&&oc(l,!0),U(Bt(l,`*[${kr}="true"]`),c=>{St(c,kr),oc(c,!0)}),Uf(a,"StyleWithCSS",!1),Uf(a,"enableInlineTableEditing",!1),Uf(a,"enableObjectResizing",!1),pv(a)&&a.focus(),(c=>{c.selection.setRng(c.selection.getRng())})(a),a.nodeChanged())})(e,s.editorReadOnly),t.set(o),((a,i)=>{a.dispatch("SwitchMode",{mode:i})})(e,o)},$f=$.each,Vf=$.explode,$B={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Tk=$.makeMap("alt,ctrl,shift,meta,access"),VB=e=>{const t={},n=Be.os.isMacOS()||Be.os.isiOS();$f(Vf(e.toLowerCase(),"+"),s=>{(a=>a in Tk)(s)?t[s]=!0:/^[0-9]{2,}$/.test(s)?t.keyCode=parseInt(s,10):(t.charCode=s.charCodeAt(0),t.keyCode=$B[s]||s.toUpperCase().charCodeAt(0))});const o=[t.keyCode];let r;for(r in Tk)t[r]?o.push(r):t[r]=!1;return t.id=o.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class Ok{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",o=>{!n.hasModifier(o)&&!n.isFunctionKey(o)||o.isDefaultPrevented()||($f(n.shortcuts,r=>{n.matchShortcut(o,r)&&(n.pendingPatterns=r.subpatterns.slice(0),o.type==="keydown"&&n.executeShortcutAction(r))}),n.matchShortcut(o,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&o.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,o,r){const s=this,a=s.normalizeCommandFunc(o);return $f(Vf($.trim(t)),i=>{const l=s.createShortcut(i,n,a,r);s.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return!!this.shortcuts[n.id]&&(delete this.shortcuts[n.id],!0)}normalizeCommandFunc(t){const n=this,o=t;return typeof o=="string"?()=>{n.editor.execCommand(o,!1,null)}:$.isArray(o)?()=>{n.editor.execCommand(o[0],o[1],o[2])}:o}createShortcut(t,n,o,r){const s=$.map(Vf(t,">"),VB);return s[s.length-1]=$.extend(s[s.length-1],{func:o,scope:r||this.editor}),$.extend(s[0],{desc:this.editor.translate(n),subpatterns:s.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!!n&&n.ctrl===t.ctrlKey&&n.meta===t.metaKey&&n.alt===t.altKey&&n.shift===t.shiftKey&&!!(t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode)&&(t.preventDefault(),!0)}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const qB=()=>{const e=(()=>{const t={},n={},o={},r={},s={},a={},i={},l={},c=(d,u)=>(m,p)=>{d[m.toLowerCase()]={...p,type:u}};return{addButton:c(t,"button"),addGroupToolbarButton:c(t,"grouptoolbarbutton"),addToggleButton:c(t,"togglebutton"),addMenuButton:c(t,"menubutton"),addSplitButton:c(t,"splitbutton"),addMenuItem:c(n,"menuitem"),addNestedMenuItem:c(n,"nestedmenuitem"),addToggleMenuItem:c(n,"togglemenuitem"),addAutocompleter:c(o,"autocompleter"),addContextMenu:c(s,"contextmenu"),addContextToolbar:c(a,"contexttoolbar"),addContextForm:c(a,"contextform"),addSidebar:c(i,"sidebar"),addView:c(l,"views"),addIcon:(d,u)=>r[d.toLowerCase()]=u,getAll:()=>({buttons:t,menuItems:n,icons:r,popups:o,contextMenus:s,contextToolbars:a,sidebars:i,views:l})}})();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},Sr=Ve.DOM,Bk=$.extend,WB=$.each;class ac{constructor(t,n,o){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=o,this.documentBaseUrl=o.documentBaseURL,Bk(this,Sk);const r=this;this.id=t,this.hidden=!1;const s=((p,g)=>RB(bk||xB,bk,g,p,g))(o.defaultOptions,n);this.options=((p,g)=>{const h={},f={},b=(y,w,E)=>{const k=Hf(w,E);return Rk(k)?(f[y]=k.value,!0):(console.warn(Nk(`Invalid value passed for the ${y} option`,k)),!1)},v=y=>ke(h,y);return{register:(y,w)=>{const E=(S=>Q(S.processor))(w)?(S=>{const _=(()=>{switch(S){case"array":return He;case"boolean":return Kt;case"function":return Ie;case"number":return Sn;case"object":return We;case"string":return Q;case"string[]":return jB;case"object[]":return T=>Ar(T,We);case"regexp":return T=>je(T,RegExp);default:return dt}})();return T=>Hf(T,_,`The value must be a ${S}.`)})(w.processor):w.processor,k=((S,_,T)=>{if(!st(_)){const P=Hf(_,T);if(Rk(P))return P.value;console.error(Nk(`Invalid default value passed for the "${S}" option`,P))}})(y,w.default,E);h[y]={...w,default:k,processor:E},Xe(f,y).orThunk(()=>Xe(g,y)).each(S=>b(y,S,E))},isRegistered:v,get:y=>Xe(f,y).orThunk(()=>Xe(h,y).map(w=>w.default)).getOrUndefined(),set:(y,w)=>{if(v(y)){const E=h[y];return E.immutable?(console.error(`"${y}" is an immutable option and cannot be updated`),!1):b(y,w,E.processor)}return console.warn(`"${y}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:y=>{const w=v(y);return w&&delete f[y],w},isSet:y=>ke(f,y)}})(0,s),(p=>{const g=p.options.register;g("id",{processor:"string",default:p.id}),g("selector",{processor:"string"}),g("target",{processor:"object"}),g("suffix",{processor:"string"}),g("cache_suffix",{processor:"string"}),g("base_url",{processor:"string"}),g("referrer_policy",{processor:"string",default:""}),g("language_load",{processor:"boolean",default:!0}),g("inline",{processor:"boolean",default:!1}),g("iframe_attrs",{processor:"object",default:{}}),g("doctype",{processor:"string",default:"<!DOCTYPE html>"}),g("document_base_url",{processor:"string",default:p.documentBaseUrl}),g("body_id",{processor:xh(p,"tinymce"),default:"tinymce"}),g("body_class",{processor:xh(p),default:""}),g("content_security_policy",{processor:"string",default:""}),g("br_in_pre",{processor:"boolean",default:!0}),g("forced_root_block",{processor:h=>{const f=Q(h)&&Un(h);return f?{value:h,valid:f}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),g("forced_root_block_attrs",{processor:"object",default:{}}),g("newline_behavior",{processor:h=>{const f=Ue(["block","linebreak","invert","default"],h);return f?{value:h,valid:f}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),g("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),g("no_newline_selector",{processor:"string",default:""}),g("keep_styles",{processor:"boolean",default:!0}),g("end_container_on_empty_block",{processor:h=>Kt(h)||Q(h)?{valid:!0,value:h}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),g("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),g("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),g("font_size_classes",{processor:"string",default:""}),g("automatic_uploads",{processor:"boolean",default:!0}),g("images_reuse_filename",{processor:"boolean",default:!1}),g("images_replace_blob_uris",{processor:"boolean",default:!0}),g("icons",{processor:"string",default:""}),g("icons_url",{processor:"string",default:""}),g("images_upload_url",{processor:"string",default:""}),g("images_upload_base_path",{processor:"string",default:""}),g("images_upload_credentials",{processor:"boolean",default:!1}),g("images_upload_handler",{processor:"function"}),g("language",{processor:"string",default:"en"}),g("language_url",{processor:"string",default:""}),g("entity_encoding",{processor:"string",default:"named"}),g("indent",{processor:"boolean",default:!0}),g("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),g("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),g("indent_use_margin",{processor:"boolean",default:!1}),g("indentation",{processor:"string",default:"40px"}),g("content_css",{processor:h=>{const f=h===!1||Q(h)||Ar(h,Q);return f?Q(h)?{value:Te(h.split(","),Pr),valid:f}:He(h)?{value:h,valid:f}:h===!1?{value:[],valid:f}:{value:h,valid:f}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Ad(p)?[]:["default"]}),g("content_style",{processor:"string"}),g("content_css_cors",{processor:"boolean",default:!1}),g("font_css",{processor:h=>{const f=Q(h)||Ar(h,Q);return f?{value:He(h)?h:Te(h.split(","),Pr),valid:f}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),g("inline_boundaries",{processor:"boolean",default:!0}),g("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),g("object_resizing",{processor:h=>{const f=Kt(h)||Q(h);return f?h===!1||Sd.isiPhone()||Sd.isiPad()?{value:"",valid:f}:{value:h===!0?"table,img,figure.image,div,video,iframe":h,valid:f}:{valid:!1,message:"Must be boolean or a string"}},default:!j_}),g("resize_img_proportional",{processor:"boolean",default:!0}),g("event_root",{processor:"string"}),g("service_message",{processor:"string"}),g("theme",{processor:h=>h===!1||Q(h)||Ie(h),default:"silver"}),g("theme_url",{processor:"string"}),g("formats",{processor:"object"}),g("format_empty_lines",{processor:"boolean",default:!1}),g("format_noneditable_selector",{processor:"string",default:""}),g("preview_styles",{processor:h=>{const f=h===!1||Q(h);return f?{value:h===!1?"":h,valid:f}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),g("custom_ui_selector",{processor:"string",default:""}),g("hidden_input",{processor:"boolean",default:!0}),g("submit_patch",{processor:"boolean",default:!0}),g("encoding",{processor:"string"}),g("add_form_submit_trigger",{processor:"boolean",default:!0}),g("add_unload_trigger",{processor:"boolean",default:!0}),g("custom_undo_redo_levels",{processor:"number",default:0}),g("disable_nodechange",{processor:"boolean",default:!1}),g("readonly",{processor:"boolean",default:!1}),g("editable_root",{processor:"boolean",default:!0}),g("plugins",{processor:"string[]",default:[]}),g("external_plugins",{processor:"object"}),g("forced_plugins",{processor:"string[]"}),g("model",{processor:"string",default:p.hasPlugin("rtc")?"plugin":"dom"}),g("model_url",{processor:"string"}),g("block_unsupported_drop",{processor:"boolean",default:!0}),g("visual",{processor:"boolean",default:!0}),g("visual_table_class",{processor:"string",default:"mce-item-table"}),g("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),g("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),g("setup",{processor:"function"}),g("init_instance_callback",{processor:"function"}),g("url_converter",{processor:"function",default:p.convertURL}),g("url_converter_scope",{processor:"object",default:p}),g("urlconverter_callback",{processor:"function"}),g("allow_conditional_comments",{processor:"boolean",default:!1}),g("allow_html_data_urls",{processor:"boolean",default:!1}),g("allow_svg_data_urls",{processor:"boolean"}),g("allow_html_in_named_anchor",{processor:"boolean",default:!1}),g("allow_script_urls",{processor:"boolean",default:!1}),g("allow_unsafe_link_target",{processor:"boolean",default:!1}),g("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),g("fix_list_elements",{processor:"boolean",default:!1}),g("preserve_cdata",{processor:"boolean",default:!1}),g("remove_trailing_brs",{processor:"boolean",default:!0}),g("pad_empty_with_br",{processor:"boolean",default:!1}),g("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),g("element_format",{processor:"string",default:"html"}),g("entities",{processor:"string"}),g("schema",{processor:"string",default:"html5"}),g("convert_urls",{processor:"boolean",default:!0}),g("relative_urls",{processor:"boolean",default:!0}),g("remove_script_host",{processor:"boolean",default:!0}),g("custom_elements",{processor:Fi}),g("extended_valid_elements",{processor:"string"}),g("invalid_elements",{processor:"string"}),g("invalid_styles",{processor:Fi}),g("valid_children",{processor:"string"}),g("valid_classes",{processor:Fi}),g("valid_elements",{processor:"string"}),g("valid_styles",{processor:Fi}),g("verify_html",{processor:"boolean",default:!0}),g("auto_focus",{processor:h=>Q(h)||h===!0}),g("browser_spellcheck",{processor:"boolean",default:!1}),g("protect",{processor:"array"}),g("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),g("deprecation_warnings",{processor:"boolean",default:!0}),g("a11y_advanced_options",{processor:"boolean",default:!1}),g("api_key",{processor:"string"}),g("license_key",{processor:"string"}),g("paste_block_drop",{processor:"boolean",default:!1}),g("paste_data_images",{processor:"boolean",default:!0}),g("paste_preprocess",{processor:"function"}),g("paste_postprocess",{processor:"function"}),g("paste_webkit_styles",{processor:"string",default:"none"}),g("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),g("paste_merge_formats",{processor:"boolean",default:!0}),g("smart_paste",{processor:"boolean",default:!0}),g("paste_as_text",{processor:"boolean",default:!1}),g("paste_tab_spaces",{processor:"number",default:4}),g("text_patterns",{processor:h=>Ar(h,We)||h===!1?{value:Eh(h===!1?[]:h),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1",trigger:"space"},{start:"##",format:"h2",trigger:"space"},{start:"###",format:"h3",trigger:"space"},{start:"####",format:"h4",trigger:"space"},{start:"#####",format:"h5",trigger:"space"},{start:"######",format:"h6",trigger:"space"},{start:"1.",cmd:"InsertOrderedList",trigger:"space"},{start:"*",cmd:"InsertUnorderedList",trigger:"space"},{start:"-",cmd:"InsertUnorderedList",trigger:"space"},{start:">",cmd:"mceBlockQuote",trigger:"space"},{start:"---",cmd:"InsertHorizontalRule",trigger:"space"}]}),g("text_patterns_lookup",{processor:h=>{return Ie(h)?{value:(f=h,b=>{const v=f(b);return Eh(v)}),valid:!0}:{valid:!1,message:"Must be a single function"};var f},default:h=>[]}),g("noneditable_class",{processor:"string",default:"mceNonEditable"}),g("editable_class",{processor:"string",default:"mceEditable"}),g("noneditable_regexp",{processor:h=>Ar(h,kh)?{value:h,valid:!0}:kh(h)?{value:[h],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),g("table_tab_navigation",{processor:"boolean",default:!0}),g("highlight_on_focus",{processor:"boolean",default:!0}),g("xss_sanitization",{processor:"boolean",default:!0}),g("details_initial_state",{processor:h=>{const f=Ue(["inherited","collapsed","expanded"],h);return f?{value:h,valid:f}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),g("details_serialized_state",{processor:h=>{const f=Ue(["inherited","collapsed","expanded"],h);return f?{value:h,valid:f}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),g("init_content_sync",{processor:"boolean",default:!1}),g("newdocument_content",{processor:"string",default:""}),g("sandbox_iframes",{processor:"boolean",default:!0}),g("sandbox_iframes_exclusions",{processor:"string[]",default:["youtube.com","youtu.be","vimeo.com","player.vimeo.com","dailymotion.com","embed.music.apple.com","open.spotify.com","giphy.com","dai.ly","codepen.io"]}),g("convert_unsafe_embeds",{processor:"boolean",default:!0}),p.on("ScriptsLoaded",()=>{g("directionality",{processor:"string",default:On.isRtl()?"rtl":void 0}),g("placeholder",{processor:"string",default:H_.getAttrib(p.getElement(),"placeholder")})})})(r);const a=this.options.get;a("deprecation_warnings")&&((p,g)=>{((h,f)=>{const b=NA(h),v=AA(f),y=v.length>0,w=b.length>0,E=f.theme==="mobile";if(y||w||E){const k=`
- `,S=E?`

Themes:${k}mobile`:"",_=y?`

Plugins:${k}${v.join(k)}`:"",T=w?`

Options:${k}${b.join(k)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 7.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/7/migration-from-6x/ for more information."+S+_+T)}})(p,g),((h,f)=>{const b=RA(h),v=TA(f),y=v.length>0,w=b.length>0;if(y||w){const E=`
- `,k=y?`

Plugins:${E}${v.map(OA).join(E)}`:"",S=w?`

Options:${E}${b.join(E)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+k+S)}})(p,g)})(n,s);const i=a("suffix");i&&(o.suffix=i),this.suffix=o.suffix;const l=a("base_url");l&&o._setBaseUrl(l),this.baseUri=o.baseURI;const c=Nd(r);c&&(go.ScriptLoader._setReferrerPolicy(c),Ve.DOM.styleSheetLoader._setReferrerPolicy(c));const d=Mh(r);q(d)&&Ve.DOM.styleSheetLoader._setContentCssCors(d),It.languageLoad=a("language_load"),It.baseURL=o.baseURL,this.setDirty(!1),this.documentBaseURI=new kn(_h(r),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Ad(r),this.hasVisual=OS(r),this.shortcuts=new Ok(this),this.editorCommands=new Ek(this),IB(this);const u=a("cache_suffix");u&&(Be.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:qB(),styleSheetLoader:void 0,show:Ne,hide:Ne,setEnabled:Ne,isEnabled:dt},this.mode=(p=>{const g=wt("design"),h=wt({design:{activate:Ne,deactivate:Ne,editorReadOnly:!1},readonly:{activate:Ne,deactivate:Ne,editorReadOnly:!0}});return(f=>{f.serializer?kk(f):f.on("PreInit",()=>{kk(f)})})(p),(f=>{f.on("ShowCaret",b=>{xr(f)&&b.preventDefault()}),f.on("ObjectSelected",b=>{xr(f)&&b.preventDefault()})})(p),{isReadOnly:()=>xr(p),set:f=>((b,v,y,w)=>{if(w!==y.get()){if(!ke(v,w))throw new Error(`Editor mode '${w}' is invalid`);b.initialized?Ak(b,y,v,w):b.on("init",()=>Ak(b,y,v,w))}})(p,h.get(),g,f),get:()=>g.get(),register:(f,b)=>{h.set(((v,y,w)=>{if(Ue(HB,y))throw new Error(`Cannot override default mode ${y}`);return{...v,[y]:{...w,deactivate:()=>{try{w.deactivate()}catch(E){console.error(`problem while deactivating editor mode ${y}:`,E)}}}}})(h.get(),f,b))}}})(r),o.dispatch("SetupEditor",{editor:this});const m=DS(r);Ie(m)&&m.call(r,r)}render(){(t=>{const n=t.id;On.setCode(Th(t));const o=()=>{Er.unbind(window,"ready",o),t.render()};if(!nr.Event.domLoaded)return void Er.bind(window,"ready",o);if(!t.getElement())return;const r=R(t.getElement()),s=xg(r);t.on("remove",()=>{ng(r.dom.attributes,i=>St(r,i.name)),so(r,s)}),t.ui.styleSheetLoader=((i,l)=>mp.forElement(i,{contentCssCors:Mh(l),referrerPolicy:Nd(l)}))(r,t),Ad(t)?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");const a=t.getElement().form||Er.getParent(n,"form");a&&(t.formElement=a,ES(t)&&!zc(t.getElement())&&(Er.insertAfter(Er.create("input",{type:"hidden",name:n}),n),t.hasHiddenInput=!0),t.formEventDelegate=i=>{t.dispatch(i.type,i)},Er.bind(a,"submit reset",t.formEventDelegate),t.on("reset",()=>{t.resetContent()}),!kS(t)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(t.editorManager.triggerSave(),t.setDirty(!1),a._mceOldSubmit(a)))),t.windowManager=hC(t),t.notificationManager=pC(t),(i=>i.options.get("encoding")==="xml")(t)&&t.on("GetContent",i=>{i.save&&(i.content=Er.encode(i.content))}),xS(t)&&t.on("submit",()=>{t.initialized&&t.save()}),_S(t)&&(t._beforeUnload=()=>{!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),kB(t,t.suffix)})(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return pr(this)}translate(t){return On.translate(t)}getParam(t,n,o){const r=this.options;return r.isRegistered(t)||(q(o)?r.register(t,{processor:o,default:n}):r.register(t,{processor:dt,default:n})),r.isSet(t)||st(n)?r.get(t):n}hasPlugin(t,n){return!(!Ue(Ui(this),t)||n&&ds.get(t)===void 0)}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,o){this.editorCommands.addCommand(t,n,o)}addQueryStateHandler(t,n,o){this.editorCommands.addQueryStateHandler(t,n,o)}addQueryValueHandler(t,n,o){this.editorCommands.addQueryValueHandler(t,n,o)}addShortcut(t,n,o,r){this.shortcuts.add(t,n,o,r)}execCommand(t,n,o,r){return this.editorCommands.execCommand(t,n,o,r)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(Sr.show(t.getContainer()),Sr.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(Sr.hide(t.getContainer()),Sr.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,o=n.getElement();if(n.removed)return"";if(o){const r={...t,load:!0},s=zc(o)?o.value:o.innerHTML,a=n.setContent(s,r);return r.no_events||n.dispatch("LoadContent",{...r,element:o}),a}return""}save(t={}){const n=this;let o=n.getElement();if(!o||!n.initialized||n.removed)return"";const r={...t,save:!0,element:o};let s=n.getContent(r);const a={...r,content:s};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),s=a.content,zc(o))o.value=s;else{!t.is_removing&&n.inline||(o.innerHTML=s);const i=Sr.getParent(n.id,"form");i&&WB(i.elements,l=>l.name!==n.id||(l.value=s,!1))}return a.element=r.element=o=null,a.set_dirty!==!1&&n.setDirty(!1),s}setContent(t,n){return Em(this,t,n)}getContent(t){return((n,o={})=>{const r=((s,a)=>({...s,format:a,get:!0,getInner:!0}))(o,o.format?o.format:"html");return Vy(n,r).fold(jt,s=>{const a=((i,l)=>wm(i).editor.getContent(l))(n,s);return qy(n,a,s)})})(this,t)}insertContent(t,n){n&&(t=Bk({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Em(this,this.startContent,{format:"raw"}):Em(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||Sr.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=Sr.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const o=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:o==null?void 0:o.body)!==null&&n!==void 0?n:null}convertURL(t,n,o){const r=this,s=r.options.get,a=MS(r);if(Ie(a))return a.call(r,t,o,!0,n);if(!s("convert_urls")||o==="link"||We(o)&&o.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0)return t;const i=new kn(t);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?t:s("relative_urls")?r.documentBaseURI.toRelative(t):t=r.documentBaseURI.toAbsolute(t,s("remove_script_host"))}addVisual(t){((n,o)=>{((r,s)=>{mt(r).editor.addVisual(s)})(n,o)})(this,t)}setEditableRoot(t){((n,o)=>{n._editableRoot!==o&&(n._editableRoot=o,n.readonly||(n.getBody().contentEditable=String(n.hasEditableRoot()),n.nodeChanged()),((r,s)=>{r.dispatch("EditableRootStateChange",{state:s})})(n,o))})(this,t)}hasEditableRoot(){return this._editableRoot}remove(){(t=>{if(!t.removed){const{_selectionOverrides:n,editorUpload:o}=t,r=t.getBody(),s=t.getElement();r&&t.save({is_removing:!0}),t.removed=!0,t.unbindAllNativeEvents(),t.hasHiddenInput&&q(s==null?void 0:s.nextSibling)&&wl.remove(s.nextSibling),(a=>{a.dispatch("remove")})(t),t.editorManager.remove(t),!t.inline&&r&&(a=>{wl.setStyle(a.id,"display",a.orgDisplay)})(t),(a=>{a.dispatch("detach")})(t),wl.remove(t.getContainer()),El(n),El(o),t.destroy()}})(this)}destroy(t){((n,o)=>{const{selection:r,dom:s}=n;n.destroyed||(o||n.removed?(o||(n.editorManager.off("beforeunload",n._beforeUnload),n.theme&&n.theme.destroy&&n.theme.destroy(),El(r),El(s)),(a=>{const i=a.formElement;i&&(i._mceOldSubmit&&(i.submit=i._mceOldSubmit,delete i._mceOldSubmit),wl.unbind(i,"submit reset",a.formEventDelegate))})(n),(a=>{const i=a;i.contentAreaContainer=i.formElement=i.container=i.editorContainer=null,i.bodyElement=i.contentDocument=i.contentWindow=null,i.iframeElement=i.targetElm=null;const l=a.selection;if(l){const c=l.dom;i.selection=l.win=l.dom=c.doc=null}})(n),n.destroyed=!0):n.remove())})(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const ys=Ve.DOM,ic=$.each;let lc,Pk=!1,qt=[];const cc=e=>{const t=e.type;ic(jo.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e)}})},Dk=e=>{if(e!==Pk){const t=Ve.DOM;e?(t.bind(window,"resize",cc),t.bind(window,"scroll",cc)):(t.unbind(window,"resize",cc),t.unbind(window,"scroll",cc)),Pk=e}},Lk=e=>{const t=qt;return qt=ye(qt,n=>e!==n),jo.activeEditor===e&&(jo.activeEditor=qt.length>0?qt[0]:null),jo.focusedEditor===e&&(jo.focusedEditor=null),t.length!==qt.length},KB=document.compatMode!=="CSS1Compat",jo={...jf,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"7",minorVersion:"0.0",releaseDate:"2024-03-20",i18n:On,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",o=kn.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(o)&&(o=o.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(o)||(o+="/"));const r=window.tinymce||window.tinyMCEPreInit;if(r)t=r.base||r.baseURL,n=r.suffix;else{const a=document.getElementsByTagName("script");for(let i=0;i<a.length;i++){const l=a[i].src||"";if(l==="")continue;const c=l.substring(l.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(l)){c.indexOf(".min")!==-1&&(n=".min"),t=l.substring(0,l.lastIndexOf("/"));break}}if(!t&&document.currentScript){const i=document.currentScript.src;i.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"))}}var s;e.baseURL=new kn(o).toAbsolute(t),e.documentBaseURL=o,e.baseURI=new kn(e.baseURL),e.suffix=n,(s=e).on("AddEditor",ne(YN,s)),s.on("RemoveEditor",ne(GN,s))},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const o=e.plugin_base_urls;o!==void 0&&Ke(o,(r,s)=>{It.PluginManager.urls[s]=r})},init(e){const t=this;let n;const o=$.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");let r=a=>{n=a};const s=()=>{let a=0;const i=[];let l;ys.unbind(window,"ready",s),(c=>{const d=e.onpageload;d&&d.apply(t,[])})(),l=sg((c=>Be.browser.isIE()||Be.browser.isEdge()?(_l("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):KB?(_l("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):Q(c.selector)?ys.select(c.selector):q(c.target)?[c.target]:[])(e)),$.each(l,c=>{var d;(d=t.get(c.id))&&d.initialized&&!(d.getContainer()||d.getBody()).parentNode&&(Lk(d),d.unbindAllNativeEvents(),d.destroy(!0),d.removed=!0)}),l=$.grep(l,c=>!t.get(c.id)),l.length===0?r([]):ic(l,c=>{((d,u)=>d.inline&&u.tagName.toLowerCase()in o)(e,c)?_l("Could not initialize inline editor on invalid inline target element",c):((d,u,m)=>{const p=new ac(d,u,t);i.push(p),p.on("init",()=>{++a===l.length&&r(i)}),p.targetElm=p.targetElm||m,p.render()})((d=>{let u=d.id;return u||(u=Xe(d,"name").filter(m=>!ys.get(m)).getOrThunk(ys.uniqueId),d.setAttribute("id",u)),u})(c),e,c)})};return ys.bind(window,"ready",s),new Promise(a=>{n?a(n):r=i=>{a(i)}})},get(e){return arguments.length===0?qt.slice(0):Q(e)?pt(qt,t=>t.id===e).getOr(null):Sn(e)&&qt[e]?qt[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&qt.push(e),Dk(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),lc||(lc=o=>{const r=t.dispatch("BeforeUnload");if(r.returnValue)return o.preventDefault(),o.returnValue=r.returnValue,r.returnValue},window.addEventListener("beforeunload",lc))),e},createEditor(e,t){return this.add(new ac(e,t,this))},remove(e){const t=this;let n;if(e){if(!Q(e))return n=e,ct(t.get(n.id))?null:(Lk(n)&&t.dispatch("RemoveEditor",{editor:n}),qt.length===0&&window.removeEventListener("beforeunload",lc),n.remove(),Dk(qt.length>0),n);ic(ys.select(e),o=>{n=t.get(o.id),n&&t.remove(n)})}else for(let o=qt.length-1;o>=0;o--)t.remove(qt[o])},execCommand(e,t,n){var o;const r=this,s=We(n)?(o=n.id)!==null&&o!==void 0?o:n.index:n;switch(e){case"mceAddEditor":if(!r.get(s)){const a=n.options;new ac(s,a,r).render()}return!0;case"mceRemoveEditor":{const a=r.get(s);return a&&a.remove(),!0}case"mceToggleEditor":{const a=r.get(s);return a?(a.isHidden()?a.show():a.hide(),!0):(r.execCommand("mceAddEditor",!1,n),!0)}}return!!r.activeEditor&&r.activeEditor.execCommand(e,t,n)},triggerSave:()=>{ic(qt,e=>{e.save()})},addI18n:(e,t)=>{On.add(e,t)},translate:e=>On.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new kn(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new kn(this.baseURL)}};jo.setup();const YB=(()=>{const e=Ro();return{FakeClipboardItem:t=>({items:t,types:Gt(t),getType:n=>Xe(t,n).getOrUndefined()}),write:t=>{e.set(t)},read:()=>e.get().getOrUndefined(),clear:e.clear}})(),Mk=Math.min,Cs=Math.max,dc=Math.round,Ik=(e,t,n)=>{let o=t.x,r=t.y;const s=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(r+=l),c[1]==="r"&&(o+=i),c[0]==="c"&&(r+=dc(l/2)),c[1]==="c"&&(o+=dc(i/2)),c[3]==="b"&&(r-=a),c[4]==="r"&&(o-=s),c[3]==="c"&&(r-=dc(a/2)),c[4]==="c"&&(o-=dc(s/2)),ws(o,r,s,a)},ws=(e,t,n,o)=>({x:e,y:t,w:n,h:o}),GB={inflate:(e,t,n)=>ws(e.x-t,e.y-n,e.w+2*t,e.h+2*n),relativePosition:Ik,findBestRelativePosition:(e,t,n,o)=>{for(let r=0;r<o.length;r++){const s=Ik(e,t,o[r]);if(s.x>=n.x&&s.x+s.w<=n.w+n.x&&s.y>=n.y&&s.y+s.h<=n.h+n.y)return o[r]}return null},intersect:(e,t)=>{const n=Cs(e.x,t.x),o=Cs(e.y,t.y),r=Mk(e.x+e.w,t.x+t.w),s=Mk(e.y+e.h,t.y+t.h);return r-n<0||s-o<0?null:ws(n,o,r-n,s-o)},clamp:(e,t,n)=>{let o=e.x,r=e.y,s=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=Cs(0,t.x-o),d=Cs(0,t.y-r),u=Cs(0,s-i),m=Cs(0,a-l);return o+=c,r+=d,n&&(s+=c,a+=d,o-=u,r-=m),s-=u,a-=m,ws(o,r,s-o,a-r)},create:ws,fromClientRect:e=>ws(e.left,e.top,e.width,e.height)},XB=(()=>{const e={},t={},n={};return{load:(o,r)=>{const s=`Script at URL "${r}" failed to load`,a=`Script at URL "${r}" did not call \`tinymce.Resource.add('${o}', data)\` within 1 second`;if(e[o]!==void 0)return e[o];{const i=new Promise((l,c)=>{const d=((u,m,p=1e3)=>{let g=!1,h=null;const f=y=>(...w)=>{g||(g=!0,h!==null&&(clearTimeout(h),h=null),y.apply(null,w))},b=f(u),v=f(m);return{start:(...y)=>{g||h!==null||(h=setTimeout(()=>v.apply(null,y),p))},resolve:b,reject:v}})(l,c);t[o]=d.resolve,go.ScriptLoader.loadScript(r).then(()=>d.start(a),()=>d.reject(s))});return e[o]=i,i}},add:(o,r)=>{t[o]!==void 0&&(t[o](r),delete t[o]),e[o]=Promise.resolve(r),n[o]=r},has:o=>o in n,get:o=>n[o],unload:o=>{delete e[o],delete n[o]}}})();let ni;try{const e="__storage_test__";ni=window.localStorage,ni.setItem(e,e),ni.removeItem(e)}catch{ni=(()=>{let t={},n=[];const o={getItem:r=>t[r]||null,setItem:(r,s)=>{n.push(r),t[r]=String(s)},key:r=>n[r],removeItem:r=>{n=n.filter(s=>s===r),delete t[r]},clear:()=>{n=[],t={}},length:0};return Object.defineProperty(o,"length",{get:()=>n.length,configurable:!1,enumerable:!1}),o})()}const ZB={geom:{Rect:GB},util:{Delay:gn,Tools:$,VK:ee,URI:kn,EventDispatcher:zf,Observable:jf,I18n:On,LocalStorage:ni,ImageUploader:e=>{const t=yC(),n=wC(e,t);return{upload:(o,r=!0)=>n.upload(o,r?CC(e):void 0)}}},dom:{EventUtils:nr,TreeWalker:yt,TextSeeker:sr,DOMUtils:Ve,ScriptLoader:go,RangeUtils:gr,Serializer:cC,StyleSheetLoader:up,ControlSelection:Vb,BookmarkManager:Ea,Selection:lC,Event:nr.Event},html:{Styles:rd,Entities:So,Node:Ft,Schema:No,DomParser:ls,Writer:Ov,Serializer:Lo},Env:Be,AddOnManager:It,Annotator:Lb,Formatter:xC,UndoManager:SC,EditorCommands:Ek,WindowManager:hC,NotificationManager:pC,EditorObservable:Sk,Shortcuts:Ok,Editor:ac,FocusManager:fv,EditorManager:jo,DOM:Ve.DOM,ScriptLoader:go.ScriptLoader,PluginManager:ds,ThemeManager:Cr,ModelManager:cs,IconManager:kl,Resource:XB,FakeClipboard:YB,trim:$.trim,isArray:$.isArray,is:$.is,toArray:$.toArray,makeMap:$.makeMap,each:$.each,map:$.map,grep:$.grep,inArray:$.inArray,extend:$.extend,walk:$.walk,resolve:$.resolve,explode:$.explode,_addCacheSuffix:$._addCacheSuffix},Fk=$.extend(jo,ZB);(e=>{window.tinymce=e,window.tinyMCE=e})(Fk),(e=>{if(typeof module=="object")try{module.exports=e}catch{}})(Fk)})();const fP={super:{width:1e3,height:500,skin_url:"/plugins/supercode/skins/oxide",skin:"oxide",promotion:!1,statusbar:!1,menubar:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","supercode"],toolbar:"undo redo | blocks | bold italic forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | codeeditor | supercode",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},classic:{width:1e3,height:500,skin:"oxide",promotion:!1,statusbar:!1,menubar:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","code"],toolbar:"undo redo | blocks | bold italic forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | codeeditor | code",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}};function lx({mode:me,value:ce}){const ge=ri.useRef(null),be=fP[me];return Kf.createElement(Kf.Fragment,null,Kf.createElement(mP,{onInit:(ve,_e)=>ge.current=_e,initialValue:ce??"<h1>Hello World</h1><p>This is the initial content of the editor.</p>",init:be}))}lx.__docgenInfo={description:"",methods:[],displayName:"TinymceEditor"};const bP={title:"Supercode/TinymceEditor",component:lx,parameters:{layout:"centered"},tags:["autodocs"]},fc={args:{mode:"classic",value:"<h1>Classic Code Plugin</h1><p>This editor is using the classic code plugin that ships with TinyMCE.</p>"}},gc={args:{mode:"super",value:"<h1>New Supercode Plugin</h1><p>This editor is using the supercode plugin which provides more powerful Source Code Editing. Use the code icon or Ctrl+Space to toggle between Editing Modes.</p>"}};var ex,tx,nx;fc.parameters={...fc.parameters,docs:{...(ex=fc.parameters)==null?void 0:ex.docs,source:{originalSource:`{
  args: {
    mode: 'classic',
    value: '<h1>Classic Code Plugin</h1><p>This editor is using the classic code plugin that ships with TinyMCE.</p>'
  }
}`,...(nx=(tx=fc.parameters)==null?void 0:tx.docs)==null?void 0:nx.source}}};var ox,rx,sx;gc.parameters={...gc.parameters,docs:{...(ox=gc.parameters)==null?void 0:ox.docs,source:{originalSource:`{
  args: {
    mode: 'super',
    value: '<h1>New Supercode Plugin</h1><p>This editor is using the supercode plugin which provides more powerful Source Code Editing. Use the code icon or Ctrl+Space to toggle between Editing Modes.</p>'
  }
}`,...(sx=(rx=gc.parameters)==null?void 0:rx.docs)==null?void 0:sx.source}}};const vP=["ClassicPlugin","SupercodePlugin"];export{fc as ClassicPlugin,gc as SupercodePlugin,vP as __namedExportsOrder,bP as default};
