import{r as kl}from"./index-BBkUAzwr.js";import{p as W}from"./index-_4_hgnnR.js";var cp=function(){return cp=Object.assign||function(se){for(var oe,ae=1,ue=arguments.length;ae<ue;ae++){oe=arguments[ae];for(var ce in oe)Object.prototype.hasOwnProperty.call(oe,ce)&&(se[ce]=oe[ce])}return se},cp.apply(this,arguments)},F_={onActivate:W.func,onAddUndo:W.func,onBeforeAddUndo:W.func,onBeforeExecCommand:W.func,onBeforeGetContent:W.func,onBeforeRenderUI:W.func,onBeforeSetContent:W.func,onBeforePaste:W.func,onBlur:W.func,onChange:W.func,onClearUndos:W.func,onClick:W.func,onContextMenu:W.func,onCommentChange:W.func,onCompositionEnd:W.func,onCompositionStart:W.func,onCompositionUpdate:W.func,onCopy:W.func,onCut:W.func,onDblclick:W.func,onDeactivate:W.func,onDirty:W.func,onDrag:W.func,onDragDrop:W.func,onDragEnd:W.func,onDragGesture:W.func,onDragOver:W.func,onDrop:W.func,onExecCommand:W.func,onFocus:W.func,onFocusIn:W.func,onFocusOut:W.func,onGetContent:W.func,onHide:W.func,onInit:W.func,onInput:W.func,onKeyDown:W.func,onKeyPress:W.func,onKeyUp:W.func,onLoadContent:W.func,onMouseDown:W.func,onMouseEnter:W.func,onMouseLeave:W.func,onMouseMove:W.func,onMouseOut:W.func,onMouseOver:W.func,onMouseUp:W.func,onNodeChange:W.func,onObjectResizeStart:W.func,onObjectResized:W.func,onObjectSelected:W.func,onPaste:W.func,onPostProcess:W.func,onPostRender:W.func,onPreProcess:W.func,onProgressState:W.func,onRedo:W.func,onRemove:W.func,onReset:W.func,onSaveContent:W.func,onSelectionChange:W.func,onSetAttrib:W.func,onSetContent:W.func,onShow:W.func,onSubmit:W.func,onUndo:W.func,onVisualAid:W.func,onSkinLoadError:W.func,onThemeLoadError:W.func,onModelLoadError:W.func,onPluginLoadError:W.func,onIconsLoadError:W.func,onLanguageLoadError:W.func,onScriptsLoad:W.func,onScriptsLoadError:W.func},C9=cp({apiKey:W.string,licenseKey:W.string,id:W.string,inline:W.bool,init:W.object,initialValue:W.string,onEditorChange:W.func,value:W.string,tagName:W.string,cloudChannel:W.string,plugins:W.oneOfType([W.string,W.array]),toolbar:W.oneOfType([W.string,W.array]),disabled:W.bool,textareaName:W.string,tinymceScriptSrc:W.oneOfType([W.string,W.arrayOf(W.string),W.arrayOf(W.shape({src:W.string,async:W.bool,defer:W.bool}))]),rollback:W.oneOfType([W.number,W.oneOf([!1])]),scriptLoading:W.shape({async:W.bool,defer:W.bool,delay:W.number})},F_),ap=function(se){return typeof se=="function"},D_=function(se){return se in F_},O_=function(se){return se.substr(2)},v9=function(se,oe,ae,ue,ce,ve,L){var ge=Object.keys(ce).filter(D_),xe=Object.keys(ve).filter(D_),$e=ge.filter(function(Me){return ve[Me]===void 0}),Ge=xe.filter(function(Me){return ce[Me]===void 0});$e.forEach(function(Me){var st=O_(Me),en=L[st];ae(st,en),delete L[st]}),Ge.forEach(function(Me){var st=ue(se,Me),en=O_(Me);L[en]=st,oe(en,st)})},y9=function(se,oe,ae,ue,ce){return v9(ce,se.on.bind(se),se.off.bind(se),function(ve,L){return function(ge){var xe;return(xe=ve(L))===null||xe===void 0?void 0:xe(ge,se)}},oe,ae,ue)},B_=0,M_=function(se){var oe=Date.now(),ae=Math.floor(Math.random()*1e9);return B_++,se+"_"+ae+B_+String(oe)},I_=function(se){return se!==null&&(se.tagName.toLowerCase()==="textarea"||se.tagName.toLowerCase()==="input")},L_=function(se){return typeof se>"u"||se===""?[]:Array.isArray(se)?se:se.split(" ")},E9=function(se,oe){return L_(se).concat(L_(oe))},S9=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},w9=function(se){if(!("isConnected"in Node.prototype)){for(var oe=se,ae=se.parentNode;ae!=null;)oe=ae,ae=oe.parentNode;return oe===se.ownerDocument}return se.isConnected},$_=function(se,oe){se!==void 0&&(se.mode!=null&&typeof se.mode=="object"&&typeof se.mode.set=="function"?se.mode.set(oe):se.setMode(oe))},lp=function(){return lp=Object.assign||function(se){for(var oe,ae=1,ue=arguments.length;ae<ue;ae++){oe=arguments[ae];for(var ce in oe)Object.prototype.hasOwnProperty.call(oe,ce)&&(se[ce]=oe[ce])}return se},lp.apply(this,arguments)},k9=function(se,oe,ae){var ue,ce,ve=se.createElement("script");ve.referrerPolicy="origin",ve.type="application/javascript",ve.id=oe.id,ve.src=oe.src,ve.async=(ue=oe.async)!==null&&ue!==void 0?ue:!1,ve.defer=(ce=oe.defer)!==null&&ce!==void 0?ce:!1;var L=function(){ve.removeEventListener("load",L),ve.removeEventListener("error",ge),ae(oe.src)},ge=function(xe){ve.removeEventListener("load",L),ve.removeEventListener("error",ge),ae(oe.src,xe)};ve.addEventListener("load",L),ve.addEventListener("error",ge),se.head&&se.head.appendChild(ve)},_9=function(se){var oe={},ae=function(L,ge){var xe=oe[L];xe.done=!0,xe.error=ge;for(var $e=0,Ge=xe.handlers;$e<Ge.length;$e++){var Me=Ge[$e];Me(L,ge)}xe.handlers=[]},ue=function(L,ge,xe){var $e=function(ee){return xe!==void 0?xe(ee):console.error(ee)};if(L.length===0){$e(new Error("At least one script must be provided"));return}for(var Ge=0,Me=!1,st=function(ee,at){Me||(at?(Me=!0,$e(at)):++Ge===L.length&&ge())},en=0,Nt=L;en<Nt.length;en++){var tn=Nt[en],In=oe[tn.src];if(In)In.done?st(tn.src,In.error):In.handlers.push(st);else{var Ln=M_("tiny-");oe[tn.src]={id:Ln,src:tn.src,done:!1,error:null,handlers:[st]},k9(se,lp({id:Ln},tn),ae)}}},ce=function(){for(var L,ge=0,xe=Object.values(oe);ge<xe.length;ge++){var $e=xe[ge],Ge=se.getElementById($e.id);Ge!=null&&Ge.tagName==="SCRIPT"&&((L=Ge.parentNode)===null||L===void 0||L.removeChild(Ge))}oe={}},ve=function(){return se};return{loadScripts:ue,deleteScripts:ce,getDocument:ve}},x9=function(){var se=[],oe=function(ce){var ve=se.find(function(L){return L.getDocument()===ce});return ve===void 0&&(ve=_9(ce),se.push(ve)),ve},ae=function(ce,ve,L,ge,xe){var $e=function(){return oe(ce).loadScripts(ve,ge,xe)};L>0?setTimeout($e,L):$e()},ue=function(){for(var ce=se.pop();ce!=null;ce=se.pop())ce.deleteScripts()};return{loadList:ae,reinitialize:ue}},N9=x9(),ip=function(se){var oe=se;return oe&&oe.tinymce?oe.tinymce:null},A9=function(){var se=function(oe,ae){return se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ue,ce){ue.__proto__=ce}||function(ue,ce){for(var ve in ce)Object.prototype.hasOwnProperty.call(ce,ve)&&(ue[ve]=ce[ve])},se(oe,ae)};return function(oe,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");se(oe,ae);function ue(){this.constructor=oe}oe.prototype=ae===null?Object.create(ae):(ue.prototype=ae.prototype,new ue)}}(),Dr=function(){return Dr=Object.assign||function(se){for(var oe,ae=1,ue=arguments.length;ae<ue;ae++){oe=arguments[ae];for(var ce in oe)Object.prototype.hasOwnProperty.call(oe,ce)&&(se[ce]=oe[ce])}return se},Dr.apply(this,arguments)},yK=function(se){A9(oe,se);function oe(ae){var ue,ce,ve,L=se.call(this,ae)||this;return L.rollbackTimer=void 0,L.valueCursor=void 0,L.rollbackChange=function(){var ge=L.editor,xe=L.props.value;ge&&xe&&xe!==L.currentContent&&ge.undoManager.ignore(function(){if(ge.setContent(xe),L.valueCursor&&(!L.inline||ge.hasFocus()))try{ge.selection.moveToBookmark(L.valueCursor)}catch{}}),L.rollbackTimer=void 0},L.handleBeforeInput=function(ge){if(L.props.value!==void 0&&L.props.value===L.currentContent&&L.editor&&(!L.inline||L.editor.hasFocus()))try{L.valueCursor=L.editor.selection.getBookmark(3)}catch{}},L.handleBeforeInputSpecial=function(ge){(ge.key==="Enter"||ge.key==="Backspace"||ge.key==="Delete")&&L.handleBeforeInput(ge)},L.handleEditorChange=function(ge){var xe=L.editor;if(xe&&xe.initialized){var $e=xe.getContent();L.props.value!==void 0&&L.props.value!==$e&&L.props.rollback!==!1&&(L.rollbackTimer||(L.rollbackTimer=window.setTimeout(L.rollbackChange,typeof L.props.rollback=="number"?L.props.rollback:200))),$e!==L.currentContent&&(L.currentContent=$e,ap(L.props.onEditorChange)&&L.props.onEditorChange($e,xe))}},L.handleEditorChangeSpecial=function(ge){(ge.key==="Backspace"||ge.key==="Delete")&&L.handleEditorChange(ge)},L.initialise=function(ge){var xe,$e,Ge;ge===void 0&&(ge=0);var Me=L.elementRef.current;if(Me){if(!w9(Me)){if(ge===0)setTimeout(function(){return L.initialise(1)},1);else if(ge<100)setTimeout(function(){return L.initialise(ge+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var st=ip(L.view);if(!st)throw new Error("tinymce should have been loaded into global scope");var en=Dr(Dr(Dr(Dr({},L.props.init),{selector:void 0,target:Me,readonly:L.props.disabled,inline:L.inline,plugins:E9((xe=L.props.init)===null||xe===void 0?void 0:xe.plugins,L.props.plugins),toolbar:($e=L.props.toolbar)!==null&&$e!==void 0?$e:(Ge=L.props.init)===null||Ge===void 0?void 0:Ge.toolbar}),L.props.licenseKey?{license_key:L.props.licenseKey}:{}),{setup:function(Nt){L.editor=Nt,L.bindHandlers({}),L.inline&&!I_(Me)&&Nt.once("PostRender",function(tn){Nt.setContent(L.getInitialValue(),{no_events:!0})}),L.props.init&&ap(L.props.init.setup)&&L.props.init.setup(Nt)},init_instance_callback:function(Nt){var tn,In,Ln=L.getInitialValue();L.currentContent=(tn=L.currentContent)!==null&&tn!==void 0?tn:Nt.getContent(),L.currentContent!==Ln&&(L.currentContent=Ln,Nt.setContent(Ln),Nt.undoManager.clear(),Nt.undoManager.add(),Nt.setDirty(!1));var ee=(In=L.props.disabled)!==null&&In!==void 0?In:!1;$_(L.editor,ee?"readonly":"design"),L.props.init&&ap(L.props.init.init_instance_callback)&&L.props.init.init_instance_callback(Nt)}});L.inline||(Me.style.visibility=""),I_(Me)&&(Me.value=L.getInitialValue()),st.init(en)}},L.id=L.props.id||M_("tiny-react"),L.elementRef=kl.createRef(),L.inline=(ve=(ue=L.props.inline)!==null&&ue!==void 0?ue:(ce=L.props.init)===null||ce===void 0?void 0:ce.inline)!==null&&ve!==void 0?ve:!1,L.boundHandlers={},L}return Object.defineProperty(oe.prototype,"view",{get:function(){var ae,ue;return(ue=(ae=this.elementRef.current)===null||ae===void 0?void 0:ae.ownerDocument.defaultView)!==null&&ue!==void 0?ue:window},enumerable:!1,configurable:!0}),oe.prototype.componentDidUpdate=function(ae){var ue=this,ce,ve;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(ae),this.editor.initialized)){if(this.currentContent=(ce=this.currentContent)!==null&&ce!==void 0?ce:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==ae.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var L=this.editor;L.undoManager.transact(function(){var xe;if(!ue.inline||L.hasFocus())try{xe=L.selection.getBookmark(3)}catch{}var $e=ue.valueCursor;if(L.setContent(ue.props.value),!ue.inline||L.hasFocus())for(var Ge=0,Me=[xe,$e];Ge<Me.length;Ge++){var st=Me[Ge];if(st)try{L.selection.moveToBookmark(st),ue.valueCursor=st;break}catch{}}})}if(this.props.disabled!==ae.disabled){var ge=(ve=this.props.disabled)!==null&&ve!==void 0?ve:!1;$_(this.editor,ge?"readonly":"design")}}},oe.prototype.componentDidMount=function(){var ae=this,ue,ce,ve,L,ge;if(ip(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(ce=(ue=this.props).onScriptsLoadError)===null||ce===void 0||ce.call(ue,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((ve=this.elementRef.current)===null||ve===void 0)&&ve.ownerDocument){var xe=function(){var Ge,Me;(Me=(Ge=ae.props).onScriptsLoad)===null||Me===void 0||Me.call(Ge),ae.initialise()},$e=function(Ge){var Me,st;(st=(Me=ae.props).onScriptsLoadError)===null||st===void 0||st.call(Me,Ge)};N9.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(ge=(L=this.props.scriptLoading)===null||L===void 0?void 0:L.delay)!==null&&ge!==void 0?ge:0,xe,$e)}},oe.prototype.componentWillUnmount=function(){var ae=this,ue=this.editor;ue&&(ue.off(this.changeEvents(),this.handleEditorChange),ue.off(this.beforeInputEvent(),this.handleBeforeInput),ue.off("keypress",this.handleEditorChangeSpecial),ue.off("keydown",this.handleBeforeInputSpecial),ue.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(ce){ue.off(ce,ae.boundHandlers[ce])}),this.boundHandlers={},ue.remove(),this.editor=void 0)},oe.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},oe.prototype.changeEvents=function(){var ae,ue,ce,ve=(ce=(ue=(ae=ip(this.view))===null||ae===void 0?void 0:ae.Env)===null||ue===void 0?void 0:ue.browser)===null||ce===void 0?void 0:ce.isIE();return ve?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},oe.prototype.beforeInputEvent=function(){return S9()?"beforeinput SelectionChange":"SelectionChange"},oe.prototype.renderInline=function(){var ae=this.props.tagName,ue=ae===void 0?"div":ae;return kl.createElement(ue,{ref:this.elementRef,id:this.id})},oe.prototype.renderIframe=function(){return kl.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},oe.prototype.getScriptSources=function(){var ae,ue,ce=(ae=this.props.scriptLoading)===null||ae===void 0?void 0:ae.async,ve=(ue=this.props.scriptLoading)===null||ue===void 0?void 0:ue.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:ce,defer:ve}]:this.props.tinymceScriptSrc.map(function($e){return typeof $e=="string"?{src:$e,async:ce,defer:ve}:$e});var L=this.props.cloudChannel,ge=this.props.apiKey?this.props.apiKey:"no-api-key",xe="https://cdn.tiny.cloud/1/".concat(ge,"/tinymce/").concat(L,"/tinymce.min.js");return[{src:xe,async:ce,defer:ve}]},oe.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},oe.prototype.bindHandlers=function(ae){var ue=this;if(this.editor!==void 0){y9(this.editor,ae,this.props,this.boundHandlers,function(ge){return ue.props[ge]});var ce=function(ge){return ge.onEditorChange!==void 0||ge.value!==void 0},ve=ce(ae),L=ce(this.props);!ve&&L?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):ve&&!L&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},oe.propTypes=C9,oe.defaultProps={cloudChannel:"7"},oe}(kl.Component);(function(){var se=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},oe=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},ae=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},ue=function(e,t){return ce(function(n,s){return e.eq(t(n),t(s))})},ce=function(e){return{eq:e}},ve=ce(function(e,t){return e===t}),L=ve,ge=function(e){return ce(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},xe=function(e,t){return ue(ge(e),function(n){return ae(n,t)})},$e=function(e){return ce(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!xe(L).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},Ge=ce(function(e,t){if(e===t)return!0;var n=se(e),s=se(t);return n!==s?!1:oe(n)?e===t:n==="array"?ge(Ge).eq(e,t):n==="object"?$e(Ge).eq(e,t):!1});const Me=Object.getPrototypeOf,st=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},en=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&st(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},Nt=e=>t=>en(t)===e,tn=e=>t=>typeof t===e,In=e=>t=>e===t,Ln=(e,t)=>at(e)&&st(e,t,(n,s)=>Me(n)===s),ee=Nt("string"),at=Nt("object"),_l=e=>Ln(e,Object),tt=Nt("array"),zt=In(null),Ps=tn("boolean"),Et=In(void 0),it=e=>e==null,V=e=>!it(e),Be=tn("function"),$n=tn("number"),Mo=(e,t)=>{if(tt(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},he=()=>{},Xn=(e,t)=>(...n)=>e(t.apply(null,n)),up=(e,t)=>n=>e(t(n)),j=e=>()=>e,Ht=e=>e,fp=(e,t)=>e===t;function G(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const Or=e=>t=>!e(t),dp=e=>()=>{throw new Error(e)},xl=e=>e(),Br=e=>{e()},qe=j(!1),ot=j(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return V(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const Nl=Array.prototype.slice,U_=Array.prototype.indexOf,z_=Array.prototype.push,mp=(e,t)=>U_.call(e,t),H_=(e,t)=>{const n=mp(e,t);return n===-1?m.none():m.some(n)},Ie=(e,t)=>mp(e,t)>-1,Je=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},ke=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},T=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},pp=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},Uo=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},le=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},Ir=(e,t,n)=>(pp(e,(s,o)=>{n=t(n,s,o)}),n),Kt=(e,t,n)=>(T(e,(s,o)=>{n=t(n,s,o)}),n),gp=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},ft=(e,t)=>gp(e,t,qe),Lr=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return m.some(n)}return m.none()},hp=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!tt(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);z_.apply(t,e[n])}return t},ln=(e,t)=>hp(ke(e,t)),Ds=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},$r=e=>{const t=Nl.call(e,0);return t.reverse(),t},fi=(e,t)=>le(e,n=>!Ie(t,n)),Al=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},eo=(e,t)=>{const n=Nl.call(e,0);return n.sort(t),n},Fr=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),Vt=e=>Fr(e,0),Os=e=>Fr(e,e.length-1),nn=Be(Array.from)?Array.from:e=>Nl.call(e),zo=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return m.none()},bp=(e,t)=>{const n=[],s=Be(t)?o=>Je(n,r=>t(r,o)):o=>Ie(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},Gt=Object.keys,V_=Object.hasOwnProperty,Ue=(e,t)=>{const n=Gt(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},Mr=(e,t)=>W_(e,(n,s)=>({k:s,v:t(n,s)})),W_=(e,t)=>{const n={};return Ue(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},Rl=e=>(t,n)=>{e[n]=t},Cp=(e,t,n,s)=>{Ue(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},j_=(e,t)=>{const n={},s={};return Cp(e,t,Rl(n),Rl(s)),{t:n,f:s}},Ur=(e,t)=>{const n={};return Cp(e,t,Rl(n),he),n},di=(e,t)=>{const n=[];return Ue(e,(s,o)=>{n.push(t(s,o))}),n},Tl=e=>di(e,Ht),We=(e,t)=>de(e,t)?m.from(e[t]):m.none(),de=(e,t)=>V_.call(e,t),Ho=(e,t)=>de(e,t)&&e[t]!==void 0&&e[t]!==null,q_=(e,t,n=Ge)=>$e(n).eq(e,t),vp=e=>{const t={};return T(e,n=>{t[n]={}}),Gt(t)},yp=e=>e.length!==void 0,Pl=Array.isArray,K_=e=>{if(Pl(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},mi=(e,t,n)=>{if(!e)return!1;if(n=n||e,yp(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(const s in e)if(de(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},Dl=(e,t)=>{const n=[];return mi(e,(s,o)=>{n.push(t(s,o,e))}),n},zr=(e,t)=>{const n=[];return mi(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},G_=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},pi=(e,t,n,s)=>{let o=Et(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},Ep=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},to=e=>e[e.length-1],Zn=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},Y_=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),c=o||!r&&a&&s("(min-device-width:768px)"),l=r||a&&!c,u=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,f=!l&&!c&&!u;return{isiPad:j(o),isiPhone:j(r),isTablet:j(c),isPhone:j(l),isTouch:j(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:j(u),isDesktop:j(f)}},X_=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},Z_=(e,t)=>{const n=X_(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return Ol(s(1),s(2))},Q_=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Sp():Z_(e,n)},Sp=()=>Ol(0,0),Ol=(e,t)=>({major:e,minor:t}),Hr={nu:Ol,detect:Q_,unknown:Sp},J_=(e,t)=>zo(t.brands,n=>{const s=n.brand.toLowerCase();return ft(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:Hr.nu(parseInt(n.version,10),0)}))}),wp=(e,t)=>{const n=String(t).toLowerCase();return ft(e,s=>s.search(n))},ex=(e,t)=>wp(e,t).map(n=>{const s=Hr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),tx=(e,t)=>wp(e,t).map(n=>{const s=Hr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),nx=(e,t)=>e.substring(t),kp=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,_p=(e,t)=>dt(e,t)?nx(e,t.length):e,At=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1?Et(s)?!0:o+t.length<=s:!1},dt=(e,t)=>kp(e,t,0),Bl=(e,t)=>kp(e,t,e.length-t.length),Il=e=>t=>t.replace(e,""),Vo=Il(/^\s+|\s+$/g),sx=Il(/^\s+/g),xp=Il(/\s+$/g),Qn=e=>e.length>0,Vr=e=>!Qn(e),ox=(e,t)=>t<=0?"":new Array(t+1).join(e),gi=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},Ll=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,gs=e=>t=>At(t,e),rx=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>At(e,"edge/")&&At(e,"chrome")&&At(e,"safari")&&At(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ll],search:e=>At(e,"chrome")&&!At(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>At(e,"msie")||At(e,"trident")},{name:"Opera",versionRegexes:[Ll,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:gs("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:gs("firefox")},{name:"Safari",versionRegexes:[Ll,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(At(e,"safari")||At(e,"mobile/"))&&At(e,"applewebkit")}],ax=[{name:"Windows",search:gs("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>At(e,"iphone")||At(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:gs("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:gs("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:gs("linux"),versionRegexes:[]},{name:"Solaris",search:gs("sunos"),versionRegexes:[]},{name:"FreeBSD",search:gs("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:gs("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Np={browsers:j(rx),oses:j(ax)},Ap="Edge",Rp="Chromium",Tp="IE",Pp="Opera",Dp="Firefox",Op="Safari",ix=()=>Bp({current:void 0,version:Hr.unknown()}),Bp=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(Ap),isChromium:s(Rp),isIE:s(Tp),isOpera:s(Pp),isFirefox:s(Dp),isSafari:s(Op)}},Ip={unknown:ix,nu:Bp,edge:j(Ap),chromium:j(Rp),ie:j(Tp),opera:j(Pp),firefox:j(Dp),safari:j(Op)},Lp="Windows",$p="iOS",Fp="Android",Mp="Linux",Up="macOS",zp="Solaris",Hp="FreeBSD",Vp="ChromeOS",cx=()=>Wp({current:void 0,version:Hr.unknown()}),Wp=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(Lp),isiOS:s($p),isAndroid:s(Fp),isMacOS:s(Up),isLinux:s(Mp),isSolaris:s(zp),isFreeBSD:s(Hp),isChromeOS:s(Vp)}},jp={unknown:cx,nu:Wp,windows:j(Lp),ios:j($p),android:j(Fp),linux:j(Mp),macos:j(Up),solaris:j(zp),freebsd:j(Hp),chromeos:j(Vp)},lx={detect:(e,t,n)=>{const s=Np.browsers(),o=Np.oses(),r=t.bind(c=>J_(s,c)).orThunk(()=>ex(s,e)).fold(Ip.unknown,Ip.nu),a=tx(o,e).fold(jp.unknown,jp.nu),i=Y_(a,r,e,n);return{browser:r,os:a,deviceType:i}}},ux=e=>window.matchMedia(e).matches;let fx=Zn(()=>lx.detect(navigator.userAgent,m.from(navigator.userAgentData),ux));const Jn=()=>fx(),dx=navigator.userAgent,$l=Jn(),es=$l.browser,ts=$l.os,no=$l.deviceType,mx=dx.indexOf("Windows Phone")!==-1,Ne={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:es.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!es.isIE(),windowsPhone:mx,browser:{current:es.current,version:es.version,isChromium:es.isChromium,isEdge:es.isEdge,isFirefox:es.isFirefox,isIE:es.isIE,isOpera:es.isOpera,isSafari:es.isSafari},os:{current:ts.current,version:ts.version,isAndroid:ts.isAndroid,isChromeOS:ts.isChromeOS,isFreeBSD:ts.isFreeBSD,isiOS:ts.isiOS,isLinux:ts.isLinux,isMacOS:ts.isMacOS,isSolaris:ts.isSolaris,isWindows:ts.isWindows},deviceType:{isDesktop:no.isDesktop,isiPad:no.isiPad,isiPhone:no.isiPhone,isPhone:no.isPhone,isTablet:no.isTablet,isTouch:no.isTouch,isWebView:no.isWebView}},px=/^\s*|\s*$/g,qp=e=>it(e)?"":(""+e).replace(px,""),gx=(e,t)=>t?t==="array"&&Pl(e)?!0:typeof e===t:e!==void 0,hx=(e,t,n={})=>{const s=ee(e)?e.split(t||","):e||[];let o=s.length;for(;o--;)n[s[o]]={};return n},bx=de,Cx=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(de(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},Kp=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),mi(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(Kp(o,t,n,s),!0)))},$={trim:qp,isArray:Pl,is:gx,toArray:K_,makeMap:hx,each:mi,map:Dl,grep:zr,inArray:G_,hasOwn:bx,extend:Cx,walk:Kp,resolve:(e,t=window)=>{const n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>tt(e)?e:e===""?[]:Dl(e.split(t||","),qp),_addCacheSuffix:e=>{const t=Ne.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},Wo=(e,t,n=fp)=>e.exists(s=>n(s,t)),Gp=(e,t,n=fp)=>Rt(e,t,n).getOr(e.isNone()&&t.isNone()),vx=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},Rt=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),yx=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),jo=(e,t)=>e?m.some(t):m.none(),Ex=typeof window<"u"?window:Function("return this;")(),Sx=(e,t)=>{let n=t??Ex;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},Yp=(e,t)=>{const n=e.split(".");return Sx(n,t)},wx=(e,t)=>Yp(e,t),kx=(e,t)=>{const n=wx(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},_x=Object.getPrototypeOf,xx=e=>kx("HTMLElement",e),Nx=e=>{const t=Yp("ownerDocument.defaultView",e);return at(e)&&(xx(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(_x(e).constructor.name))},Xp=8,Zp=9,Qp=11,Wr=1,Jp=3,_e=e=>e.dom.nodeName.toLowerCase(),eg=e=>e.dom.nodeType,hi=e=>t=>eg(t)===e,Ax=e=>eg(e)===Xp||_e(e)==="#comment",bi=e=>sn(e)&&Nx(e.dom),sn=hi(Wr),un=hi(Jp),Rx=hi(Zp),Tx=hi(Qp),Ci=e=>t=>sn(t)&&_e(t)===e,tg=(e,t,n)=>{if(ee(n)||Ps(n)||$n(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},St=(e,t,n)=>{tg(e.dom,t,n)},hs=(e,t)=>{const n=e.dom;Ue(t,(s,o)=>{tg(n,o,s)})},on=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},bs=(e,t)=>m.from(on(e,t)),jr=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},wt=(e,t)=>{e.dom.removeAttribute(t)},Px=e=>{const t=e.dom.attributes;return t==null||t.length===0},ng=e=>Kt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Fl=(e,t)=>{const n=on(e,t);return n===void 0||n===""?[]:n.split(" ")},Dx=(e,t,n)=>{const o=Fl(e,t).concat([n]);return St(e,t,o.join(" ")),!0},Ox=(e,t,n)=>{const s=le(Fl(e,t),o=>o!==n);return s.length>0?St(e,t,s.join(" ")):wt(e,t),!1},qr=e=>e.dom.classList!==void 0,sg=e=>Fl(e,"class"),og=(e,t)=>Dx(e,"class",t),rg=(e,t)=>Ox(e,"class",t),Bx=(e,t)=>Ie(sg(e),t)?rg(e,t):og(e,t),qo=(e,t)=>{qr(e)?e.dom.classList.add(t):og(e,t)},ag=e=>{(qr(e)?e.dom.classList:sg(e)).length===0&&wt(e,"class")},Kr=(e,t)=>{qr(e)?e.dom.classList.remove(t):rg(e,t),ag(e)},Ix=(e,t)=>{const n=qr(e)?e.dom.classList.toggle(t):Bx(e,t);return ag(e),n},Ml=(e,t)=>qr(e)&&e.dom.classList.contains(t),Lx=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return Gr(s.childNodes[0])},$x=(e,t)=>{const s=(t||document).createElement(e);return Gr(s)},Fx=(e,t)=>{const s=(t||document).createTextNode(e);return Gr(s)},Gr=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:Lx,fromTag:$x,fromText:Fx,fromDom:Gr,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(Gr)},ig=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},Fn=(e,t)=>{const n=e.dom;if(n.nodeType!==Wr)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},cg=e=>e.nodeType!==Wr&&e.nodeType!==Zp&&e.nodeType!==Qp||e.childElementCount===0,Mx=(e,t)=>{const n=t===void 0?document:t.dom;return cg(n)?[]:ke(n.querySelectorAll(e),C.fromDom)},Ux=(e,t)=>{const n=t===void 0?document:t.dom;return cg(n)?m.none():m.from(n.querySelector(e)).map(C.fromDom)},Te=(e,t)=>e.dom===t.dom,Cs=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},lg=e=>C.fromDom(e.dom.ownerDocument),vs=e=>Rx(e)?e:lg(e),zx=e=>C.fromDom(vs(e).dom.documentElement),Yr=e=>C.fromDom(vs(e).dom.defaultView),Mn=e=>m.from(e.dom.parentNode).map(C.fromDom),vi=e=>m.from(e.dom.parentElement).map(C.fromDom),ug=(e,t)=>{const n=Be(t)?t:qe;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=C.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},Hx=e=>{const t=n=>le(n,s=>!Te(e,s));return Mn(e).map(Tt).map(t).getOr([])},so=e=>m.from(e.dom.previousSibling).map(C.fromDom),Xr=e=>m.from(e.dom.nextSibling).map(C.fromDom),fg=e=>$r(ig(e,so)),dg=e=>ig(e,Xr),Tt=e=>ke(e.dom.childNodes,C.fromDom),Ko=(e,t)=>{const n=e.dom.childNodes;return m.from(n[t]).map(C.fromDom)},Ul=e=>Ko(e,0),zl=e=>Ko(e,e.dom.childNodes.length-1),Hl=e=>e.dom.childNodes.length,Vx=e=>e.dom.hasChildNodes(),Wx=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return C.fromDom(t)},Vl=e=>Tx(e)&&V(e.dom.host),mg=Be(Element.prototype.attachShadow)&&Be(Node.prototype.getRootNode),jx=j(mg),Bs=mg?e=>C.fromDom(e.dom.getRootNode()):vs,Wl=e=>Vl(e)?e:Wx(vs(e)),qx=e=>Vl(e)?e:C.fromDom(vs(e).dom.body),Kx=e=>{const t=Bs(e);return Vl(t)?m.some(t):m.none()},Gx=e=>C.fromDom(e.dom.host),pg=e=>{if(jx()&&V(e.target)){const t=C.fromDom(e.target);if(sn(t)&&Yx(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return Vt(n)}}return m.from(e.target)},Yx=e=>V(e.dom.shadowRoot),Go=e=>{const t=un(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Kx(C.fromDom(t)).fold(()=>n.body.contains(t),up(Go,Gx))};var gg=(e,t,n,s,o)=>e(n,s)?m.some(n):Be(o)&&o(n)?m.none():t(n,s,o);const ys=(e,t,n)=>{let s=e.dom;const o=Be(n)?n:qe;for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},oo=(e,t,n)=>gg((o,r)=>r(o),ys,e,t,n),Xx=(e,t)=>{const n=e.dom;return n.parentNode?Zx(C.fromDom(n.parentNode),s=>!Te(e,s)&&t(s)):m.none()},Zx=(e,t)=>{const n=o=>t(C.fromDom(o));return ft(e.dom.childNodes,n).map(C.fromDom)},hg=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=C.fromDom(s.childNodes[o]);if(t(r))return m.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},Zr=(e,t,n)=>ys(e,s=>Fn(s,t),n),yi=(e,t)=>Ux(t,e),Yo=(e,t,n)=>gg((o,r)=>Fn(o,r),Zr,e,t,n),Qx=e=>Yo(e,"[contenteditable]"),ro=(e,t=!1)=>Go(e)?e.dom.isContentEditable:Qx(e).fold(j(t),n=>Jx(n)==="true"),Jx=e=>e.dom.contentEditable,Qr=e=>e.style!==void 0&&Be(e.style.getPropertyValue),bg=(e,t,n)=>{if(!ee(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Qr(e)&&e.style.setProperty(t,n)},eN=(e,t)=>{Qr(e)&&e.style.removeProperty(t)},Cg=(e,t,n)=>{const s=e.dom;bg(s,t,n)},Ei=(e,t)=>{const n=e.dom;Ue(t,(s,o)=>{bg(n,o,s)})},ns=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!Go(e)?vg(n,t):o},vg=(e,t)=>Qr(e)?e.style.getPropertyValue(t):"",Si=(e,t)=>{const n=e.dom,s=vg(n,t);return m.from(s).filter(o=>o.length>0)},jl=e=>{const t={},n=e.dom;if(Qr(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},yg=(e,t)=>{const n=e.dom;eN(n,t),Wo(bs(e,"style").map(Vo),"")&&wt(e,"style")},tN=e=>e.dom.offsetWidth,Yt=(e,t)=>{Mn(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},Es=(e,t)=>{Xr(e).fold(()=>{Mn(e).each(o=>{ct(o,t)})},s=>{Yt(s,t)})},ql=(e,t)=>{Ul(e).fold(()=>{ct(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},ct=(e,t)=>{e.dom.appendChild(t.dom)},Eg=(e,t)=>{Yt(e,t),ct(t,e)},nN=(e,t)=>{T(t,(n,s)=>{const o=s===0?e:t[s-1];Es(o,n)})},ao=(e,t)=>{T(t,n=>{ct(e,n)})},Xo=e=>{e.dom.textContent="",T(Tt(e),t=>{je(t)})},je=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},Is=e=>{const t=Tt(e);t.length>0&&nN(e,t),je(e)},sN=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,Tt(C.fromDom(s))},Kl=e=>ke(e,C.fromDom),Sg=e=>e.dom.innerHTML,wi=(e,t)=>{const s=lg(e).dom,o=C.fromDom(s.createDocumentFragment()),r=sN(t,s);ao(o,r),Xo(e),ct(e,o)},oN=e=>{const t=C.fromTag("div"),n=C.fromDom(e.dom.cloneNode(!0));return ct(t,n),Sg(t)},rN=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),aN=e=>{const t=C.fromDom(pg(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=Xn(s,n);return rN(t,e.clientX,e.clientY,n,s,o,e)},iN=(e,t)=>n=>{e(n)&&t(aN(n))},cN=(e,t,n,s,o)=>{const r=iN(n,s);return e.dom.addEventListener(t,r,o),{unbind:G(uN,e,t,r,o)}},lN=(e,t,n,s)=>cN(e,t,n,s,!1),uN=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},wg=(e,t)=>({left:e,top:t,translate:(s,o)=>wg(e+s,t+o)}),Zo=wg,fN=e=>{const t=e.getBoundingClientRect();return Zo(t.left,t.top)},ki=(e,t)=>e!==void 0?e:t!==void 0?t:0,dN=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Zo(n.offsetLeft,n.offsetTop);const r=ki(s==null?void 0:s.pageYOffset,o.scrollTop),a=ki(s==null?void 0:s.pageXOffset,o.scrollLeft),i=ki(o.clientTop,n.clientTop),c=ki(o.clientLeft,n.clientLeft);return Gl(e).translate(a-c,r-i)},Gl=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?Zo(s.offsetLeft,s.offsetTop):Go(e)?fN(t):Zo(0,0)},Yl=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Zo(n,s)},kg=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},_g=(e,t)=>{Jn().browser.isSafari()&&Be(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},mN=e=>{const t=e===void 0?window:e;return Jn().browser.isFirefox()?m.none():m.from(t.visualViewport)},xg=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),Ng=e=>{const t=e===void 0?window:e,n=t.document,s=Yl(C.fromDom(n));return mN(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return xg(s.left,s.top,r,a)},o=>xg(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))},pN=(e,t)=>le(Tt(e),t),Ag=(e,t)=>{let n=[];return T(Tt(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(Ag(s,t))}),n},Pt=(e,t)=>Mx(t,e),Rg=(e,t,n)=>ys(e,t,n).isSome(),gN=(e,t)=>Xx(e,t).isSome(),Tg=(e,t)=>hg(e,t).isSome();class ht{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){const s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}const o=t.parentNode;if(o&&o!==this.rootNode)return o}}}const Jr="\uFEFF",bt=" ",Xl=e=>e===Jr,hN=e=>e.replace(/\uFEFF/g,""),bN=/^[ \t\r\n]*$/,Qo=e=>bN.test(e),CN=e=>{for(const t of e)if(!Xl(t))return!1;return!0},vN=e=>" \f	\v".indexOf(e)!==-1,Pg=e=>e===`
`||e==="\r",yN=(e,t)=>t<e.length&&t>=0?Pg(e[t]):!1,Dg=(e,t=4,n=!0,s=!0)=>{const o=ox(" ",t),r=e.replace(/\t/g,o);return Kt(r,(i,c)=>vN(c)||c===bt?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||yN(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+bt}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Pg(c),str:i.str+c},{pcIsSpace:!1,str:""}).str},io=e=>t=>!!t&&t.nodeType===e,_i=e=>!!e&&!Object.getPrototypeOf(e),Z=io(1),Ss=e=>Z(e)&&bi(C.fromDom(e)),EN=e=>Z(e)&&e.namespaceURI==="http://www.w3.org/2000/svg",ea=e=>{const t=e.toLowerCase();return n=>V(n)&&n.nodeName.toLowerCase()===t},Un=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return Ie(t,s)}return!1}},xi=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(Z(s)){const o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){const a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},SN=e=>t=>Z(t)&&t.hasAttribute(e),co=e=>Z(e)&&e.hasAttribute("data-mce-bogus"),wN=e=>Z(e)&&e.getAttribute("data-mce-bogus")==="all",ss=e=>Z(e)&&e.tagName==="TABLE",Og=e=>t=>!!(Ss(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),Zl=Un(["textarea","input"]),O=io(3),kN=io(4),_N=io(7),Ls=io(8),ta=io(9),Ql=io(11),Xe=ea("br"),Bg=ea("img"),_n=Og("true"),ze=Og("false"),Ni=Un(["td","th"]),xN=Un(["td","th","caption"]),os=Un(["video","audio","object","embed"]),NN=ea("li"),Jl=ea("details"),AN=ea("summary"),Ig={skipBogus:!0,includeZwsp:!1,checkRootAsContent:!1},RN=(e,t,n)=>{const s=C.fromDom(t),o=C.fromDom(e),r=n.getWhitespaceElements();return Rg(o,i=>de(r,_e(i)),G(Te,s))},TN=e=>Z(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),PN=(e,t)=>Z(e)&&de(t.getNonEmptyElements(),e.nodeName),DN=SN("data-mce-bookmark"),ON=e=>vi(C.fromDom(e)).exists(t=>!ro(t)),BN=(e,t,n)=>Qo(e.data)&&!RN(e,t,n),IN=(e,t,n,s)=>O(e)&&!BN(e,t,n)&&(!s.includeZwsp||!CN(e.data)),eu=(e,t,n,s)=>Be(s.isContent)&&s.isContent(t)||PN(t,e)||DN(t)||TN(t)||IN(t,n,e,s)||ze(t)||_n(t)&&ON(t),ws=(e,t,n)=>{const s={...Ig,...n};if(s.checkRootAsContent&&eu(e,t,t,s))return!1;let o=t.firstChild,r=0;if(!o)return!0;const a=new ht(o,t);do{if(s.skipBogus&&Z(o)){const i=o.getAttribute("data-mce-bogus");if(i){o=a.next(i==="all");continue}}if(Ls(o)){o=a.next(!0);continue}if(Xe(o)){r++,o=a.next();continue}if(eu(e,o,t,s))return!1;o=a.next()}while(o);return r<=1},Dt=(e,t,n)=>ws(e,t.dom,{checkRootAsContent:!0,...n}),Lg=(e,t,n)=>eu(e,t,t,{includeZwsp:Ig.includeZwsp,...n}),lo=e=>e.toLowerCase()==="svg",tu=e=>lo(e.nodeName),$g=e=>(e==null?void 0:e.nodeName)==="svg"?"svg":"html",LN=["svg"],$N=()=>{let e=[];const t=()=>e[e.length-1];return{track:r=>{tu(r)&&e.push(r);let a=t();return a&&!a.contains(r)&&(e.pop(),a=t()),$g(a)},current:()=>$g(t()),reset:()=>{e=[]}}},Ai="data-mce-block",FN=e=>le(Gt(e),t=>!/[A-Z]/.test(t)),nu=e=>ke(FN(e),t=>`${t}:`+ke(LN,n=>`not(${n} ${t})`).join(":")).join(","),Fg=(e,t)=>V(t.querySelector(e))?(t.setAttribute(Ai,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(Ai),!1),Mg=(e,t)=>{const n=nu(e.getTransparentElements()),s=nu(e.getBlockElements());return le(t.querySelectorAll(n),o=>Fg(s,o))},Ug=(e,t,n)=>{var s;const o=n?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(ws(e,r,{checkRootAsContent:!0})){(s=r.parentNode)===null||s===void 0||s.removeChild(r);return}},MN=(e,t,n)=>{const s=document.createRange(),o=t.parentNode;if(o){s.setStartBefore(t),s.setEndBefore(n);const r=s.extractContents();Ug(e,r,!0),s.setStartAfter(n),s.setEndAfter(t);const a=s.extractContents();Ug(e,a,!1),ws(e,r,{checkRootAsContent:!0})||o.insertBefore(r,t),ws(e,n,{checkRootAsContent:!0})||o.insertBefore(n,t),ws(e,a,{checkRootAsContent:!0})||o.insertBefore(a,t),o.removeChild(t)}},UN=(e,t,n)=>{const s=e.getBlockElements(),o=C.fromDom(t),r=i=>_e(i)in s,a=i=>Te(i,o);T(Kl(n),i=>{ys(i,r,a).each(c=>{const l=pN(i,u=>r(u)&&!e.isValidChild(_e(c),_e(u)));if(l.length>0){const u=vi(c);T(l,f=>{ys(f,r,a).each(d=>{MN(e,d.dom,f.dom)})}),u.each(f=>Mg(e,f.dom))}})})},zN=(e,t,n)=>{T([...n,...uo(e,t)?[t]:[]],s=>T(Pt(C.fromDom(s),s.nodeName.toLowerCase()),o=>{WN(e,o.dom)&&Is(o)}))},su=(e,t)=>{const n=Mg(e,t);UN(e,t,n),zN(e,t,n)},HN=(e,t)=>{if(au(e,t)){const n=nu(e.getBlockElements());Fg(n,t)}},VN=(e,t,n)=>{const s=r=>Te(r,C.fromDom(t)),o=ug(C.fromDom(n),s);Fr(o,o.length-2).filter(sn).fold(()=>su(e,t),r=>su(e,r.dom))},ou=e=>e.hasAttribute(Ai),ru=(e,t)=>de(e.getTransparentElements(),t),au=(e,t)=>Z(t)&&ru(e,t.nodeName),uo=(e,t)=>au(e,t)&&ou(t),WN=(e,t)=>au(e,t)&&!ou(t),iu=(e,t)=>t.type===1&&ru(e,t.name)&&ee(t.attr(Ai)),jN=Jn().browser,zg=e=>ft(e,sn),qN=e=>jN.isFirefox()&&_e(e)==="table"?zg(Tt(e)).filter(t=>_e(t)==="caption").bind(t=>zg(dg(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,Hg=(e,t)=>e.children&&Ie(e.children,t),KN=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&ns(C.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!Hg(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!Hg(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=qN(C.fromDom(t))}return{x:s,y:o}},Vg=(e,t={})=>{let n=0;const s={},o=C.fromDom(e),r=vs(o),a=v=>{t.referrerPolicy=v},i=v=>{t.contentCssCors=v},c=v=>{ct(Wl(o),v)},l=v=>{const y=Wl(o);yi(y,"#"+v).each(je)},u=v=>We(s,v).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),f=v=>new Promise((y,E)=>{let S;const R=$._addCacheSuffix(v),B=u(R);s[R]=B,B.count++;const z=(U,Q)=>{T(U,Br),B.status=Q,B.passed=[],B.failed=[],S&&(S.onload=null,S.onerror=null,S=null)},P=()=>z(B.passed,2),x=()=>z(B.failed,3);if(y&&B.passed.push(y),E&&B.failed.push(E),B.status===1)return;if(B.status===2){P();return}if(B.status===3){x();return}B.status=1;const A=C.fromTag("link",r.dom);hs(A,{rel:"stylesheet",type:"text/css",id:B.id}),t.contentCssCors&&St(A,"crossOrigin","anonymous"),t.referrerPolicy&&St(A,"referrerpolicy",t.referrerPolicy),S=A.dom,S.onload=P,S.onerror=x,c(A),St(A,"href",R)}),d=(v,y)=>{const E=u(v);s[v]=E,E.count++;const S=C.fromTag("style",r.dom);hs(S,{rel:"stylesheet",type:"text/css",id:E.id}),S.dom.innerHTML=y,c(S)},p=v=>Promise.allSettled(ke(v,E=>f(E).then(j(E)))).then(E=>{const S=Uo(E,R=>R.status==="fulfilled");return S.fail.length>0?Promise.reject(ke(S.fail,R=>R.reason)):ke(S.pass,R=>R.value)}),h=v=>{const y=$._addCacheSuffix(v);We(s,y).each(E=>{--E.count===0&&(delete s[y],l(E.id))})};return{load:f,loadRawCss:d,loadAll:p,unload:h,unloadRawCss:v=>{We(s,v).each(y=>{--y.count===0&&(delete s[v],l(y.id))})},unloadAll:v=>{T(v,y=>{h(y)})},_setReferrerPolicy:a,_setContentCssCors:i}},Wg=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=Bs(n).dom;return m.from(e.get(r)).getOrThunk(()=>{const a=Vg(r,s);return e.set(r,a),a})}}})(),GN=e=>e.nodeName.toLowerCase()==="span",jg=(e,t)=>V(e)&&(Lg(t,e)||t.isInline(e.nodeName.toLowerCase())),YN=(e,t,n)=>{const s=new ht(e,t).prev(!1),o=new ht(e,t).next(!1),r=Et(s)||jg(s,n),a=Et(o)||jg(o,n);return r&&a},qg=e=>GN(e)&&e.getAttribute("data-mce-type")==="bookmark",XN=(e,t,n)=>O(e)&&e.data.length>0&&YN(e,t,n),ZN=e=>Z(e)?e.childNodes.length>0:!1,QN=e=>Ql(e)||ta(e),cu=(e,t,n,s)=>{var o;const r=s||t;if(Z(t)&&qg(t))return t;const a=t.childNodes;for(let i=a.length-1;i>=0;i--)cu(e,a[i],n,r);if(Z(t)){const i=t.childNodes;i.length===1&&qg(i[0])&&((o=t.parentNode)===null||o===void 0||o.insertBefore(i[0],t))}return!QN(t)&&!Lg(n,t)&&!ZN(t)&&!XN(t,r,n)&&e.remove(t),t},JN=$.makeMap,Ri=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ti=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,eA=/[<>&\"\']/g,tA=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,nA={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},fo={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},sA={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},oA=e=>{const t=C.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},Kg=(e,t)=>{const n={};if(e){const s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){const r=String.fromCharCode(parseInt(s[o],t));if(!fo[r]){const a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},lu=Kg("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Gg=(e,t)=>e.replace(t?Ri:Ti,n=>fo[n]||n),rA=e=>(""+e).replace(eA,t=>fo[t]||t),Yg=(e,t)=>e.replace(t?Ri:Ti,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":fo[n]||"&#"+n.charCodeAt(0)+";"),uu=(e,t,n)=>{const s=n||lu;return e.replace(t?Ri:Ti,o=>fo[o]||s[o]||o)},$s={encodeRaw:Gg,encodeAllRaw:rA,encodeNumeric:Yg,encodeNamed:uu,getEncodeFunc:(e,t)=>{const n=Kg(t)||lu,s=(a,i)=>a.replace(i?Ri:Ti,c=>fo[c]!==void 0?fo[c]:n[c]!==void 0?n[c]:c.length>1?"&#"+((c.charCodeAt(0)-55296)*1024+(c.charCodeAt(1)-56320)+65536)+";":"&#"+c.charCodeAt(0)+";"),o=(a,i)=>uu(a,i,n),r=JN(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:uu:r.numeric?Yg:Gg},decode:e=>e.replace(tA,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):nA[n]||String.fromCharCode(n)):sA[t]||lu[t]||oA(t))},_t=(e,t)=>(e=$.trim(e),e?e.split(t||" "):[]),Xg=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),aA=e=>at(e)&&e.source&&Object.prototype.toString.call(e)==="[object RegExp]",iA=e=>{const t=n=>tt(n)?ke(n,t):aA(n)?new RegExp(n.source,n.flags):at(n)?Mr(n,t):n;return t(e)},cA=e=>{const t=/^(~)?(.+)$/;return ln(_t(e,","),n=>{const s=t.exec(n);if(s){const r=s[1]==="~"?"span":"div",a=s[2];return[{cloneName:r,name:a}]}else return[]})},Zg=e=>Object.freeze(["id","accesskey","class","dir","lang","style","tabindex","title","role",...e!=="html4"?["contenteditable","contextmenu","draggable","dropzone","hidden","spellcheck","translate"]:[],...e!=="html5-strict"?["xml:lang"]:[]]),Qg=e=>{let t,n;t="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"&&(t+=" article aside details dialog figure main header footer hgroup section nav "+"a ins del canvas map",n+=" audio canvas command data datalist mark meter output picture progress time wbr video ruby bdi keygen svg"),e!=="html5-strict"&&(n=[n,"acronym applet basefont big font strike tt"].join(" "),t=[t,"center dir isindex noframes"].join(" "));const s=[t,n].join(" ");return{blockContent:t,phrasingContent:n,flowContent:s}},fu=e=>{const{blockContent:t,phrasingContent:n,flowContent:s}=Qg(e),o=r=>Object.freeze(r.split(" "));return Object.freeze({blockContent:o(t),phrasingContent:o(n),flowContent:o(s)})},lA={html4:Zn(()=>fu("html4")),html5:Zn(()=>fu("html5")),"html5-strict":Zn(()=>fu("html5-strict"))},Jg=(e,t)=>{const{blockContent:n,phrasingContent:s,flowContent:o}=lA[e]();return t==="blocks"?m.some(n):t==="phrasing"?m.some(s):t==="flow"?m.some(o):m.none()},uA=e=>{const t=Zg(e),{phrasingContent:n,flowContent:s}=Qg(e),o={},r=(c,l,u)=>{o[c]={attributes:Al(l,j({})),attributesOrder:l,children:Al(u,j({}))}},a=(c,l="",u="")=>{const f=_t(u),d=_t(c);let p=d.length;const h=[...t,..._t(l)];for(;p--;)r(d[p],h.slice(),f)},i=(c,l)=>{const u=_t(c),f=_t(l);let d=u.length;for(;d--;){const p=o[u[d]];for(let h=0,g=f.length;h<g;h++)p.attributes[f[h]]={},p.attributesOrder.push(f[h])}};return e!=="html5-strict"&&(T(_t("acronym applet basefont big font strike tt"),u=>{a(u,"",n)}),T(_t("center dir isindex noframes"),u=>{a(u,"",s)})),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),a("dd div","",s),a("address dt caption","",e==="html4"?n:s),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",n),a("blockquote","cite",s),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",s),a("dl","","dt dd"),a("a","href target rel media hreflang type",e==="html4"?n:s),a("q","cite",n),a("ins del","cite datetime",s),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",s),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),a("param","name value"),a("map","name",[s,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",s),a("th","colspan rowspan headers scope abbr",s),a("form","accept-charset action autocomplete enctype method name novalidate target",s),a("fieldset","disabled form name",[s,"legend"].join(" ")),a("label","form for",n),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?s:n),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[s,"li"].join(" ")),a("noscript","",s),e!=="html4"&&(a("wbr"),a("ruby","",[n,"rt rp"].join(" ")),a("figcaption","",s),a("mark rt rp bdi","",n),a("summary","",[n,"h1 h2 h3 h4 h5 h6"].join(" ")),a("canvas","width height",s),a("data","value",n),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[n,"option"].join(" ")),a("article section nav aside main header footer","",s),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[s,"figcaption"].join(" ")),a("time","datetime",n),a("dialog","open",s),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",n),a("progress","value max",n),a("meter","value min max low high optimum",n),a("details","open",[s,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name"),r("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading")),e!=="html4"&&T([o.video,o.audio],c=>{delete c.children.audio,delete c.children.video}),T(_t("a form meter progress dfn"),c=>{o[c]&&delete o[c].children[c]}),delete o.caption.children.table,delete o.script,o},fA=e=>e==="-"?"remove":"add",du=e=>{const t=/^(@?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)$/;return m.from(t.exec(e)).map(n=>({preset:n[1]==="@",name:n[2]}))},dA=e=>{const t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return ln(_t(e,","),n=>{const s=t.exec(n);if(s){const o=s[1],r=o?fA(o):"replace",a=s[2],i=ln(_t(s[3],"|"),c=>du(c).toArray());return[{operation:r,name:a,validChildren:i}]}else return[]})},mA=(e,t)=>{const n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,s=/[*?+]/,{attributes:o,attributesOrder:r}=t;return T(_t(e,"|"),a=>{const i=n.exec(a);if(i){const c={},l=i[1],u=i[2].replace(/[\\:]:/g,":"),f=i[3],d=i[4];if(l==="!"&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(u),c.required=!0),l==="-"){delete o[u],r.splice($.inArray(r,u),1);return}if(f&&(f==="="?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:u,value:d}),c.defaultValue=d):f==="~"?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:u,value:d}),c.forcedValue=d):f==="<"&&(c.validValues=$.makeMap(d,"?"))),s.test(u)){const p=c;t.attributePatterns=t.attributePatterns||[],p.pattern=Xg(u),t.attributePatterns.push(p)}else o[u]||r.push(u),o[u]=c}})},pA=(e,t)=>{Ue(e.attributes,(n,s)=>{t.attributes[s]=n}),t.attributesOrder.push(...e.attributesOrder)},gA=(e,t)=>{const n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return ln(_t(t,","),s=>{const o=n.exec(s);if(o){const r=o[1],a=o[2],i=o[3],c=o[4],l=o[5],u={attributes:{},attributesOrder:[]};if(e.each(f=>pA(f,u)),r==="#"?u.paddEmpty=!0:r==="-"&&(u.removeEmpty=!0),c==="!"&&(u.removeEmptyAttrs=!0),l&&mA(l,u),i&&(u.outputName=a),a==="@")if(e.isNone())e=m.some(u);else return[];return[i?{name:a,element:u,aliasName:i}:{name:a,element:u}]}else return[]})},Pi={},na=$.makeMap,zn=$.each,eh=$.extend,th=$.explode,nh=(e,t={})=>{const n=na(e," ",na(e.toUpperCase()," "));return eh(n,t)},sh=e=>nh("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),mu=(e,t)=>{if(e){const n={};return ee(e)&&(e={"*":e}),zn(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?na(s,/[, ]/):th(s,/[, ]/)}),n}else return},Fs=(e={})=>{var t;const n={},s={};let o=[];const r={},a={},i=(J,Se,He)=>{const Ke=e[J];if(Ke)return na(Ke,/[, ]/,na(Ke.toUpperCase(),/[, ]/));{let et=Pi[J];return et||(et=nh(Se,He),Pi[J]=et),et}},c=(t=e.schema)!==null&&t!==void 0?t:"html5",l=uA(c);e.verify_html===!1&&(e.valid_elements="*[*]");const u=mu(e.valid_styles),f=mu(e.invalid_styles,"map"),d=mu(e.valid_classes,"map"),p=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),h=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),g=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),v="td th iframe video audio object script code",y=i("non_empty_elements",v+" pre svg textarea summary",g),E=i("move_caret_before_on_enter_elements",v+" table",g),S="h1 h2 h3 h4 h5 h6",R=i("text_block_elements",S+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),B=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",R),z=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),P=i("transparent_elements","a ins del canvas map"),x=i("wrap_block_elements","pre "+S);zn("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),J=>{a[J]=new RegExp("</"+J+"[^>]*>","gi")});const A=J=>{const Se=m.from(n["@"]),He=/[*?+]/;T(gA(Se,J??""),({name:Ke,element:et,aliasName:gt})=>{if(gt&&(n[gt]=et),He.test(Ke)){const Ze=et;Ze.pattern=Xg(Ke),o.push(Ze)}else n[Ke]=et})},U=J=>{o=[],T(Gt(n),Se=>{delete n[Se]}),A(J)},Q=(J,Se)=>{var He,Ke;delete Pi.text_block_elements,delete Pi.block_elements;const et=Se.extends?!Qt(Se.extends):!1,gt=Se.extends;if(s[J]=gt?s[gt]:{},r[J]=gt??J,y[J.toUpperCase()]={},y[J]={},et||(B[J.toUpperCase()]={},B[J]={}),gt&&!n[J]&&n[gt]){const Ze=iA(n[gt]);delete Ze.removeEmptyAttrs,delete Ze.removeEmpty,n[J]=Ze}else n[J]={attributesOrder:[],attributes:{}};if(tt(Se.attributes)){const Ze=Lt=>{Qe.attributesOrder.push(Lt),Qe.attributes[Lt]={}},Qe=(He=n[J])!==null&&He!==void 0?He:{};delete Qe.attributesDefault,delete Qe.attributesForced,delete Qe.attributePatterns,delete Qe.attributesRequired,Qe.attributesOrder=[],Qe.attributes={},T(Se.attributes,Lt=>{const Rn=Zg(c);du(Lt).each(({preset:Tn,name:Pn})=>{Tn?Pn==="global"&&T(Rn,Ze):Ze(Pn)})}),n[J]=Qe}if(Ps(Se.padEmpty)){const Ze=(Ke=n[J])!==null&&Ke!==void 0?Ke:{};Ze.paddEmpty=Se.padEmpty,n[J]=Ze}if(tt(Se.children)){const Ze={},Qe=Rn=>{Ze[Rn]={}},Lt=Rn=>{Jg(c,Rn).each(Tn=>{T(Tn,Qe)})};T(Se.children,Rn=>{du(Rn).each(({preset:Tn,name:Pn})=>{Tn?Lt(Pn):Qe(Pn)})}),s[J]=Ze}gt&&Ue(s,(Ze,Qe)=>{Ze[gt]&&(s[Qe]=Ze=eh({},s[Qe]),Ze[J]=Ze[gt])})},fe=J=>{T(cA(J??""),({name:Se,cloneName:He})=>{Q(Se,{extends:He})})},ye=J=>{at(J)?Ue(J,(Se,He)=>Q(He,Se)):ee(J)&&fe(J)},Ae=J=>{T(dA(J??""),({operation:Se,name:He,validChildren:Ke})=>{const et=Se==="replace"?{"#comment":{}}:s[He],gt=Qe=>{Se==="remove"?delete et[Qe]:et[Qe]={}},Ze=Qe=>{Jg(c,Qe).each(Lt=>{T(Lt,gt)})};T(Ke,({preset:Qe,name:Lt})=>{Qe?Ze(Lt):gt(Lt)}),s[He]=et})},De=J=>{const Se=n[J];if(Se)return Se;let He=o.length;for(;He--;){const Ke=o[He];if(Ke.pattern.test(J))return Ke}},Le=()=>{e.valid_elements?(U(e.valid_elements),zn(l,(J,Se)=>{s[Se]=J.children})):(zn(l,(J,Se)=>{n[Se]={attributes:J.attributes,attributesOrder:J.attributesOrder},s[Se]=J.children}),zn(_t("strong/b em/i"),J=>{const Se=_t(J,"/");n[Se[1]].outputName=Se[0]}),zn(z,(J,Se)=>{n[Se]&&(e.padd_empty_block_inline_children&&(n[Se].paddInEmptyBlock=!0),n[Se].removeEmpty=!0)}),zn(_t("ol ul blockquote a table tbody"),J=>{n[J]&&(n[J].removeEmpty=!0)}),zn(_t("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),J=>{n[J]&&(n[J].paddEmpty=!0)}),zn(_t("span"),J=>{n[J].removeEmptyAttrs=!0})),delete n.svg,ye(e.custom_elements),Ae(e.valid_children),A(e.extended_valid_elements),Ae("+ol[ul|ol],+ul[ul|ol]"),zn({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(J,Se)=>{n[Se]&&(n[Se].parentsRequired=_t(J))}),e.invalid_elements&&zn(th(e.invalid_elements),J=>{n[J]&&delete n[J]}),De("span")||A("span[!data-mce-type|*]")},yt=j(u),Oe=j(f),F=j(d),X=j(b),we=j(B),M=j(R),te=j(z),pe=j(Object.seal(g)),H=j(h),me=j(y),be=j(E),rt=j(p),Re=j(P),nt=j(x),En=j(Object.seal(a)),Yn=(J,Se)=>{const He=s[J.toLowerCase()];return!!(He&&He[Se.toLowerCase()])},It=(J,Se)=>{const He=De(J);if(He)if(Se){if(He.attributes[Se])return!0;const Ke=He.attributePatterns;if(Ke){let et=Ke.length;for(;et--;)if(Ke[et].pattern.test(Se))return!0}}else return!0;return!1},Qt=J=>de(we(),J),Sn=J=>!dt(J,"#")&&It(J)&&!Qt(J),Jt=J=>de(nt(),J)||Sn(J),wn=j(r);return Le(),{type:c,children:s,elements:n,getValidStyles:yt,getValidClasses:F,getBlockElements:we,getInvalidStyles:Oe,getVoidElements:pe,getTextBlockElements:M,getTextInlineElements:te,getBoolAttrs:X,getElementRule:De,getSelfClosingElements:H,getNonEmptyElements:me,getMoveCaretBeforeOnEnterElements:be,getWhitespaceElements:rt,getTransparentElements:Re,getSpecialElements:En,isValidChild:Yn,isValid:It,isBlock:Qt,isInline:Sn,isWrapper:Jt,getCustomElements:wn,addValidElements:A,setValidElements:U,addCustomElements:ye,addValidChildren:Ae}},hA=e=>({value:bA(e)}),bA=e=>_p(e,"#").toUpperCase(),pu=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},CA=e=>{const t=pu(e.red)+pu(e.green)+pu(e.blue);return hA(t)},vA=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,yA=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,oh=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),rh=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return oh(o,r,a,i)},ah=e=>{if(e==="transparent")return m.some(oh(0,0,0,0));const t=vA.exec(e);if(t!==null)return m.some(rh(t[1],t[2],t[3],"1"));const n=yA.exec(e);return n!==null?m.some(rh(n[1],n[2],n[3],n[4])):m.none()},EA=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,sa=e=>ah(e).map(CA).map(t=>"#"+t.value).getOr(e),gu=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r=/rgba *\(/i,a={};let i,c;const l=Jr;t&&(i=t.getValidStyles(),c=t.getInvalidStyles());const u=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let d=0;d<u.length;d++)a[u[d]]=l+d,a[l+d]=u[d];const f={parse:d=>{const p={};let h=!1;const g=e.url_converter,b=e.url_converter_scope||f,v=(x,A,U)=>{const Q=p[x+"-top"+A];if(!Q)return;const fe=p[x+"-right"+A];if(!fe)return;const ye=p[x+"-bottom"+A];if(!ye)return;const Ae=p[x+"-left"+A];if(!Ae)return;const De=[Q,fe,ye,Ae];let Le=De.length-1;for(;Le--&&De[Le]===De[Le+1];);Le>-1&&U||(p[x+A]=Le===-1?De[0]:De.join(" "),delete p[x+"-top"+A],delete p[x+"-right"+A],delete p[x+"-bottom"+A],delete p[x+"-left"+A])},y=x=>{const A=p[x];if(!A)return;const U=A.indexOf(",")>-1?[A]:A.split(" ");let Q=U.length;for(;Q--;)if(U[Q]!==U[0])return!1;return p[x]=U[0],!0},E=(x,A,U,Q)=>{y(A)&&y(U)&&y(Q)&&(p[x]=p[A]+" "+p[U]+" "+p[Q],delete p[A],delete p[U],delete p[Q])},S=x=>(h=!0,a[x]),R=(x,A)=>(h&&(x=x.replace(/\uFEFF[0-9]/g,U=>a[U])),A||(x=x.replace(/\\([\'\";:])/g,"$1")),x),B=x=>String.fromCharCode(parseInt(x.slice(1),16)),z=x=>x.replace(/\\[0-9a-f]+/gi,B),P=(x,A,U,Q,fe,ye)=>{if(fe=fe||ye,fe)return fe=R(fe),"'"+fe.replace(/\'/g,"\\'")+"'";if(A=R(A||U||Q||""),!e.allow_script_urls){const Ae=A.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(Ae)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(Ae))return""}return g&&(A=g.call(b,A,"style")),"url('"+A.replace(/\'/g,"\\'")+"')"};if(d){d=d.replace(/[\u0000-\u001F]/g,""),d=d.replace(/\\[\"\';:\uFEFF]/g,S).replace(/\"[^\"]+\"|\'[^\']+\'/g,A=>A.replace(/[;:]/g,S));let x;for(;x=s.exec(d);){s.lastIndex=x.index+x[0].length;let A=x[1].replace(o,"").toLowerCase(),U=x[2].replace(o,"");if(A&&U){if(A=z(A),U=z(U),A.indexOf(l)!==-1||A.indexOf('"')!==-1||!e.allow_script_urls&&(A==="behavior"||/expression\s*\(|\/\*|\*\//.test(U)))continue;A==="font-weight"&&U==="700"?U="bold":(A==="color"||A==="background-color")&&(U=U.toLowerCase()),r.test(U)||ah(U).each(Q=>{U=sa(EA(Q)).toLowerCase()}),U=U.replace(n,P),p[A]=h?R(U,!0):U}}v("border","",!0),v("border","-width"),v("border","-color"),v("border","-style"),v("padding",""),v("margin",""),E("border","border-width","border-style","border-color"),p.border==="medium none"&&delete p.border,p["border-image"]==="none"&&delete p["border-image"]}return p},serialize:(d,p)=>{let h="";const g=(v,y)=>{const E=y[v];if(E)for(let S=0,R=E.length;S<R;S++){const B=E[S],z=d[B];z&&(h+=(h.length>0?" ":"")+B+": "+z+";")}},b=(v,y)=>{if(!c||!y)return!0;let E=c["*"];return E&&E[v]?!1:(E=c[y],!(E&&E[v]))};return p&&i?(g("*",i),g(p,i)):Ue(d,(v,y)=>{v&&b(y,p)&&(h+=(h.length>0?" ":"")+y+": "+v+";")}),h}};return f},SA={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},wA=e=>e instanceof Event||Be(e.initEvent),kA=e=>e.isDefaultPrevented===ot||e.isDefaultPrevented===qe,_A=e=>it(e.preventDefault)||wA(e),ih=(e,t)=>{const n=t??{};for(const s in e)de(SA,s)||(n[s]=e[s]);return V(e.composedPath)&&(n.composedPath=()=>e.composedPath()),V(e.getModifierState)&&(n.getModifierState=s=>e.getModifierState(s)),V(e.getTargetRanges)&&(n.getTargetRanges=()=>e.getTargetRanges()),n},hu=(e,t,n,s)=>{var o;const r=ih(t,s);return r.type=e,it(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),_A(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=ot,Be(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=ot,Be(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=ot,r.stopPropagation()},kA(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?ot:qe,r.isPropagationStopped=r.cancelBubble===!0?ot:qe,r.isImmediatePropagationStopped=qe)),r},xA="mce-data-",NA=/^(?:mouse|contextmenu)|click/,bu=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},Di=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},AA=e=>V(e)&&NA.test(e.type),oa=(e,t)=>{const n=hu(e.type,e,document,t);if(AA(e)&&Et(e.pageX)&&!Et(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},RA=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Di(e,"DOMContentLoaded",a),Di(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():bu(e,"DOMContentLoaded",a),n.domLoaded||bu(e,"load",a)};class mo{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=xA+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a;const i=window,c=d=>{r.executeHandlers(oa(d||i.event),l)};if(!t||O(t)||Ls(t))return s;let l;t[r.expando]?l=t[r.expando]:(l=r.count++,t[r.expando]=l,r.events[l]={}),o=o||t;const u=n.split(" ");let f=u.length;for(;f--;){let d=u[f],p=c,h=!1,g=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,oa({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(h=!0,g=d==="focusin"?"focus":"blur",p=b=>{const v=oa(b||i.event);v.type=v.type==="focus"?"focusin":"focusout",r.executeHandlers(v,l)}),a=r.events[l][d],a?d==="ready"&&r.domLoaded?s(oa({type:d})):a.push({func:s,scope:o}):(r.events[l][d]=a=[{func:s,scope:o}],a.fakeName=g,a.capture=h,a.nativeHandler=p,d==="ready"?RA(t,p,r):bu(t,g||d,p,h))}return t=a=null,s}unbind(t,n,s){if(!t||O(t)||Ls(t))return this;const o=t[this.expando];if(o){let r=this.events[o];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const c=a[i],l=r[c];if(l){if(s){let u=l.length;for(;u--;)if(l[u].func===s){const f=l.nativeHandler,d=l.fakeName,p=l.capture,h=l.slice(0,u).concat(l.slice(u+1));h.nativeHandler=f,h.fakeName=d,h.capture=p,r[c]=h}}(!s||l.length===0)&&(delete r[c],Di(t,l.fakeName||c,l.nativeHandler,l.capture))}}}else Ue(r,(a,i)=>{Di(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(const a in r)if(de(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||O(t)||Ls(t))return this;const o=oa({type:n,target:t},s);do{const r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||O(t)||Ls(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}mo.Event=new mo;const Cu=$.each,TA=$.grep,vu="data-mce-style",PA=$.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),ra=(e,t,n)=>{it(n)||n===""?wt(e,t):St(e,t,n)},ch=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Jo=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){const r=o.nodeType;t&&O(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},lh=(e,t)=>{const n=on(t,"style"),s=e.serialize(e.parse(n),_e(t));ra(t,vu,s)},DA=(e,t)=>$n(e)?de(PA,t)?e+"":e+"px":e,uh=(e,t,n)=>{const s=ch(t);it(n)||n===""?yg(e,s):Cg(e,s,DA(n,s))},OA=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,c)=>{const l=C.fromDom(a);Be(t.url_converter)&&V(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),c,a));const u="data-mce-"+c;ra(l,u,i),ra(l,c,i)},get:(a,i)=>{const c=C.fromDom(a);return on(c,"data-mce-"+i)||on(c,i)}},r={style:{set:(a,i)=>{const c=C.fromDom(a);s&&ra(c,vu,i),wt(c,"style"),ee(i)&&Ei(c,e.parse(i))},get:a=>{const i=C.fromDom(a),c=on(i,vu)||on(i,"style");return e.serialize(e.parse(c),_e(i))}}};return s&&(r.href=r.src=o),r},Fe=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,c=Wg.forElement(C.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),l=[],u=t.schema?t.schema:Fs({}),f=gu({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new mo:mo.Event,p=u.getBlockElements(),h=w=>ee(w)?de(p,w):Z(w)&&(de(p,w.nodeName)||uo(u,w)),g=w=>w&&e&&ee(w)?e.getElementById(w):w,b=w=>{const k=g(w);return V(k)?C.fromDom(k):null},v=(w,k,I="")=>{let D;const ne=b(w);if(V(ne)&&sn(ne)){const Ee=ui[k];Ee&&Ee.get?D=Ee.get(ne.dom,k):D=on(ne,k)}return V(D)?D:I},y=w=>{const k=g(w);return it(k)?[]:k.attributes},E=(w,k,I)=>{X(w,D=>{if(Z(D)){const ne=C.fromDom(D),Ee=I===""?null:I,Ve=on(ne,k),Dn=ui[k];Dn&&Dn.set?Dn.set(ne.dom,Ee,k):ra(ne,k,Ee),Ve!==Ee&&t.onSetAttrib&&t.onSetAttrib({attrElm:ne.dom,attrName:k,attrValue:Ee})}})},S=(w,k)=>w.cloneNode(k),R=()=>t.root_element||e.body,B=w=>{const k=Ng(w);return{x:k.x,y:k.y,w:k.width,h:k.height}},z=(w,k)=>KN(e.body,g(w),k),P=(w,k,I)=>{X(w,D=>{const ne=C.fromDom(D);uh(ne,k,I),t.update_styles&&lh(f,ne)})},x=(w,k)=>{X(w,I=>{const D=C.fromDom(I);Ue(k,(ne,Ee)=>{uh(D,Ee,ne)}),t.update_styles&&lh(f,D)})},A=(w,k,I)=>{const D=g(w);if(!(it(D)||!Ss(D)&&!EN(D)))return I?ns(C.fromDom(D),ch(k)):(k=k.replace(/-(\D)/g,(ne,Ee)=>Ee.toUpperCase()),k==="float"&&(k="cssFloat"),D.style?D.style[k]:void 0)},U=w=>{const k=g(w);if(!k)return{w:0,h:0};let I=A(k,"width"),D=A(k,"height");return(!I||I.indexOf("px")===-1)&&(I="0"),(!D||D.indexOf("px")===-1)&&(D="0"),{w:parseInt(I,10)||k.offsetWidth||k.clientWidth,h:parseInt(D,10)||k.offsetHeight||k.clientHeight}},Q=w=>{const k=g(w),I=z(k),D=U(k);return{x:I.x,y:I.y,w:D.w,h:D.h}},fe=(w,k)=>{if(!w)return!1;const I=tt(w)?w:[w];return Je(I,D=>Fn(C.fromDom(D),k))},ye=(w,k,I,D)=>{const ne=[];let Ee=g(w);D=D===void 0;const Ve=I||(R().nodeName!=="BODY"?R().parentNode:null);if(ee(k))if(k==="*")k=Z;else{const Dn=k;k=Sl=>fe(Sl,Dn)}for(;Ee&&!(Ee===Ve||it(Ee.nodeType)||ta(Ee)||Ql(Ee));){if(!k||k(Ee))if(D)ne.push(Ee);else return[Ee];Ee=Ee.parentNode}return D?ne:null},Ae=(w,k,I)=>{const D=ye(w,k,I,!1);return D&&D.length>0?D[0]:null},De=(w,k,I)=>{let D=k;if(w){ee(k)&&(D=ne=>fe(ne,k));for(let ne=w[I];ne;ne=ne[I])if(Be(D)&&D(ne))return ne}return null},Le=(w,k)=>De(w,k,"nextSibling"),yt=(w,k)=>De(w,k,"previousSibling"),Oe=w=>Be(w.querySelectorAll),F=(w,k)=>{var I,D;const ne=(D=(I=g(k))!==null&&I!==void 0?I:t.root_element)!==null&&D!==void 0?D:e;return Oe(ne)?nn(ne.querySelectorAll(w)):[]},X=function(w,k,I){const D=I??this;if(tt(w)){const ne=[];return Cu(w,(Ee,Ve)=>{const Dn=g(Ee);Dn&&ne.push(k.call(D,Dn,Ve))}),ne}else{const ne=g(w);return ne?k.call(D,ne):!1}},we=(w,k)=>{X(w,I=>{Ue(k,(D,ne)=>{E(I,ne,D)})})},M=(w,k)=>{X(w,I=>{const D=C.fromDom(I);wi(D,k)})},te=(w,k,I,D,ne)=>X(w,Ee=>{const Ve=ee(k)?e.createElement(k):k;return V(I)&&we(Ve,I),D&&(!ee(D)&&D.nodeType?Ve.appendChild(D):ee(D)&&M(Ve,D)),ne?Ve:Ee.appendChild(Ve)}),pe=(w,k,I)=>te(e.createElement(w),w,k,I,!0),H=$s.decode,me=$s.encodeAllRaw,be=(w,k,I="")=>{let D="<"+w;for(const ne in k)Ho(k,ne)&&(D+=" "+ne+'="'+me(k[ne])+'"');return Vr(I)&&de(u.getVoidElements(),w)?D+" />":D+">"+I+"</"+w+">"},rt=w=>{const k=e.createElement("div"),I=e.createDocumentFragment();I.appendChild(k),w&&(k.innerHTML=w);let D;for(;D=k.firstChild;)I.appendChild(D);return I.removeChild(k),I},Re=(w,k)=>X(w,I=>{const D=C.fromDom(I);return k&&T(Tt(D),ne=>{un(ne)&&ne.dom.length===0?je(ne):Yt(D,ne)}),je(D),D.dom}),nt=w=>X(w,k=>{const I=k.attributes;for(let D=I.length-1;D>=0;D--)k.removeAttributeNode(I.item(D))}),En=w=>f.parse(w),Yn=(w,k)=>f.serialize(w,k),It=w=>{if(ps!==Fe.DOM&&e===document){if(n[w])return;n[w]=!0}let k=e.getElementById("mceDefaultStyles");if(!k){k=e.createElement("style"),k.id="mceDefaultStyles",k.type="text/css";const I=e.head;I.firstChild?I.insertBefore(k,I.firstChild):I.appendChild(k)}k.styleSheet?k.styleSheet.cssText+=w:k.appendChild(e.createTextNode(w))},Qt=w=>{w||(w=""),T(w.split(","),k=>{o[k]=!0,c.load(k).catch(he)})},Sn=(w,k,I)=>{X(w,D=>{if(Z(D)){const ne=C.fromDom(D),Ee=k.split(" ");T(Ee,Ve=>{V(I)?(I?qo:Kr)(ne,Ve):Ix(ne,Ve)})}})},Jt=(w,k)=>{Sn(w,k,!0)},wn=(w,k)=>{Sn(w,k,!1)},J=(w,k)=>{const I=b(w),D=k.split(" ");return V(I)&&Ds(D,ne=>Ml(I,ne))},Se=w=>{X(w,k=>yg(C.fromDom(k),"display"))},He=w=>{X(w,k=>Cg(C.fromDom(k),"display","none"))},Ke=w=>{const k=b(w);return V(k)&&Wo(Si(k,"display"),"none")},et=w=>(w||"mce_")+r++,gt=w=>{const k=b(w);return V(k)?Z(k.dom)?k.dom.outerHTML:oN(k):""},Ze=(w,k)=>{X(w,I=>{Z(I)&&(I.outerHTML=k)})},Qe=(w,k)=>{const I=g(k);return X(w,D=>{const ne=I==null?void 0:I.parentNode,Ee=I==null?void 0:I.nextSibling;return ne&&(Ee?ne.insertBefore(D,Ee):ne.appendChild(D)),D})},Lt=(w,k,I)=>X(k,D=>{var ne;const Ee=tt(k)?w.cloneNode(!0):w;return I&&Cu(TA(D.childNodes),Ve=>{Ee.appendChild(Ve)}),(ne=D.parentNode)===null||ne===void 0||ne.replaceChild(Ee,D),D}),Rn=(w,k)=>{if(w.nodeName!==k.toUpperCase()){const I=pe(k);return Cu(y(w),D=>{E(I,D.nodeName,v(w,D.nodeName))}),Lt(I,w,!0),I}else return w},Tn=(w,k)=>{let I=w;for(;I;){let D=k;for(;D&&I!==D;)D=D.parentNode;if(I===D)break;I=I.parentNode}return!I&&w.ownerDocument?w.ownerDocument.documentElement:I},Pn=(w,k,I)=>_l(k)?ws(u,w,{...I,isContent:ne=>{const Ee=ne.nodeName.toLowerCase();return!!k[Ee]}}):ws(u,w,I),kn=()=>e.createRange(),Js=(w,k,I)=>{let D=kn(),ne,Ee;if(w&&k&&w.parentNode&&k.parentNode){const Ve=w.parentNode;return D.setStart(Ve,Jo(w)),D.setEnd(k.parentNode,Jo(k)),ne=D.extractContents(),D=kn(),D.setStart(k.parentNode,Jo(k)+1),D.setEnd(Ve,Jo(w)+1),Ee=D.extractContents(),Ve.insertBefore(cu(ps,ne,u),w),I?Ve.insertBefore(I,w):Ve.insertBefore(k,w),Ve.insertBefore(cu(ps,Ee,u),w),Re(w),I||k}else return},Tr=(w,k,I,D)=>{if(tt(w)){let ne=w.length;const Ee=[];for(;ne--;)Ee[ne]=Tr(w[ne],k,I,D);return Ee}else return t.collect&&(w===e||w===s)&&l.push([w,k,I,D]),d.bind(w,k,I,D||ps)},Pr=(w,k,I)=>{if(tt(w)){let D=w.length;const ne=[];for(;D--;)ne[D]=Pr(w[D],k,I);return ne}else{if(l.length>0&&(w===e||w===s)){let D=l.length;for(;D--;){const[ne,Ee,Ve]=l[D];w===ne&&(!k||k===Ee)&&(!I||I===Ve)&&d.unbind(ne,Ee,Ve)}}return d.unbind(w,k,I)}},sp=(w,k,I)=>d.dispatch(w,k,I),Rs=(w,k,I)=>d.dispatch(w,k,I),El=w=>{if(w&&Ss(w)){const k=w.getAttribute("data-mce-contenteditable");return k&&k!=="inherit"?k:w.contentEditable!=="inherit"?w.contentEditable:null}else return null},ps={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:c,boundEvents:l,styles:f,schema:u,events:d,isBlock:h,root:null,clone:S,getRoot:R,getViewPort:B,getRect:Q,getSize:U,getParent:Ae,getParents:ye,get:g,getNext:Le,getPrev:yt,select:F,is:fe,add:te,create:pe,createHTML:be,createFragment:rt,remove:Re,setStyle:P,getStyle:A,setStyles:x,removeAllAttribs:nt,setAttrib:E,setAttribs:we,getAttrib:v,getPos:z,parseStyle:En,serializeStyle:Yn,addStyle:It,loadCSS:Qt,addClass:Jt,removeClass:wn,hasClass:J,toggleClass:Sn,show:Se,hide:He,isHidden:Ke,uniqueId:et,setHTML:M,getOuterHTML:gt,setOuterHTML:Ze,decode:H,encode:me,insertAfter:Qe,replace:Lt,rename:Rn,findCommonAncestor:Tn,run:X,getAttribs:y,isEmpty:Pn,createRng:kn,nodeIndex:Jo,split:Js,bind:Tr,unbind:Pr,fire:Rs,dispatch:sp,getContentEditable:El,getContentEditableParent:w=>{const k=R();let I=null;for(let D=w;D&&D!==k&&(I=El(D),I===null);D=D.parentNode);return I},isEditable:w=>{if(V(w)){const k=Z(w)?w:w.parentElement;return V(k)&&Ss(k)&&ro(C.fromDom(k))}else return!1},destroy:()=>{if(l.length>0){let w=l.length;for(;w--;){const[k,I,D]=l[w];d.unbind(k,I,D)}}Ue(o,(w,k)=>{c.unload(k),delete o[k]})},isChildOf:(w,k)=>w===k||k.contains(w),dumpRng:w=>"startContainer: "+w.startContainer.nodeName+", startOffset: "+w.startOffset+", endContainer: "+w.endContainer.nodeName+", endOffset: "+w.endOffset},ui=OA(f,t,j(ps));return ps};Fe.DOM=Fe(document),Fe.nodeIndex=Jo;const BA=Fe.DOM,IA=0,LA=1,Oi=2,fh=3;class ks{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=BA;let r;const a=()=>{o.remove(l),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},c=()=>{a(),s("Failed to load script: "+t)},l=o.uniqueId();r=document.createElement("script"),r.id=l,r.type="text/javascript",r.src=$._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=c,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Oi}markDone(t){this.states[t]=Oi}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=IA),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(c,l)=>{We(n.scriptLoadedCallbacks,l).each(u=>{T(u,f=>f[c](l))}),delete n.scriptLoadedCallbacks[l]},o=c=>{const l=le(c,u=>u.status==="rejected");return l.length>0?Promise.reject(ln(l,({reason:u})=>tt(u)?u:[u])):Promise.resolve()},r=c=>Promise.allSettled(ke(c,l=>n.states[l]===Oi?(s("resolve",l),Promise.resolve()):n.states[l]===fh?(s("reject",l),Promise.reject(l)):(n.states[l]=LA,n.loadScript(l).then(()=>{n.states[l]=Oi,s("resolve",l);const u=n.queue;return u.length>0?(n.queue=[],r(u).then(o)):Promise.resolve()},()=>(n.states[l]=fh,s("reject",l),Promise.reject(l)))))),a=c=>(n.loading=!0,r(c).then(l=>{n.loading=!1;const u=n.queueLoadedCallbacks.shift();return m.from(u).each(Br),o(l)})),i=vp(t);return n.loading?new Promise((c,l)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(c,l)})}):a(i)}}ks.ScriptLoader=new ks;const Ct=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},$A=(e,t)=>{const n=e.indexOf(t);return n!==-1&&e.indexOf(t,n+1)>n},FA=e=>at(e)&&de(e,"raw"),MA=e=>tt(e)&&e.length>1,aa={},yu=Ct("en"),dh=()=>We(aa,yu.get()),Hn={getData:()=>Mr(aa,e=>({...e})),setCode:e=>{e&&yu.set(e)},getCode:()=>yu.get(),add:(e,t)=>{let n=aa[e];n||(aa[e]=n={});const s=ke(Gt(t),o=>o.toLowerCase());Ue(t,(o,r)=>{const a=r.toLowerCase();a!==r&&$A(s,a)?(de(t,a)||(n[a]=o),n[r]=o):n[a]=o})},translate:e=>{const t=dh().getOr({}),n=a=>Be(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return de(t,i)?n(t[i]):We(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(FA(e))return n(e.raw);if(MA(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(c,l)=>de(a,l)?n(a[l]):c);return r(i)}return r(o(e))},isRtl:()=>dh().bind(e=>We(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>de(aa,e)},Ft=()=>{const e=[],t={},n={},s=[],o=(g,b)=>{const v=le(s,y=>y.name===g&&y.state===b);T(v,y=>y.resolve())},r=g=>de(t,g),a=g=>de(n,g),i=g=>{if(n[g])return n[g].instance},c=(g,b)=>{const v=Hn.getCode(),y=","+(b||"")+",";!v||b&&y.indexOf(","+v+",")===-1||ks.ScriptLoader.add(t[g]+"/langs/"+v+".js")},l=(g,b)=>{Ft.languageLoad!==!1&&(r(g)?c(g,b):h(g,"loaded").then(()=>c(g,b)))},u=(g,b)=>(e.push(b),n[g]={instance:b},o(g,"added"),b),f=g=>{delete t[g],delete n[g]},d=(g,b)=>ee(b)?ee(g)?{prefix:"",resource:b,suffix:""}:{prefix:g.prefix,resource:b,suffix:g.suffix}:b,p=(g,b)=>{if(t[g])return Promise.resolve();let v=ee(b)?b:b.prefix+b.resource+b.suffix;v.indexOf("/")!==0&&v.indexOf("://")===-1&&(v=Ft.baseURL+"/"+v),t[g]=v.substring(0,v.lastIndexOf("/"));const y=()=>(o(g,"loaded"),Promise.resolve());return n[g]?y():ks.ScriptLoader.add(v).then(y)},h=(g,b="added")=>b==="added"&&a(g)||b==="loaded"&&r(g)?Promise.resolve():new Promise(v=>{s.push({name:g,state:b,resolve:v})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:l,add:u,remove:f,createUrl:d,load:p,waitFor:h}};Ft.languageLoad=!0,Ft.baseURL="",Ft.PluginManager=Ft(),Ft.ThemeManager=Ft(),Ft.ModelManager=Ft();const UA=e=>{const t=Ct(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},zA=e=>{const t=Ct(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},Ms=()=>{const e=UA(he);return{...e,on:n=>e.get().each(n)}},Bi=(e,t)=>{let n=null;return{cancel:()=>{zt(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{zt(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},Eu=(e,t)=>{let n=null;const s=()=>{zt(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},HA=(e,t,n)=>Zr(e,t,n).isSome(),ia=j("mce-annotation"),po=j("data-mce-annotation"),er=j("data-mce-annotation-uid"),ca=j("data-mce-annotation-active"),la=j("data-mce-annotation-classes"),ua=j("data-mce-annotation-attrs"),mh=e=>t=>Te(t,e),ph=(e,t)=>{const n=e.selection.getRng(),s=C.fromDom(n.startContainer),o=C.fromDom(e.getBody()),r=t.fold(()=>"."+ia(),c=>`[${po()}="${c}"]`),a=Ko(s,n.startOffset).getOr(s);return Yo(a,r,mh(o)).bind(c=>bs(c,`${er()}`).bind(l=>bs(c,`${po()}`).map(u=>{const f=hh(e,l);return{uid:l,name:u,elements:f}})))},VA=e=>sn(e)&&Ml(e,ia()),gh=(e,t)=>jr(e,"data-mce-bogus")||HA(e,'[data-mce-bogus="all"]',mh(t)),hh=(e,t)=>{const n=C.fromDom(e.getBody()),s=Pt(n,`[${er()}="${t}"]`);return le(s,o=>!gh(o,n))},bh=(e,t)=>{const n=C.fromDom(e.getBody()),s=Pt(n,`[${po()}="${t}"]`),o={};return T(s,r=>{if(!gh(r,n)){const a=on(r,er()),i=We(o,a).getOr([]);o[a]=i.concat([r])}}),o},WA=(e,t)=>{const n=Ct({}),s=()=>({listeners:[],previous:Ms()}),o=(f,d)=>{r(f,p=>(d(p),p))},r=(f,d)=>{const p=n.get(),h=We(p,f).getOrThunk(s),g=d(h);p[f]=g,n.set(p)},a=(f,d,p)=>{o(f,h=>{T(h.listeners,g=>g(!0,f,{uid:d,nodes:ke(p,b=>b.dom)}))})},i=f=>{o(f,d=>{T(d.listeners,p=>p(!1,f))})},c=(f,d)=>{T(hh(e,f),p=>{d?St(p,ca(),"true"):wt(p,ca())})},l=Eu(()=>{const f=eo(t.getNames());T(f,d=>{r(d,p=>{const h=p.previous.get();return ph(e,m.some(d)).fold(()=>{h.each(g=>{i(d),p.previous.clear(),c(g,!1)})},({uid:g,name:b,elements:v})=>{Wo(h,g)||(h.each(y=>c(y,!1)),a(b,g,v),p.previous.set(g),c(g,!0))}),{previous:p.previous,listeners:p.listeners}})})},30);return e.on("remove",()=>{l.cancel()}),e.on("NodeChange",()=>{l.throttle()}),{addListener:(f,d)=>{r(f,p=>({previous:p.previous,listeners:p.listeners.concat([d])}))}}},jA=(e,t)=>{const n=po(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(er(),null),r.attr(po(),null),r.attr(ca(),null);const c=m.from(r.attr(ua())).map(d=>d.split(",")).getOr([]),l=m.from(r.attr(la())).map(d=>d.split(",")).getOr([]);T(c,d=>r.attr(d,null));const u=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],f=fi(u,[ia()].concat(l));r.attr("class",f.length>0?f.join(" "):null),r.attr(la(),null),r.attr(ua(),null)};e.serializer.addTempAttr(ca()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},qA=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>We(e,o).map(r=>r.settings),getNames:()=>Gt(e)}};let Ch=0;const fa=e=>{const n=new Date().getTime(),s=Math.floor(Math.random()*1e9);return Ch++,e+"_"+s+Ch+String(n)},KA=(e,t)=>{T(t,n=>{qo(e,n)})},GA=(e,t)=>{T(t,n=>{Kr(e,n)})},vh=(e,t)=>C.fromDom(e.dom.cloneNode(t)),go=e=>vh(e,!1),yh=e=>vh(e,!0),YA=(e,t)=>{const n=C.fromTag(t),s=ng(e);return hs(n,s),n},XA=(e,t)=>{const n=YA(e,t);Es(e,n);const s=Tt(e);return ao(n,s),je(e),n},Eh=(e,t,n=qe)=>{const s=new ht(e,t),o=r=>{let a;do a=s[r]();while(a&&!O(a)&&!n(a));return m.from(a).filter(O)};return{current:()=>m.from(s.current()).filter(O),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},ho=(e,t)=>{const n=t||(a=>e.isBlock(a)||Xe(a)||ze(a)),s=(a,i,c,l)=>{if(O(a)){const u=l(a,i,a.data);if(u!==-1)return m.some({container:a,offset:u})}return c().bind(u=>s(u.container,u.offset,c,l))};return{backwards:(a,i,c,l)=>{const u=Eh(a,l??e.getRoot(),n);return s(a,i,()=>u.prev().map(f=>({container:f,offset:f.length})),c).getOrNull()},forwards:(a,i,c,l)=>{const u=Eh(a,l??e.getRoot(),n);return s(a,i,()=>u.next().map(f=>({container:f,offset:0})),c).getOrNull()}}},Su=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(un,"text"),Ii=e=>Su.get(e),ZA=e=>Su.getOption(e),QA=(e,t)=>Su.set(e,t),JA=["td","th"],eR=["thead","tbody","tfoot"],tR=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],nR=["li","dd","dt"],sR=["ul","ol","dl"],oR=["pre","script","textarea","style"],tr=e=>{let t;return n=>(t=t||Al(e,ot),de(t,_e(n)))},rR=e=>_e(e)==="table",bo=e=>sn(e)&&_e(e)==="br",Sh=tr(tR),wu=tr(sR),da=tr(nR),aR=tr(eR),ma=tr(JA),Li=tr(oR),iR=e=>{const t=[];let n=e.dom;for(;n;)t.push(C.fromDom(n)),n=n.lastChild;return t},cR=e=>{const t=Pt(e,"br"),n=le(iR(e).slice(-1),bo);t.length===n.length&&T(n,je)},pa=()=>{const e=C.fromTag("br");return St(e,"data-mce-bogus","1"),e},Us=e=>{Xo(e),ct(e,pa())},lR=(e,t)=>{zl(e).each(n=>{so(n).each(s=>{t.isBlock(_e(e))&&bo(n)&&t.isBlock(_e(s))&&je(n)})})},mt=Jr,$i=Xl,rn=hN,uR=e=>e.insertContent(mt,{preserve_zwsp:!0}),fR=Z,nr=O,sr=e=>(nr(e)&&(e=e.parentNode),fR(e)&&e.hasAttribute("data-mce-caret")),zs=e=>nr(e)&&$i(e.data),fn=e=>sr(e)||zs(e),wh=e=>e.firstChild!==e.lastChild||!Xe(e.firstChild),dR=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(mt),r=e.parentNode;if(t){const a=e.previousSibling;if(nr(a)){if(fn(a))return a;if(Mi(a))return a.splitText(a.data.length-1)}r==null||r.insertBefore(o,e)}else{const a=e.nextSibling;if(nr(a)){if(fn(a))return a;if(Fi(a))return a.splitText(1),a}e.nextSibling?r==null||r.insertBefore(o,e.nextSibling):r==null||r.appendChild(o)}return o},ku=e=>{const t=e.container();return O(t)?t.data.charAt(e.offset())===mt||e.isAtStart()&&zs(t.previousSibling):!1},_u=e=>{const t=e.container();return O(t)?t.data.charAt(e.offset()-1)===mt||e.isAtEnd()&&zs(t.nextSibling):!1},mR=(e,t,n)=>{var s;const r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(pa().dom);const a=t.parentNode;return n?a==null||a.insertBefore(r,t):t.nextSibling?a==null||a.insertBefore(r,t.nextSibling):a==null||a.appendChild(r),r},Fi=e=>nr(e)&&e.data[0]===mt,Mi=e=>nr(e)&&e.data[e.data.length-1]===mt,pR=e=>{var t;const n=e.getElementsByTagName("br"),s=n[n.length-1];co(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},xu=e=>e&&e.hasAttribute("data-mce-caret")?(pR(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,kh=e=>sr(e.startContainer),or=Math.round,Co=e=>e?{left:or(e.left),top:or(e.top),bottom:or(e.bottom),right:or(e.right),width:or(e.width),height:or(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},_h=(e,t)=>(e=Co(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),gR=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,xh=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,ga=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:xh(t.top-e.bottom,e,t)},ha=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:xh(t.bottom-e.top,e,t),hR=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,bR=e=>Kt(e,(t,n)=>t.fold(()=>m.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),Nh=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},CR=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),vR=(e,t,n)=>Math.min(Math.max(e,t),n),Ui=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Hs=(e,t)=>{if(Z(e)&&e.hasChildNodes()){const n=e.childNodes,s=vR(t,0,n.length-1);return n[s]}else return e},yR=(e,t)=>{if(!(t<0&&Z(e)&&e.hasChildNodes()))return Hs(e,t)},ER=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Ah=e=>ee(e)&&e.charCodeAt(0)>=768&&ER.test(e),SR=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},wR=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},Rh=_n,kR=ze,_R=Xe,xR=O,NR=Un(["script","style","textarea"]),Th=Un(["img","input","textarea","hr","iframe","video","audio","object","embed"]),AR=Un(["table"]),RR=fn,Vn=e=>RR(e)?!1:xR(e)?!NR(e.parentNode):Th(e)||_R(e)||AR(e)||Nu(e),TR=e=>Z(e)&&e.getAttribute("unselectable")==="true",Nu=e=>!TR(e)&&kR(e),PR=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(Nu(n))return!1;if(Rh(n))return!0}return!0},DR=e=>Nu(e)?!Kt(nn(e.getElementsByTagName("*")),(t,n)=>t||Rh(n),!1):!1,OR=e=>Th(e)||DR(e),Ph=(e,t)=>Vn(e)&&PR(e,t),Dh=Z,BR=Vn,Oh=xi("display","block table"),IR=xi("float","left right"),ba=wR(Dh,BR,Or(IR)),LR=Or(xi("white-space","pre pre-line pre-wrap")),Ca=O,Au=Xe,Bh=Fe.nodeIndex,zi=yR,Ru=e=>e?e.createRange():Fe.DOM.createRng(),Tu=e=>ee(e)&&/[\r\n\t ]/.test(e),Ih=e=>!!e.setStart&&!!e.setEnd,Pu=e=>{const t=e.startContainer,n=e.startOffset;if(Tu(e.toString())&&LR(t.parentNode)&&O(t)){const s=t.data;if(Tu(s[n-1])||Tu(s[n+1]))return!0}return!1},$R=e=>{const t=e.ownerDocument,n=Ru(t),s=t.createTextNode(bt),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=Co(n.getBoundingClientRect());return o.removeChild(s),r},FR=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&O(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),Vs(r)}else return null},Lh=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,Vs=e=>{var t;let n;const s=e.getClientRects();return s.length>0?n=Co(s[0]):n=Co(e.getBoundingClientRect()),!Ih(e)&&Au(e)&&Lh(n)?$R(e):Lh(n)&&Ih(e)&&(t=FR(e))!==null&&t!==void 0?t:n},vo=(e,t)=>{const n=_h(e,t);return n.width=1,n.right=n.left+1,n},MR=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&gR(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const c=Ru(a.ownerDocument);if(i<a.data.length){if(Ah(a.data[i]))return;if(Ah(a.data[i-1])&&(c.setStart(a,i),c.setEnd(a,i+1),!Pu(c))){n(vo(Vs(c),!1));return}}i>0&&(c.setStart(a,i-1),c.setEnd(a,i),Pu(c)||n(vo(Vs(c),!1))),i<a.data.length&&(c.setStart(a,i),c.setEnd(a,i+1),Pu(c)||n(vo(Vs(c),!0)))},o=e.container(),r=e.offset();if(Ca(o))return s(o,r),t;if(Dh(o))if(e.isAtEnd()){const a=zi(o,r);Ca(a)&&s(a,a.data.length),ba(a)&&!Au(a)&&n(vo(Vs(a),!1))}else{const a=zi(o,r);if(Ca(a)&&s(a,0),ba(a)&&e.isAtEnd())return n(vo(Vs(a),!1)),t;const i=zi(e.container(),e.offset()-1);ba(i)&&!Au(i)&&(Oh(i)||Oh(a)||!ba(a))&&n(vo(Vs(i),!1)),ba(a)&&n(vo(Vs(a),!0))}return t},N=(e,t,n)=>{const s=()=>(Ca(e),t===0),o=()=>Ca(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const u=Ru(e.ownerDocument);return u.setStart(e,t),u.setEnd(e,t),u},a=()=>(n||(n=MR(N(e,t))),n),i=()=>a().length>0,c=u=>u&&e===u.container()&&t===u.offset(),l=u=>zi(e,u?t-1:t);return{container:j(e),offset:j(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:c,getNode:l}};N.fromRangeStart=e=>N(e.startContainer,e.startOffset),N.fromRangeEnd=e=>N(e.endContainer,e.endOffset),N.after=e=>N(e.parentNode,Bh(e)+1),N.before=e=>N(e.parentNode,Bh(e)),N.isAbove=(e,t)=>Rt(Vt(t.getClientRects()),Os(e.getClientRects()),ga).getOr(!1),N.isBelow=(e,t)=>Rt(Os(t.getClientRects()),Vt(e.getClientRects()),ha).getOr(!1),N.isAtStart=e=>e?e.isAtStart():!1,N.isAtEnd=e=>e?e.isAtEnd():!1,N.isTextPosition=e=>e?O(e.container()):!1,N.isElementPosition=e=>!N.isTextPosition(e);const Hi=(e,t)=>{O(t)&&t.data.length===0&&e.remove(t)},UR=(e,t,n)=>{t.insertNode(n),Hi(e,n.previousSibling),Hi(e,n.nextSibling)},zR=(e,t,n)=>{const s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Hi(e,r.previousSibling)),o.each(r=>Hi(e,r.nextSibling))},Du=(e,t,n)=>{Ql(n)?zR(e,t,n):UR(e,t,n)},Wn=O,$h=co,Fh=Fe.nodeIndex,Mh=e=>{const t=e.parentNode;return $h(t)?Mh(t):t},Ou=e=>e?pi(e.childNodes,(t,n)=>($h(n)&&n.nodeName!=="BR"?t=t.concat(Ou(n)):t.push(n),t),[]):[],HR=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&Wn(n);)t+=n.data.length;return t},Uh=e=>t=>e===t,VR=e=>{let t,n;t=Ou(Mh(e)),n=Ep(t,Uh(e),e),t=t.slice(0,n+1);const s=pi(t,(o,r,a)=>(Wn(r)&&Wn(t[a-1])&&o++,o),0);return t=zr(t,Un([e.nodeName])),n=Ep(t,Uh(e),e),n-s},zh=e=>(Wn(e)?"text()":e.nodeName.toLowerCase())+"["+VR(e)+"]",WR=(e,t,n)=>{const s=[];for(let o=t.parentNode;o&&o!==e&&!(n&&n(o));o=o.parentNode)s.push(o);return s},Hh=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(Wn(s))r=HR(s,o);else{const i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(zh(s));let a=WR(e,s);return a=zr(a,Or(co)),n=n.concat(Dl(a,i=>zh(i))),n.reverse().join("/")+","+r},jR=(e,t,n)=>{let s=Ou(e);return s=zr(s,(o,r)=>!Wn(o)||!Wn(s[r-1])),s=zr(s,Un([t])),s[n]},qR=(e,t)=>{let n=e,s=0;for(;Wn(n);){const o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!Wn(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return Wn(e)&&t>e.data.length&&(t=e.data.length),N(e,t)},Vh=(e,t)=>{if(!t)return null;const n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=pi(s,(a,i)=>{const c=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return c?(c[1]==="text()"&&(c[1]="#text"),jR(a,c[1],parseInt(c[2],10))):null},e);if(!r)return null;if(!Wn(r)&&r.parentNode){let a;return o==="after"?a=Fh(r)+1:a=Fh(r),N(r.parentNode,a)}return qR(r,parseInt(o,10))},Vi=ze,KR=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&O(o);o=o.previousSibling)s+=e(o.data).length;return s},Wh=(e,t,n,s,o)=>{const r=o?s.startContainer:s.endContainer;let a=o?s.startOffset:s.endOffset;const i=[],c=e.getRoot();if(O(r))i.push(n?KR(t,r,a):a);else{let l=0;const u=r.childNodes;a>=u.length&&u.length&&(l=1,a=Math.max(0,u.length-1)),i.push(e.nodeIndex(u[a],n)+l)}for(let l=r;l&&l!==c;l=l.parentNode)i.push(e.nodeIndex(l,n));return i},GR=(e,t,n,s)=>{const o=t.dom,r=Wh(o,e,n,s,!0),a=t.isForward(),i=kh(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const c=Wh(o,e,n,s,!1);return{start:r,end:c,forward:a,...i}}},Bu=(e,t,n)=>{let s=0;return $.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},jh=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(Z(n)&&n.nodeName==="TR"){const o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},qh=e=>(jh(e,!0),jh(e,!1),e),Kh=(e,t)=>{if(Z(e)&&(e=Hs(e,t),Vi(e)))return e;if(fn(e)){O(e)&&sr(e)&&(e=e.parentNode);let n=e.previousSibling;if(Vi(n)||(n=e.nextSibling,Vi(n)))return n}},YR=e=>Kh(e.startContainer,e.startOffset)||Kh(e.endContainer,e.endOffset),Gh=(e,t,n)=>{const s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||Vi(s)){const a=s.nodeName;return{name:a,index:Bu(n.dom,a,s)}}const r=YR(o);if(r){const a=r.tagName;return{name:a,index:Bu(n.dom,a,r)}}return GR(e,n,t,o)},XR=e=>{const t=e.getRng();return{start:Hh(e.dom.getRoot(),N.fromRangeStart(t)),end:Hh(e.dom.getRoot(),N.fromRangeEnd(t)),forward:e.isForward()}},ZR=e=>({rng:e.getRng(),forward:e.isForward()}),Yh=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},Xh=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,c=e.isForward();if(i==="IMG")return{name:i,index:Bu(n,i,a)};const l=qh(s.cloneRange());if(!r){l.collapse(!1);const f=Yh(n,o+"_end",t);Du(n,l,f)}s=qh(s),s.collapse(!0);const u=Yh(n,o+"_start",t);return Du(n,s,u),e.moveToBookmark({id:o,keep:!0,forward:c}),{id:o,forward:c}},QR=(e,t,n=!1)=>t===2?Gh(rn,n,e):t===3?XR(e):t?ZR(e):Xh(e,!1),Iu=G(Gh,Ht,!0),Zh=e=>{const t=r=>r(e),n=j(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:ot,isError:qe,map:r=>Wt.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},Qh=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:qe,isError:ot,map:t,mapError:s=>Wt.error(s(e)),bind:t,exists:qe,forall:ot,getOr:Ht,or:Ht,getOrThunk:xl,orThunk:xl,getOrDie:dp(String(e)),each:he,toOptional:m.none};return n},Wt={value:Zh,error:Qh,fromOption:(e,t)=>e.fold(()=>Qh(t),Zh)},rs={generate:e=>{if(!tt(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return T(e,(s,o)=>{const r=Gt(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!tt(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...c)=>{const l=c.length;if(l!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+l);return{fold:(...f)=>{if(f.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+f.length);return f[o].apply(null,c)},match:f=>{const d=Gt(f);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!Ds(t,h=>Ie(d,h)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return f[a].apply(null,c)},log:f=>{console.log(f,{constructors:t,constructor:a,params:c})}}}}),n}};rs.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const JR=e=>{const t=[],n=[];return T(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},eT=e=>e.type==="inline-command"||e.type==="inline-format",tT=e=>e.type==="block-command"||e.type==="block-format",nT=(e,t)=>(e.type==="block-command"||e.type==="block-format")&&e.trigger===t,sT=e=>{var t;const n=o=>Wt.error({message:o,pattern:e}),s=(o,r,a)=>{if(e.format!==void 0){let i;if(tt(e.format)){if(!Ds(e.format,ee))return n(o+" pattern has non-string items in the `format` array");i=e.format}else if(ee(e.format))i=[e.format];else return n(o+" pattern has non-string `format` parameter");return Wt.value(r(i))}else return e.cmd!==void 0?ee(e.cmd)?Wt.value(a(e.cmd,e.value)):n(o+" pattern has non-string `cmd` parameter"):n(o+" pattern is missing both `format` and `cmd` parameters")};if(!at(e))return n("Raw pattern is not an object");if(!ee(e.start))return n("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!ee(e.end))return n("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return n("Inline pattern has empty `start` and `end` parameters");let o=e.start,r=e.end;return r.length===0&&(r=o,o=""),s("Inline",a=>({type:"inline-format",start:o,end:r,format:a}),(a,i)=>({type:"inline-command",start:o,end:r,cmd:a,value:i}))}else{if(e.replacement!==void 0)return ee(e.replacement)?e.start.length===0?n("Replacement pattern has empty `start` parameter"):Wt.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):n("Replacement pattern has non-string `replacement` parameter");{const o=(t=e.trigger)!==null&&t!==void 0?t:"space";return e.start.length===0?n("Block pattern has empty `start` parameter"):s("Block",r=>({type:"block-format",start:e.start,format:r[0],trigger:o}),(r,a)=>({type:"block-command",start:e.start,cmd:r,value:a,trigger:o}))}}},Jh=e=>le(e,tT),eb=e=>le(e,eT),oT=(e,t)=>({inlinePatterns:eb(e),blockPatterns:Jh(e),dynamicPatternsLookup:t}),Lu=(e,t)=>({...e,blockPatterns:le(e.blockPatterns,n=>nT(n,t))}),tb=e=>{const t=JR(ke(e,sT));return T(t.errors,n=>console.error(n.message,n.pattern)),t.values},rT=e=>t=>{const n=e(t);return tb(n)},$u=Jn().deviceType,aT=$u.isTouch(),iT=Fe.DOM,cT=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Kt(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[Vo(r)]=Vo(a),n},{})},nb=e=>Ln(e,RegExp),q=e=>t=>t.options.get(e),Wi=e=>ee(e)||at(e),sb=(e,t="")=>n=>{const s=ee(n);if(s)if(n.indexOf("=")!==-1){const o=cT(n);return{value:We(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},lT=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:sb(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:sb(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=ee(n)&&Qn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=Ie(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Ps(n)?{valid:!0,value:n}:ee(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||ee(n)||Mo(n,ee);return s?ee(n)?{value:ke(n.split(","),Vo),valid:s}:tt(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Uu(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=ee(n)||Mo(n,ee);return s?{value:tt(n)?n:ke(n.split(","),Vo),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=Ps(n)||ee(n);return s?n===!1||$u.isiPhone()||$u.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!aT}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"string"}),t("service_message",{processor:"string"}),t("theme",{processor:n=>n===!1||ee(n)||Be(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{const s=n===!1||ee(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:Wi}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Wi}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Wi}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Wi}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>ee(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("license_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>Mo(n,at)||n===!1?{value:tb(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1",trigger:"space"},{start:"##",format:"h2",trigger:"space"},{start:"###",format:"h3",trigger:"space"},{start:"####",format:"h4",trigger:"space"},{start:"#####",format:"h5",trigger:"space"},{start:"######",format:"h6",trigger:"space"},{start:"1.",cmd:"InsertOrderedList",trigger:"space"},{start:"*",cmd:"InsertUnorderedList",trigger:"space"},{start:"-",cmd:"InsertUnorderedList",trigger:"space"},{start:">",cmd:"mceBlockQuote",trigger:"space"},{start:"---",cmd:"InsertHorizontalRule",trigger:"space"}]}),t("text_patterns_lookup",{processor:n=>Be(n)?{value:rT(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>Mo(n,nb)?{value:n,valid:!0}:nb(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!0}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:n=>{const s=Ie(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:n=>{const s=Ie(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),t("sandbox_iframes",{processor:"boolean",default:!0}),t("sandbox_iframes_exclusions",{processor:"string[]",default:["youtube.com","youtu.be","vimeo.com","player.vimeo.com","dailymotion.com","embed.music.apple.com","open.spotify.com","giphy.com","dai.ly","codepen.io"]}),t("convert_unsafe_embeds",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:Hn.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:iT.getAttrib(e.getElement(),"placeholder")})})},uT=q("iframe_attrs"),fT=q("doctype"),ob=q("document_base_url"),dT=q("body_id"),mT=q("body_class"),rb=q("content_security_policy"),pT=q("br_in_pre"),Ot=q("forced_root_block"),va=q("forced_root_block_attrs"),gT=q("newline_behavior"),hT=q("br_newline_selector"),bT=q("no_newline_selector"),CT=q("keep_styles"),vT=q("end_container_on_empty_block"),ab=q("automatic_uploads"),ib=q("images_reuse_filename"),yT=q("images_replace_blob_uris"),cb=q("icons"),ET=q("icons_url"),ST=q("images_upload_url"),wT=q("images_upload_base_path"),kT=q("images_upload_credentials"),_T=q("images_upload_handler"),xT=q("content_css_cors"),Fu=q("referrer_policy"),lb=q("language"),NT=q("language_url"),ub=q("indent_use_margin"),AT=q("indentation"),RT=q("content_css"),TT=q("content_style"),fb=q("font_css"),PT=q("directionality"),DT=q("inline_boundaries_selector"),db=q("object_resizing"),OT=q("resize_img_proportional"),BT=q("placeholder"),mb=q("event_root"),IT=q("service_message"),rr=q("theme"),LT=q("theme_url"),Mu=q("model"),$T=q("model_url"),ya=q("inline_boundaries"),FT=q("formats"),MT=q("preview_styles"),UT=q("format_empty_lines"),zT=q("format_noneditable_selector"),HT=q("custom_ui_selector"),Uu=q("inline"),VT=q("hidden_input"),WT=q("submit_patch"),jT=q("add_form_submit_trigger"),qT=q("add_unload_trigger"),KT=q("custom_undo_redo_levels"),GT=q("disable_nodechange"),pb=q("readonly"),YT=q("editable_root"),gb=q("content_css_cors"),ji=q("plugins"),XT=q("external_plugins"),ZT=q("block_unsupported_drop"),QT=q("visual"),JT=q("visual_table_class"),hb=q("visual_anchor_class"),eP=q("iframe_aria_text"),tP=q("setup"),nP=q("init_instance_callback"),sP=q("urlconverter_callback"),oP=q("auto_focus"),rP=q("browser_spellcheck"),aP=q("protect"),iP=q("paste_block_drop"),qi=q("paste_data_images"),cP=q("paste_preprocess"),lP=q("paste_postprocess"),uP=q("newdocument_content"),fP=q("paste_webkit_styles"),dP=q("paste_remove_styles_if_webkit"),mP=q("paste_merge_formats"),pP=q("smart_paste"),gP=q("paste_as_text"),hP=q("paste_tab_spaces"),bP=q("allow_html_data_urls"),CP=q("text_patterns"),vP=q("text_patterns_lookup"),bb=q("noneditable_class"),yP=q("editable_class"),EP=q("noneditable_regexp"),SP=q("preserve_cdata"),wP=q("highlight_on_focus"),Cb=q("xss_sanitization"),kP=q("init_content_sync"),_P=e=>e.options.isSet("text_patterns_lookup"),xP=e=>$.explode(e.options.get("font_size_style_values")),NP=e=>$.explode(e.options.get("font_size_classes")),AP=e=>e.options.get("encoding")==="xml",vb=e=>$.explode(e.options.get("images_file_types")),RP=q("table_tab_navigation"),TP=q("details_initial_state"),PP=q("details_serialized_state"),yb=q("sandbox_iframes"),zu=e=>e.options.get("sandbox_iframes_exclusions"),DP=q("convert_unsafe_embeds"),OP=q("license_key"),BP=q("api_key"),IP=Z,Eb=O,Sb=e=>{const t=e.parentNode;t&&t.removeChild(e)},wb=e=>{const t=rn(e);return{count:e.length-t.length,text:t}},kb=e=>{let t;for(;(t=e.data.lastIndexOf(mt))!==-1;)e.deleteData(t,1)},_b=(e,t)=>(yo(e),t),LP=(e,t)=>{const n=wb(e.data.substr(0,t.offset())),s=wb(e.data.substr(t.offset()));return(n.text+s.text).length>0?(kb(e),N(e,t.offset()-n.count)):t},$P=(e,t)=>{const n=t.container(),s=H_(nn(n.childNodes),e).map(o=>o<t.offset()?N(n,t.offset()-1):t).getOr(t);return yo(e),s},FP=(e,t)=>Eb(e)&&t.container()===e?LP(e,t):_b(e,t),MP=(e,t)=>t.container()===e.parentNode?$P(e,t):_b(e,t),UP=(e,t)=>N.isTextPosition(t)?FP(e,t):MP(e,t),yo=e=>{IP(e)&&fn(e)&&(wh(e)?e.removeAttribute("data-mce-caret"):Sb(e)),Eb(e)&&(kb(e),e.data.length===0&&Sb(e))},zP=ze,HP=os,VP=Ni,WP="*[contentEditable=false],video,audio,embed,object",xb=(e,t,n)=>{const s=_h(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},jP=e=>{var t,n;const s=Pt(C.fromDom(e),WP);for(let o=0;o<s.length;o++){const r=s[o].dom;let a=r.previousSibling;if(Mi(a)){const i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,Fi(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},qP=(e,t,n,s)=>{const o=Ms();let r,a;const i=Ot(e),c=e.dom,l=(g,b)=>{let v;if(u(),VP(b))return null;if(n(b)){const y=mR(i,b,g),E=xb(t,b,g);c.setStyle(y,"top",E.top),c.setStyle(y,"caret-color","transparent"),a=y;const S=c.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});c.setStyles(S,{...E}),c.add(t,S),o.set({caret:S,element:b,before:g}),g&&c.addClass(S,"mce-visual-caret-before"),f(),v=b.ownerDocument.createRange(),v.setStart(y,0),v.setEnd(y,0)}else return a=dR(b,g),v=b.ownerDocument.createRange(),Ea(a.nextSibling)?(v.setStart(a,0),v.setEnd(a,0)):(v.setStart(a,1),v.setEnd(a,1)),v;return v},u=()=>{jP(t),a&&(yo(a),a=null),o.on(g=>{c.remove(g.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},f=()=>{r=setInterval(()=>{o.on(g=>{s()?c.toggleClass(g.caret,"mce-visual-caret-hidden"):c.addClass(g.caret,"mce-visual-caret-hidden")})},500)};return{show:l,hide:u,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(g=>{const b=xb(t,g.element,g.before);c.setStyles(g.caret,{...b})})},destroy:()=>clearInterval(r)}},Nb=()=>Ne.browser.isFirefox(),Ea=e=>zP(e)||HP(e),Sa=e=>(Ea(e)||ss(e)&&Nb())&&vi(C.fromDom(e)).exists(ro),KP=_n,Hu=ze,GP=os,Ab=xi("display","block table table-cell table-caption list-item"),Rb=fn,Tb=sr,YP=Z,XP=O,ZP=Vn,ar=e=>e>0,Eo=e=>e<0,Ki=(e,t)=>{let n;for(;n=e(t);)if(!Tb(n))return n;return null},wa=(e,t,n,s,o)=>{const r=new ht(e,s),a=Hu(e)||Tb(e);let i;if(Eo(t)){if(a&&(i=Ki(r.prev.bind(r),!0),n(i)))return i;for(;i=Ki(r.prev.bind(r),o);)if(n(i))return i}if(ar(t)){if(a&&(i=Ki(r.next.bind(r),!0),n(i)))return i;for(;i=Ki(r.next.bind(r),o);)if(n(i))return i}return null},QP=(e,t)=>{const n=o=>KP(o.dom),s=o=>o.dom===t;return ys(C.fromDom(e),n,s).map(o=>o.dom).getOr(t)},Ws=(e,t)=>{for(;e&&e!==t;){if(Ab(e))return e;e=e.parentNode}return null},as=(e,t,n)=>Ws(e.container(),n)===Ws(t.container(),n),Vu=(e,t)=>{if(!t)return m.none();const n=t.container(),s=t.offset();return YP(n)?m.from(n.childNodes[s+e]):m.none()},Pb=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},JP=(e,t,n)=>Ws(t,e)===Ws(n,e),Db=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";let o=n;for(;o&&o!==t;){let r=o[s];if(r&&Rb(r)&&(r=r[s]),Hu(r)||GP(r)){if(JP(t,r,o))return r;break}if(ZP(r))break;o=o.parentNode}return null},ka=G(Pb,!0),_a=G(Pb,!1),Wu=(e,t,n)=>{let s;const o=G(Db,!0,t),r=G(Db,!1,t),a=n.startContainer,i=n.startOffset;if(sr(a)){const c=XP(a)?a.parentNode:a,l=c.getAttribute("data-mce-caret");if(l==="before"&&(s=c.nextSibling,Sa(s)))return ka(s);if(l==="after"&&(s=c.previousSibling,Sa(s)))return _a(s)}if(!n.collapsed)return n;if(O(a)){if(Rb(a)){if(e===1){if(s=r(a),s)return ka(s);if(s=o(a),s)return _a(s)}if(e===-1){if(s=o(a),s)return _a(s);if(s=r(a),s)return ka(s)}return n}if(Mi(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?ka(s):n;if(Fi(a)&&i<=1)return e===-1&&(s=o(a),s)?_a(s):n;if(i===a.data.length)return s=r(a),s?ka(s):n;if(i===0)return s=o(a),s?_a(s):n}return n},Ob=(e,t)=>Vu(e?0:-1,t).filter(Hu),xa=(e,t,n)=>{const s=Wu(e,t,n);return e===-1?N.fromRangeStart(s):N.fromRangeEnd(s)},Gi=e=>m.from(e.getNode()).map(C.fromDom),eD=e=>m.from(e.getNode(!0)).map(C.fromDom),ju=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},Yi=(e,t)=>{const n=as(e,t);return!n&&Xe(e.getNode())?!0:n};var vt;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(vt||(vt={}));const tD=ze,is=O,Bb=Z,qu=Xe,ir=Vn,Ib=OR,Xi=Ph,nD=(e,t)=>{const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},Lb=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,$b=(e,t)=>{if(ar(e)){if(ir(t.previousSibling)&&!is(t.previousSibling))return N.before(t);if(is(t))return N(t,0)}if(Eo(e)){if(ir(t.nextSibling)&&!is(t.nextSibling))return N.after(t);if(is(t))return N(t,t.data.length)}return Eo(e)?qu(t)?N.before(t):N.after(t):N.before(t)},sD=(e,t)=>{const n=t.nextSibling;return n&&ir(n)?is(n)?N(n,0):N.before(n):Ku(vt.Forwards,N.after(t),e)},Ku=(e,t,n)=>{let s,o,r,a;if(!Bb(n)||!t)return null;if(t.isEqual(N.after(n))&&n.lastChild){if(a=N.after(n.lastChild),Eo(e)&&ir(n.lastChild)&&Bb(n.lastChild))return qu(n.lastChild)?N.before(n.lastChild):a}else a=t;const i=a.container();let c=a.offset();if(is(i)){if(Eo(e)&&c>0)return N(i,--c);if(ar(e)&&c<i.length)return N(i,++c);s=i}else{if(Eo(e)&&c>0&&(o=Lb(i,c-1),ir(o)))return!Ib(o)&&(r=wa(o,e,Xi,o),r)?is(r)?N(r,r.data.length):N.after(r):is(o)?N(o,o.data.length):N.before(o);if(ar(e)&&c<i.childNodes.length&&(o=Lb(i,c),ir(o)))return qu(o)?sD(n,o):!Ib(o)&&(r=wa(o,e,Xi,o),r)?is(r)?N(r,0):N.before(r):is(o)?N(o,0):N.after(o);s=o||a.getNode()}if(s&&(ar(e)&&a.isAtEnd()||Eo(e)&&a.isAtStart())&&(s=wa(s,e,ot,n,!0),Xi(s,n)))return $b(e,s);o=s&&wa(s,e,Xi,n);const l=to(le(nD(i,n),tD));return l&&(!o||!l.contains(o))?(ar(e)?a=N.after(l):a=N.before(l),a):o?$b(e,o):null},cs=e=>({next:t=>Ku(vt.Forwards,t,e),prev:t=>Ku(vt.Backwards,t,e)}),oD=(e,t,n)=>{const s=e?N.before(n):N.after(n);return dn(e,t,s)},rD=e=>Xe(e)?N.before(e):N.after(e),Fb=e=>N.isTextPosition(e)?e.offset()===0:Vn(e.getNode()),Mb=e=>{if(N.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return Vn(e.getNode(!0))},Ub=(e,t)=>!N.isTextPosition(e)&&!N.isTextPosition(t)&&e.getNode()===t.getNode(!0),aD=e=>!N.isTextPosition(e)&&Xe(e.getNode()),iD=(e,t,n)=>e?!Ub(t,n)&&!aD(t)&&Mb(t)&&Fb(n):!Ub(n,t)&&Fb(t)&&Mb(n),dn=(e,t,n)=>{const s=cs(t);return m.from(e?s.next(n):s.prev(n))},cr=(e,t,n)=>dn(e,t,n).bind(s=>as(n,s,t)&&iD(e,n,s)?dn(e,t,s):m.some(s)),zb=(e,t,n,s)=>cr(e,t,n).bind(o=>s(o)?zb(e,t,o,s):m.some(o)),lr=(e,t)=>{const n=e?t.firstChild:t.lastChild;return O(n)?m.some(N(n,e?0:n.data.length)):n?Vn(n)?m.some(e?N.before(n):rD(n)):oD(e,t,n):m.none()},jt=G(dn,!0),Xt=G(dn,!1),Bt=G(lr,!0),xn=G(lr,!1),Gu="_mce_caret",mn=e=>Z(e)&&e.id===Gu,So=(e,t)=>{let n=t;for(;n&&n!==e;){if(mn(n))return n;n=n.parentNode}return null},cD=e=>ee(e.start),lD=e=>de(e,"rng"),uD=e=>de(e,"id"),Hb=e=>de(e,"name"),Vb=e=>$.isArray(e.start),Zi=e=>!Hb(e)&&Ps(e.forward)?e.forward:!0,Wb=(e,t)=>(Z(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),fD=(e,t)=>{const n=m.from(Vh(e.getRoot(),t.start)),s=m.from(Vh(e.getRoot(),t.end));return Rt(n,s,(o,r)=>{const a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:Zi(t)}})},dD=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(mt);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},mD=e=>!e.hasChildNodes(),pD=(e,t)=>xn(e).fold(qe,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),jb=(e,t,n)=>mD(t)&&So(e,t)?(dD(t,n),!0):!1,qb=(e,t,n,s)=>{const o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let c=o.length-1;a&&c>=1;c--){const l=a.childNodes;if(jb(r,a,s))return!0;if(o[c]>l.length-1)return jb(r,a,s)?!0:pD(a,s);a=l[o[c]]}O(a)&&(i=Math.min(o[0],a.data.length)),Z(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Yu=e=>O(e)&&e.data.length>0,Kb=(e,t,n)=>{const s=e.get(n.id+"_"+t),o=s==null?void 0:s.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):Yu(s.nextSibling)?(a=s.nextSibling,i=0):Yu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):Yu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){const c=s.previousSibling,l=s.nextSibling;$.each($.grep(s.childNodes),f=>{O(f)&&(f.data=f.data.replace(/\uFEFF/g,""))});let u;for(;u=e.get(n.id+"_"+t);)e.remove(u,!0);if(O(l)&&O(c)&&!Ne.browser.isOpera()){const f=c.data.length;c.appendData(l.data),e.remove(l),a=c,i=f}}return m.some(N(a,i))}else return m.none()},gD=(e,t)=>{const n=e.createRng();return qb(e,!0,t,n)&&qb(e,!1,t,n)?m.some({range:n,forward:Zi(t)}):m.none()},hD=(e,t)=>{const n=Kb(e,"start",t),s=Kb(e,"end",t);return Rt(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(Wb(e,o.container()),o.offset()),a.setEnd(Wb(e,r.container()),r.offset()),{range:a,forward:Zi(t)}})},bD=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),CD=(e,t)=>{const n=e.dom;if(t){if(Vb(t))return gD(n,t);if(cD(t))return fD(n,t);if(uD(t))return hD(n,t);if(Hb(t))return bD(n,t);if(lD(t))return m.some({range:t.rng,forward:Zi(t)})}return m.none()},vD=(e,t,n)=>QR(e,t,n),yD=(e,t)=>{CD(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},pn=e=>Z(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Qi=(e=>t=>e===t)(bt),ur=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Xu=e=>!ur(e)&&!Qi(e)&&!Xl(e),Zu=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},ED=e=>ln(e,t=>{const n=Ui(t);return n?[C.fromDom(n)]:[]}),SD=e=>Zu(e).length>1,wD=e=>le(ED(e),ma),kD=e=>Pt(e,"td[data-mce-selected],th[data-mce-selected]"),Gb=(e,t)=>{const n=kD(t);return n.length>0?n:wD(e)},fr=e=>Gb(Zu(e.selection.getSel()),C.fromDom(e.getBody())),Na=(e,t)=>Zr(e,"table",t),_D=e=>{const t=e.startContainer,n=e.startOffset;return O(t)?n===0?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n]).map(C.fromDom)},xD=e=>{const t=e.endContainer,n=e.endOffset;return O(t)?n===t.data.length?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(C.fromDom)},Yb=e=>Ul(e).fold(j([e]),t=>[e].concat(Yb(t))),Qu=e=>zl(e).fold(j([e]),t=>_e(t)==="br"?so(t).map(n=>[e].concat(Qu(n))).getOr([]):[e].concat(Qu(t))),Ju=(e,t)=>Rt(_D(t),xD(t),(n,s)=>{const o=ft(Yb(e),G(Te,n)),r=ft(Qu(e),G(Te,s));return o.isSome()&&r.isSome()}).getOr(!1),ef=(e,t,n,s)=>{const o=n,r=new ht(n,o),a=Ur(e.schema.getMoveCaretBeforeOnEnterElements(),(c,l)=>!Ie(["td","th","table"],l.toLowerCase()));let i=n;do{if(O(i)&&$.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Ji=e=>{const t=e.selection.getSel();return V(t)&&t.rangeCount>0},tf=(e,t)=>{const n=fr(e);n.length>0?T(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},Xb=(e,t,n)=>{const s=Xh(e,t);n(s),e.moveToBookmark(s)},Aa=e=>$n(e==null?void 0:e.nodeType),nf=e=>Z(e)&&!pn(e)&&!mn(e)&&!co(e),ND=(e,t)=>{if(nf(t)&&!/^(TD|TH)$/.test(t.nodeName)){const n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},Zb=(e,t,n)=>{const{selection:s,dom:o}=e,r=s.getNode(),a=ze(r);Xb(s,!0,()=>{t()}),a&&ze(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&AD(o,s)},AD=(e,t)=>{var n,s;const o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!ND(e,i)&&Z(r)){const c=r.childNodes,l=e.getRoot();let u;if(a<c.length){const f=c[a];u=new ht(f,(n=e.getParent(f,e.isBlock))!==null&&n!==void 0?n:l)}else{const f=c[c.length-1];u=new ht(f,(s=e.getParent(f,e.isBlock))!==null&&s!==void 0?s:l),u.next(!0)}for(let f=u.current();f;f=u.next()){if(e.getContentEditable(f)==="false")return;if(O(f)&&!of(f)){o.setStart(f,0),t.setRng(o);return}}}},Qb=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(Z(e)||!of(e))return e}},sf=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||uo(e,t),dr=(e,t,n)=>e.schema.isValidChild(t,n),of=(e,t=!1)=>{if(V(e)&&O(e)){const n=t?e.data.replace(/ /g," "):e.data;return Qo(n)}else return!1},RD=e=>V(e)&&O(e)&&e.length===0,TD=(e,t)=>{const n="[data-mce-cef-wrappable]",s=zT(e),o=Vr(s)?n:`${n},${s}`;return Fn(C.fromDom(t),o)},Jb=(e,t)=>{const n=e.dom;return nf(t)&&n.getContentEditable(t)==="false"&&TD(e,t)&&n.select('[contenteditable="true"]',t).length===0},js=(e,t)=>Be(e)?e(t):(V(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),rf=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),af=(e,t)=>{if(it(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=sa(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},ec=(e,t,n)=>{const s=e.getStyle(t,n);return af(s,n)},eC=(e,t)=>{let n;return e.getParent(t,s=>Z(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},tc=(e,t,n)=>e.getParents(t,n,e.getRoot()),cf=(e,t,n)=>{const s=e.formatter.get(t);return V(s)&&Je(s,n)},PD=(e,t)=>cf(e,t,s=>{const o=r=>Be(r)||r.length>1&&r.charAt(0)==="%";return Je(["styles","attributes"],r=>We(s,r).exists(a=>{const i=tt(a)?a:Tl(a);return Je(i,o)}))}),DD=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>Ur(r,(a,i)=>Je(s,c=>c===i));return cf(e,t,r=>{const a=o(r);return cf(e,n,i=>{const c=o(i);return q_(a,c)})})},ls=e=>Ho(e,"block"),OD=e=>ls(e)&&e.wrapper===!0,BD=e=>ls(e)&&e.wrapper!==!0,gn=e=>Ho(e,"selector"),pt=e=>Ho(e,"inline"),ID=e=>gn(e)&&pt(e)&&Wo(We(e,"mixed"),!0),lf=e=>gn(e)&&e.expand!==!1&&!pt(e),LD=e=>{const t=[];let n=e;for(;n;){if(O(n)&&n.data!==mt||n.childNodes.length>1)return[];Z(n)&&t.push(n),n=n.firstChild}return t},tC=e=>LD(e).length>0,uf=e=>mn(e.dom)&&tC(e.dom),mr=pn,nC=tc,sC=of,$D=sf,FD=e=>Xe(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,oC=(e,t)=>{let n=t;for(;n;){if(Z(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},rC=(e,t,n,s)=>{const o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},MD=(e,t,n)=>rC(e,t,n,s=>Qi(s)||ur(s)),UD=(e,t,n)=>rC(e,t,n,Xu),aC=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,e.isBlock)||t,c=(u,f,d)=>{const p=ho(e),h=o?p.backwards:p.forwards;return m.from(h(u,f,(g,b)=>mr(g.parentNode)?-1:(a=g,d(o,g,b)),i))};return c(n,s,MD).bind(u=>r?c(u.container,u.offset+(o?-1:0),UD):m.some(u)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},iC=(e,t,n,s,o)=>{const r=s[o];O(s)&&Vr(s.data)&&r&&(s=r);const a=nC(e,s);for(let i=0;i<a.length;i++)for(let c=0;c<t.length;c++){const l=t[c];if(!(V(l.collapsed)&&l.collapsed!==n.collapsed)&&gn(l)&&e.is(a[i],l.selector))return a[i]}return s},cC=(e,t,n,s)=>{var o;let r=n;const a=e.getRoot(),i=t[0];if(ls(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){const c=(o=e.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&o!==void 0?o:a;r=e.getParent(O(n)?n.parentNode:n,l=>l!==a&&$D(e.schema,l),c)}if(r&&ls(i)&&i.wrapper&&(r=nC(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!rf(r,"br")););return r||n},lC=(e,t,n,s)=>{const o=n.parentNode;return V(n[s])?!1:o===t||it(o)||e.isBlock(o)?!0:lC(e,t,o,s)},nc=(e,t,n,s,o)=>{let r=n;const a=o?"previousSibling":"nextSibling",i=e.getRoot();if(O(n)&&!sC(n)&&(o?s>0:s<n.data.length))return n;for(;r;){if(!t[0].block_expand&&e.isBlock(r))return r;for(let c=r[a];c;c=c[a]){const l=O(c)&&!lC(e,i,c,a);if(!mr(c)&&!FD(c)&&!sC(c,l))return r}if(r===i||r.parentNode===i){n=r;break}r=r.parentNode}return n},uC=e=>mr(e.parentNode)||mr(e),wo=(e,t,n,s=!1)=>{let{startContainer:o,startOffset:r,endContainer:a,endOffset:i}=t;const c=n[0];return Z(o)&&o.hasChildNodes()&&(o=Hs(o,r),O(o)&&(r=0)),Z(a)&&a.hasChildNodes()&&(a=Hs(a,t.collapsed?i:i-1),O(a)&&(i=a.data.length)),o=oC(e,o),a=oC(e,a),uC(o)&&(o=mr(o)?o:o.parentNode,t.collapsed?o=o.previousSibling||o:o=o.nextSibling||o,O(o)&&(r=t.collapsed?o.length:0)),uC(a)&&(a=mr(a)?a:a.parentNode,t.collapsed?a=a.nextSibling||a:a=a.previousSibling||a,O(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(aC(e,e.getRoot(),o,r,!0,s).each(({container:f,offset:d})=>{o=f,r=d}),aC(e,e.getRoot(),a,i,!1,s).each(({container:f,offset:d})=>{a=f,i=d})),(pt(c)||c.block_expand)&&((!pt(c)||!O(o)||r===0)&&(o=nc(e,n,o,r,!0)),(!pt(c)||!O(a)||i===a.data.length)&&(a=nc(e,n,a,i,!1))),lf(c)&&(o=iC(e,n,t,o,"previousSibling"),a=iC(e,n,t,a,"nextSibling")),(ls(c)||gn(c))&&(o=cC(e,n,o,"previousSibling"),a=cC(e,n,a,"nextSibling"),ls(c)&&(e.isBlock(o)||(o=nc(e,n,o,r,!0),O(o)&&(r=0)),e.isBlock(a)||(a=nc(e,n,a,i,!1),O(a)&&(i=a.data.length)))),Z(o)&&o.parentNode&&(r=e.nodeIndex(o),o=o.parentNode),Z(a)&&a.parentNode&&(i=e.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:r,endContainer:a,endOffset:i}},Ra=(e,t,n)=>{var s;const o=t.startOffset,r=Hs(t.startContainer,o),a=t.endOffset,i=Hs(t.endContainer,a-1),c=b=>{const v=b[0];O(v)&&v===r&&o>=v.data.length&&b.splice(0,1);const y=b[b.length-1];return a===0&&b.length>0&&y===i&&O(y)&&b.splice(b.length-1,1),b},l=(b,v,y)=>{const E=[];for(;b&&b!==y;b=b[v])E.push(b);return E},u=(b,v)=>e.getParent(b,y=>y.parentNode===v,v),f=(b,v,y)=>{const E=y?"nextSibling":"previousSibling";for(let S=b,R=S.parentNode;S&&S!==v;S=R){R=S.parentNode;const B=l(S===b?S:S[E],E);B.length&&(y||B.reverse(),n(c(B)))}};if(r===i)return n(c([r]));const d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return f(r,d,!0);if(e.isChildOf(i,r))return f(i,d);const p=u(r,d)||r,h=u(i,d)||i;f(r,p,!0);const g=l(p===r?p:p.nextSibling,"nextSibling",h===i?h.nextSibling:h);g.length&&n(c(g)),f(i,h)},zD=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],HD=e=>un(e)&&Ii(e)===mt,VD=(e,t,n,s)=>Mn(t).fold(()=>"skipping",o=>s==="br"||HD(t)?"valid":VA(t)?"existing":mn(t.dom)?"caret":Je(zD,r=>Fn(t,r))?"valid-block":!dr(e,n,s)||!dr(e,_e(o),n)?"invalid-child":"valid"),WD=(e,t)=>{const n=wo(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},fC=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;qo(e,ia()),St(e,`${er()}`,a),St(e,`${po()}`,s);const{attributes:c={},classes:l=[]}=o(a,i);if(hs(e,c),KA(e,l),r){l.length>0&&St(e,`${la()}`,l.join(","));const u=Gt(c);u.length>0&&St(e,`${ua()}`,u.join(","))}},jD=e=>{Kr(e,ia()),wt(e,`${er()}`),wt(e,`${po()}`),wt(e,`${ca()}`);const t=bs(e,`${ua()}`).map(s=>s.split(",")).getOr([]),n=bs(e,`${la()}`).map(s=>s.split(",")).getOr([]);T(t,s=>wt(e,s)),GA(e,n),wt(e,`${la()}`),wt(e,`${ua()}`)},dC=(e,t,n,s,o)=>{const r=C.fromTag("span",e);return fC(r,t,n,s,o,!1),r},qD=(e,t,n,s,o,r)=>{const a=[],i=dC(e.getDoc(),n,r,s,o),c=Ms(),l=()=>{c.clear()},u=()=>c.get().getOrThunk(()=>{const h=go(i);return a.push(h),c.set(h),h}),f=h=>{T(h,d)},d=h=>{switch(VD(e,h,"span",_e(h))){case"invalid-child":{l();const b=Tt(h);f(b),l();break}case"valid-block":{l(),fC(h,n,r,s,o,!0);break}case"valid":{const b=u();Eg(h,b);break}}},p=h=>{const g=ke(h,C.fromDom);f(g)};return Ra(e.dom,t,h=>{l(),p(h)}),a},KD=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=fr(e).length>0,i=fa("mce-annotation");if(r.collapsed&&!a&&WD(e,r),o.getRng().collapsed&&!a){const c=dC(e.getDoc(),i,s,t,n.decorate);wi(c,bt),o.getRng().insertNode(c.dom),o.select(c.dom)}else Xb(o,!1,()=>{tf(e,c=>{qD(e,c,i,t,n.decorate,s)})})})},mC=e=>{const t=qA();jA(e,t);const n=WA(e,t),s=Ci("span"),o=r=>{T(r,a=>{s(a)?Is(a):jD(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{KD(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{ph(e,m.some(r)).each(({elements:a})=>{const i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{const a=e.selection.getBookmark();Ue(bh(e,r),(i,c)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=bh(e,r);return Mr(a,i=>ke(i,c=>c.dom))}}},Ta=e=>({getBookmark:G(vD,e),moveToBookmark:G(yD,e)});Ta.isBookmarkNode=pn;const pC=(e,t,n)=>n.collapsed?!1:Je(n.getClientRects(),s=>hR(s,e,t)),GD=(e,t)=>e.dispatch("PreProcess",t),YD=(e,t)=>e.dispatch("PostProcess",t),XD=e=>{e.dispatch("remove")},ZD=e=>{e.dispatch("detach")},QD=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},JD=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},e1=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},t1=e=>{e.dispatch("PreInit")},n1=e=>{e.dispatch("PostRender")},s1=e=>{e.dispatch("Init")},o1=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},gC=(e,t,n)=>{e.dispatch(t,n)},hC=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},bC=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},r1=(e,t)=>e.dispatch("BeforeSetContent",t),CC=(e,t)=>e.dispatch("SetContent",t),a1=(e,t)=>e.dispatch("BeforeGetContent",t),vC=(e,t)=>e.dispatch("GetContent",t),i1=(e,t)=>{e.dispatch("AutocompleterStart",t)},c1=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},ff=(e,t)=>{e.dispatch("AutocompleterUpdateActiveRange",t)},l1=e=>{e.dispatch("AutocompleterEnd")},u1=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),f1=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),yC=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),d1=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),K={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||K.metaKeyPressed(e),metaKeyPressed:e=>Ne.os.isMacOS()||Ne.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},ko="data-mce-selected",m1="table,img,figure.image,hr,video,span.mce-preview-object,details",EC=Math.abs,sc=Math.round,df={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},p1=e=>e.type==="longpress"||e.type.indexOf("touch")===0,SC=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,c,l,u,f,d,p,h,g,b,v,y,E,S,R,B;const z=H=>V(H)&&(Bg(H)||n.is(H,"figure.image")),P=H=>os(H)||n.hasClass(H,"mce-preview-object"),x=(H,me)=>{if(p1(H)){const be=H.touches[0];return z(H.target)&&!pC(be.clientX,be.clientY,me)}else return z(H.target)&&!pC(H.clientX,H.clientY,me)},A=H=>{const me=H.target;x(H,t.selection.getRng())&&!H.isDefaultPrevented()&&t.selection.select(me)},U=H=>n.hasClass(H,"mce-preview-object")&&V(H.firstElementChild)?[H,H.firstElementChild]:n.is(H,"figure.image")?[H.querySelector("img")]:[H],Q=H=>{const me=db(t);return!me||H.getAttribute("data-mce-resize")==="false"||H===t.getBody()?!1:n.hasClass(H,"mce-preview-object")&&V(H.firstElementChild)?Fn(C.fromDom(H.firstElementChild),me):Fn(C.fromDom(H),me)},fe=(H,me)=>{if(P(me))return H.create("img",{src:Ne.transparentSrc});if(ss(me)){const rt=dt(l.name,"n")?Vt:Os,Re=me.cloneNode(!0);return rt(H.select("tr",Re)).each(nt=>{const En=H.select("td,th",nt);H.setStyle(nt,"height",null),T(En,Yn=>H.setStyle(Yn,"height",null))}),Re}else return me.cloneNode(!0)},ye=(H,me,be)=>{if(V(be)){const rt=U(H);T(rt,Re=>{Re.style[me]||!t.schema.isValid(Re.nodeName.toLowerCase(),me)?n.setStyle(Re,me,be):n.setAttrib(Re,me,""+be)})}},Ae=(H,me,be)=>{ye(H,"width",me),ye(H,"height",be)},De=H=>{let me,be,rt,Re,nt;me=H.screenX-f,be=H.screenY-d,E=me*l[2]+g,S=be*l[3]+b,E=E<5?5:E,S=S<5?5:S,(z(a)||P(a))&&OT(t)!==!1?rt=!K.modifierPressed(H):rt=K.modifierPressed(H),rt&&(EC(me)>EC(be)?(S=sc(E*v),E=sc(S/v)):(E=sc(S/v),S=sc(E*v))),Ae(i,E,S),Re=l.startPos.x+me,nt=l.startPos.y+be,Re=Re>0?Re:0,nt=nt>0?nt:0,n.setStyles(c,{left:Re,top:nt,display:"block"}),c.innerHTML=E+" &times; "+S,l[2]<0&&i.clientWidth<=E&&n.setStyle(i,"left",p+(g-E)),l[3]<0&&i.clientHeight<=S&&n.setStyle(i,"top",h+(b-S)),me=r.scrollWidth-R,be=r.scrollHeight-B,me+be!==0&&n.setStyles(c,{left:Re-me,top:nt-be}),y||(JD(t,a,g,b,"corner-"+l.name),y=!0)},Le=()=>{const H=y;y=!1,H&&(ye(a,"width",E),ye(a,"height",S)),n.unbind(s,"mousemove",De),n.unbind(s,"mouseup",Le),o!==s&&(n.unbind(o,"mousemove",De),n.unbind(o,"mouseup",Le)),n.remove(i),n.remove(c),n.remove(u),yt(a),H&&(e1(t,a,E,S,"corner-"+l.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},yt=H=>{M();const me=n.getPos(H,r),be=me.x,rt=me.y,Re=H.getBoundingClientRect(),nt=Re.width||Re.right-Re.left,En=Re.height||Re.bottom-Re.top;a!==H&&(F(),a=H,E=S=0);const Yn=t.dispatch("ObjectSelected",{target:H});Q(H)&&!Yn.isDefaultPrevented()?Ue(df,(It,Qt)=>{const Sn=wn=>{const J=U(a)[0];f=wn.screenX,d=wn.screenY,g=J.clientWidth,b=J.clientHeight,v=b/g,l=It,l.name=Qt,l.startPos={x:nt*It[0]+be,y:En*It[1]+rt},R=r.scrollWidth,B=r.scrollHeight,u=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=fe(n,a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:be,top:rt,margin:0}),Ae(i,nt,En),i.removeAttribute(ko),r.appendChild(i),n.bind(s,"mousemove",De),n.bind(s,"mouseup",Le),o!==s&&(n.bind(o,"mousemove",De),n.bind(o,"mouseup",Le)),c=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+b)};let Jt=n.get("mceResizeHandle"+Qt);Jt&&n.remove(Jt),Jt=n.add(r,"div",{id:"mceResizeHandle"+Qt,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+Qt+"-resize; margin:0; padding:0"}),n.bind(Jt,"mousedown",wn=>{wn.stopImmediatePropagation(),wn.preventDefault(),Sn(wn)}),It.elm=Jt,n.setStyles(Jt,{left:nt*It[0]+be-Jt.offsetWidth/2,top:En*It[1]+rt-Jt.offsetHeight/2})}):F(!1)},Oe=Bi(yt,0),F=(H=!0)=>{Oe.cancel(),M(),a&&H&&a.removeAttribute(ko),Ue(df,(me,be)=>{const rt=n.get("mceResizeHandle"+be);rt&&(n.unbind(rt),n.remove(rt))})},X=(H,me)=>n.isChildOf(H,me),we=H=>{if(y||t.removed||t.composing)return;const me=H.type==="mousedown"?H.target:e.getNode(),be=Yo(C.fromDom(me),m1).map(Re=>Re.dom).filter(Re=>n.isEditable(Re.parentElement)||Re.nodeName==="IMG"&&n.isEditable(Re)).getOrUndefined(),rt=V(be)?n.getAttrib(be,ko,"1"):"1";if(T(n.select(`img[${ko}],hr[${ko}]`),Re=>{Re.removeAttribute(ko)}),V(be)&&X(be,r)&&t.hasFocus()){te();const Re=e.getStart(!0);if(X(Re,be)&&X(e.getEnd(!0),be)){n.setAttrib(be,ko,rt),Oe.throttle(be);return}}F()},M=()=>{Ue(df,H=>{H.elm&&(n.unbind(H.elm),delete H.elm)})},te=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{te(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",we),t.on("keyup compositionend",H=>{a&&a.nodeName==="TABLE"&&we(H)}),t.on("hide blur",F),t.on("contextmenu longpress",A,!0)}),t.on("remove",M),{isResizable:Q,showResizeRect:yt,hideResizeRect:F,updateResizeRect:we,destroy:()=>{Oe.cancel(),a=i=u=null}}},g1=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},h1=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},wC=(e,t,n)=>{const s=e.document.createRange();return g1(s,t),h1(s,n),s},mf=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},Pa=rs.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),kC=(e,t,n)=>t(C.fromDom(n.startContainer),n.startOffset,C.fromDom(n.endContainer),n.endOffset),b1=(e,t)=>t.match({domRange:n=>({ltr:j(n),rtl:m.none}),relative:(n,s)=>({ltr:Zn(()=>wC(e,n,s)),rtl:Zn(()=>m.some(wC(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Zn(()=>mf(e,n,s,o,r)),rtl:Zn(()=>m.some(mf(e,o,r,n,s)))})}),C1=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>Pa.rtl(C.fromDom(o.endContainer),o.endOffset,C.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>kC(e,Pa.ltr,n)):kC(e,Pa.ltr,n)},v1=(e,t)=>{const n=b1(e,t);return C1(e,n)};Pa.ltr,Pa.rtl;const _C={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},y1=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(s,t,n)).bind(r=>{if(r.offsetNode===null)return m.none();const a=e.dom.createRange();return a.setStart(r.offsetNode,r.offset),a.collapse(),m.some(a)})},E1=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(s,t,n))},S1=document.caretPositionFromPoint?y1:document.caretRangeFromPoint?E1:m.none,w1=(e,t,n)=>{const s=C.fromDom(e.document);return S1(s,t,n).map(o=>_C.create(C.fromDom(o.startContainer),o.startOffset,C.fromDom(o.endContainer),o.endOffset))},pf=rs.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),k1=(e,t,n,s)=>e.fold(t,n,s),_1=e=>e.fold(Ht,Ht,Ht),x1=pf.before,N1=pf.on,A1=pf.after,_s={before:x1,on:N1,after:A1,cata:k1,getStart:_1},oc=rs.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),R1=e=>oc.exact(e.start,e.soffset,e.finish,e.foffset),T1=e=>e.match({domRange:t=>C.fromDom(t.startContainer),relative:(t,n)=>_s.getStart(t),exact:(t,n,s,o)=>t}),P1=oc.domRange,D1=oc.relative,O1=oc.exact,B1=e=>{const t=T1(e);return Yr(t)},I1=_C.create,pr={domRange:P1,relative:D1,exact:O1,exactFromRange:R1,getWin:B1,range:I1},rc=(e,t)=>{const n=_e(e);return n==="input"?_s.after(e):Ie(["br","img"],n)?t===0?_s.before(e):_s.after(e):_s.on(e,t)},L1=(e,t)=>{const n=e.fold(_s.before,rc,_s.after),s=t.fold(_s.before,rc,_s.after);return pr.relative(n,s)},xC=(e,t,n,s)=>{const o=rc(e,t),r=rc(n,s);return pr.relative(o,r)},$1=e=>e.match({domRange:t=>{const n=C.fromDom(t.startContainer),s=C.fromDom(t.endContainer);return xC(n,t.startOffset,s,t.endOffset)},relative:L1,exact:xC}),gf=(e,t)=>{const s=(t||document).createDocumentFragment();return T(e,o=>{s.appendChild(o.dom)}),C.fromDom(s)},F1=e=>{const t=pr.getWin(e).dom,n=(o,r,a,i)=>mf(t,o,r,a,i),s=$1(e);return v1(t,s).match({ltr:n,rtl:n})},M1=(e,t,n)=>w1(e,t,n),NC=(e,t,n)=>{const s=Yr(C.fromDom(n));return M1(s.dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},hf=(e,t)=>V(e)&&V(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,U1=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},AC=(e,t,n)=>U1(e,t,n)!==null,z1=(e,t,n)=>AC(e,t,s=>s.nodeName===n),H1=(e,t)=>fn(e)&&!AC(e,t,mn),RC=(e,t,n)=>{const s=t.parentNode;if(s){const o=new ht(t,e.getParent(s,e.isBlock)||e.getRoot());let r;for(;r=o[n?"prev":"next"]();)if(Xe(r))return!0}return!1},V1=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},W1=(e,t)=>{let n=t;for(;n&&n!==e;){if(ze(n))return!0;n=n.parentNode}return!1},bf=(e,t,n,s,o)=>{const r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode;let c,l;if(!i)return m.none();const u=e.getParent(i,e.isBlock)||r;if(s&&Xe(o)&&t&&e.isEmpty(u))return m.some(N(i,e.nodeIndex(o)));const f=new ht(o,u);for(;l=f[s?"prev":"next"]();){if(e.getContentEditableParent(l)==="false"||H1(l,r))return m.none();if(O(l)&&l.data.length>0)return z1(l,r,"A")?m.none():m.some(N(l,s?l.data.length:0));if(e.isBlock(l)||a[l.nodeName.toLowerCase()])return m.none();c=l}return Ls(c)?m.none():n&&c?m.some(N(c,0)):m.none()},TC=(e,t,n,s)=>{const o=e.getRoot();let r,a=!1,i=n?s.startContainer:s.endContainer,c=n?s.startOffset:s.endOffset;const l=Z(i)&&c===i.childNodes.length,u=e.schema.getNonEmptyElements();let f=n;if(fn(i))return m.none();if(Z(i)&&c>i.childNodes.length-1&&(f=!1),ta(i)&&(i=o,c=0),i===o){if(f&&(r=i.childNodes[c>0?c-1:0],r&&(fn(r)||u[r.nodeName]||ss(r))))return m.none();if(i.hasChildNodes()){if(c=Math.min(!f&&c>0?c-1:c,i.childNodes.length-1),i=i.childNodes[c],c=O(i)&&l?i.data.length:0,!t&&i===o.lastChild&&ss(i)||W1(o,i)||fn(i)||Jl(i))return m.none();if(i.hasChildNodes()&&!ss(i)){r=i;const d=new ht(i,o);do{if(ze(r)||fn(r)){a=!1;break}if(O(r)&&r.data.length>0){c=f?0:r.data.length,i=r,a=!0;break}if(u[r.nodeName.toLowerCase()]&&!xN(r)){c=e.nodeIndex(r),i=r.parentNode,f||c++,a=!0;break}}while(r=f?d.next():d.prev())}}}return t&&(O(i)&&c===0&&bf(e,l,t,!0,i).each(d=>{i=d.container(),c=d.offset(),a=!0}),Z(i)&&(r=i.childNodes[c],r||(r=i.childNodes[c-1]),r&&Xe(r)&&!V1(r,"A")&&!RC(e,r,!1)&&!RC(e,r,!0)&&bf(e,l,t,!0,r).each(d=>{i=d.container(),c=d.offset(),a=!0}))),f&&!t&&O(i)&&c===i.data.length&&bf(e,l,t,!1,i).each(d=>{i=d.container(),c=d.offset(),a=!0}),a&&i?m.some(N(i,c)):m.none()},ac=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=N.fromRangeStart(t);return TC(e,n,!0,s).each(r=>{(!n||!N.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||TC(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),hf(t,s)?m.none():m.some(s)},ic=(e,t)=>e.splitText(t),cc=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&O(t)){if(n>0&&n<t.data.length)if(s=ic(t,n),t=s.previousSibling,o>n){o=o-n;const r=ic(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(O(t)&&n>0&&n<t.data.length&&(t=ic(t,n),n=0),O(s)&&o>0&&o<s.data.length){const r=ic(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},_o=e=>({walk:(r,a)=>Ra(e,r,a),split:cc,expand:(r,a={type:"word"})=>{if(a.type==="word"){const i=wo(e,r,[{inline:"span"}]),c=e.createRng();return c.setStart(i.startContainer,i.startOffset),c.setEnd(i.endContainer,i.endOffset),c}return r},normalize:r=>ac(e,r).fold(qe,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});_o.compareRanges=hf,_o.getCaretRangeFromPoint=NC,_o.getSelectedNode=Ui,_o.getNode=Hs;const j1=((e,t)=>{const n=(i,c)=>{if(!$n(c)&&!c.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+c);const l=i.dom;Qr(l)&&(l.style[e]=c+"px")},s=i=>{const c=t(i);if(c<=0||c===null){const l=ns(i,e);return parseFloat(l)||0}return c},o=s,r=(i,c)=>Kt(c,(l,u)=>{const f=ns(i,u),d=f===void 0?0:parseInt(f,10);return isNaN(d)?l:l+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,c,l)=>{const u=r(i,l);return c>u?c-u:0}}})("height",e=>{const t=e.dom;return Go(e)?t.getBoundingClientRect().height:t.offsetHeight}),q1=e=>j1.get(e),PC=()=>C.fromDom(document),DC=(e,t)=>e.view(t).fold(j([]),s=>{const o=e.owner(s),r=DC(e,o);return[s].concat(r)}),K1=(e,t)=>{const n=t.owner(e);return DC(t,n)};var G1=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(C.fromDom)},owner:e=>vs(e)});const Y1=e=>{const t=PC(),n=Yl(t),s=K1(e,G1),o=Gl(e),r=Ir(s,(a,i)=>{const c=Gl(i);return{left:a.left+c.left,top:a.top+c.top}},{left:0,top:0});return Zo(r.left+o.left+n.left,r.top+o.top+n.top)},Cf=e=>_e(e)==="textarea",X1=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),Z1=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},Q1=(e,t)=>{const n=Tt(e);if(n.length===0||Cf(e))return{element:e,offset:t};if(t<n.length&&!Cf(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return Cf(s)?{element:e,offset:t}:_e(s)==="img"?{element:s,offset:1}:un(s)?{element:s,offset:Ii(s).length}:{element:s,offset:Tt(s).length}}},OC=(e,t)=>{const n=dN(e),s=q1(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},J1=(e,t)=>{const n=Q1(e,t),s=C.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+mt+"</span>");return Yt(n.element,s),OC(s,()=>je(s))},eO=e=>OC(C.fromDom(e),he),BC=(e,t,n,s)=>{nO(e,(o,r)=>tO(e,t,n,s),n)},IC=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(X1(e,r))return;const a=Yl(t).top;n(e,t,a,s,o),Z1(e,r)},tO=(e,t,n,s)=>{const o=C.fromDom(e.getBody()),r=C.fromDom(e.getDoc());tN(o);const a=J1(C.fromDom(n.startContainer),n.startOffset);IC(e,r,t,a,s),a.cleanup()},LC=(e,t,n,s)=>{const o=C.fromDom(e.getDoc());IC(e,o,n,eO(t),s)},nO=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(C.fromDom(s),C.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},vf=(e,t,n,s,o)=>{const r=t.pos;if(s)kg(r.left,r.top,o);else{const a=r.top-n+t.height;kg(-e.getBody().getBoundingClientRect().left,a,o)}},$C=(e,t,n,s,o,r)=>{const a=s+n,i=o.pos.top,c=o.bottom,l=c-i>=s;i<n?vf(e,o,s,r!==!1,t):i>a?vf(e,o,s,l?r!==!1:r===!0,t):c>a&&!l&&vf(e,o,s,r===!0,t)},FC=(e,t,n,s,o)=>{const r=Yr(t).dom.innerHeight;$C(e,t,n,r,s,o)},MC=(e,t,n,s,o)=>{const r=Yr(t).dom.innerHeight;$C(e,t,n,r,s,o);const a=Y1(s.element),i=Ng(window);a.top<i.y?_g(s.element,o!==!1):a.top>i.bottom&&_g(s.element,o===!0)},sO=(e,t,n)=>BC(e,FC,t,n),oO=(e,t,n)=>LC(e,t,FC,n),rO=(e,t,n)=>BC(e,MC,t,n),aO=(e,t,n)=>LC(e,t,MC,n),iO=(e,t,n)=>{(e.inline?oO:aO)(e,t,n)},Da=(e,t,n)=>{(e.inline?sO:rO)(e,t,n)},UC=(e,t=!1)=>e.dom.focus({preventScroll:t}),zC=e=>{const t=Bs(e).dom;return e.dom===t.activeElement},yf=(e=PC())=>m.from(e.dom.activeElement).map(C.fromDom),cO=e=>yf(Bs(e)).filter(t=>e.dom.contains(t.dom)),HC=(e,t)=>{const n=un(t)?Ii(t).length:Tt(t).length+1;return e>n?n:e<0?0:e},lO=e=>pr.range(e.start,HC(e.soffset,e.start),e.finish,HC(e.foffset,e.finish)),VC=(e,t)=>!_i(t.dom)&&(Cs(e,t)||Te(e,t)),WC=e=>t=>VC(e,t.start)&&VC(e,t.finish),uO=e=>e.inline||Ne.browser.isFirefox(),fO=e=>pr.range(C.fromDom(e.startContainer),e.startOffset,C.fromDom(e.endContainer),e.endOffset),dO=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(fO)},mO=e=>{const t=Yr(e);return dO(t.dom).filter(WC(e))},pO=(e,t)=>m.from(t).filter(WC(e)).map(lO),gO=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},lc=e=>{const t=uO(e)?mO(C.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},Ef=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>pO(C.fromDom(e.getBody()),n)).bind(gO),hO=e=>{Ef(e).each(t=>e.selection.setRng(t))},jC={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},bO=(e,t)=>($n(t)||(t=0),setTimeout(e,t)),CO=(e,t)=>($n(t)||(t=0),setInterval(e,t)),hn={setEditorTimeout:(e,t,n)=>bO(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=CO(()=>{e.removed?clearInterval(s):t()},n);return s}},vO=e=>e.type==="nodechange"&&e.selectionChange,yO=(e,t)=>{const n=()=>{t.throttle()};Fe.DOM.bind(document,"mouseup",n),e.on("remove",()=>{Fe.DOM.unbind(document,"mouseup",n)})},EO=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},SO=(e,t)=>{EO(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{vO(n)||lc(e)})},wO=e=>{const t=Bi(()=>{lc(e)},0);e.on("init",()=>{e.inline&&yO(e,t),SO(e,t)}),e.on("remove",()=>{t.cancel()})};let gr;const Sf=Fe.DOM,kO=e=>Z(e)&&jC.isEditorUIElement(e),wf=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},uc=(e,t)=>{const n=HT(e);return Sf.getParent(t,o=>kO(o)||(n?e.dom.is(o,n):!1))!==null},kf=e=>{try{const t=Bs(C.fromDom(e.getElement()));return yf(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},_O=(e,t)=>{const n=t.editor;wO(n);const s=(o,r)=>{if(wP(o)&&o.inline!==!0){const a=C.fromDom(o.getContainer());r(a,"tox-edit-focus")}};n.on("focusin",()=>{const o=e.focusedEditor;wf(kf(n))&&s(n,qo),o!==n&&(o&&o.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:o}),n.focus(!0))}),n.on("focusout",()=>{hn.setEditorTimeout(n,()=>{const o=e.focusedEditor;(!wf(kf(n))||o!==n)&&s(n,Kr),!uc(n,kf(n))&&o===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),gr||(gr=o=>{const r=e.activeEditor;r&&pg(o).each(a=>{const i=a;i.ownerDocument===document&&i!==document.body&&!uc(r,i)&&e.focusedEditor===r&&(r.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},Sf.bind(document,"focusin",gr))},xO=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&gr&&(Sf.unbind(document,"focusin",gr),gr=null)},NO=e=>{e.on("AddEditor",G(_O,e)),e.on("RemoveEditor",G(xO,e))},AO=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),RO=e=>e.collapsed?m.from(Hs(e.startContainer,e.startOffset)).map(C.fromDom):m.none(),TO=(e,t)=>RO(t).bind(n=>aR(n)?m.some(n):Cs(e,n)?m.none():m.some(e)),qC=(e,t)=>{TO(C.fromDom(e.getBody()),t).bind(n=>Bt(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},_f=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},PO=e=>zC(e)||cO(e).isSome(),DO=e=>V(e.iframeElement)&&zC(C.fromDom(e.iframeElement)),OO=e=>{const t=e.getBody();return t&&PO(C.fromDom(t))},BO=e=>{const t=Bs(C.fromDom(e.getElement()));return yf(t).filter(n=>!wf(n.dom)&&uc(e,n.dom)).isSome()},xo=e=>e.inline?OO(e):DO(e),KC=e=>xo(e)||BO(e),IO=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable(),V(e.bookmark)&&!xo(e)&&Ef(e).each(r=>{e.selection.setRng(r),s=r});const o=AO(e,t.getNode());if(o&&e.dom.isChildOf(o,n)){_f(o),qC(e,s),xf(e);return}e.inline||(Ne.browser.isOpera()||_f(n),e.getWin().focus()),(Ne.browser.isFirefox()||e.inline)&&(_f(n),qC(e,s)),xf(e)},xf=e=>e.editorManager.setActive(e),LO=(e,t)=>{e.removed||(t?xf(e):IO(e))},GC=(e,t)=>t.collapsed?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer),YC=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(C.fromDom).map(i=>!s||!t.collapsed?Ko(i,o(i,a)).getOr(i):i).bind(i=>sn(i)?m.some(i):Mn(i).filter(sn)).map(i=>i.dom).getOr(e)},XC=(e,t,n=!1)=>YC(e,t,!0,n,(s,o)=>Math.min(Hl(s),o)),ZC=(e,t,n=!1)=>YC(e,t,!1,n,(s,o)=>o>0?o-1:o),QC=(e,t)=>{const n=e;for(;e&&O(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},$O=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer;const o=t.startOffset,r=t.endOffset;let a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),O(n)&&O(s)&&(n.length===o?n=QC(n.nextSibling,!0):n=n.parentNode,r===0?s=QC(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));const i=O(a)?a.parentNode:a;return Ss(i)?i:e},FO=(e,t,n,s)=>{const o=[],r=e.getRoot(),a=e.getParent(n||XC(r,t,t.collapsed),e.isBlock),i=e.getParent(s||ZC(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let c;const l=new ht(a,r);for(;(c=l.next())&&c!==i;)e.isBlock(c)&&o.push(c)}return i&&a!==i&&i!==r&&o.push(i),o},MO=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{const r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(ef(e,a,s,!0),ef(e,a,s,!1)),a})),Nf=(e,t)=>ke(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),UO={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},fc=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},zO=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!Qo(n))return!1;const s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},JC=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class Mt{static create(t,n){const s=new Mt(t,UO[t]||1);return n&&Ue(n,(o,r)=>{s.attr(r,o)}),s}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;if(!ee(t))return V(t)&&Ue(t,(r,a)=>{s.attr(a,r)}),s;const o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new Mt(t.name,t.type),s=t.attributes;if(s){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=fc(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=fc(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;const r=this;let a=r.firstChild;if(JC(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||JC(a))return!1}if(a.type===8||a.type===3&&!zO(a)||a.type===3&&a.parent&&n[a.parent.name]&&Qo((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=fc(a,r));return!0}walk(t){return fc(this,null,t)}}const HO=$.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),ev=e=>ee(e.nodeValue)&&e.nodeValue.includes(mt),tv=e=>`${e.length===0?"":`${ke(e,t=>`[${t}]`).join(",")},`}[data-mce-bogus="all"]`,VO=(e,t)=>t.querySelectorAll(tv(e)),nv=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,t=>ev(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),sv=e=>document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t=>{if(ev(t)){const n=t.parentNode;return n&&de(HO,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}else return NodeFilter.FILTER_SKIP}),WO=e=>nv(e).nextNode()!==null,jO=e=>sv(e).nextNode()!==null,qO=(e,t)=>t.querySelector(tv(e))!==null,KO=(e,t)=>{T(VO(e,t),n=>{const s=C.fromDom(n);on(s,"data-mce-bogus")==="all"?je(s):T(e,o=>{jr(s,o)&&wt(s,o)})})},ov=e=>{let t=e.nextNode();for(;t!==null;)t.nodeValue=null,t=e.nextNode()},GO=Xn(ov,nv),YO=Xn(ov,sv),rv=(e,t)=>{const n=[{condition:G(qO,t),action:G(KO,t)},{condition:WO,action:GO},{condition:jO,action:YO}];let s=e,o=!1;return T(n,({condition:r,action:a})=>{r(s)&&(o||(s=e.cloneNode(!0),o=!0),a(s))}),s},av=e=>{const t=Pt(e,"[data-mce-bogus]");T(t,n=>{on(n,"data-mce-bogus")==="all"?je(n):bo(n)?(Yt(n,C.fromText(Jr)),je(n)):Is(n)})},iv=e=>{const t=Pt(e,"input");T(t,n=>{wt(n,"name")})},XO=(e,t)=>{const n=Ot(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},ZO=(e,t)=>{const n=e.getDoc(),s=Bs(C.fromDom(e.getBody())),o=C.fromTag("div",n);St(o,"data-mce-bogus","all"),Ei(o,{position:"fixed",left:"-9999999px",top:"0"}),wi(o,t.innerHTML),av(o),iv(o);const r=qx(s);ct(r,o);const a=rn(o.dom.innerText);return je(o),a},QO=(e,t,n)=>{let s;return t.format==="raw"?s=$.trim(rn(rv(n,e.serializer.getTempAttrs()).innerHTML)):t.format==="text"?s=ZO(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=XO(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Li(C.fromDom(n))&&ee(s)?$.trim(s):s},JO=(e,t)=>m.from(e.getBody()).fold(j(t.format==="tree"?new Mt("body",11):""),n=>QO(e,t,n)),cv=$.makeMap,lv=e=>{const t=[];e=e||{};const n=e.indent,s=cv(e.indent_before||""),o=cv(e.indent_after||""),r=$s.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,c,l)=>{if(n&&s[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}if(t.push("<",i),c)for(let u=0,f=c.length;u<f;u++){const d=c[u];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!l||a?t[t.length]=">":t[t.length]=" />",l&&n&&o[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}},end:i=>{let c;t.push("</",i,">"),n&&o[i]&&t.length>0&&(c=t[t.length-1],c.length>0&&c!==`
`&&t.push(`
`))},text:(i,c)=>{i.length>0&&(t[t.length]=c?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,c)=>{c?t.push("<?",i," ",r(c),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},qs=(e={},t=Fs())=>{const n=lv(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:c=>{var l;n.text((l=c.value)!==null&&l!==void 0?l:"",c.raw)},8:c=>{var l;n.comment((l=c.value)!==null&&l!==void 0?l:"")},7:c=>{n.pi(c.name,c.value)},10:c=>{var l;n.doctype((l=c.value)!==null&&l!==void 0?l:"")},4:c=>{var l;n.cdata((l=c.value)!==null&&l!==void 0?l:"")},11:c=>{let l=c;if(l=l.firstChild)do i(l);while(l=l.next)}};n.reset();const i=c=>{var l;const u=a[c.type];if(u)u(c);else{const f=c.name,d=f in t.getVoidElements();let p=c.attributes;if(r&&p&&p.length>1){const h=[];h.map={};const g=t.getElementRule(c.name);if(g){for(let b=0,v=g.attributesOrder.length;b<v;b++){const y=g.attributesOrder[b];if(y in p.map){const E=p.map[y];h.map[y]=E,h.push({name:y,value:E})}}for(let b=0,v=p.length;b<v;b++){const y=p[b].name;if(!(y in h.map)){const E=p.map[y];h.map[y]=E,h.push({name:y,value:E})}}p=h}}if(n.start(f,p,d),lo(f))ee(c.value)&&n.text(c.value,!0),n.end(f);else if(!d){let h=c.firstChild;if(h){(f==="pre"||f==="textarea")&&h.type===3&&((l=h.value)===null||l===void 0?void 0:l[0])===`
`&&n.text(`
`,!0);do i(h);while(h=h.next)}n.end(f)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},uv=new Set;T(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{uv.add(t)});const fv=["font","text-decoration","text-emphasis"],Af=(e,t)=>Gt(e.parseStyle(e.getAttrib(t,"style"))),eB=e=>uv.has(e),tB=(e,t)=>Ds(Af(e,t),n=>!eB(n)),nB=e=>le(e,t=>Je(fv,n=>dt(t,n))),sB=(e,t,n)=>{const s=Af(e,t),o=Af(e,n),r=a=>{var i,c;const l=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",u=(c=e.getStyle(n,a))!==null&&c!==void 0?c:"";return Qn(l)&&Qn(u)&&l!==u};return Je(s,a=>{const i=c=>Je(c,l=>l===a);if(!i(o)&&i(fv)){const c=nB(o);return Je(c,r)}else return r(a)})},dv=(e,t,n)=>m.from(n.container()).filter(O).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),Rf=G(dv,!0,ur),Tf=G(dv,!1,ur),oB=e=>{const t=e.container();return O(t)&&(t.data.length===0||$i(t.data)&&Ta.isBookmarkNode(t.parentNode))},Ks=(e,t)=>n=>Vu(e?0:-1,n).filter(t).isSome(),mv=e=>Bg(e)&&ns(C.fromDom(e),"display")==="block",pv=e=>ze(e)&&!wN(e),rB=Ks(!0,mv),aB=Ks(!1,mv),Oa=Ks(!0,os),Ba=Ks(!1,os),gv=Ks(!0,ss),hv=Ks(!1,ss),Gs=Ks(!0,pv),Ys=Ks(!1,pv),iB=e=>e.slice(0,-1),cB=(e,t,n)=>Cs(t,e)?iB(ug(e,s=>n(s)||Te(s,t))):[],bv=(e,t)=>cB(e,t,qe),xs=(e,t)=>[e].concat(bv(e,t)),Pf=(e,t,n)=>zb(e,t,n,oB),lB=e=>t=>e.isBlock(_e(t)),Cv=(e,t,n)=>ft(xs(C.fromDom(t.container()),e),lB(n)),vv=(e,t,n,s)=>Pf(e,t.dom,n).forall(o=>Cv(t,n,s).fold(()=>!as(o,n,t.dom),r=>!as(o,n,t.dom)&&Cs(r,C.fromDom(o.container())))),yv=(e,t,n,s)=>Cv(t,n,s).fold(()=>Pf(e,t.dom,n).forall(o=>!as(o,n,t.dom)),o=>Pf(e,o.dom,n).isNone()),Df=G(yv,!1),Ev=G(yv,!0),uB=G(vv,!1),fB=G(vv,!0),dB=e=>Gi(e).exists(bo),dc=(e,t,n,s)=>{const o=le(xs(C.fromDom(n.container()),t),a=>s.isBlock(_e(a))),r=Vt(o).getOr(t);return dn(e,r.dom,n).filter(dB)},Of=(e,t,n)=>Gi(t).exists(bo)||dc(!0,e,t,n).isSome(),Bf=(e,t,n)=>eD(t).exists(bo)||dc(!1,e,t,n).isSome(),mB=G(dc,!1),pB=G(dc,!0),Sv=e=>N.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),wv=(e,t,n)=>{const s=le(xs(C.fromDom(t.container()),e),o=>n.isBlock(_e(o)));return Vt(s).getOr(e)},kv=(e,t,n)=>Sv(t)?Tf(t):Tf(t)||Xt(wv(e,t,n).dom,t).exists(Tf),_v=(e,t,n)=>Sv(t)?Rf(t):Rf(t)||jt(wv(e,t,n).dom,t).exists(Rf),gB=e=>Ie(["pre","pre-wrap"],e),If=e=>Gi(e).bind(t=>oo(t,sn)).exists(t=>gB(ns(t,"white-space"))),hB=(e,t)=>Xt(e.dom,t).isNone(),bB=(e,t)=>jt(e.dom,t).isNone(),CB=(e,t,n)=>hB(e,t)||bB(e,t)||Df(e,t,n)||Ev(e,t,n)||Bf(e,t,n)||Of(e,t,n),vB=e=>V(e)&&ze(e)&&Ab(e),xv=(e,t)=>n=>vB(new ht(n,e)[t]()),yB=(e,t)=>{const n=jt(e.dom,t).getOr(t),s=xv(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},EB=(e,t)=>{const n=Xt(e.dom,t).getOr(t),s=xv(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},Nv=(e,t,n)=>If(t)?!1:CB(e,t,n)||kv(e,t,n)||_v(e,t,n),Ia=(e,t,n)=>If(t)?!1:Df(e,t,n)||uB(e,t,n)||Bf(e,t,n)||kv(e,t,n)||EB(e,t),SB=e=>{const t=e.container(),n=e.offset();return O(t)&&n<t.data.length?N(t,n+1):e},La=(e,t,n)=>If(t)?!1:Ev(e,t,n)||fB(e,t,n)||Of(e,t,n)||_v(e,t,n)||yB(e,t),Lf=(e,t,n)=>Ia(e,t,n)||La(e,SB(t),n),Av=(e,t)=>Qi(e.charAt(t)),Rv=(e,t)=>ur(e.charAt(t)),wB=e=>{const t=e.container();return O(t)&&At(t.data,bt)},kB=e=>{const t=e.split("");return ke(t,(n,s)=>Qi(n)&&s>0&&s<t.length-1&&Xu(t[s-1])&&Xu(t[s+1])?" ":n).join("")},Tv=(e,t,n,s)=>{const o=t.data,r=N(t,0);return!n&&Av(o,0)&&!Lf(e,r,s)?(t.data=" "+o.slice(1),!0):n&&Rv(o,0)&&Ia(e,r,s)?(t.data=bt+o.slice(1),!0):!1},_B=e=>{const t=e.data,n=kB(t);return n!==t?(e.data=n,!0):!1},Pv=(e,t,n,s)=>{const o=t.data,r=N(t,o.length-1);return!n&&Av(o,o.length-1)&&!Lf(e,r,s)?(t.data=o.slice(0,-1)+" ",!0):n&&Rv(o,o.length-1)&&La(e,r,s)?(t.data=o.slice(0,-1)+bt,!0):!1},xB=(e,t,n)=>{const s=t.container();if(!O(s))return m.none();if(wB(t)){const o=Tv(e,s,!1,n)||_B(s)||Pv(e,s,!1,n);return jo(o,t)}else if(Lf(e,t,n)){const o=Tv(e,s,!0,n)||Pv(e,s,!0,n);return jo(o,t)}else return m.none()},NB=e=>{const t=C.fromDom(e.getBody());e.selection.isCollapsed()&&xB(t,N.fromRangeStart(e.selection.getRng()),e.schema).each(n=>{e.selection.setRng(n.toRange())})},Dv=(e,t,n,s)=>{if(n===0)return;const o=C.fromDom(e),r=ys(o,l=>s.isBlock(_e(l))).getOr(o),a=e.data.slice(t,t+n),i=t+n>=e.data.length&&La(r,N(e,e.data.length),s),c=t===0&&Ia(r,N(e,0),s);e.replaceData(t,n,Dg(a,4,c,i))},mc=(e,t,n)=>{const s=e.data.slice(t),o=s.length-sx(s).length;Dv(e,t,o,n)},$f=(e,t,n)=>{const s=e.data.slice(0,t),o=s.length-xp(s).length;Dv(e,t-o,o,n)},Ff=(e,t,n,s,o=!0)=>{const r=xp(e.data).length,a=o?e:t,i=o?t:e;return o?a.appendData(i.data):a.insertData(0,i.data),je(C.fromDom(i)),s&&mc(a,r,n),a},AB=(e,t)=>{const n=e.container(),s=e.offset();return!N.isTextPosition(e)&&n===t.parentNode&&s>N.before(t).offset()},RB=(e,t)=>AB(t,e)?N(t.container(),t.offset()-1):t,TB=e=>O(e)?N(e,0):N.before(e),PB=e=>O(e)?N(e,e.data.length):N.after(e),Ov=e=>Vn(e.previousSibling)?m.some(PB(e.previousSibling)):e.previousSibling?xn(e.previousSibling):m.none(),Bv=e=>Vn(e.nextSibling)?m.some(TB(e.nextSibling)):e.nextSibling?Bt(e.nextSibling):m.none(),DB=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>Xt(e,N.before(n))).orThunk(()=>jt(e,N.after(t))),OB=(e,t)=>jt(e,N.after(t)).orThunk(()=>Xt(e,N.before(t))),BB=(e,t)=>Ov(t).orThunk(()=>Bv(t)).orThunk(()=>DB(e,t)),IB=(e,t)=>Bv(t).orThunk(()=>Ov(t)).orThunk(()=>OB(e,t)),LB=(e,t,n)=>e?IB(t,n):BB(t,n),$B=(e,t,n)=>LB(e,t,n).map(G(RB,n)),Iv=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},FB=e=>t=>t.dom===e,MB=(e,t)=>t&&de(e.schema.getBlockElements(),_e(t)),UB=(e,t,n)=>{if(Dt(e,t)){const s=C.fromHtml('<br data-mce-bogus="1">');return n?T(Tt(t),o=>{uf(o)||je(o)}):Xo(t),ct(t,s),m.some(N.before(s.dom))}else return m.none()},zB=(e,t,n,s)=>{const o=so(e).filter(un),r=Xr(e).filter(un);return je(e),yx(o,r,t,(a,i,c)=>{const l=a.dom,u=i.dom,f=l.data.length;return Ff(l,u,n,s),c.container()===u?N(l,f):c}).orThunk(()=>(s&&(o.each(a=>$f(a.dom,a.dom.length,n)),r.each(a=>mc(a.dom,0,n))),t))},HB=(e,t)=>de(e.schema.getTextInlineElements(),_e(t)),No=(e,t,n,s=!0,o=!1)=>{const r=$B(t,e.getBody(),n.dom),a=ys(n,G(MB,e),FB(e.getBody())),i=zB(n,r,e.schema,HB(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(c=>UB(e.schema,c,o)).fold(()=>{s&&Iv(e,t,i)},c=>{s&&Iv(e,t,m.some(c))})},VB=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,WB=e=>VB.test(e),Ao=(e,t)=>Fn(C.fromDom(t),DT(e))&&!uo(e.schema,t)&&e.dom.isEditable(t),Lv=e=>{var t;return Fe.DOM.getStyle(e,"direction",!0)==="rtl"||WB((t=e.textContent)!==null&&t!==void 0?t:"")},jB=(e,t,n)=>le(Fe.DOM.getParents(n.container(),"*",t),e),Xs=(e,t,n)=>{const s=jB(e,t,n);return m.from(s[s.length-1])},qB=(e,t,n)=>{const s=Ws(t,e),o=Ws(n,e);return V(s)&&s===o},KB=e=>ku(e)||_u(e),bn=(e,t)=>{const n=t.container(),s=t.offset();return e?zs(n)?O(n.nextSibling)?N(n.nextSibling,0):N.after(n):ku(t)?N(n,s+1):t:zs(n)?O(n.previousSibling)?N(n.previousSibling,n.previousSibling.data.length):N.before(n):_u(t)?N(n,s-1):t},$v=G(bn,!0),Fv=G(bn,!1),Mv=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},GB=e=>{e.execCommand("delete")},Mf=e=>Mv(e,"Delete"),YB=e=>Mv(e,"ForwardDelete"),XB=e=>t=>Wo(Mn(t),e,Te),ZB=e=>Sh(e)||da(e),pc=(e,t)=>Cs(e,t)?oo(t,ZB,XB(e)):m.none(),Uf=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},Uv=(e,t,n)=>Rt(Bt(n),xn(n),(s,o)=>{const r=bn(!0,s),a=bn(!1,o),i=bn(!1,t);return e?jt(n,i).exists(c=>c.isEqual(a)&&t.isEqual(r)):Xt(n,i).exists(c=>c.isEqual(r)&&t.isEqual(a))}).getOr(!0),zv=e=>(Ax(e)?so(e):zl(e)).bind(zv).orThunk(()=>m.some(e)),Hv=(e,t,n,s=!0)=>{var o;t.deleteContents();const r=zv(n).getOr(n),a=C.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?Uf(e,s):Dt(e.schema,a,{checkRootAsContent:!1})&&(Us(a),s&&e.selection.setCursorLocation(a.dom,0)),!Te(n,a)){const i=Wo(Mn(a),n)?[]:Hx(a);T(i.concat(Tt(n)),c=>{!Te(c,a)&&!Cs(c,a)&&Dt(e.schema,c)&&je(c)})}},QB=e=>t=>Te(e,t),zf=e=>Pt(e,"td,th"),Vv=(e,t)=>Na(C.fromDom(e),t),JB=e=>Rt(e.startTable,e.endTable,(t,n)=>{const s=Tg(t,r=>Te(r,n)),o=Tg(n,r=>Te(r,t));return!s&&!o?e:{...e,startTable:s?m.none():e.startTable,endTable:o?m.none():e.endTable,isSameTable:!1,isMultiTable:!1}}).getOr(e),eI=e=>JB(e),tI=(e,t)=>{const n=Vv(e.startContainer,t),s=Vv(e.endContainer,t),o=n.isSome(),r=s.isSome(),a=Rt(n,s,Te).getOr(!1);return eI({startTable:n,endTable:s,isStartInTable:o,isEndInTable:r,isSameTable:a,isMultiTable:!a&&o&&r})},Hf=(e,t)=>({start:e,end:t}),nI=(e,t,n)=>({rng:e,table:t,cells:n}),$a=rs.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),gc=(e,t)=>Yo(C.fromDom(e),"td,th",t),Wv=e=>!Te(e.start,e.end),jv=(e,t)=>Na(e.start,t).bind(n=>Na(e.end,t).bind(s=>jo(Te(n,s),n))),sI=(e,t)=>!Wv(e)&&jv(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),oI=(e,t)=>{const n=gc(e.startContainer,t),s=gc(e.endContainer,t);return Rt(n,s,Hf)},rI=e=>t=>Na(t,e).bind(n=>Os(zf(n)).map(s=>Hf(t,s))),aI=e=>t=>Na(t,e).bind(n=>Vt(zf(n)).map(s=>Hf(s,t))),Vf=e=>t=>jv(t,e).map(n=>nI(t,n,zf(n))),qv=(e,t,n,s)=>{if(n.collapsed||!e.forall(Wv))return m.none();if(t.isSameTable){const o=e.bind(Vf(s));return m.some({start:o,end:o})}else{const o=gc(n.startContainer,s),r=gc(n.endContainer,s),a=o.bind(rI(s)).bind(Vf(s)),i=r.bind(aI(s)).bind(Vf(s));return m.some({start:a,end:i})}},Kv=(e,t)=>Lr(e,n=>Te(n,t)),Wf=e=>Rt(Kv(e.cells,e.rng.start),Kv(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),iI=(e,t,n)=>e.exists(s=>sI(s,n)&&Ju(s.start,t)),Gv=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},cI=(e,t,n,s)=>qv(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=Wf(o).getOr([]);if(r&&o.cells.length===a.length)return m.some($a.fullTable(o.table));if(a.length>0){if(r)return m.some($a.partialTable(a,m.none()));{const i=Gv(n,t);return m.some($a.partialTable(a,m.some({...t,rng:i})))}}else return m.none()}),lI=(e,t,n,s)=>qv(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind(Wf).getOr([]),i=r.bind(Wf).getOr([]);if(a.length>0&&i.length>0){const c=Gv(n,t);return m.some($a.multiTable(a,i,c))}else return m.none()}),uI=(e,t)=>{const n=QB(e),s=oI(t,n),o=tI(t,n);return iI(s,t,n)?s.map(r=>$a.singleCellTable(t,r.start)):o.isMultiTable?lI(s,o,t,n):cI(s,o,t,n)},Yv=e=>T(e,t=>{wt(t,"contenteditable"),Us(t)}),fI=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(C.fromDom),dI=(e,t,n)=>{n.each(s=>{t?je(s):(Us(s),e.selection.setCursorLocation(s.dom,0))})},jf=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),qf(e,o,t,!1).each(r=>r())},Xv=e=>{const t=fr(e),n=C.fromDom(e.selection.getNode());Ni(n.dom)&&Dt(e.schema,n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Je(t,s=>Te(s,n))&&St(n,"data-mce-selected","1")},Zv=(e,t,n)=>m.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=fI(e,a?r.endContainer:r.startContainer);r.deleteContents(),dI(e,a,i.filter(G(Dt,e.schema)));const c=a?t[0]:t[t.length-1];return jf(e,c,s,a),Dt(e.schema,c)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Yv(o),Xv(e)}),mI=(e,t,n,s)=>m.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];jf(e,r,o,!0),jf(e,a,o,!1);const i=Dt(e.schema,r)?t:t.slice(1),c=Dt(e.schema,a)?n:n.slice(0,-1);Yv(i.concat(c)),s.deleteContents(),Xv(e)}),qf=(e,t,n,s=!0)=>m.some(()=>{Hv(e,t,n,s)}),pI=(e,t)=>m.some(()=>No(e,!1,t)),gI=(e,t,n)=>uI(t,n).bind(s=>s.fold(G(qf,e),G(pI,e),G(Zv,e),G(mI,e))),hI=(e,t)=>hc(e,t),bI=(e,t,n,s)=>Kf(t,s).fold(()=>gI(e,t,n),o=>hI(e,o)),CI=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?Zv(e,n,m.none()):bI(e,s,o,t)},Qv=(e,t)=>ft(xs(t,e),ma),Kf=(e,t)=>ft(xs(t,e),Ci("caption")),vI=(e,t,n,s,o)=>cr(n,e.getBody(),o).bind(r=>Qv(t,C.fromDom(r.getNode())).bind(a=>Te(a,s)?m.none():m.some(he))),hc=(e,t)=>m.some(()=>{Us(t),e.selection.setCursorLocation(t.dom,0)}),yI=(e,t,n,s)=>Bt(e.dom).bind(o=>xn(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),EI=(e,t)=>hc(e,t),SI=(e,t,n)=>Kf(e,C.fromDom(n.getNode())).fold(()=>m.some(he),s=>jo(!Te(s,t),he)),wI=(e,t,n,s,o)=>cr(n,e.getBody(),o).fold(()=>m.some(he),r=>yI(s,n,o,r)?EI(e,s):SI(t,s,r)),kI=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return Qv(n,s).bind(r=>Dt(e.schema,r,{checkRootAsContent:!1})?hc(e,r):vI(e,n,t,r,o))},_I=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return Dt(e.schema,s)?hc(e,s):wI(e,n,t,s,o)},Jv=(e,t)=>e?gv(t):hv(t),xI=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return Jv(t,n)||dn(t,e.getBody(),n).exists(s=>Jv(t,s))},NI=(e,t,n)=>{const s=C.fromDom(e.getBody());return Kf(s,n).fold(()=>kI(e,t,s,n).orThunk(()=>jo(xI(e,t),he)),o=>_I(e,t,s,o))},Gf=(e,t)=>{const n=C.fromDom(e.selection.getStart(!0)),s=fr(e);return e.selection.isCollapsed()&&s.length===0?NI(e,t,n):CI(e,n,s)},Ro=(e,t)=>{let n=t;for(;n&&n!==e;){if(_n(n)||ze(n))return n;n=n.parentNode}return null},AI=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],RI=$.each,Yf=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;const i=l=>{const u={};return RI(t.getAttribs(l),f=>{const d=f.nodeName.toLowerCase();d!=="style"&&!o(d)&&(u[d]=t.getAttrib(l,d))}),u},c=(l,u)=>{for(const f in l)if(de(l,f)){const d=u[f];if(Et(d)||l[f]!==d)return!1;delete u[f]}for(const f in u)if(de(u,f))return!1;return!0};return Z(r)&&Z(a)&&(!c(i(r),i(a))||!c(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!pn(r)&&!pn(a)},o=r=>Je(AI,a=>dt(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},ey=e=>["h1","h2","h3","h4","h5","h6"].includes(e.name),TI=e=>e.name==="summary",PI=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},ty=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const c=s.nodes[o];c?c.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],c=i.name;if(c in n.attributes.map){const l=s.attributes[c];l?l.nodes.push(n):s.attributes[c]={filter:i,nodes:[n]}}}},DI=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&PI(n,o=>{ty(e,t,o,s)}),s},ny=(e,t)=>{const n=(s,o)=>{Ue(s,r=>{const a=nn(r.nodes);T(r.filter.callbacks,i=>{for(let c=a.length-1;c>=0;c--){const l=a[c];(!(o?l.attr(r.filter.name)!==void 0:l.name===r.filter.name)||it(l.parent))&&a.splice(c,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},sy=(e,t,n,s={})=>{const o=DI(e,t,n);ny(o,s)},Xf=(e,t,n,s)=>{if((e.pad_empty_with_br||t.insert)&&n(s)){const r=new Mt("br",1);t.insert&&r.attr("data-mce-bogus","1"),s.empty().append(r)}else s.empty().append(new Mt("#text",3)).value=bt},OI=e=>{var t;return oy(e,"#text")&&((t=e==null?void 0:e.firstChild)===null||t===void 0?void 0:t.value)===bt},oy=(e,t)=>{const n=e==null?void 0:e.firstChild;return V(n)&&n===e.lastChild&&n.name===t},BI=(e,t)=>{const n=e.getElementRule(t.name);return(n==null?void 0:n.paddEmpty)===!0},Fa=(e,t,n,s)=>s.isEmpty(t,n,o=>BI(e,o)),II=(e,t)=>V(e)&&(t(e)||e.name==="br"),LI=e=>{let t;for(let n=e;n;n=n.parent){const s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},Zf=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)n&&!t.isValidChild(n.name,o.name)&&Zf(o,t,n);e.unwrap()}},Qf=(e,t,n,s=he)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=$.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),c=new Set,l=u=>u!==n&&!i[u.name];for(let u=0;u<e.length;u++){const f=e[u];let d,p,h;if(!f.parent||c.has(f))continue;if(o[f.name]&&f.parent.name==="li"){let b=f.next;for(;b&&o[b.name];){b.name="li",c.add(b),f.parent.insert(b,f.parent);b=b.next}f.unwrap();continue}const g=[f];for(d=f.parent;d&&!t.isValidChild(d.name,f.name)&&l(d);d=d.parent)g.push(d);if(d&&g.length>1)if(Jf(t,f,d))Zf(f,t);else{g.reverse(),p=g[0].clone(),s(p);let b=p;for(let v=0;v<g.length-1;v++){t.isValidChild(b.name,g[v].name)&&v>0?(h=g[v].clone(),s(h),b.append(h)):h=b;for(let y=g[v].firstChild;y&&y!==g[v+1];){const E=y.next;h.append(y),y=E}b=h}Fa(t,r,a,p)?d.insert(f,g[0],!0):(d.insert(p,g[0],!0),d.insert(f,p)),d=g[0],(Fa(t,r,a,d)||oy(d,"br"))&&d.empty().remove()}else if(f.parent){if(f.name==="li"){let b=f.prev;if(b&&(b.name==="ul"||b.name==="ol")){b.append(f);continue}if(b=f.next,b&&(b.name==="ul"||b.name==="ol")&&b.firstChild){b.insert(f,b.firstChild,!0);continue}const v=new Mt("ul",1);s(v),f.wrap(v);continue}if(t.isValidChild(f.parent.name,"div")&&t.isValidChild("div",f.name)){const b=new Mt("div",1);s(b),f.wrap(b)}else Zf(f,t)}}},$I=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},Jf=(e,t,n=t.parent)=>n?e.children[t.name]&&!e.isValidChild(n.name,t.name)||t.name==="a"&&$I(n,"a")?!0:TI(n)&&ey(t)?!((n==null?void 0:n.firstChild)===t&&(n==null?void 0:n.lastChild)===t):!1:!1,FI=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},MI=e=>{const t=N.fromRangeStart(e),n=N.fromRangeEnd(e),s=e.commonAncestorContainer;return dn(!1,s,n).map(o=>!as(t,n,s)&&as(t,o,s)?FI(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},ed=e=>e.collapsed?e:MI(e),UI=e=>V(e.firstChild)&&e.firstChild===e.lastChild,zI=e=>e.name==="br"||e.value===bt,HI=(e,t)=>e.getBlockElements()[t.name]&&UI(t)&&zI(t.firstChild),VI=(e,t)=>{const n=e.getNonEmptyElements();return V(t)&&(t.isEmpty(n)||HI(e,t))},WI=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),VI(e,s)&&(s=s==null?void 0:s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},jI=e=>{var t,n;const s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},qI=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return jI(o)},KI=e=>{var t;return le((t=e==null?void 0:e.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},GI=e=>e.data===bt||Xe(e),YI=e=>V(e==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&GI(e.firstChild),XI=e=>!e.firstChild||YI(e),ZI=e=>e.length>0&&XI(e[e.length-1])?e.slice(0,-1):e,td=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},QI=(e,t)=>!!td(e,t),JI=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},eL=(e,t)=>{const n=N.before(e),o=cs(t).next(n);return o?o.toRange():null},ry=(e,t)=>{const n=N.after(e),o=cs(t).prev(n);return o?o.toRange():null},tL=(e,t,n,s)=>{const o=JI(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),$.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),ry(t[t.length-1],n)},nL=(e,t,n)=>{const s=e.parentNode;return s&&$.each(t,o=>{s.insertBefore(o,e)}),eL(e,n)},sL=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),ry(t[0],n)),oL=(e,t,n,s)=>{const o=qI(t,e,s),r=td(t,n.startContainer),a=ZI(KI(o.firstChild)),i=1,c=2,l=t.getRoot(),u=f=>{const d=N.fromRangeStart(n),p=cs(t.getRoot()),h=f===i?p.prev(d):p.next(d),g=h==null?void 0:h.getNode();return g?td(t,g)!==r:!0};return r?u(i)?nL(r,a,l):u(c)?sL(r,a,l,t):tL(r,a,l,n):null},rL=["pre"],aL=(e,t,n,s)=>{var o;const r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,c=r===i,l=Ie(rL,r.name);if(c&&l){const u=r.attr("contenteditable")!=="false",f=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(Ro(s,n)).forall(_n);return u&&f&&d}else return!1},nd=Ni,iL=(e,t,n)=>{if(V(n)){const s=e.getParent(t.endContainer,nd);return n===s&&Ju(C.fromDom(n),t)}else return!1},cL=(e,t,n)=>{var s;if(n.getAttribute("data-mce-bogus")==="all")(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n);else{const o=n.firstChild,r=n.lastChild;!o||o===r&&o.nodeName==="BR"?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},lL=(e,t,n)=>{m.from(e.getParent(t,"td,th")).map(C.fromDom).each(s=>lR(s,n))},uL=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=Yf(e);$.each(s.select("*[data-mce-fragment]"),a=>{if(V(n[a.nodeName.toLowerCase()])&&tB(s,a)){for(let c=a.parentElement;V(c)&&c!==o&&!sB(s,a,c);c=c.parentElement)if(r.compare(c,a)){s.remove(a,!0);break}}})}},fL=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},dL=e=>{$.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},mL=e=>!!e.getAttribute("data-mce-fragment"),pL=(e,t)=>V(t)&&!e.schema.getVoidElements()[t.nodeName],gL=(e,t)=>{var n,s,o;let r;const a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);const c=Ro(e.getBody(),t);if(c&&a.getContentEditable(c)==="false"){a.remove(t),i.select(c);return}let l=a.createRng();const u=t.previousSibling;if(O(u)){l.setStart(u,(s=(n=u.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);const p=t.nextSibling;O(p)&&(u.appendData(p.data),(o=p.parentNode)===null||o===void 0||o.removeChild(p))}else l.setStartBefore(t),l.setEndBefore(t);const f=p=>{let h=N.fromRangeStart(p);return h=cs(e.getBody()).next(h),h==null?void 0:h.toRange()},d=a.getParent(t,a.isBlock);if(a.remove(t),d&&a.isEmpty(d)){const p=nd(d);Xo(C.fromDom(d)),l.setStart(d,0),l.setEnd(d,0),!p&&!mL(d)&&(r=f(l))?(l=r,a.remove(d)):a.add(d,a.create("br",p?{}:{"data-mce-bogus":"1"}))}i.setRng(l)},hL=e=>{const t=e.dom,n=ed(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,nd);iL(t,n,s)?qf(e,n,C.fromDom(s)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset===1&&O(n.startContainer.childNodes[n.startOffset])?n.deleteContents():e.getDoc().execCommand("Delete",!1)},bL=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},CL=(e,t,n)=>{var s;return Je(n.children(),ey)&&((s=e.getParent(t,e.isBlock))===null||s===void 0?void 0:s.nodeName)==="SUMMARY"},vL=(e,t,n)=>{var s,o;const r=e.selection,a=e.dom,i=e.parser,c=n.merge,l=qs({validate:!0},e.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(t=rn(t)),t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,u);let f=r.getRng();const d=f.startContainer,p=e.getBody();d===p&&r.isCollapsed()&&a.isBlock(p.firstChild)&&pL(e,p.firstChild)&&a.isEmpty(p.firstChild)&&(f=a.createRng(),f.setStart(p.firstChild,0),f.setEnd(p.firstChild,0),r.setRng(f)),r.isCollapsed()||hL(e);const h=r.getNode(),g={context:h.nodeName.toLowerCase(),data:n.data,insert:!0},b=i.parse(t,g);if(n.paste===!0&&WI(e.schema,b)&&QI(a,h))return f=oL(l,a,r.getRng(),b),f&&r.setRng(f),t;n.paste===!0&&aL(a,b,h,e.getBody())&&((s=b.firstChild)===null||s===void 0||s.unwrap()),fL(b);let v=b.lastChild;if(v&&v.attr("id")==="mce_marker"){const y=v;for(v=v.prev;v;v=v.walk(!0))if(v.type===3||!a.isBlock(v.name)){v.parent&&e.schema.isValidChild(v.parent.name,"span")&&v.parent.insert(y,v,v.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(h),!g.invalid&&!CL(a,h,b))t=l.serialize(b),cL(e,t,h);else{e.selection.setContent(u);let y=r.getNode(),E;const S=e.getBody();for(ta(y)?y=E=S:E=y;E&&E!==S;)y=E,E=E.parentNode;t=y===S?S.innerHTML:a.getOuterHTML(y);const R=i.parse(t),B=bL(R),z=B.bind(LI).getOr(R);B.each(U=>U.replace(b));const P=b.children(),x=(o=b.parent)!==null&&o!==void 0?o:R;b.unwrap();const A=le(P,U=>Jf(e.schema,U,x));Qf(A,e.schema,z),sy(i.getNodeFilters(),i.getAttributeFilters(),R),t=l.serialize(R),y===S?a.setHTML(S,t):a.setOuterHTML(y,t)}return uL(e,c),gL(e,a.get("mce_marker")),dL(e.getBody()),lL(a,r.getStart(),e.schema),VN(e.schema,e.getBody(),r.getStart()),t},bc=e=>e instanceof Mt,yL=e=>{xo(e)&&Bt(e.getBody()).each(t=>{const n=t.getNode(),s=ss(n)?Bt(n).getOr(t):t;e.selection.setRng(s.toRange())})},sd=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&yL(e)},EL=(e,t,n,s)=>{if(n=rn(n),n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=Ot(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,va(e),n)):n||(n=o),sd(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=qs({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=Li(C.fromDom(t))?n:$.trim(n);return sd(e,o,s.no_selection),{content:o,html:o}}},SL=(e,t,n,s)=>{sy(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=qs({validate:!1},e.schema).serialize(n),r=rn(Li(C.fromDom(t))?o:$.trim(o));return sd(e,r,s.no_selection),{content:n,html:r}},wL=(e,t,n)=>m.from(e.getBody()).map(s=>bc(t)?SL(e,s,t,n):EL(e,s,t,n)).getOr({content:t,html:bc(n.content)?"":n.content}),ay=e=>Be(e)?e:qe,kL=(e,t,n)=>{let s=e.dom;const o=ay(n);for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},od=(e,t,n)=>{const s=t(e),o=ay(n);return s.orThunk(()=>o(e)?m.none():kL(e,t,o))},rd=rf,iy=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(gn(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},ad=(e,t,n,s,o)=>{const r=e.dom.getRoot();if(t===r)return!1;const a=e.dom.getParent(t,i=>iy(e,i,n)?!0:i.parentNode===r||!!us(e,i,n,s,!0));return!!us(e,a,n,s,o)},Cc=(e,t,n)=>pt(n)&&rd(t,n.inline)||ls(n)&&rd(t,n.block)?!0:gn(n)?Z(t)&&e.is(t,n.selector):!1,cy=(e,t,n,s,o,r)=>{const a=n[s],i=s==="attributes";if(Be(n.onmatch))return n.onmatch(t,n,s);if(a){if(yp(a)){for(let c=0;c<a.length;c++)if(i?e.getAttrib(t,a[c]):ec(e,t,a[c]))return!0}else for(const c in a)if(de(a,c)){const l=i?e.getAttrib(t,c):ec(e,t,c),u=js(a[c],r),f=it(l)||Vr(l);if(f&&it(u))continue;if(o&&f&&!n.exact||(!o||n.exact)&&!rd(l,af(u,c)))return!1}}return!0},us=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&Z(t))for(let i=0;i<r.length;i++){const c=r[i];if(Cc(e.dom,t,c)&&cy(a,t,c,"attributes",o,s)&&cy(a,t,c,"styles",o,s)){const l=c.classes;if(l){for(let u=0;u<l.length;u++)if(!e.dom.hasClass(t,js(l[u],s)))return}return c}}},id=(e,t,n,s,o)=>{if(s)return ad(e,s,t,n,o);if(s=e.selection.getNode(),ad(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&ad(e,r,t,n,o))},_L=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const c=t[i];!o[c]&&us(e,a,c,n)&&(o[c]=!0,s.push(c))}},e.dom.getRoot()),s},xL=(e,t)=>{const n=o=>Te(o,C.fromDom(e.getBody())),s=(o,r)=>us(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>od(C.fromDom(o),r=>zo(t,a=>s(r,a)),n)).getOrNull()},NL=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n&&e.selection.isEditable()){const o=e.selection.getStart(),r=tc(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!gn(i))return!0;for(let c=r.length-1;c>=0;c--)if(s.is(r[c],i.selector))return!0}}return!1},AL=(e,t,n)=>Kt(n,(s,o)=>{const r=PD(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),Ma=mt,RL=(e,t)=>e.importNode(t,!0),ly=e=>{if(e){const t=new ht(e,e);for(let n=t.current();n;n=t.next())if(O(n))return n}return null},cd=e=>{const t=C.fromTag("span");return hs(t,{id:Gu,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&ct(t,C.fromText(Ma)),t},TL=e=>{const t=ly(e);return t&&t.data.charAt(0)===Ma&&t.deleteData(0,1),t},ld=(e,t,n)=>{const s=e.dom,o=e.selection;if(tC(t))No(e,!1,C.fromDom(t),n,!0);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,c=r.startOffset,l=r.endContainer,u=r.endOffset,f=TL(t);s.remove(t,!0),i===f&&c>0&&r.setStart(f,c-1),l===f&&u>0&&r.setEnd(f,u-1),a&&s.isEmpty(a)&&Us(C.fromDom(a)),o.setRng(r)}},ud=(e,t,n)=>{const s=e.dom,o=e.selection;if(t)ld(e,t,n);else if(t=So(e.getBody(),o.getStart()),!t)for(;t=s.get(Gu);)ld(e,t,n)},PL=(e,t,n)=>{var s,o;const r=e.dom,a=r.getParent(n,G(sf,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(cR(C.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},uy=(e,t)=>(e.appendChild(t),t),fy=(e,t)=>{var n;const s=Ir(e,(r,a)=>uy(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return uy(s,o.createTextNode(Ma))},DL=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,c=le(Gt(a.get()),f=>f!==s&&!At(f,"removeformat")),l=AL(e,n,c);if(le(l,f=>!DD(e,f,s)).length>0){const f=n.cloneNode(!1);return i.add(t,f),a.remove(s,o,f,r),i.remove(f),m.some(f)}else return m.none()},OL=(e,t,n)=>{let s;const o=e.selection,r=e.formatter.get(t);if(!r)return;const a=o.getRng();let i=a.startOffset;const l=a.startContainer.nodeValue;s=So(e.getBody(),o.getStart());const u=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(l&&i>0&&i<l.length&&u.test(l.charAt(i))&&u.test(l.charAt(i-1))){const f=o.getBookmark();a.collapse(!0);let d=wo(e.dom,a,r);d=cc(d),e.formatter.apply(t,n,d),o.moveToBookmark(f)}else{let f=s?ly(s):null;(!s||(f==null?void 0:f.data)!==Ma)&&(s=RL(e.getDoc(),cd(!0).dom),f=s.firstChild,a.insertNode(s),i=1),e.formatter.apply(t,n,s),o.setCursorLocation(f,i)}},BL=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const c=r.getRng(),l=c.startContainer,u=c.startOffset;let f=l;O(l)&&(u!==l.data.length&&(a=!0),f=f.parentNode);const d=[];let p;for(;f;){if(us(e,f,t,n,s)){p=f;break}f.nextSibling&&(a=!0),d.push(f),f=f.parentNode}if(p)if(a){const h=r.getBookmark();c.collapse(!0);let g=wo(o,c,i,!0);g=cc(g),e.formatter.remove(t,n,g,s),r.moveToBookmark(h)}else{const h=So(e.getBody(),p),g=V(h)?o.getParents(p.parentNode,ot,h):[],b=cd(!1).dom;PL(e,b,h??p);const v=DL(e,b,p,t,n,s),y=fy([...d,...v.toArray(),...g],b);h&&ld(e,h,V(h)),r.setCursorLocation(y,1),o.isEmpty(p)&&o.remove(p)}},IL=(e,t,n)=>{const s=e.selection,o=e.getBody();ud(e,null,n),(t===8||t===46)&&s.isCollapsed()&&s.getStart().innerHTML===Ma&&ud(e,So(o,s.getStart()),!0),(t===37||t===39)&&ud(e,So(o,s.getStart()),!0)},LL=e=>O(e)&&Bl(e.data,bt),$L=e=>{e.on("mouseup keydown",t=>{IL(e,t.keyCode,LL(e.selection.getRng().endContainer))})},dy=e=>{const t=cd(!1),n=fy(e,t.dom);return{caretContainer:t,caretPosition:N(n,0)}},my=(e,t)=>{const{caretContainer:n,caretPosition:s}=dy(t);return Yt(C.fromDom(e),n),je(C.fromDom(e)),s},FL=(e,t)=>{const{caretContainer:n,caretPosition:s}=dy(t);return e.insertNode(n.dom),s},py=(e,t)=>{if(mn(t.dom))return!1;const n=e.schema.getTextInlineElements();return de(n,_e(t))&&!mn(t.dom)&&!co(t.dom)},Ua={},gy=Un(["pre"]),ML=(e,t)=>{Ua[e]||(Ua[e]=[]),Ua[e].push(t)},UL=(e,t)=>{de(Ua,e)&&T(Ua[e],n=>{n(t)})};ML("pre",e=>{const t=e.selection.getRng(),n=o=>r=>{const a=r.previousSibling;return gy(a)&&Ie(o,a)},s=(o,r)=>{const a=C.fromDom(r),i=vs(a).dom;je(a),ao(C.fromDom(o),[C.fromTag("br",i),C.fromTag("br",i),...Tt(a)])};if(!t.collapsed){const o=e.selection.getSelectedBlocks(),r=le(le(o,gy),n(o));T(r,a=>{s(a.previousSibling,a)})}});const hy=["fontWeight","fontStyle","color","fontSize","fontFamily"],zL=e=>at(e.styles)&&Je(Gt(e.styles),t=>Ie(hy,t)),HL=e=>ft(e,t=>pt(t)&&t.inline==="span"&&zL(t)),by=(e,t)=>{const n=e.get(t);return tt(n)?HL(n):m.none()},Cy=(e,t)=>Xt(t,N.fromRangeStart(e)).isNone(),vy=(e,t)=>jt(t,N.fromRangeEnd(e)).exists(n=>!Xe(n.getNode())||jt(t,n).isSome())===!1,yy=e=>t=>NN(t)&&e.isEditable(t),VL=e=>{const t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return Cy(n,t[0])&&vy(n,t[0])?t:[];{const s=Vt(t).filter(a=>Cy(n,a)).toArray(),o=Os(t).filter(a=>vy(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},WL=e=>le(VL(e),yy(e.dom)),Ey=e=>le(e.getSelectedBlocks(),yy(e.dom)),fd=$.each,dd=e=>Z(e)&&!pn(e)&&!mn(e)&&!co(e),Sy=(e,t)=>{for(let n=e;n;n=n[t]){if(O(n)&&Qn(n.data))return e;if(Z(n)&&!pn(n))return n}return e},wy=(e,t,n)=>{const s=Yf(e),o=Ss(t)&&e.dom.isEditable(t),r=Ss(n)&&e.dom.isEditable(n);if(o&&r){const a=Sy(t,"previousSibling"),i=Sy(n,"nextSibling");if(s.compare(a,i)){for(let c=a.nextSibling;c&&c!==i;){const l=c;c=c.nextSibling,a.appendChild(l)}return e.dom.remove(i),$.each($.grep(i.childNodes),c=>{a.appendChild(c)}),a}}return n},ky=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){const r=(o=wy(e,Qb(s),s))!==null&&o!==void 0?o:s;wy(e,r,Qb(r,!0))}},jL=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";fd(e.select(s,n),o=>{dd(o)&&e.isEditable(o)&&fd(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},md=(e,t,n)=>{fd(e.childNodes,s=>{dd(s)&&(t(s)&&n(s),s.hasChildNodes()&&md(s,t,n))})},qL=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},_y=(e,t)=>n=>!!(n&&ec(e,n,t)),xy=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),qL(e,s)},To=rs.generate([{keep:[]},{rename:["name"]},{removed:[]}]),KL=/^(src|href|style)$/,pd=$.each,vc=rf,GL=e=>/^(TR|TH|TD)$/.test(e.nodeName),Ny=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),Ay=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(Z(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return O(s)&&n&&o>=s.data.length&&(s=new ht(s,e.getBody()).next()||s),O(s)&&!n&&o===0&&(s=new ht(s,e.getBody()).prev()||s),s},Ry=(e,t)=>{const n=t?"firstChild":"lastChild",s=e[n];return GL(e)&&s?e.nodeName==="TR"&&s[n]||s:e},gd=(e,t,n,s)=>{var o;const r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},Ty=(e,t,n,s,o)=>{const r=C.fromDom(t),a=C.fromDom(e.create(s,o)),i=n?dg(r):fg(r);return ao(a,i),n?(Yt(r,a),ql(a,r)):(Es(r,a),ct(a,r)),a.dom},YL=(e,t)=>t.links&&e.nodeName==="A",Py=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=Ot(e);ls(n)&&s===r.getRoot()&&(!n.list_block||!vc(t,n.list_block))&&T(nn(t.childNodes),i=>{dr(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=gd(r,i,a),r.setAttribs(o,va(e))):o=null}),!(ID(n)&&!vc(n.inline,t))&&r.remove(t,!0)},Dy=(e,t,n)=>$n(e)?{name:t,value:null}:{name:e,value:js(t,n)},Oy=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},By=(e,t,n,s,o)=>{let r=!1;pd(n.styles,(a,i)=>{const{name:c,value:l}=Dy(i,a,s),u=af(l,c);(n.remove_similar||zt(l)||!Z(o)||vc(ec(e,o,c),u))&&e.setStyle(t,c,""),r=!0}),r&&Oy(e,t)},XL=(e,t,n)=>{t==="removeformat"?T(Ey(e.selection),s=>{T(hy,o=>e.dom.setStyle(s,o,"")),Oy(e.dom,s)}):by(e.formatter,t).each(s=>{T(Ey(e.selection),o=>By(e.dom,o,s,n,null))})},Iy=(e,t,n,s,o)=>{const r=e.dom,a=Yf(e),i=e.schema;if(pt(t)&&ru(i,t.inline)&&uo(i,s)&&s.parentElement===e.getBody())return Py(e,s,t),To.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!Cc(r,s,t)&&!YL(s,t))return To.keep();const c=s,l=t.preserve_attributes;if(pt(t)&&t.remove==="all"&&tt(l)){const u=le(r.getAttribs(c),f=>Ie(l,f.name.toLowerCase()));if(r.removeAllAttribs(c),T(u,f=>r.setAttrib(c,f.name,f.value)),u.length>0)return To.rename("span")}if(t.remove!=="all"){By(r,c,t,n,o),pd(t.attributes,(f,d)=>{const{name:p,value:h}=Dy(d,f,n);if(t.remove_similar||zt(h)||!Z(o)||vc(r.getAttrib(o,p),h)){if(p==="class"){const g=r.getAttrib(c,p);if(g){let b="";if(T(g.split(/\s+/),v=>{/mce\-\w+/.test(v)&&(b+=(b?" ":"")+v)}),b){r.setAttrib(c,p,b);return}}}if(KL.test(p)&&c.removeAttribute("data-mce-"+p),p==="style"&&Un(["li"])(c)&&r.getStyle(c,"list-style-type")==="none"){c.removeAttribute(p),r.setStyle(c,"list-style-type","none");return}p==="class"&&c.removeAttribute("className"),c.removeAttribute(p)}}),pd(t.classes,f=>{f=js(f,n),(!Z(o)||r.hasClass(o,f))&&r.removeClass(c,f)});const u=r.getAttribs(c);for(let f=0;f<u.length;f++){const d=u[f].nodeName;if(!a.isAttributeInternal(d))return To.keep()}}return t.remove!=="none"?(Py(e,c,t),To.removed()):To.keep()},ZL=(e,t,n,s,o)=>{let r;return t.parentNode&&T(tc(e.dom,t.parentNode).reverse(),a=>{if(!r&&Z(a)&&a.id!=="_start"&&a.id!=="_end"){const i=us(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},QL=(e,t,n,s)=>Iy(e,t,n,s,s).fold(j(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),j(null)),JL=(e,t,n,s,o,r,a,i)=>{var c,l;let u,f;const d=e.dom;if(n){const p=n.parentNode;for(let h=s.parentNode;h&&h!==p;h=h.parentNode){let g=d.clone(h,!1);for(let b=0;b<t.length&&(g=QL(e,t[b],i,g),g!==null);b++);g&&(u&&g.appendChild(u),f||(f=g),u=g)}r&&(!a.mixed||!d.isBlock(n))&&(s=(c=d.split(n,s))!==null&&c!==void 0?c:s),u&&f&&((l=o.parentNode)===null||l===void 0||l.insertBefore(u,o),f.appendChild(o),pt(a)&&ky(e,a,i,u))}return s},e$=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0],i=e.dom,c=e.selection,l=g=>{const b=ZL(e,g,t,n,o);return JL(e,r,b,g,g,!0,a,n)},u=g=>pn(g)&&Z(g)&&(g.id==="_start"||g.id==="_end"),f=g=>Je(r,b=>za(e,b,n,g,g)),d=g=>{const b=nn(g.childNodes),y=f(g)||Je(r,R=>Cc(i,g,R)),E=g.parentNode;if(!y&&V(E)&&lf(a)&&f(E),a.deep&&b.length)for(let R=0;R<b.length;R++)d(b[R]);T(["underline","line-through","overline"],R=>{Z(g)&&e.dom.getStyle(g,"text-decoration")===R&&g.parentNode&&eC(i,g.parentNode)===R&&za(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:R}},void 0,g)})},p=g=>{const b=i.get(g?"_start":"_end");if(b){let v=b[g?"firstChild":"lastChild"];return u(v)&&(v=v[g?"firstChild":"lastChild"]),O(v)&&v.data.length===0&&(v=g?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling),i.remove(b,!0),v}else return null},h=g=>{let b,v,y=wo(i,g,r,g.collapsed);if(a.split){if(y=cc(y),b=Ay(e,y,!0),v=Ay(e,y),b!==v){if(b=Ry(b,!0),v=Ry(v,!1),Ny(i,b,v)){const S=m.from(b.firstChild).getOr(b);l(Ty(i,S,!0,"span",{id:"_start","data-mce-type":"bookmark"})),p(!0);return}if(Ny(i,v,b)){const S=m.from(v.lastChild).getOr(v);l(Ty(i,S,!1,"span",{id:"_end","data-mce-type":"bookmark"})),p(!1);return}b=gd(i,b,"span",{id:"_start","data-mce-type":"bookmark"}),v=gd(i,v,"span",{id:"_end","data-mce-type":"bookmark"});const E=i.createRng();E.setStartAfter(b),E.setEndBefore(v),Ra(i,E,S=>{T(S,R=>{!pn(R)&&!pn(R.parentNode)&&l(R)})}),l(b),l(v),b=p(!0),v=p()}else b=v=l(b);y.startContainer=b.parentNode?b.parentNode:b,y.startOffset=i.nodeIndex(b),y.endContainer=v.parentNode?v.parentNode:v,y.endOffset=i.nodeIndex(v)+1}Ra(i,y,E=>{T(E,d)})};if(s){if(Aa(s)){const g=i.createRng();g.setStartBefore(s),g.setEndAfter(s),h(g)}else h(s);bC(e,t,s,n);return}!c.isCollapsed()||!pt(a)||fr(e).length?(Zb(e,()=>tf(e,h),g=>pt(a)&&id(e,t,n,g)),e.nodeChanged()):BL(e,t,n,o),XL(e,t,n),bC(e,t,s,n)},Ly=(e,t,n,s,o)=>{(s||e.selection.isEditable())&&e$(e,t,n,s,o)},za=(e,t,n,s,o)=>Iy(e,t,n,s,o).fold(qe,r=>(e.dom.rename(s,r),!0),ot),$y=$.each,t$=(e,t,n,s)=>{const o=r=>{if(Ss(r)&&Z(r.parentNode)&&e.isEditable(r)){const a=eC(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&($.walk(s,o,"childNodes"),o(s))},n$=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){const o=_y(e,"fontSize");md(s,r=>o(r)&&e.isEditable(r),xy(e,"backgroundColor",js(t.styles.backgroundColor,n)))}},s$=(e,t,n,s)=>{if(pt(t)&&(t.inline==="sub"||t.inline==="sup")){const o=_y(e,"fontSize");md(s,a=>o(a)&&e.isEditable(a),xy(e,"fontSize",""));const r=le(e.select(t.inline==="sup"?"sub":"sup",s),e.isEditable);e.remove(r,!0)}},o$=(e,t,n,s)=>{$y(t,o=>{pt(o)&&$y(e.dom.select(o.inline,s),r=>{dd(r)&&za(e,o,n,r,o.exact?r:null)}),jL(e.dom,o,s)})},r$=(e,t,n,s,o)=>{const r=o.parentNode;us(e,r,n,s)&&za(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>us(e,a,n,s)?(za(e,t,s,o),!0):!1)},yc=$.each,a$=(e,t,n,s)=>{if(UT(e)&&pt(t)&&n.parentNode){const o=sh(e.schema),r=gN(C.fromDom(n),a=>mn(a.dom));return Ho(o,s)&&ws(e.schema,n.parentNode,{skipBogus:!1,includeZwsp:!0})&&!r}else return!1},Fy=(e,t,n,s)=>{if(yc(n.styles,(o,r)=>{e.setStyle(t,r,js(o,s))}),n.styles){const o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},i$=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,c=e.selection,l=(h,g=r)=>{Be(g.onformat)&&g.onformat(h,g,n,s),Fy(i,h,g,n),yc(g.attributes,(b,v)=>{i.setAttrib(h,v,js(b,n))}),yc(g.classes,b=>{const v=js(b,n);i.hasClass(h,v)||i.addClass(h,v)})},u=(h,g)=>{let b=!1;return yc(h,v=>gn(v)?i.getContentEditable(g)==="false"&&!v.ceFalseOverride||V(v.collapsed)&&v.collapsed!==a?!0:i.is(g,v.selector)&&!mn(g)?(l(g,v),b=!0,!1):!0:!1),b},f=h=>{if(ee(h)){const g=i.create(h);return l(g),g}else return null},d=(h,g,b)=>{const v=[];let y=!0;const E=r.inline||r.block,S=f(E),R=P=>OD(r)&&us(e,P,t,n),B=(P,x,A)=>{const U=BD(r)&&sf(e.schema,P)&&dr(e,x,E);return A&&U},z=(P,x,A,U)=>{const Q=P.nodeName.toLowerCase(),fe=dr(e,E,Q)&&dr(e,x,E),ye=!b&&O(P)&&$i(P.data),Ae=mn(P),De=!pt(r)||!h.isBlock(P);return(A||U)&&fe&&!ye&&!Ae&&De};Ra(h,g,P=>{let x;const A=U=>{let Q=!1,fe=y,ye=!1;const Ae=U.parentNode,De=Ae.nodeName.toLowerCase(),Le=h.getContentEditable(U);V(Le)&&(fe=y,y=Le==="true",Q=!0,ye=Jb(e,U));const yt=y&&!Q;if(Xe(U)&&!a$(e,r,U,De)){x=null,ls(r)&&h.remove(U);return}if(R(U)){x=null;return}if(B(U,De,yt)){const Oe=h.rename(U,E);l(Oe),v.push(Oe),x=null;return}if(gn(r)){let Oe=u(o,U);if(!Oe&&V(Ae)&&lf(r)&&(Oe=u(o,Ae)),!pt(r)||Oe){x=null;return}}V(S)&&z(U,De,yt,ye)?(x||(x=h.clone(S,!1),Ae.insertBefore(x,U),v.push(x)),ye&&Q&&(y=fe),x.appendChild(U)):(x=null,T(nn(U.childNodes),A),Q&&(y=fe),x=null)};T(P,A)}),r.links===!0&&T(v,P=>{const x=A=>{A.nodeName==="A"&&l(A,r),T(nn(A.childNodes),x)};x(P)}),T(v,P=>{const x=Q=>{let fe=0;return T(Q.childNodes,ye=>{!RD(ye)&&!pn(ye)&&fe++}),fe},A=Q=>ft(Q.childNodes,nf).filter(ye=>h.getContentEditable(ye)!=="false"&&Cc(h,ye,r)).map(ye=>{const Ae=h.clone(ye,!1);return l(Ae),h.replace(Ae,Q,!0),h.remove(ye,!0),Ae}).getOr(Q),U=x(P);if((v.length>1||!h.isBlock(P))&&U===0){h.remove(P,!0);return}(pt(r)||ls(r)&&r.wrapper)&&(!r.exact&&U===1&&(P=A(P)),o$(e,o,n,P),r$(e,r,t,n,P),n$(h,r,n,P),t$(h,r,n,P),s$(h,r,n,P),ky(e,r,n,P))})},p=Aa(s)?s:c.getNode();if(i.getContentEditable(p)==="false"&&!Jb(e,p)){s=p,u(o,s),hC(e,t,s,n);return}if(r){if(s)if(Aa(s)){if(!u(o,s)){const h=i.createRng();h.setStartBefore(s),h.setEndAfter(s),d(i,wo(i,h,o),!0)}}else d(i,s,!0);else!a||!pt(r)||fr(e).length?(c.setRng(ed(c.getRng())),Zb(e,()=>{tf(e,(h,g)=>{const b=g?h:wo(i,h,o);d(i,b,!1)})},ot),e.nodeChanged()):OL(e,t,n),by(e.formatter,t).each(h=>{T(WL(e.selection),g=>Fy(i,g,h,n))});UL(t,e)}hC(e,t,s,n)},My=(e,t,n,s)=>{(s||e.selection.isEditable())&&i$(e,t,n,s)},Uy=e=>de(e,"vars"),c$=(e,t)=>{e.set({}),t.on("NodeChange",n=>{Wy(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=m.from(n.node).map(o=>Aa(o)?o:o.startContainer).bind(o=>Z(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>zy(t));Wy(t,s,e.get())})},zy=e=>e.selection.getStart(),Hy=(e,t,n,s,o)=>gp(t,i=>{const c=e.formatter.matchNode(i,n,o??{},s);return!Et(c)},i=>iy(e,i,n)?!0:s?!1:V(e.formatter.matchNode(i,n,o,!0))),Vy=(e,t)=>{const n=t??zy(e);return le(tc(e.dom,n),s=>Z(s)&&!co(s))},Wy=(e,t,n)=>{const s=Vy(e,t);Ue(n,(o,r)=>{const a=i=>{const c=Hy(e,s,r,i.similar,Uy(i)?i.vars:void 0),l=c.isSome();if(i.state.get()!==l){i.state.set(l);const u=c.getOr(t);Uy(i)?i.callback(l,{node:u,format:r,parents:s}):T(i.callbacks,f=>f(l,{node:u,format:r,parents:s}))}};T([o.withSimilar,o.withoutSimilar],a),T(o.withVars,a)})},l$=(e,t,n,s,o,r)=>{const a=t.get();T(n.split(","),i=>{const c=We(a,i).getOrThunk(()=>{const u={withSimilar:{state:Ct(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Ct(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=u,u}),l=()=>{const u=Vy(e);return Hy(e,u,i,o,r).isSome()};if(Et(r)){const u=o?c.withSimilar:c.withoutSimilar;u.callbacks.push(s),u.callbacks.length===1&&u.state.set(l())}else c.withVars.push({state:Ct(l()),similar:o,vars:r,callback:s})}),t.set(a)},u$=(e,t,n)=>{const s=e.get();T(t.split(","),o=>We(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:le(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:le(r.withoutSimilar.callbacks,a=>a!==n)},withVars:le(r.withVars,a=>a.callback!==n)}})),e.set(s)},f$=(e,t,n,s,o,r)=>(l$(e,t,n,s,o,r),{unbind:()=>u$(t,n,s)}),d$=(e,t,n,s)=>{const o=e.formatter.get(t);o&&(id(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?Ly(e,t,n,s):My(e,t,n,s))},jy=$.explode,qy=()=>{const e={};return{addFilter:(o,r)=>{T(jy(o),a=>{de(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>Tl(e),removeFilter:(o,r)=>{T(jy(o),a=>{if(de(e,a))if(V(r)){const i=e[a],c=le(i.callbacks,l=>l!==r);c.length>0?i.callbacks=c:delete e[a]}else delete e[a]})}}},m$=(e,t)=>{T(t,n=>{e.attr(n,null)})},p$=(e,t,n)=>{e.addNodeFilter("font",s=>{T(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),c=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),c&&gi(c).each(l=>{r["font-size"]=n[l-1]}),o.name="span",o.attr("style",t.serialize(r)),m$(o,["color","face","size"])})})},g$=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";T(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},h$=(e,t,n)=>{var s;const o=gu();t.convert_fonts_to_spans&&p$(e,o,$.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),g$(e,n,o)},b$=(e,t,n)=>{t.inline_styles&&h$(e,t,n)},C$=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),v$=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},hd=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=r?v$(s):decodeURIComponent(s);return m.some({type:o[1],data:a,base64Encoded:r})}else return m.none()},Ky=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},y$=e=>new Promise((t,n)=>{hd(e).bind(({type:s,data:o,base64Encoded:r})=>Ky(s,o,r)).fold(()=>n("Invalid data URI"),t)}),E$=e=>dt(e,"blob:")?C$(e):dt(e,"data:")?y$(e):Promise.reject("Unknown URI format"),Gy=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)});let S$=0;const w$=e=>(e||"blobid")+S$++,Yy=(e,t,n)=>hd(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{const a=r?s:btoa(s);return n(a,o)}}),Xy=(e,t,n)=>{const s=e.create(w$(),t,n);return e.add(s),s},Zy=(e,t,n=!1)=>Yy(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>Ky(o,s).map(r=>Xy(e,r,s)))),k$=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(dt(t,"blob:")){const s=e.getByUri(t);return V(s)?Promise.resolve(s):E$(t).then(o=>Gy(o).then(r=>Yy(r,!1,a=>m.some(Xy(e,o,a))).getOrThunk(n)))}else return dt(t,"data:")?Zy(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},_$=/^(?:(?:(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)([A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*))(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?)$/,x$=e=>m.from(e.match(_$)).bind(t=>Fr(t,1)).map(t=>dt(t,"www.")?t.substring(4):t),Qy=(e,t)=>{m.from(e.attr("src")).bind(x$).forall(n=>!Ie(t,n))&&e.attr("sandbox","")},bd=(e,t)=>dt(e,`${t}/`),N$=e=>Et(e)?"iframe":bd(e,"image")?"img":bd(e,"video")?"video":bd(e,"audio")?"audio":"iframe",A$=({type:e,src:t,width:n,height:s}={},o,r)=>{const a=N$(e),i=new Mt(a,1);return i.attr(a==="audio"?{src:t}:{src:t,width:n,height:s}),(a==="audio"||a==="video")&&i.attr("controls",""),a==="iframe"&&o&&Qy(i,r),i},R$=e=>V(e.attr("data-mce-bogus")),T$=e=>e.attr("src")===Ne.transparentSrc||V(e.attr("data-mce-placeholder")),P$=(e,t)=>{const{blob_cache:n}=t;if(n){const s=o=>{const r=o.attr("src");T$(o)||R$(o)||it(r)||Zy(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>T(o,s))}},D$=(e,t)=>{var n,s;const o=e.schema;e.addAttributeFilter("href",c=>{let l=c.length;const u=d=>d.split(" ").filter(h=>h.length>0).concat(["noopener"]).sort().join(" "),f=d=>{const p=d?$.trim(d):"";return/\b(noopener)\b/g.test(p)?p:u(p)};if(!t.allow_unsafe_link_target)for(;l--;){const d=c[l];d.name==="a"&&d.attr("target")==="_blank"&&d.attr("rel",f(d.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",c=>{let l=c.length,u,f,d,p;for(;l--;)if(p=c[l],p.name==="a"&&p.firstChild&&!p.attr("href"))for(d=p.parent,u=p.lastChild;u&&d;)f=u.prev,d.insert(u,p),u=f}),t.fix_list_elements&&e.addNodeFilter("ul,ol",c=>{let l=c.length,u,f;for(;l--;)if(u=c[l],f=u.parent,f&&(f.name==="ul"||f.name==="ol"))if(u.prev&&u.prev.name==="li")u.prev.append(u);else{const d=new Mt("li",1);d.attr("style","list-style-type: none"),u.wrap(d)}});const r=o.getValidClasses();t.validate&&r&&e.addAttributeFilter("class",c=>{var l;let u=c.length;for(;u--;){const f=c[u],d=(l=f.attr("class"))!==null&&l!==void 0?l:"",p=$.explode(d," ");let h="";for(let g=0;g<p.length;g++){const b=p[g];let v=!1,y=r["*"];y&&y[b]&&(v=!0),y=r[f.name],!v&&y&&y[b]&&(v=!0),v&&(h&&(h+=" "),h+=b)}h.length||(h=null),f.attr("class",h)}}),P$(e,t);const a=(n=t.sandbox_iframes)!==null&&n!==void 0?n:!1,i=bp((s=t.sandbox_iframes_exclusions)!==null&&s!==void 0?s:[]);t.convert_unsafe_embeds&&e.addNodeFilter("object,embed",c=>T(c,l=>{l.replace(A$({type:l.attr("type"),src:l.name==="object"?l.attr("data"):l.attr("src"),width:l.attr("width"),height:l.attr("height")},a,i))})),a&&e.addNodeFilter("iframe",c=>T(c,l=>Qy(l,i)))},{entries:Jy,setPrototypeOf:eE,isFrozen:O$,getPrototypeOf:B$,getOwnPropertyDescriptor:I$}=Object;let{freeze:Zt,seal:jn,create:L$}=Object,{apply:Cd,construct:vd}=typeof Reflect<"u"&&Reflect;Cd||(Cd=function(t,n,s){return t.apply(n,s)}),Zt||(Zt=function(t){return t}),jn||(jn=function(t){return t}),vd||(vd=function(t,n){return new t(...n)});const $$=Nn(Array.prototype.forEach),F$=Nn(Array.prototype.pop),Ha=Nn(Array.prototype.push),Ec=Nn(String.prototype.toLowerCase),yd=Nn(String.prototype.toString),M$=Nn(String.prototype.match),qn=Nn(String.prototype.replace),U$=Nn(String.prototype.indexOf),z$=Nn(String.prototype.trim),Cn=Nn(RegExp.prototype.test),Va=H$(TypeError);function Nn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return Cd(e,t,s)}}function H$(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return vd(e,n)}}function Pe(e,t,n){var s;n=(s=n)!==null&&s!==void 0?s:Ec,eE&&eE(e,null);let o=t.length;for(;o--;){let r=t[o];if(typeof r=="string"){const a=n(r);a!==r&&(O$(t)||(t[o]=a),r=a)}e[r]=!0}return e}function hr(e){const t=L$(null);for(const[n,s]of Jy(e))t[n]=s;return t}function Sc(e,t){for(;e!==null;){const s=I$(e,t);if(s){if(s.get)return Nn(s.get);if(typeof s.value=="function")return Nn(s.value)}e=B$(e)}function n(s){return console.warn("fallback value for",s),null}return n}const tE=Zt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ed=Zt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Sd=Zt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V$=Zt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),wd=Zt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),W$=Zt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nE=Zt(["#text"]),sE=Zt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),kd=Zt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),oE=Zt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wc=Zt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j$=jn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q$=jn(/<%[\w\W]*|[\w\W]*%>/gm),K$=jn(/\${[\w\W]*}/gm),G$=jn(/^data-[\-\w.\u00B7-\uFFFF]/),Y$=jn(/^aria-[\-\w]+$/),rE=jn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X$=jn(/^(?:\w+script|data):/i),Z$=jn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aE=jn(/^html$/i);var iE=Object.freeze({__proto__:null,MUSTACHE_EXPR:j$,ERB_EXPR:q$,TMPLIT_EXPR:K$,DATA_ATTR:G$,ARIA_ATTR:Y$,IS_ALLOWED_URI:rE,IS_SCRIPT_OR_DATA:X$,ATTR_WHITESPACE:Z$,DOCTYPE_NAME:aE});const Q$=()=>typeof window>"u"?null:window,J$=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(s=n.getAttribute(o));const r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function cE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q$();const t=Ce=>cE(Ce);if(t.version="3.0.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;const n=e.document,s=n.currentScript;let{document:o}=e;const{DocumentFragment:r,HTMLTemplateElement:a,Node:i,Element:c,NodeFilter:l,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:d,trustedTypes:p}=e,h=c.prototype,g=Sc(h,"cloneNode"),b=Sc(h,"nextSibling"),v=Sc(h,"childNodes"),y=Sc(h,"parentNode");if(typeof a=="function"){const Ce=o.createElement("template");Ce.content&&Ce.content.ownerDocument&&(o=Ce.content.ownerDocument)}let E,S="";const{implementation:R,createNodeIterator:B,createDocumentFragment:z,getElementsByTagName:P}=o,{importNode:x}=n;let A={};t.isSupported=typeof Jy=="function"&&typeof y=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:Q,TMPLIT_EXPR:fe,DATA_ATTR:ye,ARIA_ATTR:Ae,IS_SCRIPT_OR_DATA:De,ATTR_WHITESPACE:Le}=iE;let{IS_ALLOWED_URI:yt}=iE,Oe=null;const F=Pe({},[...tE,...Ed,...Sd,...wd,...nE]);let X=null;const we=Pe({},[...sE,...kd,...oE,...wc]);let M=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),te=null,pe=null,H=!0,me=!0,be=!1,rt=!0,Re=!1,nt=!1,En=!1,Yn=!1,It=!1,Qt=!1,Sn=!1,Jt=!0,wn=!1;const J="user-content-";let Se=!0,He=!1,Ke={},et=null;const gt=Pe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ze=null;const Qe=Pe({},["audio","video","img","source","image","track"]);let Lt=null;const Rn=Pe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Tn="http://www.w3.org/1998/Math/MathML",Pn="http://www.w3.org/2000/svg",kn="http://www.w3.org/1999/xhtml";let Js=kn,Tr=!1,Pr=null;const sp=Pe({},[Tn,Pn,kn],yd);let Rs;const El=["application/xhtml+xml","text/html"],__="text/html";let xt,Fo=null;const x_=o.createElement("form"),op=function(_){return _ instanceof RegExp||_ instanceof Function},ps=function(_){if(!(Fo&&Fo===_)){if((!_||typeof _!="object")&&(_={}),_=hr(_),Rs=El.indexOf(_.PARSER_MEDIA_TYPE)===-1?Rs=__:Rs=_.PARSER_MEDIA_TYPE,xt=Rs==="application/xhtml+xml"?yd:Ec,Oe="ALLOWED_TAGS"in _?Pe({},_.ALLOWED_TAGS,xt):F,X="ALLOWED_ATTR"in _?Pe({},_.ALLOWED_ATTR,xt):we,Pr="ALLOWED_NAMESPACES"in _?Pe({},_.ALLOWED_NAMESPACES,yd):sp,Lt="ADD_URI_SAFE_ATTR"in _?Pe(hr(Rn),_.ADD_URI_SAFE_ATTR,xt):Rn,Ze="ADD_DATA_URI_TAGS"in _?Pe(hr(Qe),_.ADD_DATA_URI_TAGS,xt):Qe,et="FORBID_CONTENTS"in _?Pe({},_.FORBID_CONTENTS,xt):gt,te="FORBID_TAGS"in _?Pe({},_.FORBID_TAGS,xt):{},pe="FORBID_ATTR"in _?Pe({},_.FORBID_ATTR,xt):{},Ke="USE_PROFILES"in _?_.USE_PROFILES:!1,H=_.ALLOW_ARIA_ATTR!==!1,me=_.ALLOW_DATA_ATTR!==!1,be=_.ALLOW_UNKNOWN_PROTOCOLS||!1,rt=_.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Re=_.SAFE_FOR_TEMPLATES||!1,nt=_.WHOLE_DOCUMENT||!1,It=_.RETURN_DOM||!1,Qt=_.RETURN_DOM_FRAGMENT||!1,Sn=_.RETURN_TRUSTED_TYPE||!1,Yn=_.FORCE_BODY||!1,Jt=_.SANITIZE_DOM!==!1,wn=_.SANITIZE_NAMED_PROPS||!1,Se=_.KEEP_CONTENT!==!1,He=_.IN_PLACE||!1,yt=_.ALLOWED_URI_REGEXP||rE,Js=_.NAMESPACE||kn,M=_.CUSTOM_ELEMENT_HANDLING||{},_.CUSTOM_ELEMENT_HANDLING&&op(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(M.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&op(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(M.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(M.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(me=!1),Qt&&(It=!0),Ke&&(Oe=Pe({},[...nE]),X=[],Ke.html===!0&&(Pe(Oe,tE),Pe(X,sE)),Ke.svg===!0&&(Pe(Oe,Ed),Pe(X,kd),Pe(X,wc)),Ke.svgFilters===!0&&(Pe(Oe,Sd),Pe(X,kd),Pe(X,wc)),Ke.mathMl===!0&&(Pe(Oe,wd),Pe(X,oE),Pe(X,wc))),_.ADD_TAGS&&(Oe===F&&(Oe=hr(Oe)),Pe(Oe,_.ADD_TAGS,xt)),_.ADD_ATTR&&(X===we&&(X=hr(X)),Pe(X,_.ADD_ATTR,xt)),_.ADD_URI_SAFE_ATTR&&Pe(Lt,_.ADD_URI_SAFE_ATTR,xt),_.FORBID_CONTENTS&&(et===gt&&(et=hr(et)),Pe(et,_.FORBID_CONTENTS,xt)),Se&&(Oe["#text"]=!0),nt&&Pe(Oe,["html","head","body"]),Oe.table&&(Pe(Oe,["tbody"]),delete te.tbody),_.TRUSTED_TYPES_POLICY){if(typeof _.TRUSTED_TYPES_POLICY.createHTML!="function")throw Va('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Va('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=_.TRUSTED_TYPES_POLICY,S=E.createHTML("")}else E===void 0&&(E=J$(p,s)),E!==null&&typeof S=="string"&&(S=E.createHTML(""));Zt&&Zt(_),Fo=_}},ui=Pe({},["mi","mo","mn","ms","mtext"]),w=Pe({},["foreignobject","desc","title","annotation-xml"]),k=Pe({},["title","style","font","a","script"]),I=Pe({},Ed);Pe(I,Sd),Pe(I,V$);const D=Pe({},wd);Pe(D,W$);const ne=function(_){let Y=y(_);(!Y||!Y.tagName)&&(Y={namespaceURI:Js,tagName:"template"});const re=Ec(_.tagName),Ye=Ec(Y.tagName);return Pr[_.namespaceURI]?_.namespaceURI===Pn?Y.namespaceURI===kn?re==="svg":Y.namespaceURI===Tn?re==="svg"&&(Ye==="annotation-xml"||ui[Ye]):!!I[re]:_.namespaceURI===Tn?Y.namespaceURI===kn?re==="math":Y.namespaceURI===Pn?re==="math"&&w[Ye]:!!D[re]:_.namespaceURI===kn?Y.namespaceURI===Pn&&!w[Ye]||Y.namespaceURI===Tn&&!ui[Ye]?!1:!D[re]&&(k[re]||!I[re]):!!(Rs==="application/xhtml+xml"&&Pr[_.namespaceURI]):!1},Ee=function(_){Ha(t.removed,{element:_});try{_.parentNode.removeChild(_)}catch{_.remove()}},Ve=function(_,Y){try{Ha(t.removed,{attribute:Y.getAttributeNode(_),from:Y})}catch{Ha(t.removed,{attribute:null,from:Y})}if(Y.removeAttribute(_),_==="is"&&!X[_])if(It||Qt)try{Ee(Y)}catch{}else try{Y.setAttribute(_,"")}catch{}},Dn=function(_){let Y,re;if(Yn)_="<remove></remove>"+_;else{const On=M$(_,/^[\r\n\t ]+/);re=On&&On[0]}Rs==="application/xhtml+xml"&&Js===kn&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");const Ye=E?E.createHTML(_):_;if(Js===kn)try{Y=new d().parseFromString(Ye,Rs)}catch{}if(!Y||!Y.documentElement){Y=R.createDocument(Js,"template",null);try{Y.documentElement.innerHTML=Tr?S:Ye}catch{}}const $t=Y.body||Y.documentElement;return _&&re&&$t.insertBefore(o.createTextNode(re),$t.childNodes[0]||null),Js===kn?P.call(Y,nt?"html":"body")[0]:nt?Y.documentElement:$t},Sl=function(_){return B.call(_.ownerDocument||_,_,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},g9=function(_){return _ instanceof f&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof u)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function"||typeof _.hasChildNodes!="function")},wl=function(_){return typeof i=="object"?_ instanceof i:_&&typeof _=="object"&&typeof _.nodeType=="number"&&typeof _.nodeName=="string"},Ts=function(_,Y,re){A[_]&&$$(A[_],Ye=>{Ye.call(t,Y,re,Fo)})},N_=function(_){let Y;if(Ts("beforeSanitizeElements",_,null),g9(_))return Ee(_),!0;const re=xt(_.nodeName);if(Ts("uponSanitizeElement",_,{tagName:re,allowedTags:Oe}),_.hasChildNodes()&&!wl(_.firstElementChild)&&(!wl(_.content)||!wl(_.content.firstElementChild))&&Cn(/<[/\w]/g,_.innerHTML)&&Cn(/<[/\w]/g,_.textContent))return Ee(_),!0;if(!Oe[re]||te[re]){if(!te[re]&&R_(re)&&(M.tagNameCheck instanceof RegExp&&Cn(M.tagNameCheck,re)||M.tagNameCheck instanceof Function&&M.tagNameCheck(re)))return!1;if(Se&&!et[re]){const Ye=y(_)||_.parentNode,$t=v(_)||_.childNodes;if($t&&Ye){const On=$t.length;for(let ut=On-1;ut>=0;--ut)Ye.insertBefore(g($t[ut],!0),b(_))}}return Ee(_),!0}return _ instanceof c&&!ne(_)||(re==="noscript"||re==="noembed"||re==="noframes")&&Cn(/<\/no(script|embed|frames)/i,_.innerHTML)?(Ee(_),!0):(Re&&_.nodeType===3&&(Y=_.textContent,Y=qn(Y,U," "),Y=qn(Y,Q," "),Y=qn(Y,fe," "),_.textContent!==Y&&(Ha(t.removed,{element:_.cloneNode()}),_.textContent=Y)),Ts("afterSanitizeElements",_,null),!1)},A_=function(_,Y,re){if(Jt&&(Y==="id"||Y==="name")&&(re in o||re in x_))return!1;if(!(me&&!pe[Y]&&Cn(ye,Y))){if(!(H&&Cn(Ae,Y))){if(!X[Y]||pe[Y]){if(!(R_(_)&&(M.tagNameCheck instanceof RegExp&&Cn(M.tagNameCheck,_)||M.tagNameCheck instanceof Function&&M.tagNameCheck(_))&&(M.attributeNameCheck instanceof RegExp&&Cn(M.attributeNameCheck,Y)||M.attributeNameCheck instanceof Function&&M.attributeNameCheck(Y))||Y==="is"&&M.allowCustomizedBuiltInElements&&(M.tagNameCheck instanceof RegExp&&Cn(M.tagNameCheck,re)||M.tagNameCheck instanceof Function&&M.tagNameCheck(re))))return!1}else if(!Lt[Y]){if(!Cn(yt,qn(re,Le,""))){if(!((Y==="src"||Y==="xlink:href"||Y==="href")&&_!=="script"&&U$(re,"data:")===0&&Ze[_])){if(!(be&&!Cn(De,qn(re,Le,"")))){if(re)return!1}}}}}}return!0},R_=function(_){return _.indexOf("-")>0},T_=function(_){let Y,re,Ye,$t;Ts("beforeSanitizeAttributes",_,null);const{attributes:On}=_;if(!On)return;const ut={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X};for($t=On.length;$t--;){Y=On[$t];const{name:Bn,namespaceURI:rp}=Y;re=Bn==="value"?Y.value:z$(Y.value);const b9=re;if(Ye=xt(Bn),ut.attrName=Ye,ut.attrValue=re,ut.keepAttr=!0,ut.forceKeepAttr=void 0,Ts("uponSanitizeAttribute",_,ut),re=ut.attrValue,ut.forceKeepAttr)continue;if(!ut.keepAttr){Ve(Bn,_);continue}if(!rt&&Cn(/\/>/i,re)){Ve(Bn,_);continue}Re&&(re=qn(re,U," "),re=qn(re,Q," "),re=qn(re,fe," "));const P_=xt(_.nodeName);if(!A_(P_,Ye,re)){Ve(Bn,_);continue}if(wn&&(Ye==="id"||Ye==="name")&&(Ve(Bn,_),re=J+re),E&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!rp)switch(p.getAttributeType(P_,Ye)){case"TrustedHTML":{re=E.createHTML(re);break}case"TrustedScriptURL":{re=E.createScriptURL(re);break}}if(re!==b9)try{rp?_.setAttributeNS(rp,Bn,re):_.setAttribute(Bn,re)}catch{Ve(Bn,_)}}Ts("afterSanitizeAttributes",_,null)},h9=function Ce(_){let Y;const re=Sl(_);for(Ts("beforeSanitizeShadowDOM",_,null);Y=re.nextNode();)Ts("uponSanitizeShadowNode",Y,null),!N_(Y)&&(Y.content instanceof r&&Ce(Y.content),T_(Y));Ts("afterSanitizeShadowDOM",_,null)};return t.sanitize=function(Ce){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y,re,Ye,$t;if(Tr=!Ce,Tr&&(Ce="<!-->"),typeof Ce!="string"&&!wl(Ce))if(typeof Ce.toString=="function"){if(Ce=Ce.toString(),typeof Ce!="string")throw Va("dirty is not a string, aborting")}else throw Va("toString is not a function");if(!t.isSupported)return Ce;if(En||ps(_),t.removed=[],typeof Ce=="string"&&(He=!1),He){if(Ce.nodeName){const Bn=xt(Ce.nodeName);if(!Oe[Bn]||te[Bn])throw Va("root node is forbidden and cannot be sanitized in-place")}}else if(Ce instanceof i)Y=Dn("<!---->"),re=Y.ownerDocument.importNode(Ce,!0),re.nodeType===1&&re.nodeName==="BODY"||re.nodeName==="HTML"?Y=re:Y.appendChild(re);else{if(!It&&!Re&&!nt&&Ce.indexOf("<")===-1)return E&&Sn?E.createHTML(Ce):Ce;if(Y=Dn(Ce),!Y)return It?null:Sn?S:""}Y&&Yn&&Ee(Y.firstChild);const On=Sl(He?Ce:Y);for(;Ye=On.nextNode();)N_(Ye)||(Ye.content instanceof r&&h9(Ye.content),T_(Ye));if(He)return Ce;if(It){if(Qt)for($t=z.call(Y.ownerDocument);Y.firstChild;)$t.appendChild(Y.firstChild);else $t=Y;return(X.shadowroot||X.shadowrootmode)&&($t=x.call(n,$t,!0)),$t}let ut=nt?Y.outerHTML:Y.innerHTML;return nt&&Oe["!doctype"]&&Y.ownerDocument&&Y.ownerDocument.doctype&&Y.ownerDocument.doctype.name&&Cn(aE,Y.ownerDocument.doctype.name)&&(ut="<!DOCTYPE "+Y.ownerDocument.doctype.name+`>
`+ut),Re&&(ut=qn(ut,U," "),ut=qn(ut,Q," "),ut=qn(ut,fe," ")),E&&Sn?E.createHTML(ut):ut},t.setConfig=function(Ce){ps(Ce),En=!0},t.clearConfig=function(){Fo=null,En=!1},t.isValidAttribute=function(Ce,_,Y){Fo||ps({});const re=xt(Ce),Ye=xt(_);return A_(re,Ye,Y)},t.addHook=function(Ce,_){typeof _=="function"&&(A[Ce]=A[Ce]||[],Ha(A[Ce],_))},t.removeHook=function(Ce){if(A[Ce])return F$(A[Ce])},t.removeHooks=function(Ce){A[Ce]&&(A[Ce]=[])},t.removeAllHooks=function(){A={}},t}var lE=cE();const uE=$.each,eF=$.trim,tF=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],nF={ftp:21,http:80,https:443,mailto:25},sF=["img","video"],oF=(e,t)=>V(e)?!e:V(t)?!Ie(sF,t):!0,rF=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},fE=(e,t,n)=>{const s=rF(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?oF(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class An{static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=$s.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!fE(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}constructor(t,n={}){this.path="",this.directory="",t=eF(t),this.settings=n;const s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=s?s.path:new An(document.location.href).directory;if((s==null?void 0:s.protocol)==="")t="//mce_host"+o.toAbsPath(i,t);else{const c=/([^#?]*)([#?]?.*)/.exec(t);c&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,c[1])+c[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&uE(tF,(i,c)=>{let l=a[c];l&&(l=l.replace(/\(mce_at\)/g,"@@")),o[i]=l}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new An(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){const s=new An(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?nF[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),c=n.split("/");if(i.length>=c.length){for(r=0,a=i.length;r<a;r++)if(r>=c.length||i[r]!==c[r]){s=r+1;break}}if(i.length<c.length){for(r=0,a=c.length;r<a;r++)if(r>=i.length||i[r]!==c[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=c.length;r<a;r++)r!==s-1?o+="/"+c[r]:o+=c[r];return o}toAbsPath(t,n){let s=0;const o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];uE(r,f=>{f&&i.push(f)});const c=[];for(let f=a.length-1;f>=0;f--)if(!(a[f].length===0||a[f]===".")){if(a[f]===".."){s++;continue}if(s>0){s--;continue}c.push(a[f])}const l=i.length-s;let u;return l<=0?u=$r(c).join("/"):u=i.slice(0,l).join("/")+"/"+$r(c).join("/"),u.indexOf("/")!==0&&(u="/"+u),o&&u.lastIndexOf("/")!==u.length-1&&(u+=o),u}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const aF=$.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),_d="data-mce-type";let dE=0;const mE=(e,t,n,s,o)=>{var r,a,i,c;const l=t.validate,u=n.getSpecialElements();e.nodeType===Xp&&!t.allow_conditional_comments&&/^\[if/i.test((r=e.nodeValue)!==null&&r!==void 0?r:"")&&(e.nodeValue=" "+e.nodeValue);const f=(a=o==null?void 0:o.tagName)!==null&&a!==void 0?a:e.nodeName.toLowerCase();if(s!=="html"&&n.isValid(s)){V(o)&&(o.allowedTags[f]=!0);return}if(e.nodeType!==Wr||f==="body")return;const d=C.fromDom(e),p=jr(d,_d),h=on(d,"data-mce-bogus");if(!p&&ee(h)){h==="all"?je(d):Is(d);return}const g=n.getElementRule(f);if(l&&!g){de(u,f)?je(d):Is(d);return}else V(o)&&(o.allowedTags[f]=!0);if(l&&g&&!p){if(T((i=g.attributesForced)!==null&&i!==void 0?i:[],b=>{St(d,b.name,b.value==="{$uid}"?`mce_${dE++}`:b.value)}),T((c=g.attributesDefault)!==null&&c!==void 0?c:[],b=>{jr(d,b.name)||St(d,b.name,b.value==="{$uid}"?`mce_${dE++}`:b.value)}),g.attributesRequired&&!Je(g.attributesRequired,b=>jr(d,b))){Is(d);return}if(g.removeEmptyAttrs&&Px(d)){Is(d);return}g.outputName&&g.outputName!==f&&XA(d,g.outputName)}},iF=(e,t,n,s,o)=>{const r=e.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=pE(t,n,s,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,hE(a,n)&&(o.attrValue=a),t.allow_svg_data_urls&&dt(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):gE(e,a)&&(o.forceKeepAttr=!0)},pE=(e,t,n,s,o,r)=>n!=="html"&&!lo(s)?!0:!(o in aF&&fE(e,r,s))&&(!e.validate||t.isValid(s,o)||dt(o,"data-")||dt(o,"aria-")),gE=(e,t)=>e.hasAttribute(_d)&&(t==="id"||t==="class"||t==="style"),hE=(e,t)=>e in t.getBoolAttrs(),cF=(e,t,n,s)=>{const{attributes:o}=e;for(let r=o.length-1;r>=0;r--){const a=o[r],i=a.name,c=a.value;!pE(t,n,s,e.tagName.toLowerCase(),i,c)&&!gE(e,i)?e.removeAttribute(i):hE(i,n)&&e.setAttribute(i,i)}},lF=(e,t,n)=>{const s=lE();return s.addHook("uponSanitizeElement",(o,r)=>{mE(o,e,t,n.track(o),r)}),s.addHook("uponSanitizeAttribute",(o,r)=>{iF(o,e,t,n.current(),r)}),s},uF=(e,t)=>{const s={...{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]}};return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},fF=e=>{const t=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(s=>`xlink:${s}`),n={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:t};return lE().sanitize(e,n),e.innerHTML},dF=(e,t)=>{const n=$N();if(e.sanitize){const s=lF(e,t,n);return{sanitizeHtmlElement:(r,a)=>{s.sanitize(r,uF(e,a)),s.removed=[],n.reset()},sanitizeNamespaceElement:fF}}else return{sanitizeHtmlElement:(r,a)=>{const i=document.createNodeIterator(r,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let c;for(;c=i.nextNode();){const l=n.track(c);mE(c,e,t,l),Z(c)&&cF(c,e,t,l)}n.reset()},sanitizeNamespaceElement:he}},bE=$.makeMap,CE=$.extend,vE=(e,t,n,s)=>{const o=e.name,r=o in n&&o!=="title"&&o!=="textarea",a=t.childNodes;for(let i=0,c=a.length;i<c;i++){const l=a[i],u=new Mt(l.nodeName.toLowerCase(),l.nodeType);if(Z(l)){const f=l.attributes;for(let d=0,p=f.length;d<p;d++){const h=f[d];u.attr(h.name,h.value)}lo(u.name)&&(s(l),u.value=l.innerHTML)}else O(l)?(u.value=l.data,r&&(u.raw=!0)):(Ls(l)||kN(l)||_N(l))&&(u.value=l.data);lo(u.name)||vE(u,l,n,s),e.append(u)}},mF=(e,t,n)=>{const s=[];for(let o=e,r=o;o;r=o,o=o.walk()){const a=o;T(t,i=>i(a)),it(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){const r=s[o];T(n,a=>a(r))}},pF=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=CE(bE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),c=sh(t),l=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,f=/[ \t\r\n]+$/,d=y=>{let E=y.parent;for(;V(E);){if(E.name in a)return!0;E=E.parent}return!1},p=y=>{let E=y;for(;V(E);){if(E.name in c)return Fa(t,r,a,E);E=E.parent}return!1},h=y=>y.name in i||iu(t,y)||lo(y.name)&&y.parent===e,g=(y,E)=>{const S=E?y.prev:y.next;return V(S)||it(y.parent)?!1:h(y.parent)&&(y.parent!==e||s.isRootContent===!0)};return[y=>{var E;if(y.type===3&&!d(y)){let S=(E=y.value)!==null&&E!==void 0?E:"";S=S.replace(l," "),(II(y.prev,h)||g(y,!0))&&(S=S.replace(u,"")),S.length===0?y.remove():y.value=S}},y=>{var E;if(y.type===1){const S=t.getElementRule(y.name);if(o&&S){const R=Fa(t,r,a,y);S.paddInEmptyBlock&&R&&p(y)?Xf(n,s,h,y):S.removeEmpty&&R?h(y)?y.remove():y.unwrap():S.paddEmpty&&(R||OI(y))&&Xf(n,s,h,y)}}else if(y.type===3&&!d(y)){let S=(E=y.value)!==null&&E!==void 0?E:"";(y.next&&h(y.next)||g(y,!1))&&(S=S.replace(f,"")),S.length===0?y.remove():y.value=S}}]},gF=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},br=(e={},t=Fs())=>{const n=qy(),s=qy(),o={validate:!0,root_name:"body",sanitize:!0,...e},r=new DOMParser,a=dF(o,t),i=(E,S,R="html")=>{const B=R==="xhtml"?"application/xhtml+xml":"text/html",z=de(t.getSpecialElements(),S.toLowerCase()),P=z?`<${S}>${E}</${S}>`:E,x=R==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${P}</body></html>`:`<body>${P}</body>`,A=r.parseFromString(x,B).body;return a.sanitizeHtmlElement(A,B),z?A.firstChild:A},c=n.addFilter,l=n.getFilters,u=n.removeFilter,f=s.addFilter,d=s.getFilters,p=s.removeFilter,h=(E,S)=>{Jf(t,E)&&S.push(E)},g=(E,S)=>{const R=ee(S.attr(_d)),B=S.type===1&&!de(E,S.name)&&!iu(t,S)&&!lo(S.name);return S.type===3||B&&!R},b=(E,S)=>{const R=CE(bE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),B=/^[ \t\r\n]+/,z=/[ \t\r\n]+$/;let P=E.firstChild,x=null;const A=U=>{var Q,fe;U&&(P=U.firstChild,P&&P.type===3&&(P.value=(Q=P.value)===null||Q===void 0?void 0:Q.replace(B,"")),P=U.lastChild,P&&P.type===3&&(P.value=(fe=P.value)===null||fe===void 0?void 0:fe.replace(z,"")))};if(t.isValidChild(E.name,S.toLowerCase())){for(;P;){const U=P.next;g(R,P)?(x||(x=new Mt(S,1),x.attr(o.forced_root_block_attrs),E.insert(x,P)),x.append(P)):(A(x),x=null),P=U}A(x)}},y={schema:t,addAttributeFilter:f,getAttributeFilters:d,removeAttributeFilter:p,addNodeFilter:c,getNodeFilters:l,removeNodeFilter:u,parse:(E,S={})=>{var R;const B=o.validate,z=(R=S.context)!==null&&R!==void 0?R:o.root_name,P=i(E,z,S.format);su(t,P);const x=new Mt(z,11);vE(x,P,t.getSpecialElements(),a.sanitizeNamespaceElement),P.innerHTML="";const[A,U]=pF(x,t,o,S),Q=[],fe=B?Le=>h(Le,Q):he,ye={nodes:{},attributes:{}},Ae=Le=>ty(l(),d(),Le,ye);if(mF(x,[A,Ae],[U,fe]),Q.reverse(),B&&Q.length>0)if(S.context){const{pass:Le,fail:yt}=Uo(Q,Oe=>Oe.parent===x);Qf(yt,t,x,Ae),S.invalid=Le.length>0}else Qf(Q,t,x,Ae);const De=gF(o,S);return De&&(x.name==="body"||S.isRootContent)&&b(x,De),S.invalid||ny(ye,S),x}};return D$(y,o),b$(y,o,t),y},hF=e=>bc(e)?qs({validate:!1}).serialize(e):e,yE=(e,t,n)=>{const s=hF(e),o=t(s);if(o.isDefaultPrevented())return o;if(bc(e))if(o.content!==s){const r=br({validate:!1,forced_root_block:!1,...n}).parse(o.content,{context:e.name});return{...o,content:r}}else return{...o,content:e};else return o},EE=e=>({sanitize:Cb(e),sandbox_iframes:yb(e),sandbox_iframes_exclusions:zu(e)}),SE=(e,t)=>{if(t.no_events)return Wt.value(t);{const n=a1(e,t);return n.isDefaultPrevented()?Wt.error(vC(e,{content:"",...n}).content):Wt.value(n)}},wE=(e,t,n)=>n.no_events?t:yE(t,o=>vC(e,{...n,content:o}),EE(e)).content,xd=(e,t)=>{if(t.no_events)return Wt.value(t);{const n=yE(t.content,s=>r1(e,{...t,content:s}),EE(e));return n.isDefaultPrevented()?(CC(e,n),Wt.error(void 0)):Wt.value(n)}},Nd=(e,t,n)=>{n.no_events||CC(e,{...n,content:t})},Ad=(e,t,n)=>({element:e,width:t,rows:n}),kE=(e,t)=>({element:e,cells:t}),bF=(e,t)=>({x:e,y:t}),_E=(e,t)=>bs(e,t).bind(gi).getOr(1),CF=(e,t,n,s,o)=>{const r=_E(o,"rowspan"),a=_E(o,"colspan"),i=e.rows;for(let c=n;c<n+r;c++){i[c]||(i[c]=kE(yh(s),[]));for(let l=t;l<t+a;l++){const u=i[c].cells;u[l]=c===n&&l===t?o:go(o)}}},vF=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},yF=(e,t,n)=>{for(;vF(e,t,n);)t++;return t},xE=e=>Kt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),NE=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(Te(o[r],t))return m.some(bF(r,s))}return m.none()},AE=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const c=a[i].cells,l=t<s?c.slice(t,s+1):c.slice(s,t+1);r.push(kE(a[i].element,l))}return r},EF=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?AE(e,s,o,r,a):AE(e,s,a,r,o);return Ad(e.element,xE(i),i)},SF=(e,t)=>{const n=go(e.element),s=C.fromTag("tbody");return ao(s,t),ct(n,s),n},wF=e=>ke(e.rows,t=>{const n=ke(t.cells,o=>{const r=yh(o);return wt(r,"colspan"),wt(r,"rowspan"),r}),s=go(t.element);return ao(s,n),s}),kF=e=>{const t=Ad(go(e),0,[]);return T(Pt(e,"tr"),(n,s)=>{T(Pt(n,"td,th"),(o,r)=>{CF(t,yF(t,r,s),s,n,o)})}),Ad(t.element,xE(t.rows),t.rows)},_F=e=>SF(e,wF(e)),xF=(e,t,n)=>NE(e,t).bind(s=>NE(e,n).map(o=>EF(e,s,o))),NF=e=>ft(e,t=>_e(t)==="ul"||_e(t)==="ol"),AF=(e,t)=>ft(e,n=>_e(n)==="li"&&Ju(n,t)).fold(j([]),n=>NF(e).map(s=>{const o=C.fromTag(_e(s)),r=Ur(jl(s),(a,i)=>dt(i,"list-style"));return Ei(o,r),[C.fromTag("li"),o]}).getOr([])),RF=(e,t)=>{const n=Kt(t,(s,o)=>(ct(o,s),o),e);return t.length>0?gf([n]):n},TF=e=>da(e)?Mn(e).filter(wu).fold(j([]),t=>[e,t]):wu(e)?[e]:[],PF=(e,t,n)=>{const s=C.fromDom(t.commonAncestorContainer),o=xs(s,e),r=le(o,c=>n.isWrapper(_e(c))),a=AF(o,t),i=r.concat(a.length?a:TF(s));return ke(i,go)},RE=()=>gf([]),DF=(e,t,n)=>RF(C.fromDom(t.cloneContents()),PF(e,t,n)),OF=(e,t)=>Zr(t,"table",G(Te,e)),BF=(e,t)=>OF(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=kF(n);return xF(r,s,o).map(a=>gf([_F(a)]))}).getOrThunk(RE),IF=(e,t,n)=>t.length>0&&t[0].collapsed?RE():DF(e,t[0],n),LF=(e,t,n)=>{const s=Gb(t,e);return s.length>0?BF(e,s):IF(e,t,n)},kc=(e,t)=>t>=0&&t<e.length&&ur(e.charAt(t)),TE=e=>rn(e.innerText),$F=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),FF=e=>m.from(e.selection.getRng()).map(t=>{var n;const s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=$F(s),a=C.fromDom(t.cloneContents());av(a),iv(a);const i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),c=TE(i),l=rn((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),kc(l,0)||kc(l,l.length-1)){const u=s.getOr(o),f=TE(u),d=f.indexOf(c);if(d===-1)return c;{const p=kc(f,d-1),h=kc(f,d+c.length);return(p?" ":"")+c+(h?" ":"")}}else return c}).getOr(""),MF=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=Nf(e,Zu(o)),a=t.contextual?LF(C.fromDom(e.getBody()),r,e.schema).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},UF=(e,t)=>{if(t.format==="text")return FF(e);{const n=MF(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},zF=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),HF=(e,t,n={})=>{const s=zF(n,t);return SE(e,s).fold(Ht,o=>{const r=UF(e,o);return wE(e,r,o)})},Rd=0,PE=1,DE=2,VF=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(u,f,d)=>({start:u,end:f,diag:d}),a=(u,f,d,p,h)=>{const g=c(u,f,d,p);if(g===null||g.start===f&&g.diag===f-p||g.end===u&&g.diag===u-d){let b=u,v=d;for(;b<f||v<p;)b<f&&v<p&&e[b]===t[v]?(h.push([Rd,e[b]]),++b,++v):f-u>p-d?(h.push([DE,e[b]]),++b):(h.push([PE,t[v]]),++v)}else{a(u,g.start,d,g.start-g.diag,h);for(let b=g.start;b<g.end;++b)h.push([Rd,e[b]]);a(g.end,f,g.end-g.diag,p,h)}},i=(u,f,d,p)=>{let h=u;for(;h-f<p&&h<d&&e[h]===t[h-f];)++h;return r(u,h,f)},c=(u,f,d,p)=>{const h=f-u,g=p-d;if(h===0||g===0)return null;const b=h-g,v=g+h,y=(v%2===0?v:v+1)/2;s[1+y]=u,o[1+y]=f+1;let E,S,R,B,z;for(E=0;E<=y;++E){for(S=-E;S<=E;S+=2){for(R=S+y,S===-E||S!==E&&s[R-1]<s[R+1]?s[R]=s[R+1]:s[R]=s[R-1]+1,B=s[R],z=B-u+d-S;B<f&&z<p&&e[B]===t[z];)s[R]=++B,++z;if(b%2!==0&&b-E<=S&&S<=b+E&&o[R-b]<=s[R])return i(o[R-b],S+u-d,f,p)}for(S=b-E;S<=b+E;S+=2){for(R=S+y-b,S===b-E||S!==b+E&&o[R+1]<=o[R-1]?o[R]=o[R+1]-1:o[R]=o[R-1],B=o[R]-1,z=B-u+d-S;B>=u&&z>=d&&e[B]===t[z];)o[R]=B--,z--;if(b%2===0&&-E<=S&&S<=E&&o[R]<=s[R+b])return i(o[R],S+u-d,f,p)}}return null},l=[];return a(0,e.length,0,t.length,l),l},Td=e=>Z(e)?e.outerHTML:O(e)?$s.encodeRaw(e.data,!1):Ls(e)?"<!--"+e.data+"-->":"",WF=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},jF=(e,t,n)=>{const s=WF(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},qF=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];e.removeChild(n)}},KF=(e,t)=>{let n=0;T(e,s=>{s[0]===Rd?n++:s[0]===PE?(jF(t,s[1],n),n++):s[0]===DE&&qF(t,n)})},GF=(e,t)=>le(ke(nn(e.childNodes),t?Xn(rn,Td):Td),n=>n.length>0),YF=(e,t)=>{const n=ke(nn(t.childNodes),Td);return KF(VF(n,e),t),t},XF=Zn(()=>document.implementation.createHTMLDocument("undo")),ZF=e=>e.querySelector("iframe")!==null,QF=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),JF=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),_c=e=>{const t=e.serializer.getTempAttrs(),n=rv(e.getBody(),t);return ZF(n)?QF(GF(n,!0)):JF(rn(n.innerHTML))},Pd=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?YF(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:V(s)&&Vb(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},Dd=e=>e.type==="fragmented"?e.fragments.join(""):e.content,OE=e=>{const t=C.fromTag("body",XF());return wi(t,Dd(e)),T(Pt(t,"*[data-mce-bogus]"),Is),Sg(t)},eM=(e,t)=>Dd(e)===Dd(t),tM=(e,t)=>OE(e)===OE(t),Od=(e,t)=>!e||!t?!1:eM(e,t)?!0:tM(e,t),Bd=e=>e.get()===0,xc=(e,t,n)=>{Bd(n)&&(e.typing=t)},BE=(e,t)=>{e.typing&&(xc(e,!1,t),e.add())},nM=e=>{e.typing&&(e.typing=!1,e.add())},sM=(e,t,n)=>{Bd(t)&&n.set(Iu(e.selection))},oM=(e,t,n,s,o,r,a)=>{const i=_c(e),c=$.extend(r||{},i);if(!Bd(s)||e.removed)return null;const l=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:c,lastLevel:l,originalEvent:a}).isDefaultPrevented()||l&&Od(l,c))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});const u=KT(e);if(u&&t.data.length>u){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}c.bookmark=Iu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(c),n.set(t.data.length-1);const f={level:c,lastLevel:l,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",f),e.dispatch("change",f)):e.dispatch("AddUndo",f),c},rM=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},aM=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];Pd(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},iM=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],Pd(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},cM=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,xc(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],Pd(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},lM=e=>{e.clear(),e.add()},uM=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!Od(_c(e),t.data[0]),fM=(e,t)=>t.get()<e.data.length-1&&!e.typing,dM=(e,t,n)=>(BE(e,t),e.beforeChange(),e.ignore(n),e.add()),mM=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},pM=(e,t)=>{const n=e.dom,s=V(t)?t:e.getBody();T(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=JT(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,c=hb(e);i&&e.hasVisual?n.addClass(o,c):n.removeClass(o,c)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},IE=e=>({init:{bindEvents:he},undoManager:{beforeChange:(t,n)=>sM(e,t,n),add:(t,n,s,o,r,a)=>oM(e,t,n,s,o,r,a),undo:(t,n,s)=>cM(e,t,n,s),redo:(t,n)=>iM(e,t,n),clear:(t,n)=>rM(e,t,n),reset:t=>lM(t),hasUndo:(t,n)=>uM(e,t,n),hasRedo:(t,n)=>fM(t,n),transact:(t,n,s)=>dM(t,n,s),ignore:(t,n)=>mM(t,n),extra:(t,n,s,o)=>aM(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>id(e,t,n,s,o),matchAll:(t,n)=>_L(e,t,n),matchNode:(t,n,s,o)=>us(e,t,n,s,o),canApply:t=>NL(e,t),closest:t=>xL(e,t),apply:(t,n,s)=>My(e,t,n,s),remove:(t,n,s,o)=>Ly(e,t,n,s,o),toggle:(t,n,s)=>d$(e,t,n,s),formatChanged:(t,n,s,o,r)=>f$(e,t,n,s,o,r)},editor:{getContent:t=>JO(e,t),setContent:(t,n)=>wL(e,t,n),insertContent:(t,n)=>vL(e,t,n),addVisual:t=>pM(e,t)},selection:{getContent:(t,n)=>HF(e,t,n)},autocompleter:{addDecoration:he,removeDecoration:he},raw:{getModel:()=>m.none()}}),gM=e=>{const t=l=>at(l)?l:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:c}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(l,u,f)=>s.transact(f),ignore:(l,u)=>s.ignore(u),extra:(l,u,f,d)=>s.extra(f,d)},formatter:{match:(l,u,f,d)=>o.match(l,t(u),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:l=>o.canApply(l),closest:l=>o.closest(l),apply:(l,u,f)=>o.apply(l,t(u)),remove:(l,u,f,d)=>o.remove(l,t(u)),toggle:(l,u,f)=>o.toggle(l,t(u)),formatChanged:(l,u,f,d,p)=>o.formatChanged(u,f,d,p)},editor:{getContent:l=>r.getContent(l),setContent:(l,u)=>({content:r.setContent(l,u),html:""}),insertContent:(l,u)=>(r.insertContent(l),""),addVisual:r.addVisual},selection:{getContent:(l,u)=>a.getContent(u)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(c.getRawModel())}}},hM=()=>{const e=j(null),t=j("");return{init:{bindEvents:he},undoManager:{beforeChange:he,add:e,undo:e,redo:e,clear:he,reset:he,hasUndo:qe,hasRedo:qe,transact:e,ignore:he,extra:he},formatter:{match:qe,matchAll:j([]),matchNode:j(void 0),canApply:qe,closest:t,apply:he,remove:he,toggle:he,formatChanged:j({unbind:he})},editor:{getContent:t,setContent:j({content:"",html:""}),insertContent:j(""),addVisual:he},selection:{getContent:t},autocompleter:{addDecoration:he,removeDecoration:he},raw:{getModel:j(m.none())}}},fs=e=>de(e.plugins,"rtc"),bM=e=>We(e.plugins,"rtc").bind(t=>m.from(t.setup)),CM=e=>{const t=e;return bM(e).fold(()=>(t.rtcInstance=IE(e),m.none()),n=>(t.rtcInstance=hM(),m.some(()=>n().then(s=>(t.rtcInstance=gM(s),s.rtc.isRemote)))))},Id=e=>e.rtcInstance?e.rtcInstance:IE(e),lt=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},vM=(e,t,n)=>{lt(e).undoManager.beforeChange(t,n)},yM=(e,t,n,s,o,r,a)=>lt(e).undoManager.add(t,n,s,o,r,a),EM=(e,t,n,s)=>lt(e).undoManager.undo(t,n,s),SM=(e,t,n)=>lt(e).undoManager.redo(t,n),wM=(e,t,n)=>{lt(e).undoManager.clear(t,n)},kM=(e,t)=>{lt(e).undoManager.reset(t)},_M=(e,t,n)=>lt(e).undoManager.hasUndo(t,n),xM=(e,t,n)=>lt(e).undoManager.hasRedo(t,n),NM=(e,t,n,s)=>lt(e).undoManager.transact(t,n,s),AM=(e,t,n)=>{lt(e).undoManager.ignore(t,n)},RM=(e,t,n,s,o)=>{lt(e).undoManager.extra(t,n,s,o)},TM=(e,t,n,s,o)=>lt(e).formatter.match(t,n,s,o),PM=(e,t,n)=>lt(e).formatter.matchAll(t,n),DM=(e,t,n,s,o)=>lt(e).formatter.matchNode(t,n,s,o),OM=(e,t)=>lt(e).formatter.canApply(t),BM=(e,t)=>lt(e).formatter.closest(t),IM=(e,t,n,s)=>{lt(e).formatter.apply(t,n,s)},LM=(e,t,n,s,o)=>{lt(e).formatter.remove(t,n,s,o)},$M=(e,t,n,s)=>{lt(e).formatter.toggle(t,n,s)},FM=(e,t,n,s,o,r)=>lt(e).formatter.formatChanged(t,n,s,o,r),MM=(e,t)=>Id(e).editor.getContent(t),UM=(e,t,n)=>Id(e).editor.setContent(t,n),zM=(e,t,n)=>Id(e).editor.insertContent(t,n),HM=(e,t,n)=>lt(e).selection.getContent(t,n),VM=(e,t)=>lt(e).editor.addVisual(t),LE=e=>lt(e).init.bindEvents(),WM=(e,t={})=>{const n=t.format?t.format:"html";return HM(e,n,t)},$E=e=>e.dom.length===0?(je(e),m.none()):m.some(e),jM=(e,t)=>e.filter(n=>Ta.isBookmarkNode(n.dom)).bind(t?Xr:so),qM=(e,t,n,s,o)=>{const r=e.dom,a=t.dom,i=s?r.length:a.length;s?(Ff(r,a,o,!1,!s),n.setStart(a,i)):(Ff(a,r,o,!1,!s),n.setEnd(a,i))},KM=(e,t,n)=>{Mn(e).each(s=>{const o=e.dom;t&&Ia(s,N(o,0),n)?mc(o,0,n):!t&&La(s,N(o,o.length),n)&&$f(o,o.length,n)})},FE=(e,t,n,s,o)=>{e.bind(r=>((s?$f:mc)(r.dom,s?r.dom.length:0,o),t.filter(un).map(i=>qM(r,i,n,s,o)))).orThunk(()=>jM(t,s).or(t).filter(un).map(a=>KM(a,s,o)))},GM=(e,t,n)=>{const s=m.from(t.firstChild).map(C.fromDom),o=m.from(t.lastChild).map(C.fromDom);e.deleteContents(),e.insertNode(t);const r=s.bind(so).filter(un).bind($E),a=o.bind(Xr).filter(un).bind($E);FE(r,s,e,!0,n),FE(a,o,e,!1,n),e.collapse(!1)},YM=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),XM=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return qs({validate:!1},e.schema).serialize(r)}else return t.content},ZM=(e,t,n={})=>{const s=YM(n,t);xd(e,s).each(o=>{const r=XM(e,o),a=e.selection.getRng();GM(a,a.createContextualFragment(r),e.schema),e.selection.setRng(a),Da(e,a),Nd(e,r,o)})},ME=(e,t,n)=>{if(de(e,t)){const s=le(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var QM=(e,t)=>{let n,s;const o=(i,c)=>ft(c,l=>e.is(l,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{const c=i.element,l=r(c),u={};Ue(n,(f,d)=>{o(d,l).each(p=>{s[d]||(T(f,h=>{h(!0,{node:p,selector:d,parents:l})}),s[d]=f),u[d]=f})}),Ue(s,(f,d)=>{u[d]||(delete s[d],T(f,p=>{p(!1,{node:c,selector:d,parents:l})}))})})};return{selectorChangedWithUnbind:(i,c)=>(n||a(),n[i]||(n[i]=[]),n[i].push(c),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{ME(n,i,c),ME(s,i,c)}})}};const UE=e=>!!(e&&e.ownerDocument)&&Cs(C.fromDom(e.ownerDocument),C.fromDom(e)),JM=e=>e?UE(e.startContainer)&&UE(e.endContainer):!1,zE=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=QM(e,s),i=(F,X)=>{const we=e.createRng();V(F)&&V(X)?(we.setStart(F,X),we.setEnd(F,X),S(we),v(!1)):(ef(e,we,s.getBody(),!0),S(we))},c=F=>WM(s,F),l=(F,X)=>ZM(s,F,X),u=F=>XC(s.getBody(),E(),F),f=F=>ZC(s.getBody(),E(),F),d=(F,X)=>yt.getBookmark(F,X),p=F=>yt.moveToBookmark(F),h=(F,X)=>(MO(e,F,X).each(S),F),g=()=>{const F=E(),X=y();return!F||F.item?!1:F.compareEndPoints?F.compareEndPoints("StartToEnd",F)===0:!X||F.collapsed},b=()=>{const F=E(),X=s.getBody().querySelectorAll('[data-mce-selected="1"]');return X.length>0?Ds(X,we=>e.isEditable(we.parentElement)):GC(e,F)},v=F=>{const X=E();X.collapse(!!F),S(X)},y=()=>t.getSelection?t.getSelection():t.document.selection,E=()=>{let F;const X=(M,te,pe)=>{try{return te.compareBoundaryPoints(M,pe)}catch{return-1}},we=t.document;if(V(s.bookmark)&&!xo(s)){const M=Ef(s);if(M.isSome())return M.map(te=>Nf(s,[te])[0]).getOr(we.createRange())}try{const M=y();M&&!_i(M.anchorNode)&&(M.rangeCount>0?F=M.getRangeAt(0):F=we.createRange(),F=Nf(s,[F])[0])}catch{}if(F||(F=we.createRange()),ta(F.startContainer)&&F.collapsed){const M=e.getRoot();F.setStart(M,0),F.setEnd(M,0)}return o&&r&&(X(F.START_TO_START,F,o)===0&&X(F.END_TO_END,F,o)===0?F=r:(o=null,r=null)),F},S=(F,X)=>{if(!JM(F))return;const we=y();if(F=s.dispatch("SetSelectionRange",{range:F,forward:X}).range,we){r=F;try{we.removeAllRanges(),we.addRange(F)}catch{}X===!1&&we.extend&&(we.collapse(F.endContainer,F.endOffset),we.extend(F.startContainer,F.startOffset)),o=we.rangeCount>0?we.getRangeAt(0):null}if(!F.collapsed&&F.startContainer===F.endContainer&&(we!=null&&we.setBaseAndExtent)&&F.endOffset-F.startOffset<2&&F.startContainer.hasChildNodes()){const te=F.startContainer.childNodes[F.startOffset];te&&te.nodeName==="IMG"&&(we.setBaseAndExtent(F.startContainer,F.startOffset,F.endContainer,F.endOffset),(we.anchorNode!==F.startContainer||we.focusNode!==F.endContainer)&&we.setBaseAndExtent(te,0,te,1))}s.dispatch("AfterSetSelectionRange",{range:F,forward:X})},R=F=>(l(e.getOuterHTML(F)),F),B=()=>$O(s.getBody(),E()),z=(F,X)=>FO(e,E(),F,X),P=()=>{const F=y(),X=F==null?void 0:F.anchorNode,we=F==null?void 0:F.focusNode;if(!F||!X||!we||_i(X)||_i(we))return!0;const M=e.createRng(),te=e.createRng();try{M.setStart(X,F.anchorOffset),M.collapse(!0),te.setStart(we,F.focusOffset),te.collapse(!0)}catch{return!0}return M.compareBoundaryPoints(M.START_TO_START,te)<=0},Le={dom:e,win:t,serializer:n,editor:s,expand:(F={type:"word"})=>S(_o(e).expand(E(),F)),collapse:v,setCursorLocation:i,getContent:c,setContent:l,getBookmark:d,moveToBookmark:p,select:h,isCollapsed:g,isEditable:b,isForward:P,setNode:R,getNode:B,getSel:y,setRng:S,getRng:E,getStart:u,getEnd:f,getSelectedBlocks:z,normalize:()=>{const F=E(),X=y();if(!SD(X)&&Ji(s)){const we=ac(e,F);return we.each(M=>{S(M,P())}),we.getOr(F)}return F},selectorChanged:(F,X)=>(a(F,X),Le),selectorChangedWithUnbind:a,getScrollContainer:()=>{let F,X=e.getRoot();for(;X&&X.nodeName!=="BODY";){if(X.scrollHeight>X.clientHeight){F=X;break}X=X.parentNode}return F},scrollIntoView:(F,X)=>{V(F)?iO(s,F,X):Da(s,E(),X)},placeCaretAt:(F,X)=>S(NC(F,X,s.getDoc())),getBoundingClientRect:()=>{const F=E();return F.collapsed?N.fromRangeStart(F).getClientRects()[0]:F.getBoundingClientRect()},destroy:()=>{t=o=r=null,Oe.destroy()}},yt=Ta(Le),Oe=SC(Le,s);return Le.bookmarkManager=yt,Le.controlSelection=Oe,Le},eU=(e,t,n)=>{t.addNodeFilter("br",(s,o,r)=>{const a=$.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),c=n.getWhitespaceElements();a.body=1;const l=u=>u.name in a||iu(n,u);for(let u=0,f=s.length;u<f;u++){let d=s[u],p=d.parent;if(p&&l(p)&&d===p.lastChild){let h=d.prev;for(;h;){const g=h.name;if(g!=="span"||h.attr("data-mce-type")!=="bookmark"){g==="br"&&(d=null);break}h=h.prev}if(d&&(d.remove(),Fa(n,i,c,p))){const g=n.getElementRule(p.name);g&&(g.removeEmpty?p.remove():g.paddEmpty&&Xf(e,r,l,p))}}else{let h=d;for(;p&&p.firstChild===h&&p.lastChild===h&&(h=p,!a[p.name]);)p=p.parent;if(h===p){const g=new Mt("#text",3);g.value=bt,d.replace(g)}}}})},tU=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let c=s.length;for(;c--;){const l=s[c];let u=l.attr(r);u!==void 0?(l.attr(o,u.length>0?u:null),l.attr(r,null)):(u=l.attr(o),o==="style"?u=n.serializeStyle(n.parseStyle(u),l.name):a&&(u=a.call(i,u,o,l.name)),l.attr(o,u.length>0?u:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(l=>{var u;return!$i((u=l.value)!==null&&u!==void 0?u:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("noscript",s=>{var o;let r=s.length;for(;r--;){const a=s[r].firstChild;a&&(a.value=$s.decode((o=a.value)!==null&&o!==void 0?o:""))}}),e.addNodeFilter("script,style",(s,o)=>{var r;const a=c=>c.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let i=s.length;for(;i--;){const c=s[i],l=c.firstChild,u=(r=l==null?void 0:l.value)!==null&&r!==void 0?r:"";if(o==="script"){const f=c.attr("type");f&&c.attr("type",f==="mce-no/type"?null:f.replace(/^mce\-/,"")),t.element_format==="xhtml"&&l&&u.length>0&&(l.value=`// <![CDATA[
`+a(u)+`
// ]]>`)}else t.element_format==="xhtml"&&l&&u.length>0&&(l.value=`<!--
`+a(u)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o],a=r.value;t.preserve_cdata&&(a==null?void 0:a.indexOf("[CDATA["))===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(a==null?void 0:a.indexOf("mce:protected "))===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{T(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.remove_trailing_brs&&eU(t,e,e.schema)},nU=e=>{const t=s=>(s==null?void 0:s.name)==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},sU=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");$.each(r.nodeName==="BODY"?r.childNodes:[r],c=>{i.body.appendChild(i.importNode(c,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return GD(e,{...n,node:r}),s&&(o.doc=s),r},oU=(e,t)=>V(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,rU=(e,t,n)=>oU(e,n)?sU(e,t,n):t,aU=(e,t,n)=>{$.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},iU=(e,t,n)=>!t.no_events&&e?YD(e,{...t,content:n}).content:n,cU=(e,t,n)=>{const s=rn(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Li(C.fromDom(t))?s:$.trim(s)},lU=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return nU(o),o},uU=(e,t,n)=>qs(e,t).serialize(n),fU=(e,t,n,s,o)=>{const r=uU(t,n,s);return iU(e,o,r)},dU=(e,t)=>{const n=["data-mce-selected"],s={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},o=t&&t.dom?t.dom:Fe.DOM,r=t&&t.schema?t.schema:Fs(s),a=br(s,r);tU(a,s,o);const i=(c,l={})=>{const u={format:"html",...l},f=rU(t,c,u),d=cU(o,f,u),p=lU(a,d,u);return u.format==="tree"?p:fU(t,s,r,p,u)};return{schema:r,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:G(aU,a,n),getTempAttrs:j(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},HE=(e,t)=>{const n=dU(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},mU="html",pU=(e,t)=>({...e,format:t,get:!0,getInner:!0}),gU=(e,t={})=>{const n=t.format?t.format:mU,s=pU(t,n);return SE(e,s).fold(Ht,o=>{const r=MM(e,o);return wE(e,r,o)})},hU="html",bU=(e,t)=>({format:hU,...e,set:!0,content:t}),Ld=(e,t,n={})=>{const s=bU(n,t);return xd(e,s).map(o=>{const r=UM(e,o.content,o);return Nd(e,r.html,o),r.content}).getOr(t)},CU="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists,template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),vU=[],yU="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,template,textcolor,rtc".split(","),VE=[],WE=(e,t)=>{const n=le(t,s=>de(e,s));return eo(n)},EU=e=>{const t=WE(e,CU),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),eo(t)},SU=e=>WE(e,vU),jE=(e,t)=>{const n=$.makeMap(e.plugins," "),o=le(t,r=>de(n,r));return eo(o)},wU=e=>jE(e,yU),kU=e=>jE(e,VE.map(t=>t.name)),_U=(e,t)=>{const n=EU(e),s=wU(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,c=a?`

Themes:${i}mobile`:"",l=o?`

Plugins:${i}${s.join(i)}`:"",u=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 7.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/7/migration-from-6x/ for more information."+c+l+u)}},xU=e=>ft(VE,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),NU=(e,t)=>{const n=SU(e),s=kU(t),o=s.length>0,r=n.length>0;if(o||r){const a=`
- `,i=o?`

Plugins:${a}${s.map(xU).join(a)}`:"",c=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+c)}},AU=(e,t)=>{_U(e,t),NU(e,t)},Nc=Fe.DOM,RU=e=>{Nc.setStyle(e.id,"display",e.orgDisplay)},Ac=e=>m.from(e).each(t=>t.destroy()),TU=e=>{const t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;const n=e.selection;if(n){const s=n.dom;t.selection=n.win=n.dom=s.doc=null}},PU=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),Nc.unbind(t,"submit reset",e.formEventDelegate))},DU=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&V(o==null?void 0:o.nextSibling)&&Nc.remove(o.nextSibling),XD(e),e.editorManager.remove(e),!e.inline&&s&&RU(e),ZD(e),Nc.remove(e.getContainer()),Ac(t),Ac(n),e.destroy()}},OU=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Ac(n),Ac(s)),PU(e),TU(e),e.destroyed=!0}},Rc=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>de(e,o)}})(),Cr=Ft.ModelManager,qE=(e,t)=>t.dom[e],KE=(e,t)=>parseInt(ns(t,e),10),BU=G(qE,"clientWidth"),IU=G(qE,"clientHeight"),LU=G(KE,"margin-top"),$U=G(KE,"margin-left"),FU=e=>e.dom.getBoundingClientRect(),MU=(e,t,n)=>{const s=BU(e),o=IU(e);return t>=0&&n>=0&&t<=s&&n<=o},UU=(e,t,n,s)=>{const o=FU(t),r=e?o.left+t.dom.clientLeft+$U(t):0,a=e?o.top+t.dom.clientTop+LU(t):0,i=n-r,c=s-a;return{x:i,y:c}},zU=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.inline?s:zx(s),r=UU(e.inline,o,t,n);return MU(o,r.x,r.y)},HU=e=>m.from(e).map(C.fromDom),VU=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return HU(t).map(Go).getOr(!1)};var WU=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};const GE=e=>{const t=[],n=()=>{const d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():WU()},s=()=>m.from(t[0]),o=(d,p)=>d.type===p.type&&d.text===p.text&&!d.progressBar&&!d.timeout&&!p.progressBar&&!p.timeout,r=()=>{T(t,d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{Lr(t,p=>p===d).each(p=>{t.splice(p,1)})},c=(d,p=!0)=>e.removed||!VU(e)?{}:(p&&e.dispatch("BeforeOpenNotification",{notification:d}),ft(t,h=>o(n().getArgs(h),d)).getOrThunk(()=>{e.editorManager.setActive(e);const h=n().open(d,()=>{i(h),r(),KC(e)&&s().fold(()=>e.focus(),g=>UC(C.fromDom(g.getEl())))});return a(h),r(),e.dispatch("OpenNotification",{notification:{...h}}),h})),l=()=>{s().each(d=>{n().close(d),i(d),r()})},u=j(t);return(d=>{d.on("SkinLoaded",()=>{const p=IT(d);p&&c({text:p,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{T(t.slice(),p=>{n().close(p)})})})(e),{open:c,close:l,getNotifications:u}},vr=Ft.PluginManager,Po=Ft.ThemeManager;var jU=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};const YE=e=>{let t=[];const n=()=>{const g=e.theme;return g&&g.getWindowManagerImpl?g.getWindowManagerImpl():jU()},s=(g,b)=>(...v)=>b?b.apply(g,v):void 0,o=g=>{e.dispatch("OpenWindow",{dialog:g})},r=g=>{e.dispatch("CloseWindow",{dialog:g})},a=g=>{t.push(g),o(g)},i=g=>{r(g),t=le(t,b=>b!==g),t.length===0&&e.focus()},c=()=>m.from(t[t.length-1]),l=g=>{e.editorManager.setActive(e),lc(e),e.ui.show();const b=g();return a(b),b},u=(g,b)=>l(()=>n().open(g,b,i)),f=g=>l(()=>n().openUrl(g,i)),d=(g,b,v)=>{const y=n();y.alert(g,s(v||y,b))},p=(g,b,v)=>{const y=n();y.confirm(g,s(v||y,b))},h=()=>{c().each(g=>{n().close(g),i(g)})};return e.on("remove",()=>{T(t,g=>{n().close(g)})}),{open:u,openUrl:f,alert:d,confirm:p,close:h}},XE=(e,t)=>{e.notificationManager.open({type:"error",text:t})},Tc=(e,t)=>{e._skinLoaded?XE(e,t):e.on("SkinLoaded",()=>{XE(e,t)})},qU=(e,t)=>{Tc(e,Hn.translate(["Failed to upload image: {0}",t]))},Wa=(e,t,n)=>{gC(e,t,{message:n}),console.error(n)},ja=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,KU=(e,t,n)=>{Wa(e,"PluginLoadError",ja("plugin",t,n))},GU=(e,t,n)=>{Wa(e,"IconsLoadError",ja("icons",t,n))},YU=(e,t,n)=>{Wa(e,"LanguageLoadError",ja("language",t,n))},XU=(e,t,n)=>{Wa(e,"ThemeLoadError",ja("theme",t,n))},ZU=(e,t,n)=>{Wa(e,"ModelLoadError",ja("model",t,n))},QU=(e,t,n)=>{const s=Hn.translate(["Failed to initialize plugin: {0}",t]);gC(e,"PluginLoadError",{message:s}),Pc(s,n),Tc(e,s)},Pc=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},JU=e=>/^[a-z0-9\-]+$/i.test(e),$d=e=>"content/"+e+"/content.css",ez=e=>tinymce.Resource.has($d(e)),tz=e=>ZE(e,RT(e)),nz=e=>ZE(e,fb(e)),ZE=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return ke(t,r=>ez(r)?r:JU(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},sz=e=>{e.contentCSS=e.contentCSS.concat(tz(e),nz(e))},oz=e=>e?nn(e.getElementsByTagName("img")):[],rz=(e,t)=>{const n={};return{findAll:(o,r=ot)=>{const a=le(oz(o),c=>{const l=c.src;return c.hasAttribute("data-mce-bogus")||c.hasAttribute("data-mce-placeholder")||!l||l===Ne.transparentSrc?!1:dt(l,"blob:")?!e.isUploaded(l)&&r(c):dt(l,"data:")?r(c):!1}),i=ke(a,c=>{const l=c.src;if(de(n,l))return n[l].then(u=>ee(u)?u:{image:c,blobInfo:u.blobInfo});{const u=k$(t,l).then(f=>(delete n[l],{image:c,blobInfo:f})).catch(f=>(delete n[l],f));return n[l]=u,u}});return Promise.all(i)}}},QE=()=>{let n={};const s=(d,p)=>({status:d,resultUri:p}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{const p=n[d];return p?p.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,p)=>{n[d]=s(2,p)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}};let az=0;const iz=()=>{const e=()=>Math.round(Math.random()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},cz=e=>e+az+++iz(),lz=()=>{let e=[];const t=f=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[f.toLowerCase()]||"dat",n=(f,d,p,h,g)=>{if(ee(f))return s({id:f,name:h,filename:g,blob:d,base64:p});if(at(f))return s(f);throw new Error("Unknown input type")},s=f=>{if(!f.blob||!f.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const d=f.id||cz("blobid"),p=f.name||d,h=f.blob;return{id:j(d),name:j(p),filename:j(f.filename||p+"."+t(h.type)),blob:j(h),base64:j(f.base64),blobUri:j(f.blobUri||URL.createObjectURL(h)),uri:j(f.uri)}},o=f=>{a(f.id())||e.push(f)},r=f=>ft(e,f).getOrUndefined(),a=f=>r(d=>d.id()===f);return{create:n,add:o,get:a,getByUri:f=>r(d=>d.blobUri()===f),getByData:(f,d)=>r(p=>p.base64()===f&&p.blob().type===d),findFirst:r,removeByUri:f=>{e=le(e,d=>d.blobUri()===f?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{T(e,f=>{URL.revokeObjectURL(f.blobUri())}),e=[]}}},uz=(e,t)=>{const n={},s=(g,b)=>g?g.replace(/\/$/,"")+"/"+b.replace(/^\//,""):b,o=(g,b)=>new Promise((v,y)=>{const E=new XMLHttpRequest;E.open("POST",t.url),E.withCredentials=t.credentials,E.upload.onprogress=R=>{b(R.loaded/R.total*100)},E.onerror=()=>{y("Image upload failed due to a XHR Transport error. Code: "+E.status)},E.onload=()=>{if(E.status<200||E.status>=300){y("HTTP Error: "+E.status);return}const R=JSON.parse(E.responseText);if(!R||!ee(R.location)){y("Invalid JSON: "+E.responseText);return}v(s(t.basePath,R.location))};const S=new FormData;S.append("file",g.blob(),g.filename()),E.send(S)}),r=Be(t.handler)?t.handler:o,a=()=>new Promise(g=>{g([])}),i=(g,b)=>({url:b,blobInfo:g,status:!0}),c=(g,b)=>({url:"",blobInfo:g,status:!1,error:b}),l=(g,b)=>{$.each(n[g],v=>{v(b)}),delete n[g]},u=(g,b,v)=>(e.markPending(g.blobUri()),new Promise(y=>{let E,S;try{const R=()=>{E&&(E.close(),S=he)},B=P=>{R(),e.markUploaded(g.blobUri(),P),l(g.blobUri(),i(g,P)),y(i(g,P))},z=P=>{R(),e.removeFailed(g.blobUri()),l(g.blobUri(),c(g,P)),y(c(g,P))};S=P=>{P<0||P>100||m.from(E).orThunk(()=>m.from(v).map(xl)).each(x=>{E=x,x.progressBar.value(P)})},b(g,S).then(B,P=>{z(ee(P)?{message:P}:P)})}catch(R){y(c(g,R))}})),f=g=>g===o,d=g=>{const b=g.blobUri();return new Promise(v=>{n[b]=n[b]||[],n[b].push(v)})},p=(g,b)=>(g=$.grep(g,v=>!e.isUploaded(v.blobUri())),Promise.all($.map(g,v=>e.isPending(v.blobUri())?d(v):u(v,r,b))));return{upload:(g,b)=>!t.url&&f(r)?a():p(g,b)}},JE=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),e0=(e,t)=>uz(t,{url:ST(e),basePath:wT(e),credentials:kT(e),handler:_T(e)}),fz=e=>{const t=QE(),n=e0(e,t);return{upload:(s,o=!0)=>n.upload(s,o?JE(e):void 0)}},dz=(e,t)=>e.dom.isEmpty(t.dom)&&V(e.schema.getTextBlockElements()[_e(t)]),mz=e=>t=>{dz(e,t)&&ct(t,C.fromHtml('<br data-mce-bogus="1" />'))},pz=e=>{const t=lz();let n,s;const o=QE(),r=[],a=E=>S=>e.selection?E(S):[],i=E=>E+(E.indexOf("?")===-1?"?":"&")+new Date().getTime(),c=(E,S,R)=>{let B=0;do B=E.indexOf(S,B),B!==-1&&(E=E.substring(0,B)+R+E.substr(B+S.length),B+=R.length-S.length+1);while(B!==-1);return E},l=(E,S,R)=>{const B=`src="${R}"${R===Ne.transparentSrc?' data-mce-placeholder="1"':""}`;return E=c(E,`src="${S}"`,B),E=c(E,'data-mce-src="'+S+'"','data-mce-src="'+R+'"'),E},u=(E,S)=>{T(e.undoManager.data,R=>{R.type==="fragmented"?R.fragments=ke(R.fragments,B=>l(B,E,S)):R.content=l(R.content,E,S)})},f=(E,S)=>{const R=e.convertURL(S,"src");u(E.src,S),hs(C.fromDom(E),{src:ib(e)?i(S):S,"data-mce-src":R})},d=()=>(n||(n=e0(e,o)),b().then(a(E=>{const S=ke(E,R=>R.blobInfo);return n.upload(S,JE(e)).then(a(R=>{const B=[];let z=!1;const P=ke(R,(x,A)=>{const{blobInfo:U,image:Q}=E[A];let fe=!1;return x.status&&yT(e)?(x.url&&!At(Q.src,x.url)&&(z=!0),t.removeByUri(Q.src),fs(e)||f(Q,x.url)):x.error&&(x.error.remove&&(u(Q.src,Ne.transparentSrc),B.push(Q),fe=!0),qU(e,x.error.message)),{element:Q,status:x.status,uploadUri:x.url,blobInfo:U,removed:fe}});return B.length>0&&!fs(e)?e.undoManager.transact(()=>{T(Kl(B),x=>{const A=Mn(x);je(x),A.each(mz(e)),t.removeByUri(x.dom.src)})}):z&&e.undoManager.dispatchChange(),P}))}))),p=()=>ab(e)?d():Promise.resolve([]),h=E=>Ds(r,S=>S(E)),g=E=>{r.push(E)},b=()=>(s||(s=rz(o,t)),s.findAll(e.getBody(),h).then(a(E=>{const S=le(E,R=>ee(R)?(Tc(e,R),!1):R.uriType!=="blob");return fs(e)||T(S,R=>{u(R.image.src,R.blobInfo.blobUri()),R.image.src=R.blobInfo.blobUri(),R.image.removeAttribute("data-mce-src")}),S}))),v=()=>{t.destroy(),o.destroy(),s=n=null},y=E=>E.replace(/src="(blob:[^"]+)"/g,(S,R)=>{const B=o.getResultUri(R);if(B)return'src="'+B+'"';let z=t.getByUri(R);return z||(z=Kt(e.editorManager.get(),(P,x)=>P||x.editorUpload&&x.editorUpload.blobCache.getByUri(R),void 0)),z?'src="data:'+z.blob().type+";base64,"+z.base64()+'"':S});return e.on("SetContent",()=>{ab(e)?p():b()}),e.on("RawSaveContent",E=>{E.content=y(E.content)}),e.on("GetContent",E=>{E.source_view||E.format==="raw"||E.format==="tree"||(E.content=y(E.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",E=>{T(E,S=>{const R=S.attr("src");if(!R||t.getByUri(R))return;const B=o.getResultUri(R);B&&S.attr("src",B)})})}),{blobCache:t,addFilter:g,uploadImages:d,uploadImagesAuto:p,scanForImages:b,destroy:v}},gz=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>Z(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{$.each(a,(i,c)=>{t.setAttrib(o,c,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return $.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},t0={remove_similar:!0,inherit:!1},yr={selector:"td,th",...t0},hz={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...yr},tablecellverticalalign:{styles:{"vertical-align":"%value"},...yr},tablecellbordercolor:{styles:{borderColor:"%value"},...yr},tablecellclass:{classes:["%value"],...yr},tableclass:{selector:"table",classes:["%value"],...t0},tablecellborderstyle:{styles:{borderStyle:"%value"},...yr},tablecellborderwidth:{styles:{borderWidth:"%value"},...yr}},bz=j(hz),Cz=e=>{const t={},n=a=>V(a)?t[a]:t,s=a=>de(t,a),o=(a,i)=>{a&&(ee(a)?(tt(i)||(i=[i]),T(i,c=>{Et(c.deep)&&(c.deep=!gn(c)),Et(c.split)&&(c.split=!gn(c)||pt(c)),Et(c.remove)&&gn(c)&&!pt(c)&&(c.remove="none"),gn(c)&&pt(c)&&(c.mixed=!0,c.block_expand=!0),ee(c.classes)&&(c.classes=c.classes.split(/\s+/))}),t[a]=i):Ue(a,(c,l)=>{o(l,c)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(gz(e)),o(bz()),o(FT(e)),{get:n,has:s,register:o,unregister:r}},Dc=$.each,vn=Fe.DOM,Fd=e=>V(e)&&at(e),n0=(e,t)=>{const n=t&&t.schema||Fs({}),s=(c,l)=>{l.classes.length>0&&vn.addClass(c,l.classes.join(" ")),vn.setAttribs(c,l.attrs)},o=c=>{const l=ee(c)?{name:c,classes:[],attrs:{}}:c,u=vn.create(l.name);return s(u,l),u},r=(c,l)=>{const u=n.getElementRule(c.nodeName.toLowerCase()),f=u==null?void 0:u.parentsRequired;return f&&f.length?l&&Ie(f,l)?l:f[0]:!1},a=(c,l,u)=>{let f;const d=l[0],p=Fd(d)?d.name:void 0,h=r(c,p);if(h)p===h?(f=d,l=l.slice(1)):f=h;else if(d)f=d,l=l.slice(1);else if(!u)return c;const g=f?o(f):vn.create("div");g.appendChild(c),u&&$.each(u,v=>{const y=o(v);g.insertBefore(y,c)});const b=Fd(f)?f.siblings:void 0;return a(g,l,b)},i=vn.create("div");if(e.length>0){const c=e[0],l=o(c),u=Fd(c)?c.siblings:void 0;i.appendChild(a(l,e.slice(1),u))}return i},vz=e=>{e=$.trim(e);let t="div";const n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":$.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const c=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);c&&(n.attrs[c[1]]=c[2])}return""})),n.name=t||"div",n},yz=e=>ee(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),$.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=$.map(t.split(/(?:~\+|~|\+)/),vz),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],Ez=(e,t)=>{let n="",s=MT(e);if(s==="")return"";const o=d=>ee(d)?d.replace(/%(\w+)/g,""):"",r=(d,p)=>vn.getStyle(p??e.getBody(),d,!0);if(ee(t)){const d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){const d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i;const c=yz(t.selector);c.length>0?(c[0].name||(c[0].name=a),a=t.selector,i=n0(c,e)):i=n0([a],e);const l=vn.select(a,i)[0]||i.firstChild;Dc(t.styles,(d,p)=>{const h=o(d);h&&vn.setStyle(l,p,h)}),Dc(t.attributes,(d,p)=>{const h=o(d);h&&vn.setAttrib(l,p,h)}),Dc(t.classes,d=>{const p=o(d);vn.hasClass(l,p)||vn.addClass(l,p)}),e.dispatch("PreviewFormats"),vn.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);const u=r("fontSize"),f=/px$/.test(u)?parseInt(u,10):0;return Dc(s.split(" "),d=>{let p=r(d,l);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(p)&&(p=r(d),sa(p).toLowerCase()==="#ffffff"))&&!(d==="color"&&sa(p).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(p)){if(f===0)return;p=parseFloat(p)/(/%$/.test(p)?100:1)*f+"px"}d==="border"&&p&&(n+="padding:0 2px;"),n+=d+":"+p+";"}}),e.dispatch("AfterPreviewFormats"),vn.remove(i),n},Sz=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},s0=e=>{const t=Cz(e),n=Ct({});return Sz(e),$L(e),fs(e)||c$(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{IM(e,s,o,r)},remove:(s,o,r,a)=>{LM(e,s,o,r,a)},toggle:(s,o,r)=>{$M(e,s,o,r)},match:(s,o,r,a)=>TM(e,s,o,r,a),closest:s=>BM(e,s),matchAll:(s,o)=>PM(e,s,o),matchNode:(s,o,r,a)=>DM(e,s,o,r,a),canApply:s=>OM(e,s),formatChanged:(s,o,r,a)=>FM(e,n,s,o,r,a),getCssText:G(Ez,e)}},o0=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},wz=(e,t,n)=>{const s=Ct(!1),o=c=>{xc(t,!1,n),t.add({},c)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",c=>{const l=c.command;o0(l)||(BE(t,n),t.beforeChange())}),e.on("ExecCommand",c=>{const l=c.command;o0(l)||o(c)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",c=>{const l=c.keyCode;if(c.isDefaultPrevented())return;const u=Ne.os.isMacOS()&&c.key==="Meta";(l>=33&&l<=36||l>=37&&l<=40||l===45||c.ctrlKey||u)&&(o(),e.nodeChanged()),(l===46||l===8)&&e.nodeChanged(),s.get()&&t.typing&&!Od(_c(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged())}),e.on("keydown",c=>{const l=c.keyCode;if(c.isDefaultPrevented())return;if(l>=33&&l<=36||l>=37&&l<=40||l===45){t.typing&&o(c);return}const u=c.ctrlKey&&!c.altKey||c.metaKey;if((l<16||l>20)&&l!==224&&l!==91&&!t.typing&&!u){t.beforeChange(),xc(t,!0,n),t.add({},c),s.set(!0);return}(Ne.os.isMacOS()?c.metaKey:c.ctrlKey&&!c.altKey)&&t.beforeChange()}),e.on("mousedown",c=>{t.typing&&o(c)});const r=c=>c.inputType==="insertReplacementText",a=c=>c.inputType==="insertText"&&c.data===null,i=c=>c.inputType==="insertFromPaste"||c.inputType==="insertFromDrop";e.on("input",c=>{c.inputType&&(r(c)||a(c)||i(c))&&o(c)}),e.on("AddUndo Undo Redo ClearUndos",c=>{c.isDefaultPrevented()||e.nodeChanged()})},kz=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},r0=e=>{const t=Ms(),n=Ct(0),s=Ct(0),o={data:[],typing:!1,beforeChange:()=>{vM(e,n,t)},add:(r,a)=>yM(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);const r=_c(e);r.bookmark=Iu(e.selection),e.dispatch("change",{level:r,lastLevel:Fr(o.data,s.get()).getOrUndefined()})},undo:()=>EM(e,o,n,s),redo:()=>SM(e,s,o.data),clear:()=>{wM(e,o,s)},reset:()=>{kM(e,o)},hasUndo:()=>_M(e,o,s),hasRedo:()=>xM(e,o,s),transact:r=>NM(e,o,n,r),ignore:r=>{AM(e,n,r)},extra:(r,a)=>{RM(e,o,s,r,a)}};return fs(e)||wz(e,o,n),kz(e),o},_z=[9,27,K.HOME,K.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,K.DOWN,K.UP,K.LEFT,K.RIGHT].concat(Ne.browser.isFirefox()?[224]:[]),a0="data-mce-placeholder",i0=e=>e.type==="keydown"||e.type==="keyup",c0=e=>{const t=e.keyCode;return t===K.BACKSPACE||t===K.DELETE},xz=e=>{if(i0(e)){const t=e.keyCode;return!c0(e)&&(K.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||Ie(_z,t))}else return!1},Nz=e=>i0(e)&&!(c0(e)||e.type==="keyup"&&e.keyCode===229),Az=(e,t,n)=>{if(e.isEmpty(t,void 0,{skipBogus:!1,includeZwsp:!0})){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},Rz=e=>{var t;const n=e.dom,s=Ot(e),o=(t=BT(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(xz(a))return;const c=e.getBody(),l=Nz(a)?!1:Az(n,c,s);(n.getAttrib(c,a0)!==""!==l||i)&&(n.setAttrib(c,a0,l?o:null),o1(e,l),e.on(l?"keydown":"keyup",r),e.off(l?"keyup":"keydown",r))};Qn(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>hn.setEditorTimeout(e,()=>r(i)))})},Tz=(e,t)=>({block:e,position:t}),Pz=(e,t)=>({from:e,to:t}),Md=(e,t)=>{const n=C.fromDom(e),s=C.fromDom(t.container());return pc(n,s).map(o=>Tz(o,t))},Dz=e=>!Te(e.from.block,e.to.block),l0=(e,t)=>oo(t,o=>ma(o)||_n(o.dom),o=>Te(o,e)).filter(sn).getOr(e),Oz=(e,t)=>{const n=C.fromDom(e);return Te(l0(n,t.from.block),l0(n,t.to.block))},Bz=e=>ze(e.from.block.dom)===!1&&ze(e.to.block.dom)===!1,Iz=e=>{const t=n=>Sh(n)||ou(n.dom);return t(e.from.block)&&t(e.to.block)},Lz=(e,t,n,s)=>Xe(s.position.getNode())&&!Dt(e,s.block)?lr(!1,s.block.dom).bind(o=>o.isEqual(s.position)?dn(n,t,o).bind(r=>Md(t,r)):m.some(s)).getOr(s):s,$z=(e,t,n,s)=>{const o=Md(t,N.fromRangeStart(s)),r=o.bind(a=>dn(n,t,a.position).bind(i=>Md(t,i).map(c=>Lz(e,t,n,c))));return Rt(o,r,Pz).filter(a=>Dz(a)&&Oz(t,a)&&Bz(a)&&Iz(a))},Fz=(e,t,n,s)=>s.collapsed?$z(e,t,n,s):m.none(),Mz=(e,t)=>{const n=Tt(e);return Lr(n,s=>t.isBlock(_e(s))).fold(j(n),s=>n.slice(0,s))},u0=(e,t)=>{const n=Mz(e,t);return T(n,je),n},f0=(e,t,n)=>{const s=xs(n,t);return ft(s.reverse(),o=>Dt(e,o)).each(je)},Uz=(e,t)=>le(fg(t),n=>!Dt(e,n)).length===0,zz=(e,t,n,s,o)=>{if(Dt(s,n))return Us(n),Bt(n.dom);Uz(s,o)&&Dt(s,t)&&Yt(o,C.fromTag("br"));const r=Xt(n.dom,N.before(o.dom));return T(u0(t,s),a=>{Yt(o,a)}),f0(s,e,t),r},Hz=(e,t)=>e.isInline(_e(t)),Vz=(e,t,n,s)=>{if(Dt(s,n)){if(Dt(s,t)){const a=Ir((i=>{const c=(l,u)=>Ul(l).fold(()=>u,f=>Hz(s,f)?c(f,u.concat(go(f))):u);return c(i,[])})(n),(i,c)=>(Eg(i,c),c),pa());Xo(t),ct(t,a)}return je(n),Bt(t.dom)}const o=xn(n.dom);return T(u0(t,s),r=>{ct(n,r)}),f0(s,e,t),o},Wz=(e,t)=>{const n=xs(t,e);return m.from(n[n.length-1])},jz=(e,t)=>Cs(t,e)?Wz(t,e):m.none(),d0=(e,t)=>{lr(e,t.dom).bind(n=>m.from(n.getNode())).map(C.fromDom).filter(bo).each(je)},m0=(e,t,n,s)=>(d0(!0,t),d0(!1,n),jz(t,n).fold(G(Vz,e,t,n,s),G(zz,e,t,n,s))),p0=(e,t,n,s,o)=>t?m0(e,s,n,o):m0(e,n,s,o),Ud=(e,t)=>{const n=C.fromDom(e.getBody());return Fz(e.schema,n.dom,t,e.selection.getRng()).map(o=>()=>{p0(n,t,o.from.block,o.to.block,e.schema).each(r=>{e.selection.setRng(r.toRange())})})},qz=(e,t,n)=>{const s=t.getRng();return Rt(pc(e,C.fromDom(s.startContainer)),pc(e,C.fromDom(s.endContainer)),(o,r)=>Te(o,r)?m.none():m.some(()=>{s.deleteContents(),p0(e,!0,o,r,n).each(a=>{t.setRng(a.toRange())})})).getOr(m.none())},g0=(e,t)=>{const n=C.fromDom(t),s=G(Te,e);return ys(n,ma,s).isSome()},Kz=(e,t)=>g0(e,t.startContainer)||g0(e,t.endContainer),Gz=(e,t)=>{const n=Xt(e.dom,N.fromRangeStart(t)).isNone(),s=jt(e.dom,N.fromRangeEnd(t)).isNone();return!Kz(e,t)&&n&&s},Yz=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),Xz=e=>{const t=C.fromDom(e.getBody()),n=e.selection.getRng();return Gz(t,n)?Yz(e):qz(t,e.selection,e.schema)},zd=(e,t)=>e.selection.isCollapsed()?m.none():Xz(e),Ns=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),Zz=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},qa=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(Zz(t)),Qz=(e,t,n)=>{const s=Wu(1,e.getBody(),t),o=N.fromRangeStart(s),r=o.getNode();if(Ea(r))return Ns(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if(Ea(a))return Ns(1,e,a,!1,!1);const i=Ro(e.dom.getRoot(),o.getNode());return Ea(i)?Ns(1,e,i,!1,n):m.none()},Hd=(e,t,n)=>t.collapsed?Qz(e,t,n).getOr(t):t,Jz=e=>Gs(e)||Oa(e),eH=e=>Ys(e)||Ba(e),tH=(e,t)=>{O(t)&&t.data.length===0&&e.remove(t)},h0=(e,t,n,s,o,r)=>{Ns(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),tH(e.dom,n)},nH=(e,t)=>{const n=e.selection.getRng();if(!O(n.commonAncestorContainer))return m.none();const s=t?vt.Forwards:vt.Backwards,o=cs(e.getBody()),r=G(ju,t?o.next:o.prev),a=t?Jz:eH,i=xa(s,e.getBody(),n),c=r(i),l=c&&bn(t,c);if(!l||!Yi(i,l))return m.none();if(a(l))return m.some(()=>h0(e,n,i.getNode(),s,t,l));const u=r(l);return u&&a(u)&&Yi(l,u)?m.some(()=>h0(e,n,i.getNode(),s,t,u)):m.none()},Vd=(e,t)=>nH(e,t),Wd=(e,t)=>{const n=e.getBody();return t?Bt(n).filter(Gs):xn(n).filter(Ys)},jd=e=>{const t=e.selection.getRng();return!t.collapsed&&(Wd(e,!0).exists(n=>n.isEqual(N.fromRangeStart(t)))||Wd(e,!1).exists(n=>n.isEqual(N.fromRangeEnd(t))))},sH=e=>V(e)&&(ma(C.fromDom(e))||da(C.fromDom(e))),an=rs.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),oH=(e,t)=>{const n=t.getNode(!e),s=e?"after":"before";return Z(n)&&n.getAttribute("data-mce-caret")===s},rH=(e,t,n,s,o)=>{const r=a=>o.isInline(a.nodeName.toLowerCase())&&!as(n,s,e);return Ob(!t,n).fold(()=>Ob(t,s).fold(qe,r),r)},b0=(e,t,n,s,o)=>{const r=o.getNode(!n);return pc(C.fromDom(t),C.fromDom(s.getNode())).map(a=>Dt(e,a)?an.remove(a.dom):an.moveToElement(r)).orThunk(()=>m.some(an.moveToElement(r)))},C0=(e,t,n,s)=>dn(t,e,n).bind(o=>sH(o.getNode())||rH(e,t,n,o,s)?m.none():t&&ze(o.getNode())||!t&&ze(o.getNode(!0))?b0(s,e,t,n,o):t&&Ys(n)||!t&&Gs(n)?m.some(an.moveToPosition(o)):m.none()),aH=(e,t)=>it(t)?m.none():e&&ze(t.nextSibling)?m.some(an.moveToElement(t.nextSibling)):!e&&ze(t.previousSibling)?m.some(an.moveToElement(t.previousSibling)):m.none(),iH=(e,t,n)=>n.fold(s=>m.some(an.remove(s)),s=>m.some(an.moveToElement(s)),s=>as(t,s,e)?m.none():m.some(an.moveToPosition(s))),cH=(e,t,n,s)=>oH(t,n)?aH(t,n.getNode(!t)).orThunk(()=>C0(e,t,n,s)):C0(e,t,n,s).bind(o=>iH(e,n,o)),lH=(e,t,n,s)=>{const o=Wu(t?1:-1,e,n),r=N.fromRangeStart(o),a=C.fromDom(e);return!t&&Ys(r)?m.some(an.remove(r.getNode(!0))):t&&Gs(r)?m.some(an.remove(r.getNode())):!t&&Gs(r)&&Bf(a,r,s)?mB(a,r,s).map(i=>an.remove(i.getNode())):t&&Ys(r)&&Of(a,r,s)?pB(a,r,s).map(i=>an.remove(i.getNode())):cH(e,t,r,s)},uH=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),No(e,t,C.fromDom(n)),!0),fH=(e,t)=>n=>{const s=t?N.before(n):N.after(n);return e.selection.setRng(s.toRange()),!0},dH=e=>t=>(e.selection.setRng(t.toRange()),!0),v0=(e,t)=>m.from(Ro(e.getBody(),t)),mH=(e,t)=>{const n=e.selection.getNode();return v0(e,n).filter(ze).fold(()=>lH(e.getBody(),t,e.selection.getRng(),e.schema).map(s=>()=>s.fold(uH(e,t),fH(e,t),dH(e))),()=>m.some(he))},pH=e=>{T(Pt(e,".mce-offscreen-selection"),je)},gH=(e,t)=>{const n=e.selection.getNode();return ze(n)&&!Ni(n)?v0(e,n.parentNode).filter(ze).fold(()=>m.some(()=>{pH(C.fromDom(e.getBody())),No(e,t,C.fromDom(e.selection.getNode())),Uf(e)}),()=>m.some(he)):jd(e)?m.some(()=>{Hv(e,e.selection.getRng(),C.fromDom(e.getBody()))}):m.none()},y0=e=>{const t=e.dom,n=e.selection,s=Ro(e.getBody(),n.getNode());if(_n(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(N.before(o).toRange())}return!0},qd=(e,t)=>e.selection.isCollapsed()?mH(e,t):gH(e,t),hH=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return dn(t,e.getBody(),n).filter(s=>t?rB(s):aB(s)).bind(s=>Vu(t?0:-1,s)).map(s=>()=>e.selection.select(s))},Kd=(e,t)=>e.selection.isCollapsed()?hH(e,t):m.none(),Er=O,E0=e=>Er(e)&&e.data[0]===mt,S0=e=>Er(e)&&e.data[e.data.length-1]===mt,w0=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(mt)},bH=e=>{var t;if(Er(e.previousSibling))return S0(e.previousSibling)||e.previousSibling.appendData(mt),e.previousSibling;if(Er(e))return E0(e)||e.insertData(0,mt),e;{const n=w0(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},CH=e=>{var t,n;if(Er(e.nextSibling))return E0(e.nextSibling)||e.nextSibling.insertData(0,mt),e.nextSibling;if(Er(e))return S0(e)||e.appendData(mt),e;{const s=w0(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},Oc=(e,t)=>e?bH(t):CH(t),vH=G(Oc,!0),yH=G(Oc,!1),k0=(e,t)=>O(e.container())?Oc(t,e.container()):Oc(t,e.getNode()),_0=(e,t)=>{const n=t.get();return n&&e.container()===n&&zs(n)},Gd=(e,t)=>t.fold(n=>{yo(e.get());const s=vH(n);return e.set(s),m.some(N(s,s.length-1))},n=>Bt(n).map(s=>{if(_0(s,e)){const o=e.get();return N(o,1)}else{yo(e.get());const o=k0(s,!0);return e.set(o),N(o,1)}}),n=>xn(n).map(s=>{if(_0(s,e)){const o=e.get();return N(o,o.length-1)}else{yo(e.get());const o=k0(s,!1);return e.set(o),N(o,o.length-1)}}),n=>{yo(e.get());const s=yH(n);return e.set(s),m.some(N(s,1))}),x0=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},Ut=rs.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),N0=(e,t)=>{const n=Ws(t,e);return n||e},EH=(e,t,n)=>{const s=$v(n),o=N0(t,s.container());return Xs(e,o,s).fold(()=>jt(o,s).bind(G(Xs,e,o)).map(r=>Ut.before(r)),m.none)},SH=(e,t)=>So(e,t)===null,A0=(e,t,n)=>Xs(e,t,n).filter(G(SH,t)),wH=(e,t,n)=>{const s=Fv(n);return A0(e,t,s).bind(o=>Xt(o,s).isNone()?m.some(Ut.start(o)):m.none())},kH=(e,t,n)=>{const s=$v(n);return A0(e,t,s).bind(o=>jt(o,s).isNone()?m.some(Ut.end(o)):m.none())},_H=(e,t,n)=>{const s=Fv(n),o=N0(t,s.container());return Xs(e,o,s).fold(()=>Xt(o,s).bind(G(Xs,e,o)).map(r=>Ut.after(r)),m.none)},R0=e=>!Lv(Yd(e)),ds=(e,t,n)=>x0([EH,wH,kH,_H],[e,t,n]).filter(R0),Yd=e=>e.fold(Ht,Ht,Ht,Ht),T0=e=>e.fold(j("before"),j("start"),j("end"),j("after")),Bc=e=>e.fold(Ut.before,Ut.before,Ut.after,Ut.after),Xd=e=>e.fold(Ut.start,Ut.start,Ut.end,Ut.end),xH=(e,t)=>T0(e)===T0(t)&&Yd(e)===Yd(t),NH=(e,t,n,s,o,r)=>Rt(Xs(t,n,s),Xs(t,n,o),(a,i)=>a!==i&&qB(n,a,i)?Ut.after(e?a:i):r).getOr(r),AH=(e,t)=>e.fold(ot,n=>!xH(n,t)),RH=(e,t,n,s,o)=>{const r=bn(e,o);return dn(e,n,r).map(G(bn,e)).fold(()=>s.map(Bc),c=>ds(t,n,c).map(G(NH,e,t,n,r,c)).filter(G(AH,s))).filter(R0)},TH=(e,t)=>e?t.fold(Xn(m.some,Ut.start),m.none,Xn(m.some,Ut.after),m.none):t.fold(m.none,Xn(m.some,Ut.before),m.none,Xn(m.some,Ut.end)),PH=(e,t,n,s)=>{const o=bn(e,s),r=ds(t,n,o);return ds(t,n,o).bind(G(TH,e)).orThunk(()=>RH(e,t,n,r,s))},DH=e=>Be(e.selection.getSel().modify),P0=(e,t,n)=>{const s=e?1:-1;return t.setRng(N(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},OH=(e,t)=>{const n=t.selection.getRng(),s=e?N.fromRangeEnd(n):N.fromRangeStart(n);return DH(t)?e&&ku(s)?P0(!0,t.selection,s):!e&&_u(s)?P0(!1,t.selection,s):!1:!1};var ms;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(ms||(ms={}));const Ic=(e,t)=>e===vt.Backwards?$r(t):t,BH=(e,t,n)=>e===vt.Forwards?t.next(n):t.prev(n),IH=(e,t,n,s)=>Xe(s.getNode(t===vt.Forwards))?ms.Br:as(n,s)===!1?ms.Block:ms.Wrap,D0=(e,t,n,s)=>{const o=cs(n);let r=s;const a=[];for(;r;){const i=BH(t,o,r);if(!i)break;if(Xe(i.getNode(!1)))return t===vt.Forwards?{positions:Ic(t,a).concat([i]),breakType:ms.Br,breakAt:m.some(i)}:{positions:Ic(t,a),breakType:ms.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const c=IH(n,t,r,i);return{positions:Ic(t,a),breakType:c,breakAt:m.some(i)}}a.push(i),r=i}return{positions:Ic(t,a),breakType:ms.Eol,breakAt:m.none()}},O0=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===vt.Backwards?r.concat(o):[o].concat(r)}).getOr([]),Zd=(e,t)=>Kt(e,(n,s)=>n.fold(()=>m.some(s),o=>Rt(Vt(o.getClientRects()),Vt(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),Lc=(e,t)=>Vt(t.getClientRects()).bind(n=>Zd(e,n.left)),Ka=G(D0,N.isAbove,-1),Ga=G(D0,N.isBelow,1),B0=G(O0,-1,Ka),I0=G(O0,1,Ga),L0=(e,t)=>Ka(e,t).breakAt.isNone(),$0=(e,t)=>Ga(e,t).breakAt.isNone(),LH=e=>Bt(e).map(t=>[t].concat(Ga(e,t).positions)).getOr([]),$H=e=>xn(e).map(t=>Ka(e,t).positions.concat(t)).getOr([]),FH=(e,t)=>Lc(B0(e,t),t),MH=(e,t)=>Lc(I0(e,t),t),UH=ze,F0=(e,t)=>Math.abs(e.left-t),M0=(e,t)=>Math.abs(e.right-t),zH=e=>Ho(e,"node"),U0=(e,t)=>pi(e,(n,s)=>{const o=Math.min(F0(n,t),M0(n,t)),r=Math.min(F0(s,t),M0(s,t));return r===o&&zH(s)&&UH(s.node)||r<o?s:n}),HH=e=>{const t=n=>ke(n,s=>{const o=Co(s);return o.node=e,o});if(Z(e))return t(e.getClientRects());if(O(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},z0=e=>ln(e,HH);var Ya;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(Ya||(Ya={}));const VH=(e,t,n,s)=>{let o=s;for(;o=wa(o,e,Ph,t);)if(n(o))return},H0=(e,t,n,s,o,r)=>{let a=0;const i=[],c=f=>{let d=z0([f]);e===-1&&(d=d.reverse());for(let p=0;p<d.length;p++){const h=d[p];if(!n(h,l)){if(i.length>0&&t(h,to(i))&&a++,h.line=a,o(h))return!0;i.push(h)}}return!1},l=to(r.getClientRects());if(!l)return i;const u=r.getNode();return u&&(c(u),VH(e,s,c,u)),i},WH=(e,t)=>t.line>e,jH=(e,t)=>t.line===e,qH=G(H0,Ya.Up,ga,ha),KH=G(H0,Ya.Down,ha,ga),V0=e=>to(e.getClientRects()),GH=(e,t,n,s)=>{const o=cs(t);let r,a,i,c;const l=[];let u=0;e===1?(r=o.next,a=ha,i=ga,c=N.after(s)):(r=o.prev,a=ga,i=ha,c=N.before(s));const f=V0(c);do{if(!c.isVisible())continue;const d=V0(c);if(i(d,f))continue;l.length>0&&a(d,to(l))&&u++;const p=Co(d);if(p.position=c,p.line=u,n(p))return l;l.push(p)}while(c=r(c));return l},W0=e=>t=>WH(e,t),Qd=e=>t=>jH(e,t),As=(e,t)=>{e.selection.setRng(t),Da(e,e.selection.getRng())},Jd=(e,t,n)=>m.some(Hd(e,t,n)),j0=(e,t,n,s,o,r)=>{const a=t===vt.Forwards,i=cs(e.getBody()),c=G(ju,a?i.next:i.prev),l=a?s:o;if(!n.collapsed){const h=Ui(n);if(r(h))return Ns(t,e,h,t===vt.Backwards,!1);if(jd(e)){const g=n.cloneRange();return g.collapse(t===vt.Backwards),m.from(g)}}const u=xa(t,e.getBody(),n);if(l(u))return qa(e,u.getNode(!a));let f=c(u);const d=kh(n);if(f)f=bn(a,f);else return d?m.some(n):m.none();if(l(f))return Ns(t,e,f.getNode(!a),a,!1);const p=c(f);return p&&l(p)&&Yi(f,p)?Ns(t,e,p.getNode(!a),a,!1):d?Jd(e,f.toRange(),!1):m.none()},q0=(e,t,n,s,o,r)=>{const a=xa(t,e.getBody(),n),i=to(a.getClientRects()),c=t===Ya.Down,l=e.getBody();if(!i)return m.none();if(jd(e)){const b=c?N.fromRangeEnd(n):N.fromRangeStart(n);return(c?MH:FH)(l,b).orThunk(()=>m.from(b)).map(y=>y.toRange())}const f=(c?KH:qH)(l,W0(1),a),d=le(f,Qd(1)),p=i.left,h=U0(d,p);if(h&&r(h.node)){const b=Math.abs(p-h.left),v=Math.abs(p-h.right);return Ns(t,e,h.node,b<v,!1)}let g;if(s(a)?g=a.getNode():o(a)?g=a.getNode(!0):g=Ui(n),g){const b=GH(t,l,W0(1),g);let v=U0(le(b,Qd(1)),p);if(v||(v=to(le(b,Qd(0))),v))return Jd(e,v.position.toRange(),!1)}return d.length===0?em(e,c).filter(c?o:s).map(b=>Hd(e,b.toRange(),!1)):m.none()},em=(e,t)=>{const n=e.selection.getRng(),s=t?N.fromRangeEnd(n):N.fromRangeStart(n),o=QP(s.container(),e.getBody());if(t){const r=Ga(o,s);return Os(r.positions)}else{const r=Ka(o,s);return Vt(r.positions)}},K0=(e,t,n)=>em(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),$c=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},G0=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},Y0=(e,t,n)=>Gd(t,n).map(s=>($c(e,s),n)),YH=(e,t,n)=>{const s=N.fromRangeStart(e);if(e.collapsed)return s;{const o=N.fromRangeEnd(e);return n?Xt(t,o).getOr(o):jt(t,s).getOr(s)}},XH=(e,t,n)=>{const s=e.getBody(),o=YH(e.selection.getRng(),s,n),r=G(Ao,e);return PH(n,r,s,o).bind(i=>Y0(e,t,i))},ZH=(e,t,n)=>{const s=ke(Pt(C.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=le(s,e),r=le(n,e);T(fi(o,r),G(G0,!1)),T(fi(r,o),G(G0,!0))},QH=(e,t)=>{const n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){const s=N.fromRangeStart(e.selection.getRng());N.isTextPosition(s)&&!KB(s)&&($c(e,UP(n,s)),t.set(null))}},JH=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=le(s,e);T(o,r=>{const a=N.fromRangeStart(t.selection.getRng());ds(e,t.getBody(),a).bind(i=>Y0(t,n,i))})}},X0=(e,t,n)=>ya(e)?XH(e,t,n).isSome():!1,Z0=(e,t,n)=>ya(t)?OH(e,t):!1,e2=e=>{const t=Ct(null),n=G(Ao,e);return e.on("NodeChange",s=>{ya(e)&&(ZH(n,e.dom,s.parents),QH(e,t),JH(n,e,t,s.parents))}),t},t2=G(Z0,!0),n2=G(Z0,!1),Fc=(e,t,n)=>{if(ya(e)){const s=em(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?N.fromRangeEnd(o):N.fromRangeStart(o)});return ds(G(Ao,e),e.getBody(),s).exists(o=>{const r=Bc(o);return Gd(n,r).exists(a=>($c(e,a),!0))})}else return!1},s2=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},o2=e=>Rt(Bt(e),xn(e),(t,n)=>{const s=bn(!0,t),o=bn(!1,n);return jt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),Q0=(e,t)=>n=>Gd(t,n).map(s=>()=>$c(e,s)),J0=(e,t,n,s)=>{const o=e.getBody(),r=G(Ao,e);e.undoManager.ignore(()=>{e.selection.setRng(s2(n,s)),Mf(e),ds(r,o,N.fromRangeStart(e.selection.getRng())).map(Xd).bind(Q0(e,t)).each(Br)}),e.nodeChanged()},r2=(e,t)=>{const n=Ws(t,e);return n||e},a2=(e,t,n,s)=>{const o=r2(e.getBody(),s.container()),r=G(Ao,e),a=ds(r,o,s);return a.bind(c=>n?c.fold(j(m.some(Xd(c))),m.none,j(m.some(Bc(c))),m.none):c.fold(m.none,j(m.some(Bc(c))),m.none,j(m.some(Xd(c))))).map(Q0(e,t)).getOrThunk(()=>{const c=cr(n,o,s),l=c.bind(u=>ds(r,o,u));return Rt(a,l,()=>Xs(r,o,s).bind(u=>o2(u)?m.some(()=>{No(e,n,C.fromDom(u))}):m.none())).getOrThunk(()=>l.bind(()=>c.map(u=>()=>{n?J0(e,t,s,u):J0(e,t,u,s)})))})},tm=(e,t,n)=>{if(e.selection.isCollapsed()&&ya(e)){const s=N.fromRangeStart(e.selection.getRng());return a2(e,t,n,s)}return m.none()},i2=e=>Hl(e)>1,eS=(e,t)=>{const n=C.fromDom(e.getBody()),s=C.fromDom(e.selection.getStart()),o=xs(s,n);return Lr(o,t).fold(j(o),r=>o.slice(0,r))},c2=e=>Hl(e)===1,l2=e=>eS(e,t=>e.schema.isBlock(_e(t))||i2(t)),u2=e=>eS(e,t=>e.schema.isBlock(_e(t))),tS=(e,t)=>{const n=G(py,e);return ln(t,s=>n(s)?[s.dom]:[])},nS=e=>{const t=u2(e);return tS(e,t)},f2=(e,t,n,s)=>{const o=tS(t,s);if(o.length===0)No(t,e,n);else{const r=my(n.dom,o);t.selection.setRng(r.toRange())}},d2=(e,t)=>{const n=le(l2(e),c2);return Os(n).bind(s=>{const o=N.fromRangeStart(e.selection.getRng());return Uv(t,o,s.dom)&&!uf(s)?m.some(()=>f2(t,e,s,n)):m.none()})},m2=(e,t)=>{const n=t.parentElement;return Xe(t)&&!zt(n)&&e.dom.isEmpty(n)},p2=e=>uf(C.fromDom(e)),sS=(e,t)=>{const n=e.selection.getStart(),s=m2(e,n)||p2(n)?my(n,t):FL(e.selection.getRng(),t);e.selection.setRng(s.toRange())},g2=(e,t)=>{const n=fi(t,nS(e));n.length>0&&sS(e,n)},oS=e=>O(e.startContainer),h2=e=>e.startOffset===0&&oS(e),b2=(e,t)=>{const n=t.startContainer.parentElement;return!zt(n)&&py(e,C.fromDom(n))},C2=e=>{const t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!zt(t)&&!zt(n)&&t.isEqualNode(n)},v2=e=>{const t=e.endContainer;return e.endOffset===(O(t)?t.length:t.childNodes.length)},y2=e=>C2(e)&&v2(e),E2=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),S2=e=>y2(e)||E2(e),w2=e=>{const t=e.selection.getRng();return h2(t)&&b2(e,t)&&S2(t)},k2=e=>{if(w2(e)){const t=nS(e);return m.some(()=>{Mf(e),g2(e,t)})}else return m.none()},nm=(e,t)=>e.selection.isCollapsed()?d2(e,t):k2(e),_2=(e,t)=>Rg(e,n=>mn(n.dom),n=>t.isBlock(_e(n))),x2=e=>_2(C.fromDom(e.selection.getStart()),e.schema),N2=e=>{const t=e.selection.getRng();return t.collapsed&&(oS(t)||e.dom.isEmpty(t.startContainer))&&!x2(e)},Xa=e=>(N2(e)&&sS(e,[]),!0),sm=(e,t,n)=>V(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),No(e,t,C.fromDom(n))}):m.none(),A2=(e,t)=>{const n=t?Oa:Ba,s=t?vt.Forwards:vt.Backwards,o=xa(s,e.getBody(),e.selection.getRng());return n(o)?sm(e,t,o.getNode(!t)):m.from(bn(t,o)).filter(r=>n(r)&&Yi(o,r)).bind(r=>sm(e,t,r.getNode(!t)))},R2=(e,t)=>{const n=e.selection.getNode();return os(n)?sm(e,t,n):m.none()},om=(e,t)=>e.selection.isCollapsed()?A2(e,t):R2(e,t),T2=e=>oo(e,t=>_n(t.dom)||ze(t.dom)).exists(t=>_n(t.dom)),rm=e=>gi(e??"").getOr(0),rS=(e,t)=>{const n=e||rR(t)?"margin":"padding",s=ns(t,"direction")==="rtl"?"-right":"-left";return n+s},P2=(e,t,n,s,o,r)=>{const a=rS(n,C.fromDom(r)),i=rm(e.getStyle(r,a));if(t==="outdent"){const c=Math.max(0,i-s);e.setStyle(r,a,c?c+o:"")}else{const c=i+s+o;e.setStyle(r,a,c)}},D2=(e,t)=>Ds(t,n=>{const s=rS(ub(e),n),o=Si(n,s).map(rm).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),aS=e=>{const t=cS(e);return!e.mode.isReadOnly()&&(t.length>1||D2(e,t))},iS=e=>wu(e)||da(e),O2=e=>Mn(e).exists(iS),cS=e=>le(Kl(e.selection.getSelectedBlocks()),t=>!iS(t)&&!O2(t)&&T2(t)),lS=(e,t)=>{var n,s;const{dom:o}=e,r=AT(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=rm(r),c=ub(e);T(cS(e),l=>{P2(o,t,c,i,a,l.dom)})},B2=e=>lS(e,"indent"),uS=e=>lS(e,"outdent"),fS=e=>{if(e.selection.isCollapsed()&&aS(e)){const t=e.dom,n=e.selection.getRng(),s=N.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&Df(C.fromDom(o),s,e.schema))return m.some(()=>uS(e))}return m.none()},dS=(e,t,n)=>zo([fS,qd,Vd,(s,o)=>tm(s,t,o),Ud,Gf,Kd,om,zd,nm],s=>s(e,n)).filter(s=>e.selection.isEditable()),I2=(e,t)=>{dS(e,t,!1).fold(()=>{e.selection.isEditable()&&(Mf(e),Uf(e))},Br)},L2=(e,t)=>{dS(e,t,!0).fold(()=>{e.selection.isEditable()&&YB(e)},Br)},$2=(e,t)=>{e.addCommand("delete",()=>{I2(e,t)}),e.addCommand("forwardDelete",()=>{L2(e,t)})},mS=5,F2=400,pS=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),M2=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>mS||s>mS},U2=e=>{const t=Ms(),n=Ct(!1),s=Eu(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},F2);e.on("touchstart",o=>{pS(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),pS(o).each(r=>{t.on(a=>{M2(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},am=(e,t)=>de(e,t.nodeName),z2=(e,t)=>O(t)?!0:Z(t)?!am(e.getBlockElements(),t)&&!pn(t)&&!uo(e,t)&&!tu(t):!1,H2=(e,t,n)=>Je(bv(C.fromDom(n),C.fromDom(t)),s=>am(e,s.dom)),V2=(e,t)=>{if(O(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data))return!t.nextSibling||am(e,t.nextSibling)||tu(t.nextSibling)}return!1},gS=e=>e.dom.create(Ot(e),va(e)),W2=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody();let i,c,l=!1;const u=Ot(e);if(!r||!Z(r))return;const f=a.nodeName.toLowerCase();if(!s.isValidChild(f,u.toLowerCase())||H2(o,a,r))return;const d=n.getRng(),{startContainer:p,startOffset:h,endContainer:g,endOffset:b}=d,v=xo(e);let y=a.firstChild;for(;y;)if(Z(y)&&HN(s,y),z2(s,y)){if(V2(o,y)){c=y,y=y.nextSibling,t.remove(c);continue}i||(i=gS(e),a.insertBefore(i,y),l=!0),c=y,y=y.nextSibling,i.appendChild(c)}else i=null,y=y.nextSibling;l&&v&&(d.setStart(p,h),d.setEnd(g,b),n.setRng(d),e.nodeChanged())},hS=(e,t,n)=>{const s=C.fromDom(gS(e)),o=pa();ct(s,o),n(t,s);const r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},j2=e=>{e.on("NodeChange",G(W2,e))},bS=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,q2=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},K2=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],q2(e,o,bb(e)));n.content=o}},G2=e=>{const t="contenteditable",n=" "+$.trim(yP(e))+" ",s=" "+$.trim(bb(e))+" ",o=bS(n),r=bS(s),a=EP(e);a.length>0&&e.on("BeforeSetContent",i=>{K2(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let c=i.length;for(;c--;){const l=i[c];o(l)?l.attr(t,"true"):r(l)&&l.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let c=i.length;for(;c--;){const l=i[c];!o(l)&&!r(l)||(a.length>0&&l.attr("data-mce-content")?(l.name="#text",l.type=3,l.raw=!0,l.value=l.attr("data-mce-content")):l.attr(t,null))}})},Y2=e=>yi(C.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),CS=(e,t)=>{t.hasAttribute("data-mce-caret")&&(xu(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},X2=(e,t)=>{const n=Y2(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),CS(e,n);return}wh(n)&&(CS(e,n),e.undoManager.add())}},Z2=e=>{e.on("keyup compositionstart",G(X2,e))},vS=ze,Q2=(e,t,n)=>j0(t,e,n,Gs,Ys,vS),J2=(e,t,n)=>q0(t,e,n,r=>Gs(r)||gv(r),r=>Ys(r)||hv(r),vS),eV=e=>{const t=e.dom.create(Ot(e));return t.innerHTML='<br data-mce-bogus="1">',t},yS=(e,t,n)=>{const s=cs(e.getBody()),o=G(ju,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(N.fromRangeStart(n))){const i=C.fromDom(eV(e));t===1?Es(C.fromDom(r),i):Yt(C.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},tV=(e,t)=>{const n=t?vt.Forwards:vt.Backwards,s=e.selection.getRng();return Q2(n,e,s).orThunk(()=>(yS(e,n,s),m.none()))},nV=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return J2(n,e,s).orThunk(()=>(yS(e,n,s),m.none()))},sV=(e,t)=>{const n=t?e.getEnd(!0):e.getStart(!0);return Lv(n)?!t:t},ES=(e,t)=>tV(e,sV(e.selection,t)).exists(n=>(As(e,n),!0)),SS=(e,t)=>nV(e,t).exists(n=>(As(e,n),!0)),wS=(e,t)=>K0(e,t,t?Ys:Gs),Mc=(e,t)=>Wd(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(As(e,n),!0)),oV=e=>Ie(["figcaption"],_e(e)),rV=(e,t,n)=>{const s=G(Te,t);return oo(C.fromDom(e.container()),o=>n.isBlock(_e(o)),s).filter(oV)},aV=(e,t,n)=>t?$0(e.dom,n):L0(e.dom,n),iV=(e,t)=>{const n=C.fromDom(e.getBody()),s=N.fromRangeStart(e.selection.getRng());return rV(s,n,e.schema).exists(()=>{if(aV(n,t,s)){const r=hS(e,n,t?ct:ql);return e.selection.setRng(r),!0}else return!1})},kS=(e,t)=>e.selection.isCollapsed()?iV(e,t):!1,cV=(e,t,n)=>{const s=e.selection.getRng(),o=N.fromRangeStart(s);return e.getBody().firstChild===t&&L0(n,o)?(e.execCommand("InsertNewBlockBefore"),!0):!1},lV=(e,t)=>{const n=e.selection.getRng(),s=N.fromRangeStart(n);return e.getBody().lastChild===t&&$0(t,s)?(e.execCommand("InsertNewBlockAfter"),!0):!1},uV=(e,t)=>t?m.from(e.dom.getParent(e.selection.getNode(),"details")).map(n=>lV(e,n)).getOr(!1):m.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(n=>m.from(e.dom.getParent(n,"details")).map(s=>cV(e,s,n))).getOr(!1),_S=(e,t)=>uV(e,t),xS={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},fV=e=>ke(e,t=>({...xS,...t})),dV=e=>ke(e,t=>({...xS,...t})),NS=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,mV=(e,t)=>ln(fV(e),n=>NS(n,t)?[n]:[]),pV=(e,t)=>ln(dV(e),n=>NS(n,t)?[n]:[]),ie=(e,...t)=>()=>e.apply(null,t),Za=(e,t)=>ft(mV(e,t),n=>n.action()),AS=(e,t)=>zo(pV(e,t),n=>n.action()),RS=(e,t)=>{const n=t?vt.Forwards:vt.Backwards,s=e.selection.getRng();return j0(e,n,s,Oa,Ba,os).exists(o=>(As(e,o),!0))},TS=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return q0(e,n,s,Oa,Ba,os).exists(o=>(As(e,o),!0))},PS=(e,t)=>K0(e,t,t?Ba:Oa),DS=rs.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Qa={...DS,none:e=>DS.none(e)},gV=(e,t)=>OS(e,t,ot),OS=(e,t,n)=>ln(Tt(e),s=>Fn(s,t)?n(s)?[s]:[]:OS(s,t,n)),hV=(e,t,n=qe)=>{if(n(t))return m.none();if(Ie(e,_e(t)))return m.some(t);const s=o=>Fn(o,"table")||n(o);return Zr(t,e.join(","),s)},bV=(e,t)=>hV(["td","th"],e,t),CV=e=>gV(e,"th,td"),BS=(e,t)=>Yo(e,"table",t),im=(e,t,n,s,o=ot)=>{const r=s===1;if(!r&&n<=0)return Qa.first(e[0]);if(r&&n>=e.length-1)return Qa.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?Qa.middle(t,i):im(e,t,a,s,o)}},IS=(e,t)=>BS(e,t).bind(n=>{const s=CV(n);return Lr(s,r=>Te(e,r)).map(r=>({index:r,all:s}))}),vV=(e,t,n)=>IS(e,n).fold(()=>Qa.none(e),o=>im(o.all,e,o.index,1,t)),yV=(e,t,n)=>IS(e,n).fold(()=>Qa.none(),o=>im(o.all,e,o.index,-1,t)),EV=e=>ZA(e).filter(t=>t.trim().length!==0||t.indexOf(bt)>-1).isSome(),SV=e=>bi(e)&&on(e,"contenteditable")==="false",wV=["img","br"],kV=e=>EV(e)||Ie(wV,_e(e))||SV(e),_V=e=>hg(e,kV),xV=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),NV=(e,t)=>ln(t,n=>{const s=xV(Co(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),AV=(e,t,n)=>Kt(e,(s,o)=>s.fold(()=>m.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),LS=(e,t,n,s,o)=>{const r=Pt(C.fromDom(n),"td,th,caption").map(i=>i.dom),a=le(NV(e,r),i=>t(i,o));return AV(a,s,o).map(i=>i.cell)},RV=e=>e.bottom,TV=e=>e.top,PV=(e,t)=>e.y<t,DV=(e,t)=>e.y>t,OV=G(LS,RV,PV),BV=G(LS,TV,DV),IV=(e,t)=>Vt(t.getClientRects()).bind(n=>OV(e,n.left,n.top)).bind(n=>Lc($H(n),t)),LV=(e,t)=>Os(t.getClientRects()).bind(n=>BV(e,n.left,n.top)).bind(n=>Lc(LH(n),t)),$V=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),FV=e=>e.breakType===ms.Wrap&&e.positions.length===0,MV=e=>e.breakType===ms.Br&&e.positions.length===1,$S=(e,t,n)=>{const s=e(t,n);return FV(s)||!Xe(n.getNode())&&MV(s)?!$V(e,t,s):s.breakAt.isNone()},UV=G($S,Ka),zV=G($S,Ga),HV=(e,t,n)=>{const s=N.fromRangeStart(t);return lr(!e,n).exists(o=>o.isEqual(s))},VV=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return Nb()&&HV(t,o,n)?(Ns(r,e,n,!t,!1).each(a=>{As(e,a)}),!0):!1},WV=(e,t,n)=>IV(t,n).orThunk(()=>Vt(n.getClientRects()).bind(s=>Zd(B0(e,N.before(t)),s.left))).getOr(N.before(t)),jV=(e,t,n)=>LV(t,n).orThunk(()=>Vt(n.getClientRects()).bind(s=>Zd(I0(e,N.after(t)),s.left))).getOr(N.after(t)),FS=(e,t)=>{const n=t.getNode(e);return ss(n)?m.some(n):m.none()},qV=(e,t,n)=>{t.undoManager.transact(()=>{const s=e?Es:Yt,o=hS(t,C.fromDom(n),s);As(t,o)})},MS=(e,t,n)=>{const s=FS(!!t,n),o=t===!1;s.fold(()=>As(e,n.toRange()),r=>lr(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>As(e,n.toRange()),a=>qV(t,e,r)))},KV=(e,t,n,s)=>{const o=e.selection.getRng(),r=N.fromRangeStart(o),a=e.getBody();if(!t&&UV(s,r)){const i=WV(a,n,r);return MS(e,t,i),!0}else if(t&&zV(s,r)){const i=jV(a,n,r);return MS(e,t,i),!0}else return!1},US=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),zS=(e,t)=>US(e,t,VV),cm=(e,t)=>US(e,t,KV),GV=e=>{const t=pr.exact(e,0,e,0);return F1(t)},HS=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>_V(o).map(r=>GV(r)),s=>(e.execCommand("mceTableInsertRowAfter"),VS(e,t,s))),VS=(e,t,n)=>HS(e,t,vV(n,ro)),YV=(e,t,n)=>HS(e,t,yV(n,ro)),WS=(e,t)=>{const n=["table","li","dl"],s=C.fromDom(e.getBody()),o=i=>{const c=_e(i);return Te(i,s)||Ie(n,c)},r=e.selection.getRng(),a=C.fromDom(t?r.endContainer:r.startContainer);return bV(a,o).map(i=>(BS(i,o).each(u=>{e.model.table.clearSelectedCells(u.dom)}),e.selection.collapse(!t),(t?VS:YV)(e,o,i).each(u=>{e.selection.setRng(u)}),!0)).getOr(!1)},XV=(e,t,n)=>{const s=Ne.os.isMacOS()||Ne.os.isiOS();Za([{keyCode:K.RIGHT,action:ie(ES,e,!0)},{keyCode:K.LEFT,action:ie(ES,e,!1)},{keyCode:K.UP,action:ie(SS,e,!1)},{keyCode:K.DOWN,action:ie(SS,e,!0)},...s?[{keyCode:K.UP,action:ie(Mc,e,!1),metaKey:!0,shiftKey:!0},{keyCode:K.DOWN,action:ie(Mc,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:K.RIGHT,action:ie(zS,e,!0)},{keyCode:K.LEFT,action:ie(zS,e,!1)},{keyCode:K.UP,action:ie(cm,e,!1)},{keyCode:K.DOWN,action:ie(cm,e,!0)},{keyCode:K.UP,action:ie(cm,e,!1)},{keyCode:K.UP,action:ie(_S,e,!1)},{keyCode:K.DOWN,action:ie(_S,e,!0)},{keyCode:K.RIGHT,action:ie(RS,e,!0)},{keyCode:K.LEFT,action:ie(RS,e,!1)},{keyCode:K.UP,action:ie(TS,e,!1)},{keyCode:K.DOWN,action:ie(TS,e,!0)},{keyCode:K.RIGHT,action:ie(X0,e,t,!0)},{keyCode:K.LEFT,action:ie(X0,e,t,!1)},{keyCode:K.RIGHT,ctrlKey:!s,altKey:s,action:ie(t2,e,t)},{keyCode:K.LEFT,ctrlKey:!s,altKey:s,action:ie(n2,e,t)},{keyCode:K.UP,action:ie(kS,e,!1)},{keyCode:K.DOWN,action:ie(kS,e,!0)}],n).each(o=>{n.preventDefault()})},ZV=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||XV(e,t,n)})},Kn=(e,t)=>({container:e,offset:t}),Uc=Fe.DOM,zc=e=>t=>e===t?-1:0,QV=e=>t=>e.isBlock(t)||Ie(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",lm=(e,t,n)=>{if(O(e)&&t>=0)return m.some(Kn(e,t));{const s=ho(Uc);return m.from(s.backwards(e,t,zc(e),n)).map(o=>Kn(o.container,o.container.data.length))}},JV=(e,t,n)=>{if(O(e)&&t>=e.length)return m.some(Kn(e,t));{const s=ho(Uc);return m.from(s.forwards(e,t,zc(e),n)).map(o=>Kn(o.container,0))}},um=(e,t,n)=>{if(!O(e))return m.none();const s=e.data;if(t>=0&&t<=s.length)return m.some(Kn(e,t));{const o=ho(Uc);return m.from(o.backwards(e,t,zc(e),n)).bind(r=>{const a=r.container.data;return um(r.container,t+a.length,n)})}},jS=(e,t,n)=>{if(!O(e))return m.none();const s=e.data;if(t<=s.length)return m.some(Kn(e,t));{const o=ho(Uc);return m.from(o.forwards(e,t,zc(e),n)).bind(r=>jS(r.container,t-s.length,n))}},fm=(e,t,n,s,o)=>{const r=ho(e,QV(e));return m.from(r.backwards(t,n,s,o))},eW=e=>e.collapsed&&O(e.startContainer),tW=e=>rn(e.toString().replace(/\u00A0/g," ")),qS=e=>e!==""&&`  \f
\r	\v`.indexOf(e)!==-1,nW=(e,t)=>e.substring(t.length),sW=(e,t,n,s=!1)=>{let o;const r=n.charAt(0);for(o=t-1;o>=0;o--){const a=e.charAt(o);if(!s&&qS(a))return m.none();if(r===a&&At(e,n,o,t))break}return m.some(o)},dm=(e,t,n,s=!1)=>{if(!eW(t))return m.none();const o={text:"",offset:0},r=(i,c,l)=>(o.text=l+o.text,o.offset+=c,sW(o.text,o.offset,n,s).getOr(c)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return fm(e,t.startContainer,t.startOffset,r,a).bind(i=>{const c=t.cloneRange();if(c.setStart(i.container,i.offset),c.setEnd(t.endContainer,t.endOffset),c.collapsed)return m.none();const l=tW(c);return l.lastIndexOf(n)!==0?m.none():m.some({text:nW(l,n),range:c,trigger:n})})},oW=e=>e.nodeType===Jp,rW=e=>e.nodeType===Wr,KS=e=>{if(oW(e))return Kn(e,e.data.length);{const t=e.childNodes;return t.length>0?KS(t[t.length-1]):Kn(e,t.length)}},GS=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?GS(n[t],0):n.length>0&&rW(e)&&n.length===t?KS(n[n.length-1]):Kn(e,t)},aW=(e,t)=>{var n;const s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return fm(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{const r=o.container.data.charAt(o.offset-1);return!qS(r)}).isSome()},iW=e=>t=>{const n=GS(t.startContainer,t.startOffset);return!aW(e,n)},cW=(e,t,n)=>zo(n.triggers,s=>dm(e,t,s)),lW=(e,t)=>{const n=t(),s=e.selection.getRng();return cW(e.dom,s,n).bind(o=>YS(e,t,o))},YS=(e,t,n,s={})=>{var o;const r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",c=le(r.lookupByTrigger(n.trigger),u=>n.text.length>=u.minChars&&u.matches.getOrThunk(()=>iW(e.dom))(n.range,i,n.text));if(c.length===0)return m.none();const l=Promise.all(ke(c,u=>u.fetch(n.text,u.maxResults,s).then(d=>({matchText:n.text,items:d,columns:u.columns,onAction:u.onAction,highlightOn:u.highlightOn}))));return m.some({lookupData:l,context:n})};var Gn;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(Gn||(Gn={}));const mm=(e,t,n)=>e.stype===Gn.Error?t(e.serror):n(e.svalue),uW=e=>{const t=[],n=[];return T(e,s=>{mm(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},fW=(e,t)=>e.stype===Gn.Error?{stype:Gn.Error,serror:t(e.serror)}:e,dW=(e,t)=>e.stype===Gn.Value?{stype:Gn.Value,svalue:t(e.svalue)}:e,mW=(e,t)=>e.stype===Gn.Value?t(e.svalue):e,pW=(e,t)=>e.stype===Gn.Error?t(e.serror):e,XS=e=>({stype:Gn.Value,svalue:e}),ZS=e=>({stype:Gn.Error,serror:e}),kt={fromResult:e=>e.fold(ZS,XS),toResult:e=>mm(e,Wt.error,Wt.value),svalue:XS,partition:uW,serror:ZS,bind:mW,bindError:pW,map:dW,mapError:fW,fold:mm},pm=e=>at(e)&&Gt(e).length>100?" removed due to size":JSON.stringify(e,null,2),gW=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:j("... (only showing first ten failures)")}]):e;return ke(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},Hc=(e,t)=>kt.serror([{path:e,getErrorInfo:t}]),hW=(e,t,n)=>Hc(e,()=>'Could not find valid *required* value for "'+t+'" in '+pm(n)),bW=(e,t)=>Hc(e,()=>'Choice schema did not contain choice key: "'+t+'"'),CW=(e,t,n)=>Hc(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+pm(t)),vW=(e,t)=>Hc(e,j(t)),yW=(e,t,n,s)=>We(n,s).fold(()=>CW(e,n,s),r=>r.extract(e.concat(["branch: "+s]),t)),EW=(e,t)=>({extract:(o,r)=>We(r,e).fold(()=>bW(o,e),i=>yW(o,r,t,i)),toString:()=>"chooseOn("+e+"). Possible values: "+Gt(t)}),SW=(e,t)=>t,wW=(e,t)=>_l(e)&&_l(t)?Vc(e,t):t,QS=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)de(o,r)&&(n[r]=e(n[r],o[r]))}return n},Vc=QS(wW),kW=QS(SW),JS=()=>({tag:"required",process:{}}),_W=e=>({tag:"defaultedThunk",process:e}),ew=e=>_W(j(e)),xW=()=>({tag:"option",process:{}}),NW=(e,t)=>e.length>0?kt.svalue(Vc(t,kW.apply(void 0,e))):kt.svalue(t),tw=e=>Xn(kt.serror,hp)(e),AW={consolidateObj:(e,t)=>{const n=kt.partition(e);return n.errors.length>0?tw(n.errors):NW(n.values,t)},consolidateArr:e=>{const t=kt.partition(e);return t.errors.length>0?tw(t.errors):kt.svalue(t.values)}},RW=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),TW=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),nw=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},gm=e=>{const t=(s,o)=>kt.bindError(e(o),r=>vW(s,r)),n=j("val");return{extract:t,toString:n}},PW=gm(kt.svalue),DW=(e,t,n,s)=>We(t,n).fold(()=>hW(e,n,t),s),sw=(e,t,n,s)=>{const o=We(e,t).getOrThunk(()=>n(e));return s(o)},OW=(e,t,n)=>n(We(e,t)),BW=(e,t,n,s)=>{const o=We(e,t).map(r=>r===!0?n(e):r);return s(o)},IW=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>kt.svalue(m.none()),c=>{const l=o.extract(t.concat([s]),c);return kt.map(l,m.some)});switch(e.tag){case"required":return DW(t,n,s,r);case"defaultedThunk":return sw(n,s,e.process,r);case"option":return OW(n,s,a);case"defaultedOptionThunk":return BW(n,s,e.process,a);case"mergeWithThunk":return sw(n,s,j({}),i=>{const c=Vc(e.process(n),i);return r(c)})}},LW=(e,t,n)=>{const s={},o=[];for(const r of n)nw(r,(a,i,c,l)=>{const u=IW(c,e,t,a,l);kt.fold(u,f=>{o.push(...f)},f=>{s[i]=f})},(a,i)=>{s[a]=i(t)});return o.length>0?kt.serror(o):kt.svalue(s)},hm=e=>({extract:(s,o)=>LW(s,o,e),toString:()=>`obj{
`+ke(e,o=>nw(o,(r,a,i,c)=>r+" -> "+c.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),ow=e=>({extract:(s,o)=>{const r=ke(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return AW.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),$W=e=>gm(t=>e(t).fold(kt.serror,kt.svalue)),FW=(e,t,n)=>{const s=t.extract([e],n);return kt.mapError(s,o=>({input:n,errors:o}))},MW=(e,t,n)=>kt.toResult(FW(e,t,n)),UW=e=>`Errors: 
`+gW(e.errors).join(`
`)+`

Input object: `+pm(e.input),rw=(e,t)=>EW(e,Mr(t,hm)),zW=j(PW),Wc=(e,t)=>gm(n=>{const s=typeof n;return e(n)?kt.svalue(n):kt.serror(`Expected type: ${t} but got: ${s}`)}),HW=Wc($n,"number"),jc=Wc(ee,"string"),VW=Wc(Ps,"boolean"),bm=Wc(Be,"function"),Ja=RW,aw=TW,WW=e=>$W(t=>Ie(e,t)?Wt.value(t):Wt.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),iw=(e,t)=>Ja(e,e,JS(),t),cw=e=>iw(e,jc),lw=e=>iw(e,bm),jW=(e,t)=>Ja(e,e,JS(),ow(t)),Cm=(e,t)=>Ja(e,e,xW(),t),qc=e=>Cm(e,jc),qW=e=>Cm(e,bm),KW=(e,t)=>Ja(e,e,ew(t),zW()),Sr=(e,t,n)=>Ja(e,e,ew(t),n),uw=(e,t)=>Sr(e,t,HW),GW=(e,t)=>Sr(e,t,jc),fw=(e,t,n)=>Sr(e,t,WW(n)),vm=(e,t)=>Sr(e,t,VW),ym=(e,t)=>Sr(e,t,bm),YW=(e,t,n)=>Sr(e,t,ow(n)),XW=cw("type"),ZW=lw("fetch"),Em=lw("onAction"),QW=ym("onSetup",()=>he),JW=qc("text"),e3=qc("icon"),t3=qc("tooltip"),n3=qc("label"),s3=vm("active",!1),o3=vm("enabled",!0),dw=vm("primary",!1),r3=e=>KW("columns",e),ei=e=>GW("type",e),a3=hm([XW,cw("trigger"),uw("minChars",1),r3(1),uw("maxResults",10),qW("matches"),ZW,Em,YW("highlightOn",[],jc)]),i3=e=>MW("Autocompleter",a3,e),Sm=[o3,t3,e3,JW,QW],mw=[s3].concat(Sm),c3=[ym("predicate",qe),fw("scope","node",["node","editor"]),fw("position","selection",["node","selection","line"])],l3=Sm.concat([ei("contextformbutton"),dw,Em,aw("original",Ht)]),u3=mw.concat([ei("contextformbutton"),dw,Em,aw("original",Ht)]),f3=Sm.concat([ei("contextformbutton")]),d3=mw.concat([ei("contextformtogglebutton")]),m3=rw("type",{contextformbutton:l3,contextformtogglebutton:u3});hm([ei("contextform"),ym("initValue",j("")),n3,jW("commands",m3),Cm("launch",rw("type",{contextformbutton:f3,contextformtogglebutton:d3}))].concat(c3));const p3=e=>{const t=e.ui.registry.getAll().popups,n=Mr(t,a=>i3(a).fold(i=>{throw new Error(UW(i))},Ht)),s=vp(di(n,a=>a.trigger)),o=Tl(n);return{dataset:n,triggers:s,lookupByTrigger:a=>le(o,i=>i.trigger===a)}},g3=(e,t)=>{const n=Eu(t.load,50);e.on("input",()=>{n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27?(n.cancel(),t.cancelIfNecessary()):(o===38||o===40)&&n.cancel()},!0),e.on("remove",n.cancel)},h3=e=>{const t=Ms(),n=Ct(!1),s=t.isSet,o=()=>{s()&&(l1(e),n.set(!1),t.clear())},r=f=>{s()||t.set({trigger:f.trigger,matchLength:f.text.length})},a=Zn(()=>p3(e)),i=f=>t.get().map(d=>dm(e.dom,e.selection.getRng(),d.trigger,!0).bind(p=>YS(e,a,p,f))).getOrThunk(()=>lW(e,a)),c=f=>{i(f).fold(o,d=>{r(d.context),d.lookupData.then(p=>{t.get().map(h=>{const g=d.context;h.trigger===g.trigger&&(g.text.length-h.matchLength>=10?o():(t.set({...h,matchLength:g.text.length}),n.get()?(ff(e,{range:g.range}),c1(e,{lookupData:p})):(n.set(!0),ff(e,{range:g.range}),i1(e,{lookupData:p}))))})})})},l=(f,d)=>{const p=f.compareBoundaryPoints(window.Range.START_TO_START,d),h=f.compareBoundaryPoints(window.Range.END_TO_END,d);return p>=0&&h<=0},u=()=>t.get().bind(({trigger:f})=>{const d=e.selection.getRng();return dm(e.dom,d,f,n.get()).filter(({range:p})=>l(d,p)).map(({range:p})=>p)});e.addCommand("mceAutocompleterReload",(f,d)=>{const p=at(d)?d.fetchOptions:{};c(p)}),e.addCommand("mceAutocompleterClose",o),e.addCommand("mceAutocompleterRefreshActiveRange",()=>{u().each(f=>{ff(e,{range:f})})}),e.editorCommands.addQueryStateHandler("mceAutoCompleterInRange",()=>u().isSome()),g3(e,{cancelIfNecessary:o,load:c})},b3=Jn().browser.isSafari(),pw=e=>Us(C.fromDom(e)),gw=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},Kc=(e,t)=>m.from(e.getParent(t.container(),"details")),hw=(e,t)=>Kc(e,t).isSome(),C3=(e,t)=>{const n=m.from(e.getParent(t.startContainer,"details")),s=m.from(e.getParent(t.endContainer,"details"));if(n.isSome()||s.isSome()){const o=n.bind(r=>m.from(e.select("summary",r)[0]));return m.some({startSummary:o,startDetails:n,endDetails:s})}else return m.none()},v3=(e,t)=>Bt(t).exists(n=>n.isEqual(e)),y3=(e,t)=>xn(t).exists(n=>Xe(n.getNode())&&Xt(t,n).exists(s=>s.isEqual(e))||n.isEqual(e)),E3=(e,t)=>t.startSummary.exists(n=>v3(e,n)),S3=(e,t)=>t.startSummary.exists(n=>y3(e,n)),w3=(e,t)=>t.startDetails.exists(n=>Xt(n,e).forall(s=>t.startSummary.exists(o=>!o.contains(e.container())&&o.contains(s.container())))),k3=(e,t,n)=>n.startDetails.exists(s=>jt(e,t).forall(o=>!s.contains(o.container()))),bw=(e,t)=>{const n=t.getNode();Et(n)||e.selection.setCursorLocation(n,t.offset())},Cw=(e,t,n)=>{const s=e.dom.getParent(t.container(),"details");if(s&&!s.open){const o=e.dom.select("summary",s)[0];o&&(n?Bt(o):xn(o)).each(a=>bw(e,a))}else bw(e,t)},_3=(e,t)=>{const n=c=>c.contains(e.startContainer),s=c=>c.contains(e.endContainer),o=t.startSummary.exists(n),r=t.startSummary.exists(s),a=t.startDetails.forall(c=>t.endDetails.forall(l=>c!==l));return(o||r)&&!(o&&r)||a},vw=(e,t,n)=>{const{dom:s,selection:o}=e,r=e.getBody();if(n==="character"){const a=N.fromRangeStart(o.getRng()),i=s.getParent(a.container(),s.isBlock),c=Kc(s,a),l=i&&s.isEmpty(i),u=zt(i==null?void 0:i.previousSibling),f=zt(i==null?void 0:i.nextSibling);return l&&(t?f:u)&&cr(!t,r,a).exists(h=>hw(s,h)&&!Gp(c,Kc(s,h)))?!0:cr(t,r,a).fold(qe,d=>{const p=Kc(s,d);if(hw(s,d)&&!Gp(c,p)){if(t||Cw(e,d,!1),i&&l){if(t&&u)return!0;if(!t&&f)return!0;Cw(e,d,t),e.dom.remove(i)}return!0}else return!1})}else return!1},x3=(e,t,n,s)=>{const r=e.selection.getRng(),a=N.fromRangeStart(r),i=e.getBody();return s==="selection"?_3(r,t):n?S3(a,t)||k3(i,a,t):E3(a,t)||w3(a,t)},N3=(e,t,n)=>C3(e.dom,e.selection.getRng()).fold(()=>vw(e,t,n),s=>x3(e,s,t,n)||vw(e,t,n)),A3=(e,t,n)=>{const s=e.selection,o=s.getNode(),r=s.getRng(),a=N.fromRangeStart(r);return AN(o)?(n==="selection"&&gw(r,o)||Uv(t,a,o)?pw(o):e.undoManager.transact(()=>{const i=s.getSel();let{anchorNode:c,anchorOffset:l,focusNode:u,focusOffset:f}=i??{};const d=()=>{V(c)&&V(l)&&V(u)&&V(f)&&(i==null||i.setBaseAndExtent(c,l,u,f))},p=()=>{c=i==null?void 0:i.anchorNode,l=i==null?void 0:i.anchorOffset,u=i==null?void 0:i.focusNode,f=i==null?void 0:i.focusOffset},h=(b,v)=>{T(b.childNodes,y=>{Aa(y)&&v.appendChild(y)})},g=e.dom.create("span",{"data-mce-bogus":"1"});h(o,g),o.appendChild(g),d(),(n==="word"||n==="line")&&(i==null||i.modify("extend",t?"right":"left",n)),!s.isCollapsed()&&gw(s.getRng(),g)?pw(o):(e.execCommand(t?"ForwardDelete":"Delete"),p(),h(g,o),d()),e.dom.remove(g)}),!0):!1},Do=(e,t,n)=>N3(e,t,n)||b3&&A3(e,t,n)?m.some(he):m.none(),yw=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:he,inputType:n},a=ih(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},ti=yw("input"),Gc=yw("beforeinput"),Ew=Jn(),Sw=Ew.os,ww=Sw.isMacOS()||Sw.isiOS(),R3=Ew.browser.isFirefox(),T3=(e,t,n)=>{const s=n.keyCode===K.BACKSPACE?"deleteContentBackward":"deleteContentForward",o=e.selection.isCollapsed(),r=o?"character":"selection",a=i=>o?i?"word":"line":"selection";AS([{keyCode:K.BACKSPACE,action:ie(fS,e)},{keyCode:K.BACKSPACE,action:ie(qd,e,!1)},{keyCode:K.DELETE,action:ie(qd,e,!0)},{keyCode:K.BACKSPACE,action:ie(Vd,e,!1)},{keyCode:K.DELETE,action:ie(Vd,e,!0)},{keyCode:K.BACKSPACE,action:ie(tm,e,t,!1)},{keyCode:K.DELETE,action:ie(tm,e,t,!0)},{keyCode:K.BACKSPACE,action:ie(Gf,e,!1)},{keyCode:K.DELETE,action:ie(Gf,e,!0)},{keyCode:K.BACKSPACE,action:ie(Do,e,!1,r)},{keyCode:K.DELETE,action:ie(Do,e,!0,r)},...ww?[{keyCode:K.BACKSPACE,altKey:!0,action:ie(Do,e,!1,a(!0))},{keyCode:K.DELETE,altKey:!0,action:ie(Do,e,!0,a(!0))},{keyCode:K.BACKSPACE,metaKey:!0,action:ie(Do,e,!1,a(!1))}]:[{keyCode:K.BACKSPACE,ctrlKey:!0,action:ie(Do,e,!1,a(!0))},{keyCode:K.DELETE,ctrlKey:!0,action:ie(Do,e,!0,a(!0))}],{keyCode:K.BACKSPACE,action:ie(Kd,e,!1)},{keyCode:K.DELETE,action:ie(Kd,e,!0)},{keyCode:K.BACKSPACE,action:ie(om,e,!1)},{keyCode:K.DELETE,action:ie(om,e,!0)},{keyCode:K.BACKSPACE,action:ie(zd,e,!1)},{keyCode:K.DELETE,action:ie(zd,e,!0)},{keyCode:K.BACKSPACE,action:ie(Ud,e,!1)},{keyCode:K.DELETE,action:ie(Ud,e,!0)},{keyCode:K.BACKSPACE,action:ie(nm,e,!1)},{keyCode:K.DELETE,action:ie(nm,e,!0)}],n).filter(i=>e.selection.isEditable()).each(i=>{n.preventDefault(),Gc(e,s).isDefaultPrevented()||(i(),ti(e,s))})},P3=(e,t,n)=>Za([{keyCode:K.BACKSPACE,action:ie(y0,e)},{keyCode:K.DELETE,action:ie(y0,e)},...ww?[{keyCode:K.BACKSPACE,altKey:!0,action:ie(Xa,e)},{keyCode:K.DELETE,altKey:!0,action:ie(Xa,e)},...n?[{keyCode:R3?224:91,action:ie(Xa,e)}]:[]]:[{keyCode:K.BACKSPACE,ctrlKey:!0,action:ie(Xa,e)},{keyCode:K.DELETE,ctrlKey:!0,action:ie(Xa,e)}]],t),D3=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===K.BACKSPACE,s.isDefaultPrevented()||T3(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||P3(e,s,n),n=!1})},O3=e=>{for(;e;){if(Z(e)||O(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},wr=(e,t)=>{const n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const r=O3(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(bt),t.firstChild)}const o=n.createRng();if(t.normalize(),t.hasChildNodes()){const r=new ht(t,t);let a=t,i;for(;i=r.current();){if(O(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else Xe(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),Da(e,o)},ni=(e,t)=>{const n=e.getRoot();let s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";){if(e.getContentEditable(o)==="true"){s=o;break}o=o.parentNode}return o!==n?s:n},wm=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),B3=e=>wm(e).fold(j(""),t=>t.nodeName.toUpperCase()),I3=e=>wm(e).filter(t=>da(C.fromDom(t))).isSome(),km=e=>{e.innerHTML='<br data-mce-bogus="1">'},L3=(e,t,n)=>{const s=e.dom;m.from(n.style).map(s.parseStyle).each(c=>{const u={...jl(C.fromDom(t)),...c};s.setStyles(t,u)});const o=m.from(n.class).map(c=>c.split(/\s+/)),r=m.from(t.className).map(c=>le(c.split(/\s+/),l=>l!==""));Rt(o,r,(c,l)=>{const u=le(l,d=>!Ie(c,d)),f=[...c,...u];s.setAttrib(t,"class",f.join(" "))});const a=["style","class"],i=Ur(n,(c,l)=>!Ie(a,l));s.setAttribs(t,i)},si=(e,t)=>{if(Ot(e).toLowerCase()===t.tagName.toLowerCase()){const s=va(e);L3(e,t,s)}},kw=(e,t,n,s,o=!0,r,a)=>{const i=e.dom,c=e.schema,l=Ot(e),u=n?n.nodeName.toUpperCase():"";let f=t;const d=c.getTextInlineElements();let p;r||u==="TABLE"||u==="HR"?p=i.create(r||l,a||{}):p=n.cloneNode(!1);let h=p;if(!o)i.setAttrib(p,"style",null),i.setAttrib(p,"class",null);else do if(d[f.nodeName]){if(mn(f)||pn(f))continue;const g=f.cloneNode(!1);i.setAttrib(g,"id",""),p.hasChildNodes()?(g.appendChild(p.firstChild),p.appendChild(g)):(h=g,p.appendChild(g))}while((f=f.parentNode)&&f!==s);return si(e,p),km(h),p},$3=(e,t)=>e.dom.getParent(t,Jl),F3=(e,t,n)=>{let s=t;for(;s&&s!==e&&zt(s.nextSibling);){const o=s.parentElement;if(!o||!n(o))return Jl(o);s=o}return!1},M3=(e,t,n)=>!t&&n.nodeName.toLowerCase()===Ot(e)&&e.dom.isEmpty(n)&&F3(e.getBody(),n,s=>de(e.schema.getTextBlockElements(),s.nodeName.toLowerCase())),U3=(e,t,n)=>{var s,o,r;const a=t(Ot(e)),i=$3(e,n);i&&(e.dom.insertAfter(a,i),wr(e,a),((r=(o=(s=n.parentElement)===null||s===void 0?void 0:s.childNodes)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)>1&&e.dom.remove(n))},z3=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,H3=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},_w=(e,t)=>{const n=e==null?void 0:e.parentNode;return V(n)&&n.nodeName===t},xw=e=>V(e)&&/^(OL|UL|LI)$/.test(e.nodeName),_m=e=>V(e)&&/^(LI|DT|DD)$/.test(e.nodeName),V3=e=>xw(e)&&xw(e.parentNode),Yc=e=>{const t=e.parentNode;return _m(t)?t:e},Xc=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!Z(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},Nw=e=>Kt(di(jl(C.fromDom(e)),(t,n)=>`${n}: ${t};`),(t,n)=>t+n,""),W3=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;V3(n)&&(o="LI");const c=_m(s)?Nw(s):void 0;let l=_m(s)&&c?t(o,{style:Nw(s)}):t(o);if(Xc(n,s,!0)&&Xc(n,s,!1))if(_w(n,"LI")){const u=Yc(n);r.insertAfter(l,u),H3(n)?r.remove(u):r.remove(n)}else r.replace(l,n);else if(Xc(n,s,!0))_w(n,"LI")?(r.insertAfter(l,Yc(n)),l.appendChild(r.doc.createTextNode(" ")),l.appendChild(n)):i.insertBefore(l,n),r.remove(s);else if(Xc(n,s,!1))r.insertAfter(l,Yc(n)),r.remove(s);else{n=Yc(n);const u=a.cloneRange();u.setStartAfter(s),u.setEndAfter(n);const f=u.extractContents();if(o==="LI"&&z3(f,"LI")){const d=le(ke(l.children,C.fromDom),Or(Ci("br")));l=f.firstChild,r.insertAfter(f,n),T(d,p=>ql(C.fromDom(l),p)),c&&l.setAttribute("style",c)}else r.insertAfter(f,n),r.insertAfter(l,n);r.remove(s)}wr(e,l)},j3=e=>{T(Ag(C.fromDom(e),un),t=>{const n=t.dom;n.nodeValue=rn(n.data)})},q3=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},K3=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),xm=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,Nm=(e,t)=>V(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",G3=(e,t,n)=>{var s;const o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;Z(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||K3(e,r))&&e.remove(r)},Am=(e,t,n)=>O(t)?e?n===1&&t.data.charAt(n-1)===mt?0:n:n===t.data.length-1&&t.data.charAt(n)===mt?t.data.length:n:n,Y3=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,Am(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Am(!1,e.endContainer,e.endOffset)),t},X3=e=>{let t=e;do O(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},Z3=(e,t,n,s,o)=>{var r,a;const i=e.dom,c=(r=ni(i,s))!==null&&r!==void 0?r:i.getRoot();let l=i.getParent(s,i.isBlock);if(!l||!Nm(i,l)){if(l=l||c,!l.hasChildNodes()){const p=i.create(t);return si(e,p),l.appendChild(p),n.setStart(p,0),n.setEnd(p,0),p}let u=s;for(;u&&u.parentNode!==l;)u=u.parentNode;let f;for(;u&&!i.isBlock(u);)f=u,u=u.previousSibling;const d=(a=f==null?void 0:f.parentElement)===null||a===void 0?void 0:a.nodeName;if(f&&d&&e.schema.isValidChild(d,t.toLowerCase())){const p=f.parentNode,h=i.create(t);for(si(e,h),p.insertBefore(h,f),u=f;u&&!i.isBlock(u);){const g=u.nextSibling;h.appendChild(u),u=g}n.setStart(s,o),n.setEnd(s,o)}}return s},Q3=(e,t)=>{t.normalize();const n=t.lastChild;(!n||Z(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},J3=(e,t)=>{const n=vT(e);return it(t)?!1:ee(n)?Ie($.explode(n),t.nodeName.toLowerCase()):n},Aw={insert:(e,t)=>{let n,s,o,r,a=!1;const i=e.dom,c=e.schema,l=c.getNonEmptyElements(),u=e.selection.getRng(),f=Ot(e),d=C.fromDom(u.startContainer),p=Ko(d,u.startOffset),h=p.exists(A=>bi(A)&&!ro(A)),g=u.collapsed&&h,b=(A,U)=>kw(e,n,B,R,CT(e),A,U),v=A=>{const U=Am(A,n,s);if(O(n)&&(A?U>0:U<n.data.length))return!1;if((n.parentNode===B||n===B)&&a&&!A||A&&Z(n)&&n===B.firstChild)return!0;if(xm(n,"TABLE")||xm(n,"HR"))return a&&!A||!a&&A;const Q=new ht(n,B);O(n)&&(A&&U===0?Q.prev():!A&&U===n.data.length&&Q.next());let fe;for(;fe=Q.current();){if(Z(fe)){if(!fe.getAttribute("data-mce-bogus")){const ye=fe.nodeName.toLowerCase();if(l[ye]&&ye!=="br")return!1}}else if(O(fe)&&!Qo(fe.data))return!1;A?Q.prev():Q.next()}return!0},y=()=>{let A;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&z!=="HGROUP"?A=b(f):A=b(),J3(e,r)&&Nm(i,r)&&i.isEmpty(B,void 0,{includeZwsp:!0})?A=i.split(r,B):i.insertAfter(A,B),wr(e,A),A};ac(i,u).each(A=>{u.setStart(A.startContainer,A.startOffset),u.setEnd(A.endContainer,A.endOffset)}),n=u.startContainer,s=u.startOffset;const E=!!(t&&t.shiftKey),S=!!(t&&t.ctrlKey);Z(n)&&n.hasChildNodes()&&!g&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&O(n)?s=n.data.length:s=0);const R=ni(i,n);if(!R||q3(e,n))return;E||(n=Z3(e,f,u,n,s));let B=i.getParent(n,i.isBlock)||i.getRoot();r=V(B==null?void 0:B.parentNode)?i.getParent(B.parentNode,i.isBlock):null,o=B?B.nodeName.toUpperCase():"";const z=r?r.nodeName.toUpperCase():"";if(z==="LI"&&!S){const A=r;B=A,r=A.parentNode,o=z}if(Z(r)&&M3(e,E,B))return U3(e,b,B);if(/^(LI|DT|DD)$/.test(o)&&Z(r)&&i.isEmpty(B)){W3(e,b,r,B,f);return}if(!g&&(B===e.getBody()||!Nm(i,B)))return;const P=B.parentNode;let x;if(g)x=b(f),p.fold(()=>{ct(d,C.fromDom(x))},A=>{Yt(A,C.fromDom(x))}),e.selection.setCursorLocation(x,0);else if(sr(B))x=xu(B),i.isEmpty(B)&&km(B),si(e,x),wr(e,x);else if(v(!1))x=y();else if(v(!0)&&P){x=P.insertBefore(b(),B);const A=Vx(C.fromDom(u.startContainer))&&u.collapsed;wr(e,xm(B,"HR")||A?x:B)}else{const A=Y3(u).cloneRange();A.setEndAfter(B);const U=A.extractContents();j3(U),X3(U),x=U.firstChild,i.insertAfter(U,B),G3(i,l,x),Q3(i,B),i.isEmpty(B)&&km(B),x.normalize(),i.isEmpty(x)?(i.remove(x),y()):(si(e,x),wr(e,x))}i.setAttrib(x,"id",""),e.dispatch("NewBlock",{newBlock:x})},fakeEventName:"insertParagraph"},ej=(e,t,n)=>{const s=new ht(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||O(o)&&o.length>0)return!0;return!1},Rw=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),Da(e,s)},tj=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a=!1;ac(s,o).each(p=>{o.setStart(p.startContainer,p.startOffset),o.setEnd(p.endContainer,p.endOffset)});let i=o.startOffset,c=o.startContainer;if(Z(c)&&c.hasChildNodes()){const p=i>c.childNodes.length-1;c=c.childNodes[Math.min(i,c.childNodes.length-1)]||c,p&&O(c)?i=c.data.length:i=0}let l=s.getParent(c,s.isBlock);const u=l&&l.parentNode?s.getParent(l.parentNode,s.isBlock):null,f=u?u.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);f==="LI"&&!d&&(l=u),O(c)&&i>=c.data.length&&(ej(e.schema,c,l||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),Du(s,o,r),Rw(e,r,a),e.undoManager.add()},nj=(e,t)=>{const n=C.fromTag("br");Yt(C.fromDom(t),n),e.undoManager.add()},sj=(e,t)=>{rj(e.getBody(),t)||Es(C.fromDom(t),C.fromTag("br"));const n=C.fromTag("br");Es(C.fromDom(t),n),Rw(e,n.dom,!1),e.undoManager.add()},oj=e=>Xe(e.getNode()),rj=(e,t)=>oj(N.after(t))?!0:jt(e,N.after(t)).map(n=>Xe(n.getNode())).getOr(!1),Tw=e=>e&&e.nodeName==="A"&&"href"in e,aj=e=>e.fold(qe,Tw,Tw,qe),ij=e=>{const t=G(Ao,e),n=N.fromRangeStart(e.selection.getRng());return ds(t,e.getBody(),n).filter(aj)},cj=(e,t)=>{t.fold(he,G(nj,e),G(sj,e),he)},Pw={insert:(e,t)=>{const n=ij(e);n.isSome()?n.each(G(cj,e)):tj(e,t)},fakeEventName:"insertLineBreak"},Dw=(e,t)=>wm(e).filter(n=>t.length>0&&Fn(C.fromDom(n),t)).isSome(),lj=e=>Dw(e,hT(e)),uj=e=>Dw(e,bT(e)),cn=rs.generate([{br:[]},{block:[]},{none:[]}]),fj=(e,t)=>uj(e),Ow=e=>(t,n)=>I3(t)===e,Bw=(e,t)=>(n,s)=>B3(n)===e.toUpperCase()===t,dj=e=>{const t=ni(e.dom,e.selection.getStart());return it(t)},oi=e=>Bw("pre",e),mj=()=>Bw("summary",!0),Zc=e=>(t,n)=>pT(t)===e,pj=(e,t)=>lj(e),Qc=(e,t)=>t,gj=e=>{const t=Ot(e),n=ni(e.dom,e.selection.getStart());return V(n)&&e.schema.isValidChild(n.nodeName,t)},hj=e=>{const t=e.selection.getRng(),n=C.fromDom(t.startContainer),o=Ko(n,t.startOffset).map(r=>bi(r)&&!ro(r));return t.collapsed&&o.getOr(!0)},yn=(e,t)=>(n,s)=>Kt(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),bj=(e,t)=>x0([yn([fj],cn.none()),yn([oi(!0),dj],cn.none()),yn([mj()],cn.br()),yn([oi(!0),Zc(!1),Qc],cn.br()),yn([oi(!0),Zc(!1)],cn.block()),yn([oi(!0),Zc(!0),Qc],cn.block()),yn([oi(!0),Zc(!0)],cn.br()),yn([Ow(!0),Qc],cn.br()),yn([Ow(!0)],cn.block()),yn([pj],cn.br()),yn([Qc],cn.br()),yn([gj],cn.block()),yn([hj],cn.block())],[e,!!(t&&t.shiftKey)]).getOr(cn.none()),Jc=(e,t,n)=>{t.selection.isCollapsed()||GB(t),!(V(n)&&Gc(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),V(n)&&ti(t,e.fakeEventName))},Iw=(e,t)=>{const n=()=>Jc(Pw,e,t),s=()=>Jc(Aw,e,t),o=bj(e,t);switch(gT(e)){case"linebreak":o.fold(n,n,he);break;case"block":o.fold(s,s,he);break;case"invert":o.fold(s,n,he);break;default:o.fold(n,s,he);break}},Lw=Jn(),Cj=Lw.os.isiOS()&&Lw.browser.isSafari(),$w=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),nM(e.undoManager),e.undoManager.transact(()=>{Iw(e,t)}))},vj=e=>{if(!e.collapsed)return!1;const t=e.startContainer;if(O(t)){const n=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,s=t.data.charAt(e.startOffset-1);return n.test(s)}else return!1},yj=e=>{let t=m.none();const n=o=>{t=m.some(o.selection.getBookmark()),o.undoManager.add()},s=(o,r)=>{o.undoManager.undo(),t.fold(he,a=>o.selection.moveToBookmark(a)),$w(o,r),t=m.none()};e.on("keydown",o=>{o.keyCode===K.ENTER&&(Cj&&vj(e.selection.getRng())?n(e):$w(e,o))}),e.on("keyup",o=>{o.keyCode===K.ENTER&&t.each(()=>s(e,o))})},Ej=(e,t,n)=>{const s=Ne.os.isMacOS()||Ne.os.isiOS();Za([{keyCode:K.END,action:ie(wS,e,!0)},{keyCode:K.HOME,action:ie(wS,e,!1)},...s?[]:[{keyCode:K.HOME,action:ie(Mc,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:K.END,action:ie(Mc,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:K.END,action:ie(PS,e,!0)},{keyCode:K.HOME,action:ie(PS,e,!1)},{keyCode:K.END,action:ie(Fc,e,!0,t)},{keyCode:K.HOME,action:ie(Fc,e,!1,t)}],n).each(o=>{n.preventDefault()})},Sj=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||Ej(e,t,n)})},wj=e=>{e.on("input",t=>{t.isComposing||NB(e)})},kj=Jn(),_j=(e,t,n)=>{Za([{keyCode:K.PAGE_UP,action:ie(Fc,e,!1,t)},{keyCode:K.PAGE_DOWN,action:ie(Fc,e,!0,t)}],n)},Fw=e=>e.stopImmediatePropagation(),Mw=e=>e.keyCode===K.PAGE_UP||e.keyCode===K.PAGE_DOWN,Uw=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",Fw,!0):!n&&e.get()&&t.off("NodeChange",Fw),e.set(n)},xj=(e,t)=>{if(kj.os.isMacOS())return;const n=Ct(!1);e.on("keydown",s=>{Mw(s)&&Uw(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||_j(e,t,s),Mw(s)&&n.get()&&(Uw(n,e,!1),e.nodeChanged())})},Nj=e=>{e.on("beforeinput",t=>{(!e.selection.isEditable()||Je(t.getTargetRanges(),n=>!GC(e.dom,n)))&&t.preventDefault()})},zw=(e,t)=>{const n=t.container(),s=t.offset();return O(n)?(n.insertData(s,e),m.some(N(n,s+e.length))):Gi(t).map(o=>{const r=C.fromText(e);return t.isAtEnd()?Es(o,r):Yt(o,r),N(r.dom,e.length)})},Hw=G(zw,bt),Vw=G(zw," "),Aj=(e,t,n)=>Nv(e,t,n)?Hw(t):Vw(t),Rj=e=>t=>t.fold(n=>Xt(e.dom,N.before(n)),n=>Bt(n),n=>xn(n),n=>jt(e.dom,N.after(n))),Tj=(e,t,n)=>s=>Nv(e,s,n)?Hw(t):Vw(t),Ww=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},Pj=(e,t)=>e.isEditable(e.getParent(t,"summary")),Dj=e=>{const t=N.fromRangeStart(e.selection.getRng()),n=C.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=G(Ao,e),o=N.fromRangeStart(e.selection.getRng());return ds(s,e.getBody(),o).bind(Rj(n)).map(r=>()=>Tj(n,t,e.schema)(r).each(Ww(e)))}else return m.none()},Oj=e=>{const t=()=>{const n=C.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");const s=N.fromRangeStart(e.selection.getRng());Aj(n,s,e.schema).each(Ww(e))};return jo(Ne.browser.isFirefox()&&e.selection.isEditable()&&Pj(e.dom,e.selection.getRng().startContainer),t)},Bj=(e,t)=>{AS([{keyCode:K.SPACEBAR,action:ie(Dj,e)},{keyCode:K.SPACEBAR,action:ie(Oj,e)}],t).each(n=>{t.preventDefault(),Gc(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),ti(e,"insertText",{data:" "}))})},Ij=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||Bj(e,t)})},Lj=e=>RP(e)?[{keyCode:K.TAB,action:ie(WS,e,!0)},{keyCode:K.TAB,shiftKey:!0,action:ie(WS,e,!1)}]:[],$j=(e,t)=>{Za([...Lj(e)],t).each(n=>{t.preventDefault()})},Fj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||$j(e,t)})},Mj=e=>{if(e.addShortcut("Meta+P","","mcePrint"),h3(e),fs(e))return Ct(null);{const t=e2(e);return Nj(e),Z2(e),ZV(e,t),D3(e,t),yj(e),Ij(e),wj(e),Fj(e),Sj(e,t),xj(e,t),t}};class Uj{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!hf(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{lc(t),t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);o&&Ji(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&Ji(t)&&(t.selection.getNode().nodeName==="IMG"?hn.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor.selection;let s;if(this.editor.initialized&&n&&!GT(this.editor)&&!this.editor.mode.isReadOnly()){const o=this.editor.getBody();s=n.getStart(!0)||o,(s.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(s,o))&&(s=o);const r=[];this.editor.dom.getParent(s,a=>a===o?!0:(r.push(a),!1)),this.editor.dispatch("NodeChange",{...t,element:s,parents:r})}}isSameElementPath(t){let n;const s=this.editor,o=$r(s.dom.getParents(t,ot,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const jw=fa("image"),zj=e=>{const t=e;return m.from(t[jw])},Hj=(e,t)=>{const n=e;n[jw]=t},Rm=fa("event"),Vj=e=>{const t=e;return m.from(t[Rm])},el=e=>t=>{const n=t;n[Rm]=e},Wj=(e,t)=>el(t)(e),qw=el(0),jj=el(2),qj=el(1),Kj=(e=>t=>{const n=t;return m.from(n[Rm]).exists(s=>s===e)})(0),Gj=()=>Object.freeze({length:0,item:e=>null}),Tm=fa("mode"),Yj=e=>{const t=e;return m.from(t[Tm])},tl=e=>t=>{const n=t;n[Tm]=e},Kw=(e,t)=>tl(t)(e),Gw=tl(0),Pm=tl(2),Xj=tl(1),Yw=e=>t=>{const n=t;return m.from(n[Tm]).exists(s=>s===e)},kr=Yw(0),Xw=Yw(1),Zj=(e,t)=>({...t,get length(){return t.length},add:(n,s)=>{if(kr(e))if(ee(n)){if(!Et(s))return t.add(n,s)}else return t.add(n);return null},remove:n=>{kr(e)&&t.remove(n)},clear:()=>{kr(e)&&t.clear()}}),Qj=["none","copy","link","move"],Jj=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],Dm=()=>{const e=new window.DataTransfer;let t="move",n="all";const s={get dropEffect(){return t},set dropEffect(o){Ie(Qj,o)&&(t=o)},get effectAllowed(){return n},set effectAllowed(o){Kj(s)&&Ie(Jj,o)&&(n=o)},get items(){return Zj(s,e.items)},get files(){return Xw(s)?Gj():e.files},get types(){return e.types},setDragImage:(o,r,a)=>{kr(s)&&(Hj(s,{image:o,x:r,y:a}),e.setDragImage(o,r,a))},getData:o=>Xw(s)?"":e.getData(o),setData:(o,r)=>{kr(s)&&e.setData(o,r)},clearData:o=>{kr(s)&&e.clearData(o)}};return Gw(s),s},e8=e=>{const t=Dm(),n=Yj(e);return Pm(e),qw(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,zj(e).each(s=>t.setDragImage(s.image,s.x,s.y)),T(e.types,s=>{s!=="Files"&&t.setData(s,e.getData(s))}),T(e.files,s=>t.items.add(s)),Vj(e).each(s=>{Wj(t,s)}),n.each(s=>{Kw(e,s),Kw(t,s)}),t},t8=e=>{const t=e.getData("text/html");return t===""?m.none():m.some(t)},Zw=(e,t)=>e.setData("text/html",t),Qw="x-tinymce/html",nl=j(Qw),Om="<!-- "+Qw+" -->",n8=e=>Om+e,s8=e=>e.replace(Om,""),Jw=e=>e.indexOf(Om)!==-1,o8=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),r8=(e,t)=>{let n="<"+e;const s=di(t,(o,r)=>r+'="'+$s.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},a8=(e,t,n)=>{const s=e.split(/\n\n/),o=r8(t,n),r="</"+t+">",a=ke(s,c=>c.split(/\n/).join("<br />")),i=c=>o+c+r;return a.length===1?a[0]:ke(a,i).join("")},ek="%MCEPASTEBIN%",i8=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},ek);Ne.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},c8=(e,t)=>{const n=e.dom;if(Bm(e)){let s;const o=t.get();for(;s=Bm(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},Bm=e=>e.dom.get("mcepastebin"),l8=e=>V(e)&&e.id==="mcepastebin",u8=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=le(e.getBody().childNodes,l8);T(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},tk=e=>e===ek,f8=e=>{const t=Ct(null);return{create:()=>i8(e,t),remove:()=>c8(e,t),getEl:()=>Bm(e),getHtml:()=>u8(e),getLastRng:t.get}},nk=(e,t)=>($.each(t,n=>{Ln(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),d8=e=>{const t=Fs(),n=br({},t);let s="";const o=t.getVoidElements(),r=$.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=c=>{const l=c.name,u=c;if(l==="br"){s+=`
`;return}if(l!=="wbr"){if(o[l]&&(s+=" "),r[l]){s+=" ";return}if(c.type===3&&(s+=c.value),!(c.name in t.getVoidElements())){let f=c.firstChild;if(f)do i(f);while(f=f.next)}a[l]&&u.next&&(s+=`
`,l==="p"&&(s+=`
`))}};return e=nk(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},sk=e=>(e=nk(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":bt],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),m8=e=>{let t=0;return()=>e+t++},p8=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return $.hasOwn(n,t)?"image/"+n[t]:"image/"+t},g8=(e,t)=>{const n=br({sanitize:Cb(e),sandbox_iframes:yb(e),sandbox_iframes_exclusions:zu(e),convert_unsafe_embeds:DP(e)},e.schema);n.addNodeFilter("meta",o=>{$.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return qs({validate:!0},e.schema).serialize(s)},ok=(e,t)=>({content:e,cancelled:t}),h8=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=f1(e,s,n);return ok(o.node.innerHTML,o.isDefaultPrevented())},b8=(e,t,n)=>{const s=u1(e,t,n),o=g8(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?h8(e,o,n):ok(o,s.isDefaultPrevented())},C8=(e,t,n)=>b8(e,t,n),Im=(e,t)=>(e.insertContent(t,{merge:mP(e),paste:!0}),!0),Lm=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),v8=(e,t)=>Lm(t)&&Je(vb(e),n=>Bl(t.toLowerCase(),`.${n.toLowerCase()}`)),y8=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),E8=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),S8=(e,t,n)=>!e.selection.isCollapsed()&&Lm(t)?E8(e,t,n):!1,w8=(e,t,n)=>v8(e,t)?y8(e,t,n):!1,k8=(e,t)=>{$.each([S8,w8,Im],n=>!n(e,t,Im))},_8=(e,t,n)=>{n||!pP(e)?Im(e,t):k8(e,t)},x8=m8("mceclip"),N8=e=>{const t=Dm();return Zw(t,e),Pm(t),t},rk=(e,t,n,s,o)=>{const r=C8(e,t,n);if(!r.cancelled){const a=r.content,i=()=>_8(e,a,s);o?Gc(e,"insertFromPaste",{dataTransfer:N8(a)}).isDefaultPrevented()||(i(),ti(e,"insertFromPaste")):i()}},sl=(e,t,n,s)=>{const o=n||Jw(t);rk(e,s8(t),o,!1,s)},$m=(e,t,n)=>{const s=e.dom.encode(t).replace(/\r\n/g,`
`),o=Dg(s,hP(e)),r=a8(o,Ot(e),va(e));rk(e,r,!1,!0,n)},ak=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},Zs=(e,t)=>t in e&&e[t].length>0,ik=e=>Zs(e,"text/html")||Zs(e,"text/plain"),A8=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return V(n)?e.dom.encode(n[1]):void 0},R8=(e,t,n,s)=>{const o=x8(),r=ib(e)&&V(n.name),a=r?A8(e,n.name):o,i=r?n.name:void 0,c=t.create(o,n,s,a,i);return t.add(c),c},T8=(e,t)=>{hd(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,c=i.getByData(r,s),l=c??R8(e,i,a,r);sl(e,`<img src="${l.blobUri()}">`,!1,!0)})},P8=e=>e.type==="paste",D8=e=>Promise.all(ke(e,t=>Gy(t).then(n=>({file:t,uri:n})))),O8=e=>{const t=vb(e);return n=>dt(n.type,"image/")&&Je(t,s=>p8(s)===n.type)},B8=(e,t)=>{const n=t.items?ln(nn(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?nn(t.files):[];return le(n.length>0?n:s,O8(e))},ck=(e,t,n)=>{const s=P8(t)?t.clipboardData:t.dataTransfer;if(qi(e)&&s){const o=B8(e,s);if(o.length>0)return t.preventDefault(),D8(o).then(r=>{n&&e.selection.setRng(n),T(r,a=>{T8(e,a)})}),!0}return!1},I8=e=>{var t,n;return Ne.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},L8=e=>K.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,Fm=(e,t,n,s,o)=>{let r=sk(n);const a=Zs(t,nl())||Jw(n),i=!a&&o8(r),c=Lm(r);(tk(r)||!r.length||i&&!c)&&(s=!0),(s||c)&&(Zs(t,"text/plain")&&i?r=t["text/plain"]:r=d8(r)),!tk(r)&&(s?$m(e,r,o):sl(e,r,a,o))},$8=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{L8(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||I8(r))return;const a=n.get()==="text"||s;s=!1;const i=ak(r.clipboardData);!ik(i)&&ck(e,r,o())||(Zs(i,"text/html")?(r.preventDefault(),Fm(e,i,i["text/html"],a,!0)):Zs(i,"text/plain")&&Zs(i,"text/uri-list")?(r.preventDefault(),Fm(e,i,i["text/plain"],a,!0)):(t.create(),hn.setEditorTimeout(e,()=>{const c=t.getHtml();t.remove(),Fm(e,i,c,a,!1)},0)))})},F8=e=>{const t=o=>dt(o,"webkit-fake-url"),n=o=>dt(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!qi(e)&&s(a))for(const i of o){const c=i.attr("src");ee(c)&&!i.attr("data-mce-object")&&c!==Ne.transparentSrc&&(t(c)||!bP(e)&&n(c))&&i.remove()}})},M8=(e,t,n)=>{$8(e,t,n),F8(e)},U8=(e,t)=>{t.get()==="text"?(t.set("html"),yC(e,!1)):(t.set("text"),yC(e,!0)),e.focus()},z8=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{U8(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&sl(e,s.html,s.internal,!1),s.text&&$m(e,s.text,!1)})},H8=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(nl(),t),!0}catch{return!1}else return!1},lk=(e,t,n,s)=>{H8(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},uk=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const c=s.createRng();c.selectNodeContents(a),o.setRng(c),hn.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},fk=e=>({html:n8(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),V8=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),dk=e=>!e.selection.isCollapsed()||V8(e),W8=e=>t=>{!t.isDefaultPrevented()&&dk(e)&&e.selection.isEditable()&&lk(t,fk(e),uk(e),()=>{if(Ne.browser.isChromium()||Ne.browser.isFirefox()){const n=e.selection.getRng();hn.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},j8=e=>t=>{!t.isDefaultPrevented()&&dk(e)&&lk(t,fk(e),uk(e),he)},q8=e=>{e.on("cut",W8(e)),e.on("copy",j8(e))},mk=(e,t)=>{var n,s;return _o.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},K8=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},pk=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},G8=e=>Je(e.files,t=>/^image\//.test(t.type)),Y8=(e,t,n,s)=>{const o=e.getParent(n,a=>uo(t,a));if(!zt(e.getParent(n,"summary")))return!0;if(o&&de(s,"text/html")){const a=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!zt(a.querySelector(o.nodeName.toLowerCase()))}else return!1},X8=e=>{e.on("input",t=>{const n=s=>zt(s.querySelector("summary"));if(t.inputType==="deleteByDrag"){const s=le(e.dom.select("details"),n);T(s,o=>{Xe(o.firstChild)&&o.firstChild.remove();const r=e.dom.create("summary");r.appendChild(pa().dom),o.prepend(r)})}})},Z8=(e,t)=>{iP(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),qi(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&G8(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;const s=mk(e,n);if(it(s))return;const o=ak(n.dataTransfer),r=Zs(o,nl());if((!ik(o)||K8(o))&&ck(e,n,s))return;const a=o[nl()],i=a||o["text/html"]||o["text/plain"],c=Y8(e.dom,e.schema,s.startContainer,o),l=t.get();l&&!c||i&&(n.preventDefault(),hn.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(a||l&&c)&&e.execCommand("Delete"),pk(e,s);const u=sk(i);o["text/html"]?sl(e,u,r,!0):$m(e,u,!0)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{qi(e)&&!t.get()&&(n.preventDefault(),pk(e,mk(e,n))),n.type==="dragend"&&t.set(!1)}),X8(e)},Q8=e=>{const t=o=>r=>{o(e,r)},n=cP(e);Be(n)&&e.on("PastePreProcess",t(n));const s=lP(e);Be(s)&&e.on("PastePostProcess",t(s))},J8=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},e4=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,gk=e=>$.trim(e).replace(e4,sa).toLowerCase(),t4=(e,t,n)=>{const s=fP(e);if(n||s==="all"||!dP(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,c,l,u)=>{const f=r.parseStyle(r.decode(l)),d={};for(let h=0;h<o.length;h++){const g=f[o[h]];let b=g,v=r.getStyle(a,o[h],!0);/color/.test(o[h])&&(b=gk(b),v=gk(v)),v!==b&&(d[o[h]]=g)}const p=r.serializeStyle(d,"span");return p?c+' style="'+p+'"'+u:c+u})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,c)=>a+' style="'+i+'"'+c),t},n4=e=>{(Ne.browser.isChromium()||Ne.browser.isSafari())&&J8(e,t4)},s4=e=>{const t=Ct(!1),n=Ct(gP(e)?"text":"html"),s=f8(e);n4(e),z8(e,n),Q8(e),e.on("PreInit",()=>{q8(e),Z8(e,t),M8(e,s,n)})},o4=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},r4=e=>{e.parser.addNodeFilter("details",t=>{const n=TP(e);T(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{const n=PP(e);T(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})})},a4=e=>{o4(e),r4(e)},i4=Xe,hk=O,c4=e=>ze(e.dom),l4=e=>_n(e.dom),bk=e=>t=>Te(C.fromDom(e),t),u4=(e,t,n)=>oo(C.fromDom(e),s=>l4(s)||n.isBlock(_e(s)),bk(t)).getOr(C.fromDom(t)).dom,Ck=(e,t)=>oo(C.fromDom(e),c4,bk(t)),vk=(e,t,n)=>{const s=new ht(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!i4(a);a=o())Vn(a)&&(r=a);return r},f4=(e,t,n)=>{const o=N.fromRangeStart(e).getNode(),r=u4(o,t,n),a=vk(o,r,!1),i=vk(o,r,!0),c=document.createRange();return Ck(a,r).fold(()=>{hk(a)?c.setStart(a,0):c.setStartBefore(a)},l=>c.setStartBefore(l.dom)),Ck(i,r).fold(()=>{hk(i)?c.setEnd(i,i.data.length):c.setEndAfter(i)},l=>c.setEndAfter(l.dom)),c},d4=e=>{const t=f4(e.selection.getRng(),e.getBody(),e.schema);e.selection.setRng(ed(t))},m4=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),d4(e))})};var _r;(function(e){e.Before="before",e.After="after"})(_r||(_r={}));const p4=(e,t)=>Math.abs(e.left-t),g4=(e,t)=>Math.abs(e.right-t),h4=(e,t)=>e>=t.top&&e<=t.bottom,b4=(e,t)=>e.top<t.bottom&&e.bottom>t.top,C4=(e,t)=>{const n=CR(e,t)/Math.min(e.height,t.height);return b4(e,t)&&n>.5},v4=(e,t)=>{const n=le(e,s=>h4(t,s));return bR(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=Uo(e,a=>C4(a,s));return[o,r]})},y4=(e,t)=>({node:e.node,position:p4(e,t)<g4(e,t)?_r.Before:_r.After}),E4=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),Mm=(e,t,n,s)=>{const o=f=>Vn(f.node)?m.some(f):Z(f.node)?Mm(nn(f.node.childNodes),t,n,!1):m.none(),r=(f,d,p)=>o(d).filter(h=>Math.abs(p(f,t,n)-p(h,t,n))<2&&O(h.node)),a=(f,d)=>{const p=eo(f,(h,g)=>d(h,t,n)-d(g,t,n));return zo(p,o).map(h=>s&&!O(h.node)&&p.length>1?r(h,p[1],d).getOr(h):h)},[i,c]=v4(z0(e),n),{pass:l,fail:u}=Uo(c,f=>f.top<n);return a(i,E4).orThunk(()=>a(u,Nh)).orThunk(()=>a(l,Nh))},S4=(e,t,n,s)=>{const o=(r,a)=>{const i=l=>Z(l)&&l.classList.contains("mce-drag-container"),c=le(r.dom.childNodes,Or(i));return a.fold(()=>Mm(c,n,s,!0),l=>{const u=le(c,f=>f!==l.dom);return Mm(u,n,s,!0)}).orThunk(()=>(Te(r,e)?m.none():vi(r)).bind(u=>o(u,m.some(r))))};return o(t,m.none())},w4=(e,t,n)=>{const s=C.fromDom(e),o=vs(s),a=C.fromPoint(o,t,n).filter(i=>Cs(s,i)).getOr(s);return S4(s,a,t,n)},yk=(e,t,n)=>w4(e,t,n).filter(s=>Sa(s.node)).map(s=>y4(s,t)),Ek=e=>{var t,n;const s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},k4=e=>e.inline?Ek(e.getBody()):{left:0,top:0},_4=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},x4=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},N4=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=Ek(e.getContentAreaContainer()),s=x4(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},A4=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),R4=(e,t)=>A4(k4(e),_4(e),N4(e,t)),Sk=e=>({target:e,srcElement:e}),T4=(e,t,n,s)=>({...t,dataTransfer:s,type:e,...Sk(n)}),P4=(e,t,n)=>{const s=dp("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:s,initEvent:s,preventDefault:he,stopImmediatePropagation:he,stopPropagation:he,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:s,initMouseEvent:s,getModifierState:s,dataTransfer:n,...Sk(t)}},D4=(e,t)=>{const n=e8(e);return t==="dragstart"?(qw(n),Gw(n)):t==="drop"?(jj(n),Pm(n)):(qj(n),Xj(n)),n},O4=(e,t,n,s)=>{const o=D4(n,e);return Et(s)?P4(e,t,o):T4(e,s,t,o)},ol=32,B4=100,rl=8,al=16,wk=ze,I4=SR(wk,_n),L4=(e,t,n)=>wk(n)&&n!==t&&e.isEditable(n.parentElement),$4=(e,t,n)=>it(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),F4=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},M4=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},il=(e,t)=>n=>()=>{const s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},kk=il("left",-ol),_k=il("left",ol),xk=il("top",-ol),Nk=il("top",ol),U4=(e,t,n,s,o,r,a,i,c,l,u,f)=>{let d=0,p=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(p=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-p+"px";const h=c.clientHeight,g=c.clientWidth,b=a+c.getBoundingClientRect().top,v=i+c.getBoundingClientRect().left;u.on(y=>{y.intervalId.clear(),y.dragging&&f&&(a+rl>=h?y.intervalId.set(Nk(l)):a-rl<=0?y.intervalId.set(xk(l)):i+rl>=g?y.intervalId.set(_k(l)):i-rl<=0?y.intervalId.set(kk(l)):b+al>=window.innerHeight?y.intervalId.set(Nk(window)):b-al<=0?y.intervalId.set(xk(window)):v+al>=window.innerWidth?y.intervalId.set(_k(window)):v-al<=0&&y.intervalId.set(kk(window)))})},Ak=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},z4=(e,t)=>{const n=e.getParent(t.parentNode,e.isBlock);Ak(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&Us(C.fromDom(n))},H4=e=>e.button===0,V4=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),W4=(e,t)=>n=>{if(H4(n)){const s=ft(t.dom.getParents(n.target),I4).getOr(null);if(V(s)&&L4(t.dom,t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dataTransfer:Dm(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:F4(t,s,s.offsetWidth,s.offsetHeight),intervalId:zA(B4)})}}},j4=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),yk(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{const o=e._selectionOverrides.showCaret(1,s.node,s.position===_r.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},ri=(e,t,n,s,o)=>{t==="dragstart"&&Zw(s,e.dom.getOuterHTML(n));const r=O4(t,n,s,o);return e.dispatch(t,r)},q4=(e,t)=>{const n=Bi((o,r)=>j4(t,o,r),0);t.on("remove",n.cancel);const s=e;return o=>e.on(r=>{const a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){const i=ri(t,"dragstart",r.element,r.dataTransfer,o);if(V(i.dataTransfer)&&(r.dataTransfer=i.dataTransfer),i.isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){const i=o.currentTarget===t.getDoc().documentElement,c=V4(r,R4(t,o));M4(r.ghost,t.getBody()),U4(r.ghost,c,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},K4=e=>{const t=e.getSel();if(V(t)){const s=t.getRangeAt(0).startContainer;return O(s)?s.parentNode:s}else return null},G4=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if($4(t,K4(t.selection),s.element)){const r=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();ri(t,"drop",r,s.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{z4(t.dom,s.element),t8(s.dataTransfer).each(i=>t.insertContent(i)),t._selectionOverrides.hideFakeCaret()})}ri(t,"dragend",t.getBody(),s.dataTransfer,n)}}),Tk(e)},Rk=(e,t,n)=>{e.on(s=>{s.intervalId.clear(),s.dragging&&n.fold(()=>ri(t,"dragend",s.element,s.dataTransfer),o=>ri(t,"dragend",s.element,s.dataTransfer,o))}),Tk(e)},Y4=(e,t)=>n=>Rk(e,t,m.some(n)),Tk=e=>{e.on(t=>{t.intervalId.clear(),Ak(t.ghost)}),e.clear()},X4=e=>{const t=Ms(),n=Fe.DOM,s=document,o=W4(t,e),r=q4(t,e),a=G4(t,e),i=Y4(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",c=>{c.keyCode===K.ESC&&Rk(t,e,m.none())})},Z4=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(Ie(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&Tc(e,"Dropped file type is not supported"))}},n=o=>{uc(e,o.target)&&t(o)},s=()=>{const o=Fe.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),c=["drop","dragover"];T(c,l=>{o.bind(a,l,n),r.bind(i,l,t)}),e.on("remove",()=>{T(c,l=>{o.unbind(a,l,n),r.unbind(i,l,t)})})};e.on("init",()=>{hn.setEditorTimeout(e,s,0)})},Q4=e=>{X4(e),ZT(e)&&Z4(e)},J4=e=>{const t=Bi(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=Hd(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},eq=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if(os(n)){const s=Ro(e.getBody(),n),o=ze(s)?s:n;e.selection.getNode()!==o&&qa(e,o).each(r=>e.selection.setRng(r))}})})},ai=ze,Pk=(e,t)=>Ro(e.getBody(),t),tq=e=>{const t=e.selection,n=e.dom,s=e.getBody(),o=qP(e,s,n.isBlock,()=>xo(e)),r="sel-"+n.uniqueId(),a="data-mce-selected";let i;const c=z=>V(z)&&n.hasClass(z,"mce-offscreen-selection"),l=z=>z!==s&&(ai(z)||os(z))&&n.isChildOf(z,s)&&n.isEditable(z.parentNode),u=z=>{z&&t.setRng(z)},f=(z,P,x,A=!0)=>e.dispatch("ShowCaret",{target:P,direction:z,before:x}).isDefaultPrevented()?null:(A&&t.scrollIntoView(P,z===-1),o.show(x,P)),d=z=>{z.hasAttribute("data-mce-caret")&&(xu(z),t.scrollIntoView(z))},p=()=>{e.on("click",P=>{n.isEditable(P.target)||(P.preventDefault(),e.focus())}),e.on("blur NewBlock",S),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",P=>{const x=P.target,A=Pk(e,x);ai(A)?(P.preventDefault(),qa(e,A).each(E)):l(x)&&qa(e,x).each(E)},!0),e.on("mousedown",P=>{const x=P.target;if(x!==s&&x.nodeName!=="HTML"&&!n.isChildOf(x,s)||!zU(e,P.clientX,P.clientY))return;S(),B();const A=Pk(e,x);ai(A)?(P.preventDefault(),qa(e,A).each(E)):yk(s,P.clientX,P.clientY).each(U=>{P.preventDefault();const Q=f(1,U.node,U.position===_r.Before,!1);u(Q),Ss(A)?A.focus():e.getBody().focus()})}),e.on("keypress",P=>{K.modifierPressed(P)||ai(t.getNode())&&P.preventDefault()}),e.on("GetSelectionRange",P=>{let x=P.range;if(i){if(!i.parentNode){i=null;return}x=x.cloneRange(),x.selectNode(i),P.range=x}}),e.on("SetSelectionRange",P=>{P.range=b(P.range);const x=E(P.range,P.forward);x&&(P.range=x)});const z=P=>Z(P)&&P.id==="mcepastebin";e.on("AfterSetSelectionRange",P=>{const x=P.range,A=x.startContainer.parentElement;!g(x)&&!z(A)&&B(),c(A)||S()}),Q4(e),J4(e),eq(e)},h=z=>fn(z)||Fi(z)||Mi(z),g=z=>h(z.startContainer)||h(z.endContainer),b=z=>{const P=e.schema.getVoidElements(),x=n.createRng(),A=z.startContainer,U=z.startOffset,Q=z.endContainer,fe=z.endOffset;return de(P,A.nodeName.toLowerCase())?U===0?x.setStartBefore(A):x.setStartAfter(A):x.setStart(A,U),de(P,Q.nodeName.toLowerCase())?fe===0?x.setEndBefore(Q):x.setEndAfter(Q):x.setEnd(Q,fe),x},v=(z,P)=>{const x=C.fromDom(e.getBody()),A=e.getDoc(),U=yi(x,"#"+r).getOrThunk(()=>{const ye=C.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',A);return St(ye,"id",r),ct(x,ye),ye}),Q=n.createRng();Xo(U),ao(U,[C.fromText(bt,A),C.fromDom(P),C.fromText(bt,A)]),Q.setStart(U.dom.firstChild,1),Q.setEnd(U.dom.lastChild,0),Ei(U,{top:n.getPos(z,e.getBody()).y+"px"}),UC(U);const fe=t.getSel();return fe&&(fe.removeAllRanges(),fe.addRange(Q)),Q},y=z=>{const P=z.cloneNode(!0),x=e.dispatch("ObjectSelected",{target:z,targetClone:P});if(x.isDefaultPrevented())return null;const A=v(z,x.targetClone),U=C.fromDom(z);return T(Pt(C.fromDom(e.getBody()),`*[${a}]`),Q=>{Te(U,Q)||wt(Q,a)}),n.getAttrib(z,a)||z.setAttribute(a,"1"),i=z,B(),A},E=(z,P)=>{if(!z)return null;if(z.collapsed){if(!g(z)){const Q=P?1:-1,fe=xa(Q,s,z),ye=fe.getNode(!P);if(V(ye)){if(Sa(ye))return f(Q,ye,P?!fe.isAtEnd():!1,!1);if(zs(ye)&&ze(ye.nextSibling)){const De=n.createRng();return De.setStart(ye,0),De.setEnd(ye,0),De}}const Ae=fe.getNode(P);if(V(Ae)){if(Sa(Ae))return f(Q,Ae,P?!1:!fe.isAtEnd(),!1);if(zs(Ae)&&ze(Ae.previousSibling)){const De=n.createRng();return De.setStart(Ae,1),De.setEnd(Ae,1),De}}}return null}let x=z.startContainer,A=z.startOffset;const U=z.endOffset;if(O(x)&&A===0&&ai(x.parentNode)&&(x=x.parentNode,A=n.nodeIndex(x),x=x.parentNode),!Z(x))return null;if(U===A+1&&x===z.endContainer){const Q=x.childNodes[A];if(l(Q))return y(Q)}return null},S=()=>{i&&i.removeAttribute(a),yi(C.fromDom(e.getBody()),"#"+r).each(je),i=null},R=()=>{o.destroy(),i=null},B=()=>{o.hide()};return fs(e)||p(),{showCaret:f,showBlockCaretContainer:d,hideFakeCaret:B,destroy:R}},nq=(e,t)=>{let n=t;for(let s=e.previousSibling;O(s);s=s.previousSibling)n+=s.data.length;return n},Dk=(e,t,n,s,o)=>{if(O(n)&&(s<0||s>n.data.length))return[];const r=o&&O(n)?[nq(n,s)]:[s];let a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},Um=(e,t,n,s,o,r,a=!1)=>{const i=Dk(e,t,n,s,a),c=Dk(e,t,o,r,a);return{start:i,end:c}},Ok=(e,t)=>{const n=t.slice(),s=n.pop();return $n(s)?Kt(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>O(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},Bk=(e,t)=>Ok(e,t.start).bind(({node:n,offset:s})=>Ok(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),sq=(e,t,n,s=!1)=>Um(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),xr=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t,O(t.firstChild)&&Qo(t.firstChild.data)),xr(e,s,n)}},cl=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(O(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),O(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),xr(e,o,n),o!==r&&xr(e,r,n))},ll=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),zm=(e,t,n)=>{const s=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:Jh(s).concat(e.blockPatterns),inlinePatterns:eb(s).concat(e.inlinePatterns)}},Hm=(e,t,n,s)=>{const o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},Ik=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),ul=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},Lk=(e,t,n)=>{const s=Bk(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),c=i.parentNode,l=a.parentNode;return{prefix:t,end:l.insertBefore(Ik(e,t+"-end"),a),start:c.insertBefore(Ik(e,t+"-start"),i)}},$k=(e,t,n)=>{xr(e,e.get(t.prefix+"-end"),n),xr(e,e.get(t.prefix+"-start"),n)},Vm=e=>e.start.length===0,oq=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},Fk=(e,t,n,s)=>{const o=t.start;return fm(e,s.container,s.offset,oq(o),n).bind(a=>{var i,c;const l=(c=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&c!==void 0?c:-1;if(l!==-1&&a.offset>=l+o.length){const f=e.createRng();return f.setStart(a.container,a.offset-o.length),f.setEnd(a.container,a.offset),m.some(f)}else{const f=a.offset-o.length;return um(a.container,f,n).map(d=>{const p=e.createRng();return p.setStart(d.container,d.offset),p.setEnd(a.container,a.offset),p}).filter(d=>d.toString()===o).orThunk(()=>Fk(e,t,n,Kn(a.container,0)))}})},rq=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return lm(n,s,o).bind(a=>Fk(e,t,o,a).bind(c=>{var l;if(r){if(c.endContainer===a.container&&c.endOffset===a.offset)return m.none();if(a.offset===0&&((l=c.endContainer.textContent)===null||l===void 0?void 0:l.length)===c.endOffset)return m.none()}return m.some(c)}))},aq=(e,t,n,s)=>{const o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,c=n.position.offset;return um(i,c-n.pattern.end.length,t).bind(l=>{const u=Um(o,r,l.container,l.offset,i,c,s);if(Vm(a))return m.some({matches:[{pattern:a,startRng:u,endRng:u}],position:l});{const f=fl(e,n.remainingPatterns,l.container,l.offset,t,s),d=f.getOr({matches:[],position:l}),p=d.position;return rq(o,a,p.container,p.offset,t,f.isNone()).map(g=>{const b=sq(o,r,g,s);return{matches:d.matches.concat([{pattern:a,startRng:b,endRng:u}]),position:Kn(g.startContainer,g.startOffset)}})}})},fl=(e,t,n,s,o,r)=>{const a=e.dom;return lm(n,s,a.getRoot()).bind(i=>{const c=Hm(a,o,n,s);for(let l=0;l<t.length;l++){const u=t[l];if(!Bl(c,u.end))continue;const f=t.slice();f.splice(l,1);const d=aq(e,o,{pattern:u,remainingPatterns:f,position:i},r);if(d.isNone()&&s>0)return fl(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},Mk=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?T(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},iq=(e,t,n,s)=>{const o=ul(e.dom,n);cl(e.dom,o,s),Mk(e,t,o)},cq=(e,t,n,s,o)=>{const r=e.dom,a=ul(r,s),i=ul(r,n);cl(r,i,o),cl(r,a,o);const c={prefix:n.prefix,start:n.end,end:s.start},l=ul(r,c);Mk(e,t,l)},lq=(e,t)=>{const n=fa("mce_textpattern"),s=Ir(t,(o,r)=>{const a=Lk(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return Ir(s,(o,r)=>{const a=s.length-o.length-1,i=Vm(r.pattern)?r.endMarker:Lk(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},uq=e=>eo(e,(t,n)=>n.end.length-t.end.length),fq=(e,t)=>{const n=Ds(e,s=>Je(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},Uk=(e,t,n,s,o,r)=>{const a=fl(e,o.inlinePatterns,n,s,t,r).fold(()=>[],c=>c.matches),i=fl(e,uq(o.inlinePatterns),n,s,t,r).fold(()=>[],c=>c.matches);return fq(a,i)},zk=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=lq(n,t);T(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=c=>c===a;Vm(r.pattern)?iq(e,r.pattern,r.endMarker,i):cq(e,r.pattern,r.startMarker,r.endMarker,i),$k(n,r.endMarker,i),$k(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},Hk=(e,t,n)=>JV(t,0,t).map(s=>{const o=s.container;return jS(o,n.start.length,t).each(r=>{const a=e.createRng();a.setStart(o,0),a.setEnd(r.container,r.offset),cl(e,a,i=>i===t)}),o}),Vk=e=>(t,n)=>{const s=t.dom,o=n.pattern,r=Bk(s.getRoot(),n.range).getOrDie("Unable to resolve path range"),a=(i,c)=>{const l=c.get(i);return tt(l)&&Vt(l).exists(u=>de(u,"block"))};return ll(t,r).each(i=>{o.type==="block-format"?a(o.format,t.formatter)&&t.undoManager.transact(()=>{e(t.dom,i,o),t.formatter.apply(o.format)}):o.type==="block-command"&&t.undoManager.transact(()=>{e(t.dom,i,o),t.execCommand(o.cmd,!1,o.value)})}),!0},dq=e=>eo(e,(t,n)=>n.start.length-t.start.length),Wk=e=>(t,n)=>{const s=dq(t),o=n.replace(bt," ");return ft(s,r=>e(r,n,o))},jk=(e,t)=>(n,s,o,r,a)=>{var i;a===void 0&&(a=(i=s.textContent)!==null&&i!==void 0?i:"");const c=n.dom,l=Ot(n);return c.is(s,l)?e(o.blockPatterns,a).map(u=>t&&$.trim(a).length===u.start.length?[]:[{pattern:u,range:Um(c,c.getRoot(),s,0,s,0,r)}]).getOr([]):[]},mq=e=>/^\s[^\s]/.test(e),pq=Vk((e,t,n)=>{Hk(e,t,n).each(s=>{const o=C.fromDom(s),r=Ii(o);mq(r)&&QA(o,r.slice(1))})}),gq=Wk((e,t,n)=>t.indexOf(e.start)===0||n.indexOf(e.start)===0),hq=jk(gq,!0),bq=(e,t)=>{const n=e.selection.getRng();return ll(e,n).map(s=>{var o;const r=Math.max(0,n.startOffset),a=zm(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=Uk(e,s,n.startContainer,r,a,!0),c=hq(e,s,a,!0);return{inlineMatches:i,blockMatches:c}}).filter(({inlineMatches:s,blockMatches:o})=>o.length>0||s.length>0)},Cq=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();T(t,s=>pq(e,s)),e.selection.moveToBookmark(n)},vq=Vk(Hk),yq=Wk((e,t,n)=>t===e.start||n===e.start),Eq=jk(yq,!1),Sq=(e,t)=>{const n=e.selection.getRng();return ll(e,n).map(s=>{const o=Math.max(0,n.startOffset),r=Hm(e.dom,s,n.startContainer,o),a=zm(t,s,r);return Eq(e,s,a,!1,r)}).filter(s=>s.length>0)},wq=(e,t)=>{T(t,n=>vq(e,n))},kq=(e,t)=>bq(e,t).fold(qe,({inlineMatches:n,blockMatches:s})=>(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{uR(e),zk(e,n),Cq(e,s);const o=e.selection.getRng(),r=lm(o.startContainer,o.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each(a=>{const i=a.container;i.data.charAt(a.offset-1)===Jr&&(i.deleteData(a.offset-1,1),xr(e.dom,i.parentNode,c=>c===e.dom.getRoot()))})}),!0)),_q=(e,t)=>{const n=e.selection.getRng();ll(e,n).map(s=>{const o=Math.max(0,n.startOffset-1),r=Hm(e.dom,s,n.startContainer,o),a=zm(t,s,r),i=Uk(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{zk(e,i)})})},xq=(e,t)=>Sq(e,t).fold(qe,n=>(e.undoManager.transact(()=>{wq(e,n)}),!0)),qk=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},Nq=(e,t)=>qk(e,t,(n,s)=>n===s.keyCode&&!K.modifierPressed(s)),Aq=(e,t)=>qk(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),Rq=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>oT(CP(e),vP(e)),o=()=>_P(e);e.on("keydown",a=>{if(a.keyCode===13&&!K.modifierPressed(a)&&e.selection.isCollapsed()){const i=Lu(s(),"enter");(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&kq(e,i)&&a.preventDefault()}},!0),e.on("keydown",a=>{if(a.keyCode===32&&e.selection.isCollapsed()){const i=Lu(s(),"space");(i.blockPatterns.length>0||o())&&xq(e,i)&&a.preventDefault()}},!0);const r=()=>{if(e.selection.isCollapsed()){const a=Lu(s(),"space");(a.inlinePatterns.length>0||o())&&_q(e,a)}};e.on("keyup",a=>{Nq(n,a)&&r()}),e.on("keypress",a=>{Aq(t,a)&&hn.setEditorTimeout(e,r)})},Tq=e=>{Rq(e)},Pq=e=>{const t=$.each,n=K.BACKSPACE,s=K.DELETE,o=e.dom,r=e.selection,a=e.parser,i=Ne.browser,c=i.isFirefox(),l=i.isChromium()||i.isSafari(),u=Ne.deviceType.isiPhone()||Ne.deviceType.isiPad(),f=Ne.os.isMacOS()||Ne.os.isiOS(),d=(M,te)=>{try{e.getDoc().execCommand(M,!1,String(te))}catch{}},p=M=>M.isDefaultPrevented(),h=()=>{const M=pe=>{const H=o.create("body"),me=pe.cloneContents();return H.appendChild(me),r.serializer.serialize(H,{format:"html"})},te=pe=>{const H=M(pe),me=o.createRng();me.selectNode(e.getBody());const be=M(me);return H===be};e.on("keydown",pe=>{const H=pe.keyCode;if(!p(pe)&&(H===s||H===n)&&e.selection.isEditable()){const me=e.selection.isCollapsed(),be=e.getBody();if(me&&!ws(e.schema,be)||!me&&!te(e.selection.getRng()))return;pe.preventDefault(),e.setContent(""),be.firstChild&&o.isBlock(be.firstChild)?e.selection.setCursorLocation(be.firstChild,0):e.selection.setCursorLocation(be,0),e.nodeChanged()}})},g=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},b=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",M=>{let te;if(M.target===e.getDoc().documentElement)if(te=r.getRng(),e.getBody().focus(),M.type==="mousedown"){if(fn(te.startContainer))return;r.placeCaretAt(M.clientX,M.clientY)}else r.setRng(te)})},v=()=>{e.on("keydown",M=>{if(!p(M)&&M.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const te=r.getNode(),pe=te.previousSibling;if(te.nodeName==="HR"){o.remove(te),M.preventDefault();return}pe&&pe.nodeName&&pe.nodeName.toLowerCase()==="hr"&&(o.remove(pe),M.preventDefault())}}})},y=()=>{Range.prototype.getClientRects||e.on("mousedown",M=>{if(!p(M)&&M.target.nodeName==="HTML"){const te=e.getBody();te.blur(),hn.setEditorTimeout(e,()=>{te.focus()})}})},E=()=>{const M=hb(e);e.on("click",te=>{const pe=te.target;/^(IMG|HR)$/.test(pe.nodeName)&&o.isEditable(pe)&&(te.preventDefault(),e.selection.select(pe),e.nodeChanged()),pe.nodeName==="A"&&o.hasClass(pe,M)&&pe.childNodes.length===0&&o.isEditable(pe.parentNode)&&(te.preventDefault(),r.select(pe))})},S=()=>{const M=()=>{const pe=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const H=r.getStart();H!==e.getBody()&&(o.setAttrib(H,"style",null),t(pe,me=>{H.setAttributeNode(me.cloneNode(!0))}))}},te=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",pe=>{let H;return!p(pe)&&(pe.keyCode===8||pe.keyCode===46)&&te()?(H=M(),e.getDoc().execCommand("delete",!1),H(),pe.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",pe=>{if(!p(pe)&&te()){const H=M();hn.setEditorTimeout(e,()=>{H()})}})},R=()=>{e.on("keydown",M=>{if(!p(M)&&M.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const te=r.getNode().previousSibling;if(te&&te.nodeName&&te.nodeName.toLowerCase()==="table")return M.preventDefault(),!1}return!0})},B=()=>{e.on("keydown",M=>{if(p(M)||M.keyCode!==K.BACKSPACE)return;let te=r.getRng();const pe=te.startContainer,H=te.startOffset,me=o.getRoot();let be=pe;if(!(!te.collapsed||H!==0)){for(;be.parentNode&&be.parentNode.firstChild===be&&be.parentNode!==me;)be=be.parentNode;be.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,be),te=o.createRng(),te.setStart(pe,0),te.setEnd(pe,0),r.setRng(te))}})},z=()=>{const M=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),db(e)||d("enableObjectResizing",!1)};pb(e)||e.on("BeforeExecCommand mousedown",M)},P=()=>{const M=()=>{t(o.select("a:not([data-mce-block])"),te=>{var pe;let H=te.parentNode;const me=o.getRoot();if((H==null?void 0:H.lastChild)===te){for(;H&&!o.isBlock(H);){if(((pe=H.parentNode)===null||pe===void 0?void 0:pe.lastChild)!==H||H===me)return;H=H.parentNode}o.add(H,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",te=>{(te.type==="setcontent"||te.command==="mceInsertLink")&&M()})},x=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",Ot(e))})},A=M=>{const te=M.getBody(),pe=M.selection.getRng();return pe.startContainer===pe.endContainer&&pe.startContainer===te&&pe.startOffset===0&&pe.endOffset===te.childNodes.length},U=()=>{e.on("keyup focusin mouseup",M=>{!K.modifierPressed(M)&&!A(e)&&r.normalize()},!0)},Q=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},fe=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},ye=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",M=>{let te;M.target.nodeName==="HTML"&&(te=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(te),e.selection.normalize(),e.nodeChanged())}))},Ae=()=>{f&&e.on("keydown",M=>{K.metaKeyPressed(M)&&!M.shiftKey&&(M.keyCode===37||M.keyCode===39)&&(M.preventDefault(),e.selection.getSel().modify("move",M.keyCode===37?"backward":"forward","lineboundary"))})},De=()=>{e.on("click",M=>{let te=M.target;do if(te.tagName==="A"){M.preventDefault();return}while(te=te.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},Le=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",M=>{M.preventDefault()})})},yt=()=>{a.addNodeFilter("br",M=>{let te=M.length;for(;te--;)M[te].attr("class")==="Apple-interchange-newline"&&M[te].remove()})},Oe=he,F=()=>{if(!c||e.removed)return!1;const M=e.selection.getSel();return!M||!M.rangeCount||M.rangeCount===0},X=()=>{l&&(b(),E(),Le(),g(),u&&(fe(),ye(),De())),c&&(y(),z(),Q(),Ae())},we=()=>{B(),h(),Ne.windowsPhone||U(),l&&(b(),E(),x(),Le(),R(),yt(),u?(fe(),ye(),De()):g()),c&&(v(),y(),S(),z(),P(),Q(),Ae(),R())};return fs(e)?X():we(),{refreshContentEditable:Oe,isHidden:F}},Dq=e=>e.toLowerCase()==="gpl",Oq=e=>e.length>=64&&e.length<=255,Bq=e=>Dq(e)||Oq(e)?"VALID":"INVALID",Iq=e=>{const t=OP(e);!ee(BP(e))&&(Et(t)||Bq(t)==="INVALID")&&console.warn("TinyMCE is running in evaluation mode. Provide a valid license key or add license_key: 'gpl' to the init config to agree to the open source license terms. Read more at https://www.tiny.cloud/license-key/")},Wm=Fe.DOM,Lq=(e,t)=>{const n=C.fromDom(e.getBody()),s=Wl(Bs(n)),o=C.fromTag("style");St(o,"type","text/css"),ct(o,C.fromText(t)),ct(s,o),e.on("remove",()=>{je(o)})},$q=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,jm=e=>Ur(e,t=>Et(t)===!1),Kk=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return jm({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_unsafe_embeds:t("convert_unsafe_embeds"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:$q(e),sandbox_iframes:t("sandbox_iframes"),sandbox_iframes_exclusions:zu(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},Gk=e=>{const t=e.options.get;return jm({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},Fq=e=>{const t=e.options.get;return{...Kk(e),...Gk(e),...jm({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},Mq=e=>{const t=br(Kk(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{const o=e.dom,r="data-mce-"+s;let a=n.length;for(;a--;){const i=n[a];let c=i.attr(s);if(c&&!i.attr(r)){if(c.indexOf("data:")===0||c.indexOf("blob:")===0)continue;s==="style"?(c=o.serializeStyle(o.parseStyle(c),i.name),c.length||(c=null),i.attr(r,c),i.attr(s,c)):s==="tabindex"?(i.attr(r,c),i.attr(s,null)):i.attr(r,e.convertURL(c,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),SP(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){const r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new Mt("br",1))}}),t},Uq=e=>{const t=oP(e);t&&hn.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},zq=e=>{const t=e.dom.getRoot();!e.inline&&(!Ji(e)||e.selection.getStart(!0)===t)&&Bt(t).each(n=>{const s=n.getNode(),o=ss(s)?Bt(s).getOr(n):n;e.selection.setRng(o.toRange())})},Hq=e=>{e.bindPendingEventDelegates(),e.initialized=!0,s1(e),e.focus(!0),zq(e),e.nodeChanged({initial:!0});const t=nP(e);Be(t)&&t.call(e,e),Uq(e)},qm=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,Vq=(e,t,n)=>{const{pass:s,fail:o}=Uo(t,i=>tinymce.Resource.has($d(i))),a=[...s.map(i=>{const c=tinymce.Resource.get($d(i));return ee(c)?Promise.resolve(qm(e).loadRawCss(i,c)):Promise.resolve()}),qm(e).loadAll(o)];return e.inline?a:a.concat([e.ui.styleSheetLoader.loadAll(n)])},Yk=e=>{const t=qm(e),n=fb(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let c="";$.each(e.contentStyles,l=>{c+=l+`\r
`}),e.dom.addStyle(c)}const a=Promise.all(Vq(e,s,n)).then(r).catch(r),i=TT(e);return i&&Lq(e,i),a},Wq=e=>{const t=e.getDoc(),n=e.getBody();t1(e),rP(e)||(t.body.spellcheck=!1,Wm.setAttrib(n,"spellcheck","false")),e.quirks=Pq(e),n1(e);const s=PT(e);s!==void 0&&(n.dir=s);const o=aP(e);o&&e.on("BeforeSetContent",r=>{$.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},jq=e=>{fs(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Km=e=>{e.removed!==!0&&(jq(e),Hq(e))},qq=e=>{let t=!1;const n=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(n),t=!0,e.setProgressState(!1)}},Xk=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(Wm.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=pb(e),e._editableRoot=YT(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&Wm.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=pz(e),e.schema=Fs(Gk(e)),e.dom=Fe(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:xT(e),referrerPolicy:Fu(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=Mq(e),e.serializer=HE(Fq(e),e),e.selection=zE(e.dom,e.getWin(),e.serializer,e),e.annotator=mC(e),e.formatter=s0(e),e.undoManager=r0(e),e._nodeChangeDispatcher=new Uj(e),e._selectionOverrides=tq(e),U2(e),a4(e),G2(e),fs(e)||(m4(e),Tq(e));const o=Mj(e);$2(e,o),j2(e),Rz(e),s4(e);const r=CM(e);Wq(e),Iq(e),r.fold(()=>{const a=qq(e);Yk(e).then(()=>{Km(e),a()})},a=>{e.setProgressState(!0),Yk(e).then(()=>{a().then(i=>{e.setProgressState(!1),Km(e),LE(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Km(e),LE(e)})})})},Kq=ot,Gq=(e,t,n)=>lN(e,t,Kq,n),Gm=Fe.DOM,Yq=(e,t,n,s)=>{const o=C.fromTag("iframe");return s.each(r=>St(o,"tabindex",r)),hs(o,n),hs(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),qo(o,"tox-edit-area__iframe"),o},Xq=e=>{let t=fT(e)+"<html><head>";ob(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=dT(e),s=mT(e),o=e.translate(eP(e));return rb(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+rb(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},Zq=(e,t)=>{const n=e.translate("Rich Text Area"),s=bs(C.fromDom(e.getElement()),"tabindex").bind(gi),o=Yq(e.id,n,uT(e),s).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=Xq(e),Gm.add(t.iframeContainer,o)},Qq=e=>{const t=e.iframeElement,n=()=>{e.contentDocument=t.contentDocument,Xk(e)};if(kP(e)||Ne.browser.isFirefox()){const s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close(),n()}else{const s=Gq(C.fromDom(t),"load",()=>{s.unbind(),n()});t.srcdoc=e.iframeHTML}},Jq=(e,t)=>{Zq(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=Gm.isHidden(t.editorContainer)),e.getElement().style.display="none",Gm.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,Qq(e)},Zk=Fe.DOM,e5=(e,t,n)=>{const s=vr.get(n),o=vr.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=$.trim(n),s&&$.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,Be(r.init)&&(r.init(e,o),t.push(n))}catch(r){QU(e,n,r)}}},t5=e=>e.replace(/^\-/,""),n5=e=>{const t=[];T(ji(e),n=>{e5(e,t,t5(n))})},s5=e=>{const t=$.trim(cb(e)),n=e.ui.registry.getAll().icons,s={...Rc.get("default").icons,...Rc.get(t).icons};Ue(s,(o,r)=>{de(n,r)||e.ui.registry.addIcon(r,o)})},o5=e=>{const t=rr(e);if(ee(t)){const n=Po.get(t);e.theme=n(e,Po.urls[t])||{},Be(e.theme.init)&&e.theme.init(e,Po.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},r5=e=>{const t=Mu(e),n=Cr.get(t);e.model=n(e,Cr.urls[t])},a5=e=>{const t=e.theme.renderUI;return t?t():Jk(e)},i5=e=>{const t=e.getElement(),s=rr(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},Qk=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),c5=e=>{const t=Zk.create("div");return Zk.insertAfter(t,e),Qk(t,t)},Jk=e=>{const t=e.getElement();return e.inline?Qk(null):c5(t)},l5=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,ee(rr(e))?a5(e):Be(rr(e))?i5(e):Jk(e)},u5=(e,t)=>{const n={show:m.from(t.show).getOr(he),hide:m.from(t.hide).getOr(he),isEnabled:m.from(t.isEnabled).getOr(ot),setEnabled:s=>{e.mode.isReadOnly()||m.from(t.setEnabled).each(o=>o(s))}};e.ui={...e.ui,...n}},f5=async e=>{e.dispatch("ScriptsLoaded"),s5(e),o5(e),r5(e),n5(e);const t=await l5(e);u5(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,sz(e),e.inline?Xk(e):Jq(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},Oo=Fe.DOM,e_=e=>e.charAt(0)==="-",d5=(e,t)=>{const n=lb(t),s=NT(t);if(!Hn.hasCode(n)&&n!=="en"){const o=Qn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{YU(t,o,n)})}},m5=(e,t)=>{const n=rr(e);if(ee(n)&&!e_(n)&&!de(Po.urls,n)){const s=LT(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;Po.load(n,o).catch(()=>{XU(e,o,n)})}},p5=(e,t)=>{const n=Mu(e);if(n!=="plugin"&&!de(Cr.urls,n)){const s=$T(e),o=ee(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;Cr.load(n,o).catch(()=>{ZU(e,o,n)})}},g5=e=>m.from(ET(e)).filter(Qn).map(t=>({url:t,name:m.none()})),t_=(e,t,n)=>m.from(t).filter(s=>Qn(s)&&!Rc.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),h5=(e,t,n)=>{const s=t_(t,"default",n),o=g5(t).orThunk(()=>t_(t,cb(t),""));T(vx([s,o]),r=>{e.add(r.url).catch(()=>{GU(t,r.url,r.name.getOrUndefined())})})},b5=(e,t)=>{const n=(s,o)=>{vr.load(s,o).catch(()=>{KU(e,o,s)})};Ue(XT(e),(s,o)=>{n(o,s),e.options.set("plugins",ji(e).concat(o))}),T(ji(e),s=>{s=$.trim(s),s&&!vr.urls[s]&&!e_(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},C5=e=>{const t=rr(e);return!ee(t)||V(Po.get(t))},v5=e=>{const t=Mu(e);return V(Cr.get(t))},y5=(e,t)=>{const n=ks.ScriptLoader,s=()=>{!e.removed&&C5(e)&&v5(e)&&f5(e)};m5(e,t),p5(e,t),d5(n,e),h5(n,e,t),b5(e,t),n.loadQueue().then(s,s)},E5=(e,t)=>Wg.forElement(e,{contentCssCors:gb(t),referrerPolicy:Fu(t)}),S5=e=>{const t=e.id;Hn.setCode(lb(e));const n=()=>{Oo.unbind(window,"ready",n),e.render()};if(!mo.Event.domLoaded){Oo.bind(window,"ready",n);return}if(!e.getElement())return;const s=C.fromDom(e.getElement()),o=ng(s);e.on("remove",()=>{pp(s.dom.attributes,a=>wt(s,a.name)),hs(s,o)}),e.ui.styleSheetLoader=E5(s,e),Uu(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||Oo.getParent(t,"form");r&&(e.formElement=r,VT(e)&&!Zl(e.getElement())&&(Oo.insertAfter(Oo.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},Oo.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),WT(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=YE(e),e.notificationManager=GE(e),AP(e)&&e.on("GetContent",a=>{a.save&&(a.content=Oo.encode(a.content))}),jT(e)&&e.on("submit",()=>{e.initialized&&e.save()}),qT(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),y5(e,e.suffix)},w5=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,e.readonly||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),d1(e,t))},k5=e=>e._editableRoot,_5=(e,t)=>({sections:j(e),options:j(t)}),n_=Jn().deviceType,s_=n_.isPhone(),x5=n_.isTablet(),ii=e=>{if(it(e))return[];{const t=tt(e)?e:e.split(/[ ,]/),n=ke(t,Vo);return le(n,Qn)}},N5=(e,t)=>{const n=j_(t,(s,o)=>Ie(e,o));return _5(n.t,n.f)},A5=(e,t,n={})=>{const s=e.sections(),o=We(s,t).getOr({});return $.extend({},n,o)},Ym=(e,t)=>de(e.sections(),t),R5=(e,t)=>Ym(e,t)?e.sections()[t]:{},T5=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:We(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),P5=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?$.extend({},e.external_plugins,s):s},D5=(e,t)=>[...ii(e),...ii(t)],O5=(e,t,n,s)=>e&&Ym(t,"mobile")?s:n,B5=(e,t,n,s)=>{const o=ii(n.forced_plugins),r=ii(s.plugins),a=R5(t,"mobile"),i=a.plugins?ii(a.plugins):r,c=O5(e,t,r,i),l=D5(o,c);return $.extend(s,{forced_plugins:o,plugins:l})},I5=(e,t)=>e&&Ym(t,"mobile"),L5=(e,t,n,s,o)=>{var r;const a=e?{mobile:T5((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=N5(["mobile"],Vc(a,o)),c=$.extend(n,s,i.options(),I5(e,i)?A5(i,"mobile"):{},{external_plugins:P5(s,i.options())});return B5(e,i,s,c)},$5=(e,t)=>L5(s_||x5,s_,t,e,t),F5=(e,t)=>VM(e,t),M5=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{T("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},U5=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Je(o,r=>V(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},z5=e=>{M5(e),U5(e)},H5=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Ne.os.isMacOS()||Ne.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}}})},V5=(e,t,n,s)=>{const o=C.fromDom(e.getRoot());return Ia(o,N.fromRangeStart(t),s)?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),La(o,N.fromRangeEnd(t),s)?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},W5=e=>{if(typeof e!="string"){const t=$.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},j5=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?V5(s,n.getRng(),t,e.schema):t},dl=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:s}=W5(t);xd(e,{...s,content:j5(e,n),format:"html",set:!1,selection:!0}).each(o=>{const r=zM(e,o.content,s);Nd(e,r,o),e.addVisual()})}},q5=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{dl(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{dl(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{dl(e,s)},mceInsertContent:(t,n,s)=>{dl(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(uP(e))}})},K5={"font-size":"size","font-family":"face"},G5=Ci("font"),Y5=(e,t,n)=>{const s=r=>Si(r,e).orThunk(()=>G5(r)?We(K5,e).bind(a=>bs(r,a)):m.none()),o=r=>Te(C.fromDom(t),r);return od(C.fromDom(n),r=>s(r),o)},X5=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),Z5=(e,t)=>m.from(Fe.DOM.getStyle(t,e,!0)),o_=e=>(t,n)=>m.from(n).map(C.fromDom).filter(sn).bind(s=>Y5(e,t,s.dom).or(Z5(e,s.dom))).getOr(""),Q5=o_("font-size"),J5=Xn(X5,o_("font-family")),e6=e=>Bt(e.getBody()).bind(t=>{const n=t.container();return m.from(O(n)?n.parentNode:n)}),t6=e=>m.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),n6=(e,t)=>t6(e).orThunk(G(e6,e)).map(C.fromDom).filter(sn).bind(t),Xm=(e,t)=>n6(e,up(m.some,t)),r_=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=xP(e),o=NP(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},s6=e=>{const t=e.split(/\s*,\s*/);return ke(t,n=>n.indexOf(" ")!==-1&&!(dt(n,'"')||dt(n,"'"))?`'${n}'`:n).join(",")},o6=(e,t)=>{const n=r_(e,t);e.formatter.toggle("fontname",{value:s6(n)}),e.nodeChanged()},r6=e=>Xm(e,t=>J5(e.getBody(),t.dom)).getOr(""),a6=(e,t)=>{e.formatter.toggle("fontsize",{value:r_(e,t)}),e.nodeChanged()},i6=e=>Xm(e,t=>Q5(e.getBody(),t.dom)).getOr(""),c6=e=>Xm(e,t=>{const n=C.fromDom(e.getBody()),s=od(t,r=>Si(r,"line-height"),G(Te,n)),o=()=>{const r=parseFloat(ns(t,"line-height")),a=parseFloat(ns(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),l6=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},u6=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{o6(e,o)},FontSize:(n,s,o)=>{a6(e,o)},LineHeight:(n,s,o)=>{l6(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(ee(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},f6=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>r6(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>i6(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>c6(e))},d6=e=>{u6(e),f6(e)},m6=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},p6=e=>{e.editorCommands.addCommands({Indent:()=>{B2(e)},Outdent:()=>{uS(e)}}),e.editorCommands.addCommands({Outdent:()=>aS(e)},"state")},g6=e=>{const t=(n,s,o)=>{const r=ee(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");at(r)&&ee(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},h6=(e,t,n,s)=>{const o=e.dom,r=i=>o.isBlock(i)&&i.parentElement===n,a=r(t)?t:o.getParent(s,r,n);return m.from(a).map(C.fromDom)},a_=(e,t)=>{const n=e.dom,s=e.selection.getRng(),o=t?e.selection.getStart():e.selection.getEnd(),r=t?s.startContainer:s.endContainer,a=ni(n,r);if(!a||!a.isContentEditable)return;const i=t?Yt:Es,c=Ot(e);h6(e,o,a,r).each(l=>{const u=kw(e,r,l.dom,a,!1,c);i(l,C.fromDom(u)),e.selection.setCursorLocation(u,0),e.dispatch("NewBlock",{newBlock:u}),ti(e,"insertParagraph")})},b6=e=>a_(e,!0),C6=e=>a_(e,!1),v6=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{b6(e)},InsertNewBlockAfter:()=>{C6(e)}})},y6=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Jc(Aw,e)},mceInsertNewLine:(t,n,s)=>{Iw(e,s)},InsertLineBreak:(t,n,s)=>{Jc(Pw,e)}})},E6=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>Z(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),_n);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},S6=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s??e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{LO(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},w6=e=>{z5(e),H5(e),m6(e),E6(e),q5(e),g6(e),p6(e),v6(e),y6(e),d6(e),S6(e)},k6=["toggleview"],i_=e=>Ie(k6,e.toLowerCase());class c_{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():hO(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const l=this.commands.exec[a];return Be(l)?(l(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!i_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return Be(s)?s(n):!1}queryCommandValue(t){if(!i_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return Be(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Ue(t,(o,r)=>{T(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}const Bo="data-mce-contenteditable",_6=(e,t,n)=>{Ml(e,t)&&!n?Kr(e,t):n&&qo(e,t)},Zm=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},ml=(e,t)=>{e.dom.contentEditable=t?"true":"false"},x6=e=>{T(Pt(e,'*[contenteditable="true"]'),t=>{St(t,Bo,"true"),ml(t,!1)})},N6=e=>{T(Pt(e,`*[${Bo}="true"]`),t=>{wt(t,Bo),ml(t,!0)})},A6=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},R6=e=>{e.selection.setRng(e.selection.getRng())},T6=(e,t)=>{const n=C.fromDom(e.getBody());_6(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),A6(e),e.readonly=!0,ml(n,!1),x6(n)):(e.readonly=!1,e.hasEditableRoot()&&ml(n,!0),N6(n),Zm(e,"StyleWithCSS",!1),Zm(e,"enableInlineTableEditing",!1),Zm(e,"enableObjectResizing",!1),KC(e)&&e.focus(),R6(e),e.nodeChanged())},Io=e=>e.readonly,l_=e=>{e.parser.addAttributeFilter("contenteditable",t=>{Io(e)&&T(t,n=>{n.attr(Bo,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(Bo,t=>{Io(e)&&T(t,n=>{n.attr("contenteditable",n.attr(Bo))})}),e.serializer.addTempAttr(Bo)},P6=e=>{e.serializer?l_(e):e.on("PreInit",()=>{l_(e)})},D6=e=>e.type==="click",O6=["copy"],B6=e=>Ie(O6,e.type),I6=(e,t)=>Yo(t,"a",s=>Te(s,C.fromDom(e.getBody()))).bind(s=>bs(s,"href")),L6=(e,t)=>{if(D6(t)&&!K.metaKeyPressed(t)){const n=C.fromDom(t.target);I6(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${_p(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else B6(t)&&e.dispatch(t.type,t)},$6=e=>{e.on("ShowCaret",t=>{Io(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{Io(e)&&t.preventDefault()})},F6=$.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Qm{static isNative(t){return!!F6[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||qe}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=hu(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const c=r[a];if(!c.removed){if(c.once&&this.off(s,c.func),o.isImmediatePropagationStopped())return o;if(c.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=qe),n){const r={func:n,removed:!1};o&&$.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const c=a[i];let l=this.bindings[c];l||(l=[],this.toggleEvent(c,!0)),s?l=[r,...l]:l=[...l,r],this.bindings[c]=l}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Ue(this.bindings,(i,c)=>{this.toggleEvent(c,!1),delete this.bindings[c]}),this;if(a){if(!n)a.length=0;else{const i=Uo(a,c=>c.func===n);a=i.fail,this.bindings[r]=a,T(i.pass,c=>{c.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Ue(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const ci=e=>(e._eventDispatcher||(e._eventDispatcher=new Qm({scope:e,toggleEvent:(t,n)=>{Qm.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),Jm={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return hu(e.toLowerCase(),t??{},s);const o=ci(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return ci(this).on(e,t,n)},off(e,t){return ci(this).off(e,t)},once(e,t){return ci(this).once(e,t)},hasEventListeners(e){return ci(this).has(e)}},pl=Fe.DOM;let Lo;const gl=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=mb(e);return n?(e.eventRoot||(e.eventRoot=pl.select(n)[0]),e.eventRoot):e.getBody()},M6=e=>!e.hidden&&!Io(e),u_=(e,t,n)=>{M6(e)?e.dispatch(t,n):Io(e)&&L6(e,n)},f_=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=gl(e,t);if(mb(e)){if(Lo||(Lo={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||Lo&&(Ue(Lo,(o,r)=>{e.dom.unbind(gl(e,r))}),Lo=null)})),Lo[t])return;const s=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const c=a[i].getBody();(c===r||pl.isChildOf(r,c))&&u_(a[i],t,o)}};Lo[t]=s,pl.bind(n,t,s)}else{const s=o=>{u_(e,t,o)};pl.bind(n,t,s),e.delegates[t]=s}},d_={...Jm,bindPendingEventDelegates(){const e=this;$.each(e._pendingNativeEvents,t=>{f_(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?f_(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(gl(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Ue(e.delegates,(s,o)=>{e.dom.unbind(gl(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},U6=e=>ee(e)?{value:e.split(/[ ,]/),valid:!0}:Mo(e,ee)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},z6=e=>{const t=(()=>{switch(e){case"array":return tt;case"boolean":return Ps;case"function":return Be;case"number":return $n;case"object":return at;case"string":return ee;case"string[]":return U6;case"object[]":return n=>Mo(n,at);case"regexp":return n=>Ln(n,RegExp);default:return ot}})();return n=>ep(n,t,`The value must be a ${e}.`)},H6=e=>ee(e.processor),m_=(e,t)=>{const n=Vr(t.message)?"":`. ${t.message}`;return e+n},p_=e=>e.valid,ep=(e,t,n="")=>{const s=t(e);return Ps(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},V6=(e,t,n)=>{if(!Et(t)){const s=ep(t,n);if(p_(s))return s.value;console.error(m_(`Invalid default value passed for the "${e}" option`,s))}},W6=(e,t)=>{const n={},s={},o=(f,d,p)=>{const h=ep(d,p);return p_(h)?(s[f]=h.value,!0):(console.warn(m_(`Invalid value passed for the ${f} option`,h)),!1)},r=(f,d)=>{const p=H6(d)?z6(d.processor):d.processor,h=V6(f,d.default,p);n[f]={...d,default:h,processor:p},We(s,f).orThunk(()=>We(t,f)).each(b=>o(f,b,p))},a=f=>de(n,f);return{register:r,isRegistered:a,get:f=>We(s,f).orThunk(()=>We(n,f).map(d=>d.default)).getOrUndefined(),set:(f,d)=>{if(a(f)){const p=n[f];return p.immutable?(console.error(`"${f}" is an immutable option and cannot be updated`),!1):o(f,d,p.processor)}else return console.warn(`"${f}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:f=>{const d=a(f);return d&&delete s[f],d},isSet:f=>de(s,f)}},j6=["design","readonly"],g_=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&T6(e,r.editorReadOnly),t.set(s),QD(e,s)},q6=(e,t,n,s)=>{if(s!==n.get()){if(!de(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?g_(e,n,t,s):e.on("init",()=>g_(e,n,t,s))}},K6=(e,t,n)=>{if(Ie(j6,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},G6=e=>{const t=Ct("design"),n=Ct({design:{activate:he,deactivate:he,editorReadOnly:!1},readonly:{activate:he,deactivate:he,editorReadOnly:!0}});return P6(e),$6(e),{isReadOnly:()=>Io(e),set:s=>q6(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(K6(n.get(),s,o))}}},tp=$.each,np=$.explode,Y6={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},h_=$.makeMap("alt,ctrl,shift,meta,access"),X6=e=>e in h_,Z6=e=>{const t={},n=Ne.os.isMacOS()||Ne.os.isiOS();tp(np(e.toLowerCase(),"+"),r=>{X6(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=Y6[r]||r.toUpperCase().charCodeAt(0))});const s=[t.keyCode];let o;for(o in h_)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class b_{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(tp(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return tp(np($.trim(t)),i=>{const c=r.createShortcut(i,n,a,o);r.shortcuts[c.id]=c}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:$.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=$.map(np(t,">"),Z6);return r[r.length-1]=$.extend(r[r.length-1],{func:s,scope:o||this.editor}),$.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const Q6=()=>{const e={},t={},n={},s={},o={},r={},a={},i={},c=(u,f)=>(d,p)=>{u[d.toLowerCase()]={...p,type:f}},l=(u,f)=>s[u.toLowerCase()]=f;return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(r,"contexttoolbar"),addContextForm:c(r,"contextform"),addSidebar:c(a,"sidebar"),addView:c(i,"views"),addIcon:l,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:a,views:i})}},J6=()=>{const e=Q6();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},$o=Fe.DOM,C_=$.extend,e9=$.each;class hl{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,C_(this,d_);const o=this;this.id=t,this.hidden=!1;const r=$5(s.defaultOptions,n);this.options=W6(o,r),lT(o);const a=this.options.get;a("deprecation_warnings")&&AU(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const c=a("base_url");c&&s._setBaseUrl(c),this.baseUri=s.baseURI;const l=Fu(o);l&&(ks.ScriptLoader._setReferrerPolicy(l),Fe.DOM.styleSheetLoader._setReferrerPolicy(l));const u=gb(o);V(u)&&Fe.DOM.styleSheetLoader._setContentCssCors(u),Ft.languageLoad=a("language_load"),Ft.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new An(ob(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Uu(o),this.hasVisual=QT(o),this.shortcuts=new b_(this),this.editorCommands=new c_(this),w6(this);const f=a("cache_suffix");f&&(Ne.cacheSuffix=f.replace(/^[\?\&]+/,"")),this.ui={registry:J6(),styleSheetLoader:void 0,show:he,hide:he,setEnabled:he,isEnabled:ot},this.mode=G6(o),s.dispatch("SetupEditor",{editor:this});const d=tP(o);Be(d)&&d.call(o,o)}render(){S5(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return xo(this)}translate(t){return Hn.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(V(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:ot,default:n})),!o.isSet(t)&&!Et(n)?n:o.get(t)}hasPlugin(t,n){return Ie(ji(this),t)?n?vr.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":($o.show(t.getContainer()),$o.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):($o.hide(t.getContainer()),$o.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,s=n.getElement();if(n.removed)return"";if(s){const o={...t,load:!0},r=Zl(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",{...o,element:s}),a}else return""}save(t={}){const n=this;let s=n.getElement();if(!s||!n.initialized||n.removed)return"";const o={...t,save:!0,element:s};let r=n.getContent(o);const a={...o,content:r};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,Zl(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);const i=$o.getParent(n.id,"form");i&&e9(i.elements,c=>c.name===n.id?(c.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return Ld(this,t,n)}getContent(t){return gU(this,t)}insertContent(t,n){n&&(t=C_({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Ld(this,this.startContent,{format:"raw"}):Ld(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||$o.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=$o.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s==null?void 0:s.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){const o=this,r=o.options.get,a=sP(o);if(Be(a))return a.call(o,t,s,!0,n);if(!r("convert_urls")||s==="link"||at(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0)return t;const i=new An(t);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){F5(this,t)}setEditableRoot(t){w5(this,t)}hasEditableRoot(){return k5(this)}remove(){DU(this)}destroy(t){OU(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const Nr=Fe.DOM,bl=$.each;let v_=!1,Cl,qt=[];const vl=e=>{const t=e.type;bl(Qs.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},y_=e=>{if(e!==v_){const t=Fe.DOM;e?(t.bind(window,"resize",vl),t.bind(window,"scroll",vl)):(t.unbind(window,"resize",vl),t.unbind(window,"scroll",vl)),v_=e}},E_=e=>{const t=qt;return qt=le(qt,n=>e!==n),Qs.activeEditor===e&&(Qs.activeEditor=qt.length>0?qt[0]:null),Qs.focusedEditor===e&&(Qs.focusedEditor=null),t.length!==qt.length},t9=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(E_(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},n9=document.compatMode!=="CSS1Compat",Qs={...Jm,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"7",minorVersion:"0.0",releaseDate:"2024-03-20",i18n:Hn,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",s=An.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const c=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){c.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new An(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new An(e.baseURL),e.suffix=n,NO(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Ue(s,(o,r)=>{Ft.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=$.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(u,f)=>u.inline&&f.tagName.toLowerCase()in s,r=u=>{let f=u.id;return f||(f=We(u,"name").filter(d=>!Nr.get(d)).getOrThunk(Nr.uniqueId),u.setAttribute("id",f)),f},a=u=>{const f=e[u];if(f)return f.apply(t,[])},i=u=>Ne.browser.isIE()||Ne.browser.isEdge()?(Pc("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):n9?(Pc("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):ee(u.selector)?Nr.select(u.selector):V(u.target)?[u.target]:[];let c=u=>{n=u};const l=()=>{let u=0;const f=[];let d;const p=(h,g,b)=>{const v=new hl(h,g,t);f.push(v),v.on("init",()=>{++u===d.length&&c(f)}),v.targetElm=v.targetElm||b,v.render()};Nr.unbind(window,"ready",l),a("onpageload"),d=bp(i(e)),$.each(d,h=>{t9(t.get(h.id))}),d=$.grep(d,h=>!t.get(h.id)),d.length===0?c([]):bl(d,h=>{o(e,h)?Pc("Could not initialize inline editor on invalid inline target element",h):p(r(h),e,h)})};return Nr.bind(window,"ready",l),new Promise(u=>{n?u(n):c=f=>{u(f)}})},get(e){return arguments.length===0?qt.slice(0):ee(e)?ft(qt,t=>t.id===e).getOr(null):$n(e)&&qt[e]?qt[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&qt.push(e),y_(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),Cl||(Cl=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",Cl))),e},createEditor(e,t){return this.add(new hl(e,t,this))},remove(e){const t=this;let n;if(!e){for(let s=qt.length-1;s>=0;s--)t.remove(qt[s]);return}if(ee(e)){bl(Nr.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,zt(t.get(n.id))?null:(E_(n)&&t.dispatch("RemoveEditor",{editor:n}),qt.length===0&&window.removeEventListener("beforeunload",Cl),n.remove(),y_(qt.length>0),n)},execCommand(e,t,n){var s;const o=this,r=at(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new hl(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{bl(qt,e=>{e.save()})},addI18n:(e,t)=>{Hn.add(e,t)},translate:e=>Hn.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new An(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new An(this.baseURL)}};Qs.setup();const s9=(()=>{const e=Ms(),t=r=>({items:r,types:Gt(r),getType:a=>We(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),S_=Math.min,Ar=Math.max,yl=Math.round,w_=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,c=t.h,l=(n||"").split("");return l[0]==="b"&&(o+=c),l[1]==="r"&&(s+=i),l[0]==="c"&&(o+=yl(c/2)),l[1]==="c"&&(s+=yl(i/2)),l[3]==="b"&&(o-=a),l[4]==="r"&&(s-=r),l[3]==="c"&&(o-=yl(a/2)),l[4]==="c"&&(s-=yl(r/2)),Rr(s,o,r,a)},o9=(e,t,n,s)=>{for(let o=0;o<s.length;o++){const r=w_(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},r9=(e,t,n)=>Rr(e.x-t,e.y-n,e.w+t*2,e.h+n*2),a9=(e,t)=>{const n=Ar(e.x,t.x),s=Ar(e.y,t.y),o=S_(e.x+e.w,t.x+t.w),r=S_(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:Rr(n,s,o-n,r-s)},i9=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,c=t.y+t.h,l=Ar(0,t.x-s),u=Ar(0,t.y-o),f=Ar(0,r-i),d=Ar(0,a-c);return s+=l,o+=u,n&&(r+=l,a+=u,s-=f,o-=d),r-=f,a-=d,Rr(s,o,r-s,a-o)},Rr=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),c9={inflate:r9,relativePosition:w_,findBestRelativePosition:o9,intersect:a9,clamp:i9,create:Rr,fromClientRect:e=>Rr(e.left,e.top,e.width,e.height)},l9=(e,t,n=1e3)=>{let s=!1,o=null;const r=l=>(...u)=>{s||(s=!0,o!==null&&(clearTimeout(o),o=null),l.apply(null,u))},a=r(e),i=r(t);return{start:(...l)=>{!s&&o===null&&(o=setTimeout(()=>i.apply(null,l),n))},resolve:a,reject:i}},u9=(()=>{const e={},t={},n={};return{load:(c,l)=>{const u=`Script at URL "${l}" failed to load`,f=`Script at URL "${l}" did not call \`tinymce.Resource.add('${c}', data)\` within 1 second`;if(e[c]!==void 0)return e[c];{const d=new Promise((p,h)=>{const g=l9(p,h);t[c]=g.resolve,ks.ScriptLoader.loadScript(l).then(()=>g.start(f),()=>g.reject(u))});return e[c]=d,d}},add:(c,l)=>{t[c]!==void 0&&(t[c](l),delete t[c]),e[c]=Promise.resolve(l),n[c]=l},has:c=>c in n,get:c=>n[c],unload:c=>{delete e[c],delete n[c]}}})(),f9=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let li;try{const e="__storage_test__";li=window.localStorage,li.setItem(e,e),li.removeItem(e)}catch{li=f9()}var d9=li;const m9={geom:{Rect:c9},util:{Delay:hn,Tools:$,VK:K,URI:An,EventDispatcher:Qm,Observable:Jm,I18n:Hn,LocalStorage:d9,ImageUploader:fz},dom:{EventUtils:mo,TreeWalker:ht,TextSeeker:ho,DOMUtils:Fe,ScriptLoader:ks,RangeUtils:_o,Serializer:HE,StyleSheetLoader:Vg,ControlSelection:SC,BookmarkManager:Ta,Selection:zE,Event:mo.Event},html:{Styles:gu,Entities:$s,Node:Mt,Schema:Fs,DomParser:br,Writer:lv,Serializer:qs},Env:Ne,AddOnManager:Ft,Annotator:mC,Formatter:s0,UndoManager:r0,EditorCommands:c_,WindowManager:YE,NotificationManager:GE,EditorObservable:d_,Shortcuts:b_,Editor:hl,FocusManager:jC,EditorManager:Qs,DOM:Fe.DOM,ScriptLoader:ks.ScriptLoader,PluginManager:vr,ThemeManager:Po,ModelManager:Cr,IconManager:Rc,Resource:u9,FakeClipboard:s9,trim:$.trim,isArray:$.isArray,is:$.is,toArray:$.toArray,makeMap:$.makeMap,each:$.each,map:$.map,grep:$.grep,inArray:$.inArray,extend:$.extend,walk:$.walk,resolve:$.resolve,explode:$.explode,_addCacheSuffix:$._addCacheSuffix},k_=$.extend(Qs,m9),p9=e=>{if(typeof module=="object")try{module.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(k_),p9(k_)})();export{yK as E};
